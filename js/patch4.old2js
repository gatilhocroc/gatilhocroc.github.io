var CABLES=function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){t.exports=i(2)},function(module,__webpack_exports__,__webpack_require__){"use strict";let GLOB_EXP=/(?:^|[^\\])\*/,NOT_LINE_ENDING=/[^\r\n]/g;const Preprocessor=function(t,e,i){this.source=""+t,this.baseDir="string"==typeof e?e:".",this.includes="object"==typeof e?e:{},this.preserveLineNumbers="boolean"==typeof i&&i,this.isNode=!("undefined"!=typeof window&&window.window),this.errorSourceAhead=50,this.defines=[]};Preprocessor.EXPR=/([ ]*)\/\/[ ]+#(include_once|include|ifn?def|if|endif|else|elif|put|define)/g,Preprocessor.ALL=/([^\r\n]*)\r?(?:\n|$)/,Preprocessor.INCLUDE=/(include_once|include)[ ]+"([^"\\]*(\\.[^"\\]*)*)"[ ]*\r?(?:\n|$)/g,Preprocessor.IF=/(ifdef|ifndef|if)[ ]*([^\r\n]+)\r?\n/g,Preprocessor.ENDIF=/(endif|else|elif)([ ]+[^\r\n]+)?\r?(?:\n|$)/g,Preprocessor.PUT=/put[ ]+([^\n]+)[ ]*/g,Preprocessor.DEFINE=/define[ ]+([^\n\r]+)\r?(?:\n|$)/g,Preprocessor.VAR=/define[ ]+var[ ]+([a-zA-Z_][a-zA-Z0-9_]*)[ ]*=[ ]*(.+)/g,Preprocessor.BOOLVAR=/define[ ]+([a-zA-Z_][a-zA-Z0-9_]*)[ ]*/g,Preprocessor.FUNCTION=/define[ ]+function[ ]+([a-zA-Z_][a-zA-Z0-9_]*)[ ]*(.+)/g,Preprocessor.stripSlashes=function(t){return(t+"").replace(/\\(.?)/g,(function(t,e){switch(e){case"\\":return"\\";case"0":return"\0";case"":return"";default:return e}}))},Preprocessor.addSlashes=function(t){return(t+"").replace(/([\\"'])/g,"\\$1").replace(/\0/g,"\\0")},Preprocessor.indent=function(t,e){let i=t.split("\n");for(let t=0;t<i.length;t++)i[t]=e+i[t];return i.join("\n")},Preprocessor.nlToStr=function(t){return"["+t.replace(/\r/g,"").replace(/\n/g,"\\n")+"]"},Preprocessor.evaluate=function(defines,expr){let evalFunction=function(){for(let key in defines)defines.hasOwnProperty(key)&&("var"===defines[key].type?eval("var "+key+" = "+defines[key].value+";"):eval("function "+key+defines[key].value));return eval(expr)};return evalFunction()},Preprocessor.prototype.process=function(t,e){t=t||{},(e="function"==typeof e?e:function(){})("Defines: "+JSON.stringify(t));let i,s,r,n,o,a,h=[],l=!1;for(;null!==(i=Preprocessor.EXPR.exec(this.source));){e(i[2]+" @ "+i.index+"-"+Preprocessor.EXPR.lastIndex);let _=i[1];if(l&&h.length>0&&"endif"!==i[2]&&"else"!==i[2]&&"elif"!==i[2]){if(a=h.pop(),e("  pop ("+h.length+"): "+JSON.stringify(a)),Preprocessor.ALL.lastIndex=i.index,null===(s=Preprocessor.ALL.exec(this.source)))throw new Error("Illegal #"+i[2]+": "+this.source.substring(i.index,i.index+this.errorSourceAhead)+"...");h.push(o={include:a.include,index:a.index,lastIndex:Preprocessor.ALL.lastIndex}),e("  push ("+h.length+"): "+JSON.stringify(o))}else switch(i[2]){case"ifdef":case"ifndef":case"if":if(Preprocessor.IF.lastIndex=i.index,null===(s=Preprocessor.IF.exec(this.source)))throw new Error("Illegal #"+i[2]+": "+this.source.substring(i.index,i.index+this.errorSourceAhead)+"...");e("  test: "+s[2]),e("  defines  "+JSON.stringify(t)),n="ifdef"===s[1]?void 0!==t[s[2]]:"ifndef"===s[1]?void 0===t[s[2]]:Preprocessor.evaluate(t,s[2]),l=!n,e("  value: "+n+", isSkip: "+l),h.push(o={include:n,index:i.index,lastIndex:Preprocessor.IF.lastIndex}),e("  push ("+h.length+"): "+JSON.stringify(o));break;case"endif":case"else":case"elif":if(Preprocessor.ENDIF.lastIndex=i.index,null===(s=Preprocessor.ENDIF.exec(this.source)))throw new Error("Illegal #"+i[2]+': "'+this.source.substring(i.index,i.index+this.errorSourceAhead)+"...");if(0===h.length)throw new Error("Unexpected #"+s[1]+': "'+this.source.substring(i.index,i.index+this.errorSourceAhead)+"...");a=h.pop(),e("  pop ("+h.length+"): "+JSON.stringify(a)),n=this.preserveLineNumbers?this.source.substring(a.index,a.lastIndex).replace(NOT_LINE_ENDING,"")+this.source.substring(a.lastIndex,i.index)+this.source.substring(i.index,Preprocessor.ENDIF.lastIndex).replace(NOT_LINE_ENDING,""):this.source.substring(a.lastIndex,i.index),a.include?(e("  incl: "+Preprocessor.nlToStr(n)+", 0-"+a.index+" + "+n.length+" bytes + "+Preprocessor.ENDIF.lastIndex+"-"+this.source.length),this.source=this.source.substring(0,a.index)+n+this.source.substring(Preprocessor.ENDIF.lastIndex)):this.preserveLineNumbers?(e("  excl(\\n): "+Preprocessor.nlToStr(n)+", 0-"+a.index+" + "+Preprocessor.ENDIF.lastIndex+"-"+this.source.length),n=n.replace(NOT_LINE_ENDING,""),this.source=this.source.substring(0,a.index)+n+this.source.substring(Preprocessor.ENDIF.lastIndex)):(e("  excl: "+Preprocessor.nlToStr(n)+", 0-"+a.index+" + "+Preprocessor.ENDIF.lastIndex+"-"+this.source.length),n="",this.source=this.source.substring(0,a.index)+this.source.substring(Preprocessor.ENDIF.lastIndex)),""===this.source&&e("  result empty"),l=!1,Preprocessor.EXPR.lastIndex=a.index+n.length,e("  continue at "+Preprocessor.EXPR.lastIndex),"else"!==s[1]&&"elif"!==s[1]||(n="else"===s[1]?!a.include:Preprocessor.evaluate(t,s[2]),l=!n,e("  isSkip: "+l),h.push(o={include:n,index:Preprocessor.EXPR.lastIndex,lastIndex:Preprocessor.EXPR.lastIndex}),e("  push ("+h.length+"): "+JSON.stringify(o)));break;case"define":if(Preprocessor.DEFINE.lastIndex=i.index,Preprocessor.VAR.lastIndex=i.index,Preprocessor.FUNCTION.lastIndex=i.index,Preprocessor.BOOLVAR.lastIndex=i.index,null===(s=Preprocessor.DEFINE.exec(this.source)))throw new Error("Illegal #"+i[2]+": "+this.source.substring(i.index,i.index+this.errorSourceAhead)+"...");var c,u,g;if(e('  def: "'+s[1]+'"'),null!==(r=Preprocessor.VAR.exec(this.source)))g="var",c=r[1],u=r[2],e(" match3(var): "+JSON.stringify(r));else if(null!==(r=Preprocessor.FUNCTION.exec(this.source)))g="function",c=r[1],u=r[2],e(" match3(function): "+JSON.stringify(r));else{if(null===(r=Preprocessor.BOOLVAR.exec(this.source)))throw new Error("Illegal #"+i[2]+": "+this.source.substring(i.index,i.index+this.errorSourceAhead)+"...");g="var",c=r[1],u=!0,e(" match3(boolvar): "+JSON.stringify(r))}e("  type: "+g),e("  identifier: "+c),e("  value: "+u),t[c]={type:g,value:u},e("  defines  "+JSON.stringify(t));var p="";this.preserveLineNumbers&&(p=this.source.substring(i.index,Preprocessor.DEFINE.lastIndex).replace(NOT_LINE_ENDING,"")),this.source=this.source.substring(0,i.index)+_+p+this.source.substring(Preprocessor.DEFINE.lastIndex),Preprocessor.EXPR.lastIndex=i.index,e("  continue at "+Preprocessor.EXPR.lastIndex)}}return h.length>0&&e("Still on stack ("+h.length+"): "+JSON.stringify(h.pop())),this.source};var _unused_webpack_default_export=Preprocessor},function(t,e,i){"use strict";i.r(e);var s={};i.r(s),i.d(s,"getShortOpName",(function(){return p})),i.d(s,"shuffleArray",(function(){return _})),i.d(s,"shortId",(function(){return m})),i.d(s,"uuid",(function(){return T})),i.d(s,"generateUUID",(function(){return A})),i.d(s,"simpleId",(function(){return x})),i.d(s,"smoothStep",(function(){return v})),i.d(s,"smootherStep",(function(){return y})),i.d(s,"clamp",(function(){return I})),i.d(s,"map",(function(){return S})),i.d(s,"cacheBust",(function(){return R})),i.d(s,"copyArray",(function(){return P})),i.d(s,"basename",(function(){return O})),i.d(s,"jsonp",(function(){return F})),i.d(s,"ajaxSync",(function(){return C})),i.d(s,"ajax",(function(){return w})),i.d(s,"request",(function(){return M})),i.d(s,"keyCodeToName",(function(){return U})),i.d(s,"UTILS",(function(){return g}));var r={};i.r(r),i.d(r,"base64Chars",(function(){return k})),i.d(r,"base64lookup",(function(){return D})),i.d(r,"b64encTypesArray",(function(){return G})),i.d(r,"b64decTypedArray",(function(){return H}));var n={};i.r(n),i.d(n,"easeExpoIn",(function(){return j})),i.d(n,"easeExpoOut",(function(){return K})),i.d(n,"easeExpoInOut",(function(){return Q})),i.d(n,"easeCubicIn",(function(){return q})),i.d(n,"easeCubicOut",(function(){return J})),i.d(n,"easeCubicInOut",(function(){return Z})),i.d(n,"ANIM",(function(){return X})),i.d(n,"Anim",(function(){return $})),i.d(n,"TL",(function(){return tt}));var o={};i.r(o),i.d(o,"PatchConnectionReceiver",(function(){return Kt})),i.d(o,"PatchConnectionSender",(function(){return Qt})),i.d(o,"PatchConnectorBroadcastChannel",(function(){return qt}));class a{constructor(t){this._logs=[],this.initiator=t}stack(t){console.error("["+this.initiator+"] ",t),console.log((new Error).stack),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"error",t)}groupCollapsed(t){console.groupCollapsed("["+this.initiator+"] "+t)}table(t){console.table(t)}groupEnd(){console.groupEnd()}error(t){console.error("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"error",arguments)}info(t){console.error("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"info",arguments)}warn(t){console.warn("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"warn",arguments)}verbose(){(CABLES.UI&&CABLES.UI.logFilter.shouldPrint(this.initiator,...arguments)||!CABLES.logSilent)&&console.log("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"verbose",arguments)}log(t){(CABLES.UI&&CABLES.UI.logFilter.shouldPrint(this.initiator,...arguments)||!CABLES.logSilent)&&console.log("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"log",arguments)}userInteraction(t){}}const h={EASINGS:["linear","absolute","smoothstep","smootherstep","Cubic In","Cubic Out","Cubic In Out","Expo In","Expo Out","Expo In Out","Sin In","Sin Out","Sin In Out","Quart In","Quart Out","Quart In Out","Quint In","Quint Out","Quint In Out","Back In","Back Out","Back In Out","Elastic In","Elastic Out","Bounce In","Bounce Out"],EASING_LINEAR:0,EASING_ABSOLUTE:1,EASING_SMOOTHSTEP:2,EASING_SMOOTHERSTEP:3,EASING_CUBICSPLINE:4,EASING_CUBIC_IN:5,EASING_CUBIC_OUT:6,EASING_CUBIC_INOUT:7,EASING_EXPO_IN:8,EASING_EXPO_OUT:9,EASING_EXPO_INOUT:10,EASING_SIN_IN:11,EASING_SIN_OUT:12,EASING_SIN_INOUT:13,EASING_BACK_IN:14,EASING_BACK_OUT:15,EASING_BACK_INOUT:16,EASING_ELASTIC_IN:17,EASING_ELASTIC_OUT:18,EASING_BOUNCE_IN:19,EASING_BOUNCE_OUT:21,EASING_QUART_IN:22,EASING_QUART_OUT:23,EASING_QUART_INOUT:24,EASING_QUINT_IN:25,EASING_QUINT_OUT:26,EASING_QUINT_INOUT:27},l={OP_PORT_TYPE_VALUE:0,OP_PORT_TYPE_FUNCTION:1,OP_PORT_TYPE_OBJECT:2,OP_PORT_TYPE_TEXTURE:2,OP_PORT_TYPE_ARRAY:3,OP_PORT_TYPE_DYNAMIC:4,OP_PORT_TYPE_STRING:5,OP_VERSION_PREFIX:"_v"},c={PORT_DIR_IN:0,PORT_DIR_OUT:1},u={PACO_CLEAR:0,PACO_VALUECHANGE:1,PACO_OP_DELETE:2,PACO_UNLINK:3,PACO_LINK:4,PACO_LOAD:5,PACO_OP_CREATE:6,PACO_OP_ENABLE:7,PACO_OP_DISABLE:8,PACO_UIATTRIBS:9,PACO_VARIABLES:10,PACO_TRIGGERS:11,PACO_PORT_SETVARIABLE:12,PACO_PORT_SETANIMATED:13,PACO_PORT_ANIM_UPDATED:14,PACO_DESERIALIZE:15},g={float32Concat:function(t,e){t instanceof Float32Array||(t=new Float32Array(t)),e instanceof Float32Array||(e=new Float32Array(e));const i=new Float32Array(t.length+e.length);return i.set(t),i.set(e,t.length),i}},p=function(t){let e=t.split(".")[t.split(".").length-1];if(e.indexOf(l.OP_VERSION_PREFIX)>0){const t=e.split(l.OP_VERSION_PREFIX)[1];e=e.substring(0,e.length-(l.OP_VERSION_PREFIX+t).length)}return e},_=function(t){for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.seededRandom()*(e+1)),s=t[e];t[e]=t[i],t[i]=s}return t},d={},f=function(){let t=Math.random().toString(36).substr(2,9);return d.hasOwnProperty(t)&&(t=f()),d[t]=!0,t},m=f,E=function(){let t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?i:3&i|8).toString(16)})},T=E,A=E;let b=0;const x=function(){return b++,b},v=function(t){const e=Math.max(0,Math.min(1,(t-0)/1));return t=e*e*(3-2*e)},y=function(t){const e=Math.max(0,Math.min(1,(t-0)/1));return t=e*e*e*(e*(6*e-15)+10)},I=function(t,e,i){return Math.min(Math.max(t,e),i)},S=function(t,e,i,s,r,n){if(t>=i)return r;if(t<=e)return s;let o=!1;const a=Math.min(e,i),h=Math.max(e,i);a!=e&&(o=!0);let l=!1;const c=Math.min(s,r),u=Math.max(s,r);c!=s&&(l=!0);let g=0,p=0;return g=o?(h-t)*(u-c)/(h-a):(t-a)*(u-c)/(h-a),p=l?u-g:g+c,n?1==n?s+(t=Math.max(0,Math.min(1,(p-s)/(r-s))))*t*(3-2*t)*(r-s):2==n?s+(t=Math.max(0,Math.min(1,(p-s)/(r-s))))*t*t*(t*(6*t-15)+10)*(r-s):p:p};Math.randomSeed=1,Math.seededRandom=function(t,e){0===Math.randomSeed&&(Math.randomSeed=999*Math.random()),t=t||1,e=e||0,Math.randomSeed=(9301*Math.randomSeed+49297)%233280;return e+Math.randomSeed/233280*(t-e)},g.arrayWriteToEnd=function(t,e){for(let e=1;e<t.length;e++)t[e-1]=t[e];t[t.length-1]=e},g.isNumeric=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},g.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},String.prototype.endl=function(){return this+"\n"},String.prototype.startsWith=function(t){return 0===this.indexOf(t)},String.prototype.endsWith=function(t){return this.match(t+"$")==t};const R=function(t){return t.indexOf("?")>-1?t+="&":t+="?",t+"cb="+CABLES.uuid()},P=function(t,e){if(!t)return null;(e=e||[]).length=t.length;for(let i=0;i<t.length;i++)e[i]=t[i];return e},O=function(t){let e="";if(!t)return"";const i=(t+"").split("/");if(i.length>0){let t=i[i.length-1].split("?");e=t[0],t=e.split("."),e=t[0]}return e};let N=null;const F=function(t,e){N=N||0,N++;const i=N;CABLES["jsonpFunc"+i]=function(t){e(!1,t)};let s="?";t.indexOf(s)>-1&&(s="&");const r=document.createElement("script");r.setAttribute("src",t+s+"callback=CABLES.jsonpFunc"+i),document.body.appendChild(r)},C=function(t,e,i,s,r){M({url:t,cb:e,method:i,data:s,contenttype:r,sync:!0})},w=function(t,e,i,s,r,n,o={}){M({url:t,cb:e,method:i,data:s,contenttype:r,sync:!1,jsonP:n,headers:o})},M=function(t){let e;t.hasOwnProperty("asynch")||(t.asynch=!0);try{e=new XMLHttpRequest}catch(t){}if(e.onreadystatechange=function(){4==e.readyState&&t.cb&&(200==e.status||0==e.status?t.cb(!1,e.responseText,e):t.cb(!0,e.responseText,e))},e.addEventListener("progress",t=>{}),e.open(t.method?t.method.toUpperCase():"GET",t.url,!t.sync),"object"==typeof t.headers){const i=Object.keys(t.headers);for(let s=0;s<i.length;s++){const r=i[s],n=t.headers[r];e.setRequestHeader(r,n)}}t.post||t.data?(e.setRequestHeader("Content-type",t.contenttype?t.contenttype:"application/x-www-form-urlencoded"),e.send(t.data||t.post)):e.send()},U=function(t){if(!t&&0!==t)return"Unidentified";const e={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};return e[t]?e[t]:String.fromCharCode(t)};window.performance=window.performance||{offset:Date.now(),now:function(){return Date.now()-this.offset}};const B=function(t,e){if(!t)throw new Error("no cgl");this._log=new a("cgl_texture"),this._cgl=t,this.tex=this._cgl.gl.createTexture(),this.id=CABLES.uuid(),this.width=0,this.height=0,this.loading=!1,this.flip=!0,this.flipped=!1,this.shadowMap=!1,this.deleted=!1,this.image=null,this.anisotropic=0,this.filter=B.FILTER_NEAREST,this.wrap=B.WRAP_CLAMP_TO_EDGE,this.texTarget=this._cgl.gl.TEXTURE_2D,e&&e.type&&(this.texTarget=e.type),this.textureType=B.TYPE_DEFAULT,this.unpackAlpha=!0,this._fromData=!0,this.name="unknown",e?(this.name=e.name||this.name,e.isDepthTexture&&(this.textureType=B.TYPE_DEPTH),e.isFloatingPointTexture&&(this.textureType=B.TYPE_FLOAT),"textureType"in e&&(this.textureType=e.textureType),"filter"in e&&(this.filter=e.filter),"wrap"in e&&(this.wrap=e.wrap),"unpackAlpha"in e&&(this.unpackAlpha=e.unpackAlpha),"flip"in e&&(this.flip=e.flip),"shadowMap"in e&&(this.shadowMap=e.shadowMap),"anisotropic"in e&&(this.anisotropic=e.anisotropic)):e={},e.width||(e.width=8),e.height||(e.height=8),this._cgl.profileData.profileTextureNew++,this._cgl.profileData.addHeavyEvent("texture created",this.name,e.width+"x"+e.height),this.setSize(e.width,e.height),this.getInfoOneLine()};B.prototype.isFloatingPoint=function(){return this.textureType==B.TYPE_FLOAT},B.prototype.compareSettings=function(t){return!!t&&(t.width==this.width&&t.height==this.height&&t.filter==this.filter&&t.wrap==this.wrap&&t.textureType==this.textureType&&t.unpackAlpha==this.unpackAlpha&&t.anisotropic==this.anisotropic&&t.shadowMap==this.shadowMap&&t.texTarget==this.texTarget&&t.flip==this.flip)},B.prototype.clone=function(){const t=new B(this._cgl,{name:this.name,filter:this.filter,wrap:this.wrap,textureType:this.textureType,unpackAlpha:this.unpackAlpha,flip:this.flip,width:this.width,height:this.height});return this._cgl.profileData.addHeavyEvent("texture created",this.name,this.width+"x"+this.height),this.compareSettings(t)||(this._log.error("Cloned texture settings do not compare!"),this._log.error(this),this._log.error(t)),t},B.prototype.setSize=function(t,e){if((t!=t||t<=0||!t)&&(t=8),(e!=e||e<=0||!e)&&(e=8),(t>this._cgl.maxTexSize||e>this._cgl.maxTexSize)&&this._log.error("texture size too big! "+t+"x"+e+" / max: "+this._cgl.maxTexSize),t=Math.min(t,this._cgl.maxTexSize),e=Math.min(e,this._cgl.maxTexSize),t=Math.floor(t),e=Math.floor(e),this.width==t&&this.height==e)return;this.width=t,this.height=e,this.deleted=!1,this.shortInfoString=this.getInfoOneLine(),this._cgl.gl.bindTexture(this.texTarget,this.tex),this._cgl.profileData.profileTextureResize++;if(this._cgl.patch.config.canvas.forceTextureNearest&&(this.filter=B.FILTER_NEAREST),1!=this._cgl.glVersion||this.textureType!=B.TYPE_FLOAT||this.filter!=B.FILTER_LINEAR||this._cgl.gl.getExtension("OES_texture_float_linear")||(console.warn("this graphics card does not support floating point texture linear interpolation! using NEAREST"),this.filter=B.FILTER_NEAREST),this.textureType==B.TYPE_FLOAT)if(1==this._cgl.glVersion)if(this._cgl.glUseHalfFloatTex){const i=this._cgl.gl.getExtension("OES_texture_half_float");this._cgl.gl.getExtension("EXT_color_buffer_half_float");if(!i)throw new Error("no half float texture extension");this._cgl.gl.texImage2D(this.texTarget,0,this._cgl.gl.RGBA,t,e,0,this._cgl.gl.RGBA,i.HALF_FLOAT_OES,null)}else this._cgl.gl.getExtension("OES_texture_float"),this._cgl.gl.texImage2D(this.texTarget,0,this._cgl.gl.RGBA,t,e,0,this._cgl.gl.RGBA,this._cgl.gl.FLOAT,null);else if(this._cgl.glUseHalfFloatTex){if(!this._cgl.gl.getExtension("EXT_color_buffer_half_float"))throw new Error("no half float texture extension");console.log("half float",this._cgl.gl.RGBA16F,this._cgl.gl.HALF_FLOAT),console.log("half float",this._cgl.gl.HALF_FLOAT),console.log("half float",this._cgl.gl.RGBA16F),this._cgl.gl.texImage2D(this.texTarget,0,this._cgl.gl.RGBA,t,e,0,this._cgl.gl.RGBA,this._cgl.gl.HALF_FLOAT,null)}else this._cgl.gl.getExtension("EXT_color_buffer_float"),this._cgl.gl.getExtension("EXT_color_buffer_float_linear"),this._cgl.gl.getExtension("OES_texture_float_linear"),this._cgl.gl.texImage2D(this.texTarget,0,this._cgl.gl.RGBA32F,t,e,0,this._cgl.gl.RGBA,this._cgl.gl.FLOAT,null);else if(this.textureType==B.TYPE_DEPTH)if(1==this._cgl.glVersion){const i=this._cgl.gl.DEPTH_COMPONENT;this._cgl.gl.texImage2D(this.texTarget,0,i,t,e,0,this._cgl.gl.DEPTH_COMPONENT,this._cgl.gl.UNSIGNED_SHORT,null)}else{const i=this._cgl.gl.DEPTH_COMPONENT32F;this._cgl.gl.texImage2D(this.texTarget,0,i,t,e,0,this._cgl.gl.DEPTH_COMPONENT,this._cgl.gl.FLOAT,null)}else this._cgl.gl.texImage2D(this.texTarget,0,this._cgl.gl.RGBA,t,e,0,this._cgl.gl.RGBA,this._cgl.gl.UNSIGNED_BYTE,null);this._setFilter(),this.updateMipMap(),this._cgl.gl.bindTexture(this.texTarget,null)},B.prototype.initFromData=function(t,e,i,s,r){if(this.filter=s,this.wrap=r,null==s&&(this.filter=B.FILTER_LINEAR),null==r&&(this.wrap=B.WRAP_CLAMP_TO_EDGE),this.width=e,this.height=i,this._fromData=!0,this.deleted=!1,this.height>this._cgl.maxTexSize||this.width>this._cgl.maxTexSize){const t=CGL.Texture.getTempTexture(this._cgl);return this.width=t.width,this.height=t.height,this.tex=t.tex,void this._log.error("[cgl_texture] texture size to big!!!",this.width,this.height,this._cgl.maxTexSize)}this.flip&&this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL,this.flip),this._cgl.gl.bindTexture(this.texTarget,this.tex),this.textureType==B.TYPE_FLOAT?this._cgl.gl.texImage2D(this.texTarget,0,this._cgl.gl.RGBA32F,e,i,0,this._cgl.gl.RGBA,this._cgl.gl.FLOAT,t):this._cgl.gl.texImage2D(this.texTarget,0,this._cgl.gl.RGBA,e,i,0,this._cgl.gl.RGBA,this._cgl.gl.UNSIGNED_BYTE,t),this._setFilter(),this.updateMipMap(),this.flip&&this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL,!1),this._cgl.gl.bindTexture(this.texTarget,null)},B.prototype.updateMipMap=function(){2!=this._cgl.glVersion&&!this.isPowerOfTwo()||this.filter!=B.FILTER_MIPMAP||(this._cgl.gl.generateMipmap(this.texTarget),this._cgl.profileData.profileGenMipMap++)},B.prototype.initTexture=function(t,e){if(this._cgl.printError("before initTexture"),this._cgl.checkFrameStarted("texture inittexture"),this._fromData=!1,this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.unpackAlpha),t.width&&(this.width=t.width),t.height&&(this.height=t.height),e&&(this.filter=e),t.height>this._cgl.maxTexSize||t.width>this._cgl.maxTexSize){const e=CGL.Texture.getTempTexture(this._cgl);return this.width=e.width,this.height=e.height,this.tex=e.tex,void this._log.error("[cgl_texture] texture size to big!!!",t.width,t.height,this._cgl.maxTexSize)}this._cgl.gl.bindTexture(this.texTarget,this.tex),this.deleted=!1,this.flipped=!this.flip,this.flipped&&this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL,this.flipped),this._cgl.gl.texImage2D(this.texTarget,0,this._cgl.gl.RGBA,this._cgl.gl.RGBA,this._cgl.gl.UNSIGNED_BYTE,t),this._setFilter(),this.updateMipMap(),this._cgl.gl.bindTexture(this.texTarget,null),this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.flipped&&this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL,!1),this.getInfoOneLine(),this._cgl.printError("initTexture")},B.prototype.delete=function(){this.loading||(this.deleted=!0,this.width=0,this.height=0,this._cgl.profileData.profileTextureDelete++,this._cgl.gl.deleteTexture(this.tex),this.image=null,this.tex=null)},B.prototype.isPowerOfTwo=function(){return B.isPowerOfTwo(this.width)&&B.isPowerOfTwo(this.height)},B.prototype.printInfo=function(){console.log(this.getInfo())},B.prototype.getInfoReadable=function(){const t=this.getInfo();let e="";t.name=t.name.substr(0,t.name.indexOf("?rnd="));for(const i in t)e+="* "+i+":  **"+t[i]+"**\n";return e},B.prototype.getInfoOneLine=function(){let t=this.width+"x"+this.height;return this.textureType===CGL.Texture.TYPE_FLOAT?t+=" 32bit":t+=" 8bit",this.filter===CGL.Texture.FILTER_NEAREST&&(t+=" nearest"),this.filter===CGL.Texture.FILTER_LINEAR&&(t+=" linear"),this.filter===CGL.Texture.FILTER_MIPMAP&&(t+=" mipmap"),this.wrap===CGL.Texture.WRAP_CLAMP_TO_EDGE&&(t+=" clamp"),this.wrap===CGL.Texture.WRAP_REPEAT&&(t+=" repeat"),this.wrap===CGL.Texture.WRAP_MIRRORED_REPEAT&&(t+=" repeatmir"),this.shortInfoString=t,t},B.prototype.getInfo=function(){return B.getTexInfo(this)},B.prototype._setFilter=function(){if(this._cgl.printError("before _setFilter"),this._fromData||this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.unpackAlpha),this.shadowMap&&(this._cgl.gl.texParameteri(this._cgl.gl.TEXTURE_2D,this._cgl.gl.TEXTURE_COMPARE_MODE,this._cgl.gl.COMPARE_REF_TO_TEXTURE),this._cgl.gl.texParameteri(this._cgl.gl.TEXTURE_2D,this._cgl.gl.TEXTURE_COMPARE_FUNC,this._cgl.gl.LEQUAL)),this.textureType==B.TYPE_FLOAT&&this.filter==B.FILTER_MIPMAP&&(this.filter=B.FILTER_LINEAR,this._log.stack("texture: HDR and mipmap filtering at the same time is not possible")),1!=this._cgl.glVersion||this.isPowerOfTwo()){if(this.wrap==B.WRAP_CLAMP_TO_EDGE?(this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.CLAMP_TO_EDGE),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.CLAMP_TO_EDGE)):this.wrap==B.WRAP_REPEAT?(this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.REPEAT),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.REPEAT)):this.wrap==B.WRAP_MIRRORED_REPEAT&&(this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.MIRRORED_REPEAT),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.MIRRORED_REPEAT)),this.filter==B.FILTER_NEAREST)this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.NEAREST),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.NEAREST);else if(this.filter==B.FILTER_LINEAR)this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.LINEAR),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.LINEAR);else{if(this.filter!=B.FILTER_MIPMAP)throw this._log.log("unknown texture filter!",this.filter),new Error("unknown texture filter!"+this.filter);this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.LINEAR),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.LINEAR_MIPMAP_LINEAR)}if(this.anisotropic){const t=this._cgl.gl.getExtension("EXT_texture_filter_anisotropic");if(t){const e=this._cgl.gl.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this._cgl.gl.texParameterf(this._cgl.gl.TEXTURE_2D,t.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e,this.anisotropic))}}}else this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.NEAREST),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.NEAREST),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.CLAMP_TO_EDGE),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.CLAMP_TO_EDGE),this.filter=B.FILTER_NEAREST,this.wrap=B.WRAP_CLAMP_TO_EDGE;this.getInfoOneLine(),this._cgl.printError("_setFilter")},B.load=function(t,e,i,s){if(!e)return i({error:!0});let r=null;t.patch.loading.existByName(e)||(r=t.patch.loading.start("texture",e));const n=new B(t);return n.name=e,t.patch.isEditorMode()&&gui.jobs().start({id:"loadtexture"+r,title:"loading texture "+CABLES.basename(e)}),n.image=new Image,n.image.crossOrigin="anonymous",n.loading=!0,s&&s.hasOwnProperty("filter")&&(n.filter=s.filter),s&&s.hasOwnProperty("flip")&&(n.flip=s.flip),s&&s.hasOwnProperty("wrap")&&(n.wrap=s.wrap),s&&s.hasOwnProperty("anisotropic")&&(n.anisotropic=s.anisotropic),s&&s.hasOwnProperty("unpackAlpha")&&(n.unpackAlpha=s.unpackAlpha),n.image.onabort=n.image.onerror=s=>{console.warn("[cgl.texture.load] error loading texture",e,s),n.loading=!1,r&&t.patch.loading.finished(r);i&&i({error:!0},n),t.patch.isEditorMode()&&gui.jobs().finish("loadtexture"+r)},n.image.onload=function(e){t.addNextFrameOnceCallback(()=>{n.initTexture(n.image),r&&t.patch.loading.finished(r),n.loading=!1,t.patch.isEditorMode()&&gui.jobs().finish("loadtexture"+r),i&&i(null,n)})},n.image.src=e,n},B.getTempTexture=function(t){return t||console.error("[getTempTexture] no cgl!"),t.tempTexture||(t.tempTexture=B.getTemporaryTexture(t,256,B.FILTER_LINEAR,B.REPEAT)),t.tempTexture},B.getEmptyTexture=function(t,e){if(e)return B.getEmptyTextureFloat(t);if(t||console.error("[getEmptyTexture] no cgl!"),t.tempTextureEmpty)return t.tempTextureEmpty;t.tempTextureEmpty=new B(t,{name:"emptyTexture"});const i=new Uint8Array(256).fill(0);for(let t=0;t<256;t+=4)i[t+3]=0;return t.tempTextureEmpty.initFromData(i,8,8,B.FILTER_NEAREST,B.WRAP_REPEAT),t.tempTextureEmpty},B.getEmptyTextureFloat=function(t){if(t||console.error("[getEmptyTextureFloat] no cgl!"),t.tempTextureEmptyFloat)return t.tempTextureEmptyFloat;t.tempTextureEmptyFloat=new B(t,{name:"emptyTexture",isFloatingPointTexture:!0});const e=new Float32Array(256).fill(1);for(let t=0;t<256;t+=4)e[t+3]=0;return t.tempTextureEmptyFloat.initFromData(e,8,8,B.FILTER_NEAREST,B.WRAP_REPEAT),t.tempTextureEmptyFloat},B.getRandomTexture=function(t){if(t||console.error("[getRandomTexture] no cgl!"),t.randomTexture)return t.randomTexture;const e=new Uint8Array(262144);for(let t=0;t<65536;t++)e[4*t+0]=255*Math.random(),e[4*t+1]=255*Math.random(),e[4*t+2]=255*Math.random(),e[4*t+3]=255;return t.randomTexture=new B(t),t.randomTexture.initFromData(e,256,256,B.FILTER_NEAREST,B.WRAP_REPEAT),t.randomTexture},B.getBlackTexture=function(t){if(t||this._log.error("[getBlackTexture] no cgl!"),t.blackTexture)return t.blackTexture;const e=new Uint8Array(256);for(let t=0;t<64;t++)e[4*t+0]=e[4*t+1]=e[4*t+2]=0,e[4*t+3]=255;return t.blackTexture=new B(t),t.blackTexture.initFromData(e,8,8,B.FILTER_NEAREST,B.WRAP_REPEAT),t.blackTexture},B.getEmptyCubemapTexture=function(t){const e=[t.gl.TEXTURE_CUBE_MAP_POSITIVE_X,t.gl.TEXTURE_CUBE_MAP_NEGATIVE_X,t.gl.TEXTURE_CUBE_MAP_POSITIVE_Y,t.gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,t.gl.TEXTURE_CUBE_MAP_POSITIVE_Z,t.gl.TEXTURE_CUBE_MAP_NEGATIVE_Z],i=t.gl.createTexture(),s=t.gl.TEXTURE_CUBE_MAP,r=B.FILTER_NEAREST,n=B.WRAP_CLAMP_TO_EDGE;t.profileData.profileTextureNew++,t.gl.bindTexture(s,i),t.profileData.profileTextureResize++;for(let i=0;i<6;i+=1){const r=new Uint8Array(256);t.gl.texImage2D(e[i],0,t.gl.RGBA,8,8,0,t.gl.RGBA,t.gl.UNSIGNED_BYTE,r),t.gl.texParameteri(s,t.gl.TEXTURE_MAG_FILTER,t.gl.NEAREST),t.gl.texParameteri(s,t.gl.TEXTURE_MIN_FILTER,t.gl.NEAREST),t.gl.texParameteri(s,t.gl.TEXTURE_WRAP_S,t.gl.CLAMP_TO_EDGE),t.gl.texParameteri(s,t.gl.TEXTURE_WRAP_T,t.gl.CLAMP_TO_EDGE)}return t.gl.bindTexture(s,null),{id:CABLES.uuid(),tex:i,cubemap:i,width:8,height:8,filter:r,wrap:n,unpackAlpha:!0,flip:!0,_fromData:!0,name:"emptyCubemapTexture",anisotropic:0}},B.getTempGradientTexture=function(t){if(t||console.error("[getTempGradientTexture] no cgl!"),t.tempTextureGradient)return t.tempTextureGradient;const e=new B(t),i=new Uint8Array(262144);for(let t=0;t<256;t++)for(let e=0;e<256;e++)i[4*(e+256*t)+0]=i[4*(e+256*t)+1]=i[4*(e+256*t)+2]=255-t,i[4*(e+256*t)+3]=255;return e.initFromData(i,256,256,B.FILTER_NEAREST,B.WRAP_REPEAT),t.tempTextureGradient=e,e},B.getTemporaryTexture=function(t,e,i,s){const r=new B(t),n=[];for(let t=0;t<e;t++)for(let i=0;i<e;i++)(i+t)%64<32?(n.push(200+t/e*25+i/e*25),n.push(200+t/e*25+i/e*25),n.push(200+t/e*25+i/e*25)):(n.push(40+t/e*25+i/e*25),n.push(40+t/e*25+i/e*25),n.push(40+t/e*25+i/e*25)),n.push(255);const o=new Uint8Array(n);return r.initFromData(o,e,e,i,s),r},B.createFromImage=function(t,e,i){const s=new B(t,i=i||{});return s.flip=!1,s.image=e,s.width=e.width,s.height=e.height,i.hasOwnProperty("wrap")&&(s.wrap=i.wrap),s.initTexture(e,i.filter),s},B.fromImage=function(t,e,i,s){console.error("deprecated texture from image...");const r=new B(t);return r.flip=!1,i&&(r.filter=i),s&&(r.wrap=s),r.image=e,r.initTexture(e),r},B.isPowerOfTwo=function(t){return 1==t||2==t||4==t||8==t||16==t||32==t||64==t||128==t||256==t||512==t||1024==t||2048==t||4096==t||8192==t||16384==t},B.getTexInfo=function(t){const e={};e.name=t.name,e["power of two"]=B.isPowerOfTwo(),e.size=t.width+" x "+t.height;let i=t.texTarget;return t.texTarget==t._cgl.gl.TEXTURE_2D&&(i="TEXTURE_2D"),e.target=i,e.unpackAlpha=t.unpackAlpha,t.cubemap&&(e.cubemap=!0),t.textureType==B.TYPE_FLOAT?e.textureType="TYPE_FLOAT":t.textureType==B.TYPE_DEPTH?e.textureType="TYPE_DEPTH":t.textureType==B.TYPE_DEFAULT?e.textureType="TYPE_DEFAULT":e.textureType="UNKNOWN",t.wrap==B.WRAP_CLAMP_TO_EDGE?e.wrap="CLAMP_TO_EDGE":t.wrap==B.WRAP_REPEAT?e.wrap="WRAP_REPEAT":t.wrap==B.WRAP_MIRRORED_REPEAT?e.wrap="WRAP_MIRRORED_REPEAT":e.wrap="UNKNOWN",t.filter==B.FILTER_NEAREST?e.filter="FILTER_NEAREST":t.filter==B.FILTER_LINEAR?e.filter="FILTER_LINEAR":t.filter==B.FILTER_MIPMAP?e.filter="FILTER_MIPMAP":e.filter="UNKNOWN",e},B.FILTER_NEAREST=0,B.FILTER_LINEAR=1,B.FILTER_MIPMAP=2,B.WRAP_REPEAT=0,B.WRAP_MIRRORED_REPEAT=1,B.WRAP_CLAMP_TO_EDGE=2,B.TYPE_DEFAULT=0,B.TYPE_DEPTH=1,B.TYPE_FLOAT=2,B.PFORMATSTR_RGBA32F="RGBA 32bit float",B.PFORMATSTR_RGBA8UB="RGBA 8bit ubyte",B.PIXELFORMATS=[B.PFORMATSTR_RGBA8UB,B.PFORMATSTR_RGBA32F];const L=function(t,e,i,s){this._log=new a("cgl_framebuffer2"),this.Framebuffer2DrawTargetsDefault=null,this.Framebuffer2BlittingFramebuffer=null,this.Framebuffer2FinalFramebuffer=null,this._cgl=t,this._cgl.printError("before framebuffer2 constructor"),this._width=0,this._height=0,this._depthRenderbuffer=null,this._frameBuffer=null,this._textureFrameBuffer=null,this._colorRenderbuffers=[],this._drawTargetArray=[],this._disposed=!1,this.Framebuffer2BlittingFramebuffer||(this.Framebuffer2BlittingFramebuffer=t.gl.createFramebuffer()),this.Framebuffer2FinalFramebuffer||(this.Framebuffer2FinalFramebuffer=t.gl.createFramebuffer()),this.Framebuffer2DrawTargetsDefault||(this.Framebuffer2DrawTargetsDefault=[t.gl.COLOR_ATTACHMENT0]),this._options=s||{isFloatingPointTexture:!1},this.name=this._options.name||"unknown",this._cgl.profileData.addHeavyEvent("framebuffer create",this.name),this._options.hasOwnProperty("numRenderBuffers")||(this._options.numRenderBuffers=1),this._options.hasOwnProperty("depth")||(this._options.depth=!0),this._options.hasOwnProperty("clear")||(this._options.clear=!0),this._options.hasOwnProperty("multisampling")||(this._options.multisampling=!1,this._options.multisamplingSamples=0),this._options.multisamplingSamples&&(this._cgl.glSlowRenderer&&(this._options.multisamplingSamples=0),this._cgl.gl.MAX_SAMPLES?this._options.multisamplingSamples=Math.min(this._cgl.maxSamples,this._options.multisamplingSamples):this._options.multisamplingSamples=0),this._options.hasOwnProperty("filter")||(this._options.filter=B.FILTER_LINEAR),this._options.hasOwnProperty("wrap")||(this._options.wrap=B.WRAP_REPEAT),this._numRenderBuffers=this._options.numRenderBuffers,this._colorTextures=[];for(let e=0;e<this._numRenderBuffers;e++)this._colorTextures[e]=new B(t,{name:"fb2 "+this.name+" "+e,isFloatingPointTexture:this._options.isFloatingPointTexture,filter:this._options.filter,wrap:this._options.wrap});let r=B.FILTER_NEAREST;this._options.shadowMap&&(r=B.FILTER_LINEAR);this._options.depth&&(this._textureDepth=new B(t,{name:"fb2 depth "+this.name,isDepthTexture:!0,filter:r,shadowMap:this._options.shadowMap||!1,width:e||512,height:i||512})),t.aborted||(this.setSize(e||512,i||512),this._cgl.printError("framebuffer2 constructor"))};L.prototype.getWidth=function(){return this._width},L.prototype.getHeight=function(){return this._height},L.prototype.getGlFrameBuffer=function(){return this._frameBuffer},L.prototype.getDepthRenderBuffer=function(){return this._depthRenderbuffer},L.prototype.getTextureColor=function(){return this._colorTextures[0]},L.prototype.getTextureColorNum=function(t){return this._colorTextures[t]},L.prototype.getTextureDepth=function(){return this._textureDepth},L.prototype.setFilter=function(t){for(let e=0;e<this._numRenderBuffers;e++)this._colorTextures[e].filter=t,this._colorTextures[e].setSize(this._width,this._height)},L.prototype.delete=L.prototype.dispose=function(){this._disposed=!0;let t=0;for(t=0;t<this._numRenderBuffers;t++)this._colorTextures[t].delete();for(this._textureDepth&&this._textureDepth.delete(),t=0;t<this._numRenderBuffers;t++)this._cgl.gl.deleteRenderbuffer(this._colorRenderbuffers[t]);this._cgl.gl.deleteRenderbuffer(this._depthRenderbuffer),this._cgl.gl.deleteFramebuffer(this._frameBuffer),this._cgl.gl.deleteFramebuffer(this._textureFrameBuffer)},L.prototype.setSize=function(t,e){if(this._disposed)return this._log.warn("disposed framebuffer setsize...");this._cgl.profileData.addHeavyEvent("framebuffer resize",this.name);let i=0;if(this._width=Math.floor(t),this._height=Math.floor(e),this._width=Math.min(this._width,this._cgl.maxTexSize),this._height=Math.min(this._height,this._cgl.maxTexSize),this._cgl.profileData.profileFrameBuffercreate++,this._frameBuffer){for(i=0;i<this._numRenderBuffers;i++)this._cgl.gl.deleteRenderbuffer(this._colorRenderbuffers[i]);this._cgl.gl.deleteRenderbuffer(this._depthRenderbuffer),this._cgl.gl.deleteFramebuffer(this._frameBuffer),this._cgl.gl.deleteFramebuffer(this._textureFrameBuffer)}this._frameBuffer=this._cgl.gl.createFramebuffer(),this._textureFrameBuffer=this._cgl.gl.createFramebuffer();const s=this._options.depth;for(i=0;i<this._numRenderBuffers;i++)this._colorTextures[i].setSize(this._width,this._height);for(i=0;i<this._numRenderBuffers;i++){const t=this._cgl.gl.createRenderbuffer();this._cgl.gl.getExtension("EXT_color_buffer_float");if(this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuffer),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,t),this._options.isFloatingPointTexture){this._cgl.gl.getExtension("EXT_color_buffer_float"),this._cgl.gl.getExtension("EXT_color_buffer_float_linear"),this._cgl.gl.getExtension("OES_texture_float_linear");if(this._options.multisampling&&this._options.multisamplingSamples)this._cgl.gl.renderbufferStorageMultisample(this._cgl.gl.RENDERBUFFER,this._options.multisamplingSamples,this._cgl.gl.RGBA32F,this._width,this._height);else{let t=this._cgl.gl.RGBA32F;this._cgl._isSafariCrap&&(t=this._cgl.gl.RGBA16F),this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,t,this._width,this._height)}}else this._options.multisampling&&this._options.multisamplingSamples?this._cgl.gl.renderbufferStorageMultisample(this._cgl.gl.RENDERBUFFER,this._options.multisamplingSamples,this._cgl.gl.RGBA8,this._width,this._height):this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,this._cgl.gl.RGBA8,this._width,this._height);this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0+i,this._cgl.gl.RENDERBUFFER,t),this._colorRenderbuffers[i]=t}for(this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._textureFrameBuffer),i=0;i<this._numRenderBuffers;i++)this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0+i,this._cgl.gl.TEXTURE_2D,this._colorTextures[i].tex,0);this._options.depth&&this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.TEXTURE_2D,this._textureDepth.tex,0),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuffer);let r=this._cgl.gl.DEPTH_COMPONENT32F;for(this._cgl.glSlowRenderer&&(r=this._cgl.gl.DEPTH_COMPONENT16),s&&(this._textureDepth.setSize(this._width,this._height),this._depthRenderbuffer=this._cgl.gl.createRenderbuffer(),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,this._depthRenderbuffer),this._options.isFloatingPointTexture,this._options.multisampling?this._cgl.gl.renderbufferStorageMultisample(this._cgl.gl.RENDERBUFFER,this._options.multisamplingSamples,r,this._width,this._height):this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,r,this._width,this._height),this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.RENDERBUFFER,this._depthRenderbuffer)),this._drawTargetArray.length=0,i=0;i<this._numRenderBuffers;i++)this._drawTargetArray.push(this._cgl.gl.COLOR_ATTACHMENT0+i);this._cgl.gl.isFramebuffer(this._textureFrameBuffer)||this._log.warn("invalid framebuffer");const n=this._cgl.gl.checkFramebufferStatus(this._cgl.gl.FRAMEBUFFER);if(n!=this._cgl.gl.FRAMEBUFFER_COMPLETE)switch(this._log.error("framebuffer incomplete: "+this.name,this),n){case this._cgl.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw this._log.warn("FRAMEBUFFER_INCOMPLETE_ATTACHMENT...",this),new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");case this._cgl.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw this._log.warn("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT"),new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");case this._cgl.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw this._log.warn("FRAMEBUFFER_INCOMPLETE_DIMENSIONS"),new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");case this._cgl.gl.FRAMEBUFFER_UNSUPPORTED:throw this._log.warn("FRAMEBUFFER_UNSUPPORTED"),new Error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");default:throw this._log.warn("incomplete framebuffer",n),new Error("Incomplete framebuffer: "+n)}this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,null),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,null)},L.prototype.renderStart=function(){if(this._disposed)return this._log.warn("disposed framebuffer renderStart...");this._cgl.checkFrameStarted("fb2 renderstart"),this._cgl.pushModelMatrix(),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuffer),this._cgl.pushGlFrameBuffer(this._frameBuffer),this._cgl.pushFrameBuffer(this),this._cgl.pushPMatrix(),this._cgl.gl.viewport(0,0,this._width,this._height),this._cgl.gl.drawBuffers(this._drawTargetArray),this._options.clear&&(this._cgl.gl.clearColor(0,0,0,0),this._cgl.gl.clear(this._cgl.gl.COLOR_BUFFER_BIT|this._cgl.gl.DEPTH_BUFFER_BIT))},L.prototype.renderEnd=function(){if(this._disposed)return this._log.warn("disposed framebuffer renderEnd...");if(this._cgl.popPMatrix(),this._cgl.profileData.profileFramebuffer++,this._numRenderBuffers<=1)this._cgl.gl.bindFramebuffer(this._cgl.gl.READ_FRAMEBUFFER,this._frameBuffer),this._cgl.gl.bindFramebuffer(this._cgl.gl.DRAW_FRAMEBUFFER,this._textureFrameBuffer),this._cgl.gl.clearBufferfv(this._cgl.gl.COLOR,0,[0,0,0,1]),this._cgl.gl.blitFramebuffer(0,0,this._width,this._height,0,0,this._width,this._height,this._cgl.gl.COLOR_BUFFER_BIT|this._cgl.gl.DEPTH_BUFFER_BIT,this._cgl.gl.NEAREST);else{this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this.Framebuffer2BlittingFramebuffer),this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.RENDERBUFFER,this._depthRenderbuffer),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this.Framebuffer2FinalFramebuffer),this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.TEXTURE_2D,this._textureDepth.tex,0);for(let t=0;t<this._numRenderBuffers;t++){this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this.Framebuffer2BlittingFramebuffer),this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0,this._cgl.gl.RENDERBUFFER,this._colorRenderbuffers[t]),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this.Framebuffer2FinalFramebuffer),this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0,this._cgl.gl.TEXTURE_2D,this._colorTextures[t].tex,0),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,null),this._cgl.gl.bindFramebuffer(this._cgl.gl.READ_FRAMEBUFFER,this.Framebuffer2BlittingFramebuffer),this._cgl.gl.bindFramebuffer(this._cgl.gl.DRAW_FRAMEBUFFER,this.Framebuffer2FinalFramebuffer),this._cgl.gl.clearBufferfv(this._cgl.gl.COLOR,0,[0,0,0,1]);let e=this._cgl.gl.COLOR_BUFFER_BIT;0==t&&(e|=this._cgl.gl.DEPTH_BUFFER_BIT),this._cgl.gl.blitFramebuffer(0,0,this._width,this._height,0,0,this._width,this._height,e,this._cgl.gl.NEAREST)}}if(this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.popGlFrameBuffer()),this._cgl.popFrameBuffer(),this._cgl.popModelMatrix(),this._cgl.resetViewPort(),this._colorTextures[0].filter==B.FILTER_MIPMAP)for(let t=0;t<this._numRenderBuffers;t++)this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,this._colorTextures[t].tex),this._colorTextures[t].updateMipMap(),this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,null)};const k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",V=new Uint8Array(256);for(let t=0;t<k.length;t++)V[k.charCodeAt(t)]=t;const D=V,G=function(t){t.buffer&&(t=t.buffer);let e,i=new Uint8Array(t),s=i.length,r="";for(e=0;e<s;e+=3)r+=k[i[e]>>2],r+=k[(3&i[e])<<4|i[e+1]>>4],r+=k[(15&i[e+1])<<2|i[e+2]>>6],r+=k[63&i[e+2]];return s%3==2?r=r.substring(0,r.length-1)+"=":s%3==1&&(r=r.substring(0,r.length-2)+"=="),r},H=function(t){let e,i,s,r,n,o=.75*t.length,a=t.length,h=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);let l=new ArrayBuffer(o),c=new Uint8Array(l);for(e=0;e<a;e+=4)i=D[t.charCodeAt(e)],s=D[t.charCodeAt(e+1)],r=D[t.charCodeAt(e+2)],n=D[t.charCodeAt(e+3)],c[h++]=i<<2|s>>4,c[h++]=(15&s)<<4|r>>2,c[h++]=(3&r)<<6|63&n;return l};class z{constructor(t){this._init(),this._first=!0,this._wireMesh=null,t&&this.apply(t)}_init(){this._max=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],this._min=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this._center=[0,0,0],this._size=[0,0,0],this._maxAxis=0,this._first=!0}get maxAxis(){return this._maxAxis||1}get size(){return this._size}get center(){return this._center}get x(){return this._center[0]}get y(){return this._center[1]}get z(){return this._center[2]}get minX(){return this._min[0]}get minY(){return this._min[1]}get minZ(){return this._min[2]}get maxX(){return this._max[0]}get maxY(){return this._max[1]}get maxZ(){return this._max[2]}apply(t,e){if(t){if(t instanceof z){const e=t;this.applyPos(e.maxX,e.maxY,e.maxZ),this.applyPos(e.minX,e.minY,e.minZ)}else for(let e=0;e<t.vertices.length;e+=3)this.applyPos(t.vertices[e],t.vertices[e+1],t.vertices[e+2]);this.calcCenterSize()}}copy(){return new z(this)}get changed(){return!(this._max[0]==-Number.MAX_VALUE&&this._max[1]==-Number.MAX_VALUE&&this._max[2]==-Number.MAX_VALUE)}applyPos(t,e,i){if(t!=Number.MAX_VALUE&&t!=-Number.MAX_VALUE&&e!=Number.MAX_VALUE&&e!=-Number.MAX_VALUE&&i!=Number.MAX_VALUE&&i!=-Number.MAX_VALUE&&CABLES.UTILS.isNumeric(t)&&CABLES.UTILS.isNumeric(e)&&CABLES.UTILS.isNumeric(i)){if(this._first)return this._max[0]=t,this._max[1]=e,this._max[2]=i,this._min[0]=t,this._min[1]=e,this._min[2]=i,void(this._first=!1);this._max[0]=Math.max(this._max[0],t),this._max[1]=Math.max(this._max[1],e),this._max[2]=Math.max(this._max[2],i),this._min[0]=Math.min(this._min[0],t),this._min[1]=Math.min(this._min[1],e),this._min[2]=Math.min(this._min[2],i)}}calcCenterSize(){this._first||(this._size[0]=this._max[0]-this._min[0],this._size[1]=this._max[1]-this._min[1],this._size[2]=this._max[2]-this._min[2],this._center[0]=(this._min[0]+this._max[0])/2,this._center[1]=(this._min[1]+this._max[1])/2,this._center[2]=(this._min[2]+this._max[2])/2,this._maxAxis=Math.max(this._size[2],Math.max(this._size[0],this._size[1])))}mulMat4(t){this._first&&(this._max[0]=0,this._max[1]=0,this._max[2]=0,this._min[0]=0,this._min[1]=0,this._min[2]=0,this._first=!1),vec3.transformMat4(this._max,this._max,t),vec3.transformMat4(this._min,this._min,t),this.calcCenterSize()}render(t,e){this._wireMesh||(this._wireMesh=new CGL.WireCube(t)),t.pushModelMatrix(),mat4.translate(t.mMatrix,t.mMatrix,this._center),this._wireMesh.render(t,this._size[0]/2,this._size[1]/2,this._size[2]/2),t.popModelMatrix()}}const W=function(t){this.name=t||"unknown",this._log=new a("cgl_geometry"),this.faceVertCount=3,this.glPrimitive=null,this._attributes={},this._vertices=[],this.verticesIndices=[],this.morphTargets=[],Object.defineProperty(this,"vertices",{get(){return this._vertices},set(t){this.setVertices(t)}}),Object.defineProperty(this,"texCoords",{get(){const t=this.getAttribute("texCoords");return t?t.data:[]},set(t){this.setAttribute("texCoords",t,2)}}),Object.defineProperty(this,"vertexNormals",{get(){const t=this.getAttribute("vertexNormals");return t?t.data:[]},set(t){this.setAttribute("vertexNormals",t,3)}}),Object.defineProperty(this,"tangents",{get(){const t=this.getAttribute("tangents");return t?t.data:[]},set(t){this.setAttribute("tangents",t,3)}}),Object.defineProperty(this,"biTangents",{get(){const t=this.getAttribute("biTangents");return t?t.data:[]},set(t){this.setAttribute("biTangents",t,3)}}),Object.defineProperty(this,"vertexColors",{get(){const t=this.getAttribute("vertexColors");return t?t.data:[]},set(t){this.setAttribute("vertexColors",t,4)}})};W.prototype.clear=function(){this._vertices=new Float32Array([]),this.verticesIndices=[],this.texCoords=new Float32Array([]),this.vertexNormals=new Float32Array([]),this.tangents=[],this.biTangents=[]},W.prototype.getAttributes=function(){return this._attributes},W.prototype.getAttribute=function(t){for(const e in this._attributes)if(this._attributes[e].name==t)return this._attributes[e];return null},W.prototype.setAttribute=function(t,e,i){let s="";(!i||i>4)&&(console.log("itemsize wrong?",i,t),this._log.stack("itemsize"),i=3),1==i?s="float":2==i?s="vec2":3==i?s="vec3":4==i&&(s="vec4");const r={name:t,data:e,itemSize:i,type:s};this._attributes[t]=r},W.prototype.copyAttribute=function(t,e){const i=this.getAttribute(t);e.setAttribute(t,new Float32Array(i.data),i.itemSize)},W.prototype.setVertices=function(t){t instanceof Float32Array?this._vertices=t:this._vertices=new Float32Array(t)},W.prototype.setTexCoords=function(t){t instanceof Float32Array?this.texCoords=t:this.texCoords=new Float32Array(t)},W.prototype.calcNormals=function(t){t||this.unIndex(),this.calculateNormals({})},W.prototype.flipNormals=function(t,e,i){let s=vec3.create();null==t&&(t=1),null==e&&(e=1),null==i&&(i=1);for(let r=0;r<this.vertexNormals.length;r+=3)vec3.set(s,this.vertexNormals[r+0],this.vertexNormals[r+1],this.vertexNormals[r+2]),s[0]*=-t,s[1]*=-e,s[2]*=-i,vec3.normalize(s,s),this.vertexNormals[r+0]=s[0],this.vertexNormals[r+1]=s[1],this.vertexNormals[r+2]=s[2]},W.prototype.getNumTriangles=function(){return this.verticesIndices&&this.verticesIndices.length?this.verticesIndices.length/3:this.vertices.length/3},W.prototype.flipVertDir=function(){const t=[];t.length=this.verticesIndices.length;for(let e=0;e<this.verticesIndices.length;e+=3)t[e]=this.verticesIndices[e+2],t[e+1]=this.verticesIndices[e+1],t[e+2]=this.verticesIndices[e];this.verticesIndices=t},W.prototype.setPointVertices=function(t){if(t.length%3==0){t instanceof Float32Array?this.vertices=t:this.vertices=new Float32Array(t),this.texCoords instanceof Float32Array||(this.texCoords=new Float32Array(t.length/3*2)),this.verticesIndices.length=t.length/3;for(let e=0;e<t.length/3;e++)this.verticesIndices[e]=e,this.texCoords[2*e]=0,this.texCoords[2*e+1]=0}else this._log.error("SetPointVertices: Array must be multiple of three.")},W.prototype.merge=function(t){if(!t)return;if(this.isIndexed()!=t.isIndexed()&&(this.isIndexed()&&this.unIndex(!1,!0),t.isIndexed())){const e=t.copy();e.unIndex(!1,!0),t=e}const e=this.verticesIndices.length,i=this._vertices.length/3;this.verticesIndices.length=this.verticesIndices.length+t.verticesIndices.length;for(let s=0;s<t.verticesIndices.length;s++)this.verticesIndices[e+s]=t.verticesIndices[s]+i;this.vertices=g.float32Concat(this._vertices,t.vertices),this.texCoords=g.float32Concat(this.texCoords,t.texCoords),this.vertexNormals=g.float32Concat(this.vertexNormals,t.vertexNormals),this.tangents=g.float32Concat(this.tangents,t.tangents),this.biTangents=g.float32Concat(this.biTangents,t.biTangents)},W.prototype.copy=function(){const t=new W(this.name+" copy");if(t.faceVertCount=this.faceVertCount,t.glPrimitive=this.glPrimitive,t.setVertices(this._vertices.slice(0)),this.verticesIndices){t.verticesIndices.length=this.verticesIndices.length;for(let e=0;e<this.verticesIndices.length;e++)t.verticesIndices[e]=this.verticesIndices[e]}for(let e in this._attributes)this.copyAttribute(e,t);t.morphTargets.length=this.morphTargets.length;for(let e=0;e<this.morphTargets.length;e++)t.morphTargets[e]=this.morphTargets[e];return t},W.prototype.calculateNormals=function(t){const e=vec3.create(),i=vec3.create(),s=vec3.create();function r(r){return vec3.subtract(e,r[0],r[1]),vec3.subtract(i,r[0],r[2]),vec3.cross(s,e,i),vec3.normalize(s,s),t&&t.forceZUp&&s[2]<0&&(s[0]*=-1,s[1]*=-1,s[2]*=-1),s}this.getVertexVec=function(t){const e=[0,0,0];return e[0]=this.vertices[3*t+0],e[1]=this.vertices[3*t+1],e[2]=this.vertices[3*t+2],e},this.vertexNormals instanceof Float32Array&&this.vertexNormals.length==this.vertices.length||(this.vertexNormals=new Float32Array(this.vertices.length));for(let t=0;t<this.vertices.length;t++)this.vertexNormals[t]=0;if(this.isIndexed()){const t=[];t.length=Math.floor(this.verticesIndices.length/3);for(let e=0;e<this.verticesIndices.length;e+=3){const i=[this.getVertexVec(this.verticesIndices[e+0]),this.getVertexVec(this.verticesIndices[e+1]),this.getVertexVec(this.verticesIndices[e+2])];t[e/3]=r(i),this.vertexNormals[3*this.verticesIndices[e+0]+0]+=t[e/3][0],this.vertexNormals[3*this.verticesIndices[e+0]+1]+=t[e/3][1],this.vertexNormals[3*this.verticesIndices[e+0]+2]+=t[e/3][2],this.vertexNormals[3*this.verticesIndices[e+1]+0]+=t[e/3][0],this.vertexNormals[3*this.verticesIndices[e+1]+1]+=t[e/3][1],this.vertexNormals[3*this.verticesIndices[e+1]+2]+=t[e/3][2],this.vertexNormals[3*this.verticesIndices[e+2]+0]+=t[e/3][0],this.vertexNormals[3*this.verticesIndices[e+2]+1]+=t[e/3][1],this.vertexNormals[3*this.verticesIndices[e+2]+2]+=t[e/3][2]}for(let t=0;t<this.verticesIndices.length;t+=3)for(let e=0;e<3;e++){const i=[this.vertexNormals[3*this.verticesIndices[t+e]+0],this.vertexNormals[3*this.verticesIndices[t+e]+1],this.vertexNormals[3*this.verticesIndices[t+e]+2]];vec3.normalize(i,i),this.vertexNormals[3*this.verticesIndices[t+e]+0]=i[0],this.vertexNormals[3*this.verticesIndices[t+e]+1]=i[1],this.vertexNormals[3*this.verticesIndices[t+e]+2]=i[2]}}else{const t=[];for(let e=0;e<this.vertices.length;e+=9){const i=r([[this.vertices[e+0],this.vertices[e+1],this.vertices[e+2]],[this.vertices[e+3],this.vertices[e+4],this.vertices[e+5]],[this.vertices[e+6],this.vertices[e+7],this.vertices[e+8]]]);t.push(i[0],i[1],i[2],i[0],i[1],i[2],i[0],i[1],i[2])}this.vertexNormals=t}},W.prototype.calcTangentsBitangents=function(){if(!this.vertices.length)return void this._log.error("Cannot calculate tangents/bitangents without vertices.");if(!this.vertexNormals.length)return void this._log.error("Cannot calculate tangents/bitangents without normals.");if(!this.texCoords.length){const t=this.vertices.length/3*2;this.texCoords=new Float32Array(t);for(let e=0;e<t;e+=1)this.texCoords[e]=0}if(!this.verticesIndices||!this.verticesIndices.length)return void this._log.error("Cannot calculate tangents/bitangents without vertex indices.");if(this.verticesIndices.length%3!=0)return void this._log.error("Vertex indices mismatch!");const t=this.verticesIndices.length/3,e=this.vertices.length/3;this.tangents=new Float32Array(this.vertexNormals.length),this.biTangents=new Float32Array(this.vertexNormals.length);const i=[];i.length=2*e;const s=vec3.create(),r=vec3.create(),n=vec3.create(),o=vec2.create(),a=vec2.create(),h=vec2.create(),l=vec3.create(),c=vec3.create();for(let u=0;u<t;u+=1){const t=this.verticesIndices[3*u],g=this.verticesIndices[3*u+1],p=this.verticesIndices[3*u+2];vec3.set(s,this.vertices[3*t],this.vertices[3*t+1],this.vertices[3*t+2]),vec3.set(r,this.vertices[3*g],this.vertices[3*g+1],this.vertices[3*g+2]),vec3.set(n,this.vertices[3*p],this.vertices[3*p+1],this.vertices[3*p+2]),vec2.set(o,this.texCoords[2*t],this.texCoords[2*t+1]),vec2.set(a,this.texCoords[2*g],this.texCoords[2*g+1]),vec2.set(h,this.texCoords[2*p],this.texCoords[2*p+1]);const _=r[0]-s[0],d=n[0]-s[0],f=r[1]-s[1],m=n[1]-s[1],E=r[2]-s[2],T=n[2]-s[2],A=a[0]-o[0],b=h[0]-o[0],x=a[1]-o[1],v=h[1]-o[1],y=1/(A*v-b*x);vec3.set(l,(v*_-x*d)*y,(v*f-x*m)*y,(v*E-x*T)*y),vec3.set(c,(A*d-b*_)*y,(A*m-b*f)*y,(A*T-b*E)*y),i[t]=l,i[g]=l,i[p]=l,i[t+e]=c,i[g+e]=c,i[p+e]=c}const u=vec3.create(),g=vec3.create(),p=vec3.create(),_=vec3.create(),d=vec3.create(),f=vec3.create(),m=vec3.create(),E=vec3.create();for(let t=0;t<e;t+=1){if(!i[t])continue;vec3.set(u,this.vertexNormals[3*t],this.vertexNormals[3*t+1],this.vertexNormals[3*t+2]),vec3.set(g,i[t][0],i[t][1],i[t][2]);const s=vec3.dot(u,g);vec3.scale(d,u,s),vec3.subtract(f,g,d),vec3.normalize(E,f),vec3.cross(m,u,g);vec3.dot(m,i[t+e]);const r=1;vec3.scale(p,E,1/r),vec3.cross(_,u,p),this.tangents[3*t+0]=p[0],this.tangents[3*t+1]=p[1],this.tangents[3*t+2]=p[2],this.biTangents[3*t+0]=_[0],this.biTangents[3*t+1]=_[1],this.biTangents[3*t+2]=_[2]}},W.prototype.isIndexed=function(){return 0==this._vertices.length||0!=this.verticesIndices.length},W.prototype.unIndex=function(t,e){const i=[],s=[],r=[],n=[],o=[],a=[];let h=0,l=0;for(l=0;l<this.verticesIndices.length;l+=3)i.push(this.vertices[3*this.verticesIndices[l+0]+0],this.vertices[3*this.verticesIndices[l+0]+1],this.vertices[3*this.verticesIndices[l+0]+2]),n.push(this.vertexNormals[3*this.verticesIndices[l+0]+0],this.vertexNormals[3*this.verticesIndices[l+0]+1],this.vertexNormals[3*this.verticesIndices[l+0]+2]),this.tangents.length>0&&o.push(this.tangents[3*this.verticesIndices[l+0]+0],this.tangents[3*this.verticesIndices[l+0]+1],this.tangents[3*this.verticesIndices[l+0]+2]),this.biTangents.length>0&&a.push(this.biTangents[3*this.verticesIndices[l+0]+0],this.biTangents[3*this.verticesIndices[l+0]+1],this.biTangents[3*this.verticesIndices[l+0]+2]),this.texCoords?r.push(this.texCoords[2*this.verticesIndices[l+0]+0],this.texCoords[2*this.verticesIndices[l+0]+1]):r.push(0,0),s.push(h),h++,i.push(this.vertices[3*this.verticesIndices[l+1]+0],this.vertices[3*this.verticesIndices[l+1]+1],this.vertices[3*this.verticesIndices[l+1]+2]),n.push(this.vertexNormals[3*this.verticesIndices[l+1]+0],this.vertexNormals[3*this.verticesIndices[l+1]+1],this.vertexNormals[3*this.verticesIndices[l+1]+2]),this.tangents.length>0&&o.push(this.tangents[3*this.verticesIndices[l+1]+0],this.tangents[3*this.verticesIndices[l+1]+1],this.tangents[3*this.verticesIndices[l+1]+2]),this.biTangents.length>0&&a.push(this.biTangents[3*this.verticesIndices[l+1]+0],this.biTangents[3*this.verticesIndices[l+1]+1],this.biTangents[3*this.verticesIndices[l+1]+2]),this.texCoords?r.push(this.texCoords[2*this.verticesIndices[l+1]+0],this.texCoords[2*this.verticesIndices[l+1]+1]):r.push(0,0),s.push(h),h++,i.push(this.vertices[3*this.verticesIndices[l+2]+0],this.vertices[3*this.verticesIndices[l+2]+1],this.vertices[3*this.verticesIndices[l+2]+2]),n.push(this.vertexNormals[3*this.verticesIndices[l+2]+0],this.vertexNormals[3*this.verticesIndices[l+2]+1],this.vertexNormals[3*this.verticesIndices[l+2]+2]),this.tangents.length>0&&o.push(this.tangents[3*this.verticesIndices[l+2]+0],this.tangents[3*this.verticesIndices[l+2]+1],this.tangents[3*this.verticesIndices[l+2]+2]),this.biTangents.length>0&&a.push(this.biTangents[3*this.verticesIndices[l+2]+0],this.biTangents[3*this.verticesIndices[l+2]+1],this.biTangents[3*this.verticesIndices[l+2]+2]),this.texCoords?r.push(this.texCoords[2*this.verticesIndices[l+2]+0],this.texCoords[2*this.verticesIndices[l+2]+1]):r.push(0,0),s.push(h),h++;this.vertices=i,this.texCoords=r,this.vertexNormals=n,o.length>0&&(this.tangents=o),a.length>0&&(this.biTangents=a),this.verticesIndices.length=0,t&&(this.verticesIndices=s),e||this.calculateNormals()},W.prototype.calcBarycentric=function(){let t=[];t.length=this.vertices.length;for(let e=0;e<this.vertices.length;e++)t[e]=0;let e=0;for(let i=0;i<this.vertices.length;i+=3)t[i+e]=1,e++,3==e&&(e=0);this.setAttribute("attrBarycentric",t,3)},W.prototype.getBounds=function(){return new z(this)},W.prototype.center=function(t,e,i){void 0===t&&(t=!0,e=!0,i=!0);let s=0;const r=this.getBounds(),n=[r.minX+(r.maxX-r.minX)/2,r.minY+(r.maxY-r.minY)/2,r.minZ+(r.maxZ-r.minZ)/2];for(s=0;s<this.vertices.length;s+=3)this.vertices[s+0]==this.vertices[s+0]&&(t&&(this.vertices[s+0]-=n[0]),e&&(this.vertices[s+1]-=n[1]),i&&(this.vertices[s+2]-=n[2]));return n},W.prototype.mapTexCoords2d=function(){const t=this.getBounds(),e=this.vertices.length/3;this.texCoords=new Float32Array(2*e);for(let i=0;i<e;i++){const e=this.vertices[3*i+0],s=this.vertices[3*i+1];this.texCoords[2*i+0]=e/(t.maxX-t.minX)+.5,this.texCoords[2*i+1]=1-s/(t.maxY-t.minY)+.5}},W.prototype.getInfo=function(){const t={};return 3==this.faceVertCount&&this.verticesIndices?t.numFaces=this.verticesIndices.length/3:t.numFaces=0,this.verticesIndices&&this.verticesIndices.length&&(t.indices=this.verticesIndices.length),this.vertices?t.numVerts=this.vertices.length/3:t.numVerts=0,this.vertexNormals?t.numNormals=this.vertexNormals.length/3:t.numNormals=0,this.texCoords?t.numTexCoords=this.texCoords.length/2:t.numTexCoords=0,this.tangents?t.numTangents=this.tangents.length/3:t.numTangents=0,this.biTangents?t.numBiTangents=this.biTangents.length/3:t.numBiTangents=0,this.biTangents?t.numBiTangents=this.biTangents.length/3:t.numBiTangents=0,this.vertexColors?t.numVertexColors=this.vertexColors.length/4:t.numVertexColors=0,this.getAttributes()?t.numAttribs=Object.keys(this.getAttributes()).length:t.numAttribs=0,t.isIndexed=this.isIndexed(),t},W.buildFromFaces=function(t,e,i){const s=[],r=[];for(let e=0;e<t.length;e+=3){const n=t[e+0],o=t[e+1],a=t[e+2],h=[-1,-1,-1];if(i)for(let t=0;t<s.length;t+=3)s[t+0]==n[0]&&s[t+1]==n[1]&&s[t+2]==n[2]&&(h[0]=t/3),s[t+0]==o[0]&&s[t+1]==o[1]&&s[t+2]==o[2]&&(h[1]=t/3),s[t+0]==a[0]&&s[t+1]==a[1]&&s[t+2]==a[2]&&(h[2]=t/3);-1==h[0]&&(s.push(n[0],n[1],n[2]),h[0]=(s.length-1)/3),-1==h[1]&&(s.push(o[0],o[1],o[2]),h[1]=(s.length-1)/3),-1==h[2]&&(s.push(a[0],a[1],a[2]),h[2]=(s.length-1)/3),r.push(parseInt(h[0],10)),r.push(parseInt(h[1],10)),r.push(parseInt(h[2],10))}const n=new W(e);return n.name=e,n.vertices=s,n.verticesIndices=r,n},W.json2geom=function(t){const e=new W("jsonMeshGeom");if(e.verticesIndices=[],e.vertices=t.vertices||[],e.vertexNormals=t.normals||[],e.vertexColors=t.colors||[],e.tangents=t.tangents||[],e.biTangents=t.bitangents||[],t.texturecoords&&e.setTexCoords(t.texturecoords[0]),t.vertices_b64&&(e.vertices=new Float32Array(H(t.vertices_b64))),t.normals_b64&&(e.vertexNormals=new Float32Array(H(t.normals_b64))),t.tangents_b64&&(e.tangents=new Float32Array(H(t.tangents_b64))),t.bitangents_b64&&(e.biTangents=new Float32Array(H(t.bitangents_b64))),t.texturecoords_b64&&e.setTexCoords(new Float32Array(H(t.texturecoords_b64[0]))),t.faces_b64)e.verticesIndices=new Uint32Array(H(t.faces_b64));else{e.verticesIndices.length=3*t.faces.length;for(let i=0;i<t.faces.length;i++)e.verticesIndices[3*i]=t.faces[i][0],e.verticesIndices[3*i+1]=t.faces[i][1],e.verticesIndices[3*i+2]=t.faces[i][2]}return e};const Y=function(){this._log=new a("eventtaget"),this._eventCallbacks={},this._logName="",this._logEvents=!1,this._listeners={},this.addEventListener=this.on=function(t,e,i){const s={id:(i||"")+CABLES.uuid(),name:t,cb:e};return this._eventCallbacks[t]?this._eventCallbacks[t].push(s):this._eventCallbacks[t]=[s],this._listeners[s.id]=s,s.id},this.hasEventListener=function(t,e){if(t&&!e)return!!this._listeners[t];if(this._log.warn("old eventtarget function haseventlistener!"),t&&e&&this._eventCallbacks[t]){return-1!=this._eventCallbacks[t].indexOf(e)}},this.removeEventListener=this.off=function(t,e){if(null==t)return;if(!e){const e=this._listeners[t];if(!e)return;let i=!0;for(;i;){i=!1;let s=-1;for(let r=0;r<this._eventCallbacks[e.name].length;r++)0===this._eventCallbacks[e.name][r].id.indexOf(t)&&(i=!0,s=r);-1!==s&&(this._eventCallbacks[e.name].splice(s,1),delete this._listeners[t])}return}this._log.stack(" old function signature: removeEventListener! use listener id");let i=null;for(let s=0;s<this._eventCallbacks[t].length;s++)this._eventCallbacks[t][s].cb==e&&(i=s);null!==i?delete this._eventCallbacks[i]:this._log.warn("removeEventListener not found "+t)},this.logEvents=function(t,e){this._logEvents=t,this._logName=e},this.emitEvent=function(t,e,i,s,r,n,o){if(this._logEvents&&console.log("[event] ",this._logName,t,this._eventCallbacks),this._eventCallbacks[t])for(let a=0;a<this._eventCallbacks[t].length;a++)this._eventCallbacks[t][a]&&this._eventCallbacks[t][a].cb(e,i,s,r,n,o);else this._logEvents&&console.log("[event] has no event callback",t,this._eventCallbacks)}},X={Key:function(t){this.time=0,this.value=0,this.ui=null,this.onChange=null,this._easing=0,this.bezTangIn=0,this.bezTangOut=0,this.cb=null,this.cbTriggered=!1;this.setEasing(h.EASING_LINEAR),this.set(t)}};X.Key.cubicSpline=function(t,e,i){let s=t*t,r=s*t;return(2*r-3*s+1)*e.value+(r-2*s+t)*e.bezTangOut+(-2*r+3*s)*i.value+(r-s)*i.bezTangIn},X.Key.easeCubicSpline=function(t,e){return X.Key.cubicSpline(t,this,e)},X.Key.linear=function(t,e,i){return parseFloat(e.value)+parseFloat(i.value-e.value)*t},X.Key.easeLinear=function(t,e){return X.Key.linear(t,this,e)},X.Key.easeAbsolute=function(t,e){return this.value};const j=function(t){return Math.pow(2,10*(t-1))};X.Key.easeExpoIn=function(t,e){return t=j(t),X.Key.linear(t,this,e)};const K=function(t){return t=1-Math.pow(2,-10*t)};X.Key.easeExpoOut=function(t,e){return t=K(t),X.Key.linear(t,this,e)};const Q=function(t){return(t*=2)<1?t=.5*Math.pow(2,10*(t-1)):(t--,t=.5*(2-Math.pow(2,-10*t))),t};X.Key.easeExpoInOut=function(t,e){return t=Q(t),X.Key.linear(t,this,e)},X.Key.easeSinIn=function(t,e){return t=-1*Math.cos(t*Math.PI/2)+1,X.Key.linear(t,this,e)},X.Key.easeSinOut=function(t,e){return t=Math.sin(t*Math.PI/2),X.Key.linear(t,this,e)},X.Key.easeSinInOut=function(t,e){return t=-.5*(Math.cos(Math.PI*t)-1),X.Key.linear(t,this,e)};const q=function(t){return t*=t*t};X.Key.easeCubicIn=function(t,e){return t=q(t),X.Key.linear(t,this,e)},X.Key.easeInQuint=function(t,e){return t*=t*t*t*t,X.Key.linear(t,this,e)},X.Key.easeOutQuint=function(t,e){return t=(t-=1)*t*t*t*t+1,X.Key.linear(t,this,e)},X.Key.easeInOutQuint=function(t,e){return(t/=.5)<1?t*=.5*t*t*t*t:t=.5*((t-=2)*t*t*t*t+2),X.Key.linear(t,this,e)},X.Key.easeInQuart=function(t,e){return t*=t*t*t,X.Key.linear(t,this,e)},X.Key.easeOutQuart=function(t,e){return t=-1*((t-=1)*t*t*t-1),X.Key.linear(t,this,e)},X.Key.easeInOutQuart=function(t,e){return(t/=.5)<1?t*=.5*t*t*t:t=-.5*((t-=2)*t*t*t-2),X.Key.linear(t,this,e)},X.Key.bounce=function(t){return(t/=1)<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,t},X.Key.easeInBounce=function(t,e){return X.Key.linear(X.Key.bounce(t),this,e)},X.Key.easeOutBounce=function(t,e){return X.Key.linear(X.Key.bounce(t),this,e)},X.Key.easeInElastic=function(t,e){let i=1.70158,s=0,r=1;return 0===t?t=0:1==(t/=1)?t=1:(s||(s=.3),r<Math.abs(1)?(r=1,i=s/4):i=s/(2*Math.PI)*Math.asin(1/r),t=-r*Math.pow(2,10*(t-=1))*Math.sin((1*t-i)*(2*Math.PI)/s)+0),X.Key.linear(t,this,e)},X.Key.easeOutElastic=function(t,e){let i=1.70158,s=0,r=1;return 0===t?t=0:1==(t/=1)?t=1:(s||(s=.3),r<Math.abs(1)?(r=1,i=s/4):i=s/(2*Math.PI)*Math.asin(1/r),t=r*Math.pow(2,-10*t)*Math.sin((1*t-i)*(2*Math.PI)/s)+1+0),X.Key.linear(t,this,e)},X.Key.easeInBack=function(t,e){const i=1.70158;return t=t*t*((i+1)*t-i),X.Key.linear(t,this,e)},X.Key.easeOutBack=function(t,e){const i=1.70158;return t=(t=t/1-1)*t*((i+1)*t+i)+1,X.Key.linear(t,this,e)},X.Key.easeInOutBack=function(t,e){let i=1.70158;return t=(t/=.5)<1?t*t*((1+(i*=1.525))*t-i)*.5:.5*((t-=2)*t*((1+(i*=1.525))*t+i)+2),X.Key.linear(t,this,e)};const J=function(t){return t=--t*t*t+1};X.Key.easeCubicOut=function(t,e){return t=J(t),X.Key.linear(t,this,e)};const Z=function(t){return(t*=2)<1?t*=.5*t*t:t=.5*((t-=2)*t*t+2),t};X.Key.easeCubicInOut=function(t,e){return t=Z(t),X.Key.linear(t,this,e)},X.Key.easeSmoothStep=function(t,e){const i=Math.max(0,Math.min(1,t));return t=i*i*(3-2*i),X.Key.linear(t,this,e)},X.Key.easeSmootherStep=function(t,e){const i=Math.max(0,Math.min(1,(t-0)/1));return t=i*i*i*(i*(6*i-15)+10),X.Key.linear(t,this,e)},X.Key.prototype.setEasing=function(t){this._easing=t,this._easing==h.EASING_LINEAR?this.ease=X.Key.easeLinear:this._easing==h.EASING_ABSOLUTE?this.ease=X.Key.easeAbsolute:this._easing==h.EASING_SMOOTHSTEP?this.ease=X.Key.easeSmoothStep:this._easing==h.EASING_SMOOTHERSTEP?this.ease=X.Key.easeSmootherStep:this._easing==h.EASING_CUBIC_IN?this.ease=X.Key.easeCubicIn:this._easing==h.EASING_CUBIC_OUT?this.ease=X.Key.easeCubicOut:this._easing==h.EASING_CUBIC_INOUT?this.ease=X.Key.easeCubicInOut:this._easing==h.EASING_EXPO_IN?this.ease=X.Key.easeExpoIn:this._easing==h.EASING_EXPO_OUT?this.ease=X.Key.easeExpoOut:this._easing==h.EASING_EXPO_INOUT?this.ease=X.Key.easeExpoInOut:this._easing==h.EASING_SIN_IN?this.ease=X.Key.easeSinIn:this._easing==h.EASING_SIN_OUT?this.ease=X.Key.easeSinOut:this._easing==h.EASING_SIN_INOUT?this.ease=X.Key.easeSinInOut:this._easing==h.EASING_BACK_OUT?this.ease=X.Key.easeOutBack:this._easing==h.EASING_BACK_IN?this.ease=X.Key.easeInBack:this._easing==h.EASING_BACK_INOUT?this.ease=X.Key.easeInOutBack:this._easing==h.EASING_ELASTIC_IN?this.ease=X.Key.easeInElastic:this._easing==h.EASING_ELASTIC_OUT?this.ease=X.Key.easeOutElastic:this._easing==h.EASING_ELASTIC_INOUT?this.ease=X.Key.easeElasticInOut:this._easing==h.EASING_BOUNCE_IN?this.ease=X.Key.easeInBounce:this._easing==h.EASING_BOUNCE_OUT?this.ease=X.Key.easeOutBounce:this._easing==h.EASING_QUART_OUT?this.ease=X.Key.easeOutQuart:this._easing==h.EASING_QUART_IN?this.ease=X.Key.easeInQuart:this._easing==h.EASING_QUART_INOUT?this.ease=X.Key.easeInOutQuart:this._easing==h.EASING_QUINT_OUT?this.ease=X.Key.easeOutQuint:this._easing==h.EASING_QUINT_IN?this.ease=X.Key.easeInQuint:this._easing==h.EASING_QUINT_INOUT?this.ease=X.Key.easeInOutQuint:this._easing==h.EASING_CUBICSPLINE?this.ease=X.Key.easeCubicSpline:(this._easing=h.EASING_LINEAR,this.ease=X.Key.easeLinear)},X.Key.prototype.trigger=function(){this.cb(),this.cbTriggered=!0},X.Key.prototype.setValue=function(t){this.value=t,null!==this.onChange&&this.onChange()},X.Key.prototype.set=function(t){t&&(t.e&&this.setEasing(t.e),t.cb&&(this.cb=t.cb,this.cbTriggered=!1),t.b,t.hasOwnProperty("t")&&(this.time=t.t),t.hasOwnProperty("time")&&(this.time=t.time),t.hasOwnProperty("v")?this.value=t.v:t.hasOwnProperty("value")&&(this.value=t.value)),null!==this.onChange&&this.onChange()},X.Key.prototype.getSerialized=function(){const t={};return t.t=this.time,t.v=this.value,t.e=this._easing,t},X.Key.prototype.getEasing=function(){return this._easing};const $=function(t){Y.apply(this),t=t||{},this.keys=[],this.onChange=null,this.stayInTimeline=!1,this.loop=!1,this._log=new a("Anim"),this.defaultEasing=t.defaultEasing||h.EASING_LINEAR,this.onLooped=null,this._timesLooped=0,this._needsSort=!1};$.prototype.forceChangeCallback=function(){null!==this.onChange&&this.onChange(),this.emitEvent("onChange",this)},$.prototype.getLoop=function(){return this.loop},$.prototype.setLoop=function(t){this.loop=t,this.emitEvent("onChange",this)},$.prototype.hasEnded=function(t){return 0===this.keys.length||this.keys[this.keys.length-1].time<=t},$.prototype.isRising=function(t){if(this.hasEnded(t))return!1;const e=this.getKeyIndex(t);return this.keys[e].value<this.keys[e+1].value},$.prototype.clearBefore=function(t){const e=this.getValue(t),i=this.getKeyIndex(t);this.setValue(t,e),i>1&&this.keys.splice(0,i)},$.prototype.clear=function(t){let e=0;t&&(e=this.getValue(t)),this.keys.length=0,t&&this.setValue(t,e),null!==this.onChange&&this.onChange(),this.emitEvent("onChange",this)},$.prototype.sortKeys=function(){this.keys.sort((t,e)=>parseFloat(t.time)-parseFloat(e.time)),this._needsSort=!1},$.prototype.getLength=function(){return 0===this.keys.length?0:this.keys[this.keys.length-1].time},$.prototype.getKeyIndex=function(t){let e=0;for(let i=0;i<this.keys.length;i++)if(t>=this.keys[i].time&&(e=i),this.keys[i].time>t)return e;return e},$.prototype.setValue=function(t,e,i){let s=null;for(const r in this.keys)if(this.keys[r].time==t){s=this.keys[r],this.keys[r].setValue(e),this.keys[r].cb=i;break}return s||(s=new X.Key({time:t,value:e,e:this.defaultEasing,cb:i}),this.keys.push(s)),this.onChange&&this.onChange(),this.emitEvent("onChange",this),this._needsSort=!0,s},$.prototype.setKeyEasing=function(t,e){this.keys[t]&&(this.keys[t].setEasing(e),this.emitEvent("onChange",this))},$.prototype.getSerialized=function(){const t={keys:[]};t.loop=this.loop;for(const e in this.keys)t.keys.push(this.keys[e].getSerialized());return t},$.prototype.getKey=function(t){const e=this.getKeyIndex(t);return this.keys[e]},$.prototype.getNextKey=function(t){let e=this.getKeyIndex(t)+1;return e>=this.keys.length&&(e=this.keys.length-1),this.keys[e]},$.prototype.isFinished=function(t){return this.keys.length<=0||t>this.keys[this.keys.length-1].time},$.prototype.isStarted=function(t){return!(this.keys.length<=0)&&t>=this.keys[0].time},$.prototype.getValue=function(t){if(0===this.keys.length)return 0;if(this._needsSort&&this.sortKeys(),t<this.keys[0].time)return this.keys[0].value;const e=this.keys.length-1;if(this.loop&&t>this.keys[e].time){t/this.keys[e].time>this._timesLooped&&(this._timesLooped++,this.onLooped&&this.onLooped()),t=(t-this.keys[0].time)%(this.keys[e].time-this.keys[0].time),t+=this.keys[0].time}const i=this.getKeyIndex(t);if(i>=e)return this.keys[e].cb&&!this.keys[e].cbTriggered&&this.keys[e].trigger(),this.keys[e].value;const s=parseInt(i,10)+1,r=this.keys[i],n=this.keys[s];if(r.cb&&!r.cbTriggered&&r.trigger(),!n)return-1;const o=(t-r.time)/(n.time-r.time);return r.ease||this.log._warn("has no ease",r,n),r.ease(o,n)},$.prototype.addKey=function(t){void 0===t.time?this.log.warn("key time undefined, ignoring!"):(this.keys.push(t),null!==this.onChange&&this.onChange(),this.emitEvent("onChange",this))},$.prototype.easingFromString=function(t){return"linear"==t?h.EASING_LINEAR:"absolute"==t?h.EASING_ABSOLUTE:"smoothstep"==t?h.EASING_SMOOTHSTEP:"smootherstep"==t?h.EASING_SMOOTHERSTEP:"Cubic In"==t?h.EASING_CUBIC_IN:"Cubic Out"==t?h.EASING_CUBIC_OUT:"Cubic In Out"==t?h.EASING_CUBIC_INOUT:"Expo In"==t?h.EASING_EXPO_IN:"Expo Out"==t?h.EASING_EXPO_OUT:"Expo In Out"==t?h.EASING_EXPO_INOUT:"Sin In"==t?h.EASING_SIN_IN:"Sin Out"==t?h.EASING_SIN_OUT:"Sin In Out"==t?h.EASING_SIN_INOUT:"Back In"==t?h.EASING_BACK_IN:"Back Out"==t?h.EASING_BACK_OUT:"Back In Out"==t?h.EASING_BACK_INOUT:"Elastic In"==t?h.EASING_ELASTIC_IN:"Elastic Out"==t?h.EASING_ELASTIC_OUT:"Bounce In"==t?h.EASING_BOUNCE_IN:"Bounce Out"==t?h.EASING_BOUNCE_OUT:"Quart Out"==t?h.EASING_QUART_OUT:"Quart In"==t?h.EASING_QUART_IN:"Quart In Out"==t?h.EASING_QUART_INOUT:"Quint Out"==t?h.EASING_QUINT_OUT:"Quint In"==t?h.EASING_QUINT_IN:"Quint In Out"==t?h.EASING_QUINT_INOUT:void 0},$.prototype.createPort=function(t,e,i){const s=t.inDropDown(e,h.EASINGS);return s.set("linear"),s.defaultValue="linear",s.onChange=function(){this.defaultEasing=this.easingFromString(s.get()),i&&i()}.bind(this),s},$.slerpQuaternion=function(t,e,i,s,r,n){$.slerpQuaternion.q1||($.slerpQuaternion.q1=quat.create(),$.slerpQuaternion.q2=quat.create());const o=i.getKeyIndex(t);let a=o+1;if(a>=i.keys.length&&(a=i.keys.length-1),o==a)quat.set(e,i.keys[o].value,s.keys[o].value,r.keys[o].value,n.keys[o].value);else{const h=i.keys[o].time,l=(t-h)/(i.keys[a].time-h);quat.set($.slerpQuaternion.q1,i.keys[o].value,s.keys[o].value,r.keys[o].value,n.keys[o].value),quat.set($.slerpQuaternion.q2,i.keys[a].value,s.keys[a].value,r.keys[a].value,n.keys[a].value),quat.slerp(e,$.slerpQuaternion.q1,$.slerpQuaternion.q2,l)}return e};const tt=X;tt.Anim=$;const et=function(t,e,i,s){Y.apply(this),this.data={},this._log=new a("core_port"),this.direction=c.PORT_DIR_IN,this.id=CABLES.simpleId(),this.parent=t,this.links=[],this.value=0,this.name=e,this.type=i||l.OP_PORT_TYPE_VALUE,this.uiAttribs=s||{},this.anim=null,this._oldAnimVal=-5711,this.defaultValue=null,this._uiActiveState=!0,this.ignoreValueSerialize=!1,this.onLinkChanged=null,this.crashed=!1,this._valueBeforeLink=null,this._lastAnimFrame=-1,this._animated=!1,this.onValueChanged=null,this.onTriggered=null,this.onUiActiveStateChange=null,this.changeAlways=!1,this._warnedDeprecated=!1,this._useVariableName=null,this.activityCounter=0,this._tempLastUiValue=null,Object.defineProperty(this,"title",{get(){return this.uiAttribs.title||this.name}}),Object.defineProperty(this,"val",{get(){return this._log.warn("val getter deprecated!",this),this._log.stack("val getter deprecated"),this._warnedDeprecated=!0,this.get()},set(t){this._log.warn("val setter deprecated!",this),this._log.stack("val setter deprecated"),this.setValue(t),this._warnedDeprecated=!0}})};et.prototype.copyLinkedUiAttrib=function(t,e){if(!CABLES.UI)return;if(!this.isLinked())return;const i={};i[t]=this.links[0].getOtherPort(this).getUiAttrib(t),e.setUiAttribs(i)},et.prototype.getValueForDisplay=function(){let t=String(this.value);return this.uiAttribs&&"boolnum"==this.uiAttribs.display&&(t+=" - ",this.value?t+="true":t+="false"),t=t.replace(/(<([^>]+)>)/gi,""),t.length>100&&(t=t.substring(0,100)),t},et.prototype.onAnimToggle=function(){},et.prototype._onAnimToggle=function(){this.onAnimToggle()},et.prototype.remove=function(){this.removeLinks(),this.parent.removePort(this)},et.prototype.setUiAttribs=function(t){let e=!1;this.uiAttribs||(this.uiAttribs={});for(const i in t)this.uiAttribs[i]!=t[i]&&(e=!0),this.uiAttribs[i]=t[i],"group"==i&&this.indexPort&&this.indexPort.setUiAttribs({group:t[i]});e&&this.emitEvent("onUiAttrChange",t,this)},et.prototype.getUiAttribs=function(){return this.uiAttribs},et.prototype.getUiAttrib=function(t){return this.uiAttribs&&this.uiAttribs.hasOwnProperty(t)?this.uiAttribs[t]:null},et.prototype.get=function(){return this._animated&&this._lastAnimFrame!=this.parent.patch.getFrameNum()&&(this._lastAnimFrame=this.parent.patch.getFrameNum(),this.value=this.anim.getValue(this.parent.patch.timer.getTime()),this._oldAnimVal=this.value,this.forceChange()),this.value},et.prototype.set=et.prototype.setValue=function(t){if(void 0!==t&&this.parent.enabled&&!this.crashed&&(t!==this.value||this.changeAlways||this.type==l.OP_PORT_TYPE_TEXTURE||this.type==l.OP_PORT_TYPE_ARRAY)){if(this._animated)this.anim.setValue(this.parent.patch.timer.getTime(),t);else{try{this.value=t,this.forceChange()}catch(t){this.crashed=!0,this.setValue=function(t){},this.onTriggered=function(){},this._log.error("onvaluechanged exception cought",t),this._log.error(t.stack),this._log.warn("exception in: "+this.parent.name),this.parent.patch.isEditorMode()&&gui.showOpCrash(this.parent),this.parent.patch.emitEvent("exception",t,this.parent),this.parent.onError&&this.parent.onError(t)}this.parent&&this.parent.patch&&this.parent.patch.isEditorMode()&&this.type==l.OP_PORT_TYPE_TEXTURE&&gui.texturePreview().updateTexturePort(this)}if(this.direction==c.PORT_DIR_OUT)for(let t=0;t<this.links.length;++t)this.links[t].setValue()}},et.prototype.updateAnim=function(){this._animated&&(this.value=this.get(),(this._oldAnimVal!=this.value||this.changeAlways)&&(this._oldAnimVal=this.value,this.forceChange()),this._oldAnimVal=this.value)},et.args=function(t){return(t+"").replace(/[/][/].*$/gm,"").replace(/\s+/g,"").replace(/[/][*][^/*]*[*][/]/g,"").split("){",1)[0].replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean)},et.prototype.forceChange=function(){this.onValueChanged||this.onChange,this._activity(),this.emitEvent("change",this.value,this),this.onChange?this.onChange(this,this.value):this.onValueChanged&&this.onValueChanged(this,this.value)},et.prototype.getTypeString=function(){return this.type==l.OP_PORT_TYPE_VALUE?"Number":this.type==l.OP_PORT_TYPE_FUNCTION?"Trigger":this.type==l.OP_PORT_TYPE_OBJECT?"Object":this.type==l.OP_PORT_TYPE_DYNAMIC?"Dynamic":this.type==l.OP_PORT_TYPE_ARRAY?"Array":this.type==l.OP_PORT_TYPE_STRING?"String":"Unknown"},et.prototype.deSerializeSettings=function(t){if(t&&(t.animated&&this.setAnimated(t.animated),t.useVariable&&this.setVariableName(t.useVariable),t.anim)){this.anim||(this.anim=new $),this.anim.addEventListener("onChange",()=>{this.parent.patch.emitEvent("portAnimUpdated",this.parent,this,this.anim)}),t.anim.loop&&(this.anim.loop=t.anim.loop);for(const e in t.anim.keys)this.anim.keys.push(new X.Key(t.anim.keys[e]))}},et.prototype.getSerialized=function(){const t={};if(t.name=this.getName(),this.ignoreValueSerialize||0!==this.links.length||this.type==l.OP_PORT_TYPE_OBJECT&&this.value&&this.value.tex||(t.value=this.value),this._useVariableName&&(t.useVariable=this._useVariableName),this._animated&&(t.animated=!0),this.anim&&(t.anim=this.anim.getSerialized()),"file"==this.uiAttribs.display&&(t.display=this.uiAttribs.display),this.direction==c.PORT_DIR_OUT&&this.links.length>0){t.links=[];for(const e in this.links)!this.links[e].ignoreInSerialize&&this.links[e].portIn&&this.links[e].portOut&&t.links.push(this.links[e].getSerialized())}return t},et.prototype.shouldLink=function(){return!0},et.prototype.removeLinks=function(){let t=0;for(;this.links.length>0;){if(t++,t>5e3){this._log.warn("could not delete links... / infinite loop"),this.links.length=0;break}this.links[0].remove()}},et.prototype.removeLink=function(t){for(const e in this.links)this.links[e]==t&&this.links.splice(e,1);this.direction==c.PORT_DIR_IN&&(this.type==l.OP_PORT_TYPE_VALUE?this.setValue(this._valueBeforeLink||0):this.setValue(this._valueBeforeLink||null)),CABLES.UI&&this.parent.checkLinkTimeWarnings&&this.parent.checkLinkTimeWarnings(),this.onLinkChanged&&this.onLinkChanged(),this.emitEvent("onLinkChanged"),this.parent.emitEvent("onLinkChanged")},et.prototype.getName=function(){return this.name},et.prototype.addLink=function(t){this._valueBeforeLink=this.value,this.links.push(t),CABLES.UI&&this.parent.checkLinkTimeWarnings&&this.parent.checkLinkTimeWarnings(),this.onLinkChanged&&this.onLinkChanged(),this.emitEvent("onLinkChanged"),this.parent.emitEvent("onLinkChanged")},et.prototype.getLinkTo=function(t){for(const e in this.links)if(this.links[e].portIn==t||this.links[e].portOut==t)return this.links[e]},et.prototype.removeLinkTo=function(t){for(const e in this.links)if(this.links[e].portIn==t||this.links[e].portOut==t)return this.links[e].remove(),CABLES.UI&&this.parent.checkLinkTimeWarnings&&this.parent.checkLinkTimeWarnings(),this.onLinkChanged&&this.onLinkChanged(),void this.emitEvent("onLinkChanged")},et.prototype.isLinkedTo=function(t){for(const e in this.links)if(this.links[e].portIn==t||this.links[e].portOut==t)return!0;return!1},et.prototype._activity=function(){this.activityCounter++},et.prototype.trigger=function(){if(this._activity(),0===this.links.length)return;if(!this.parent.enabled)return;let t=null;try{for(let e=0;e<this.links.length;++e)this.links[e].portIn&&(t=this.links[e].portIn,t.parent.patch.pushTriggerStack(t),t._onTriggered(),t.parent.patch.popTriggerStack()),this.links[e]&&this.links[e].activity()}catch(e){this.parent.enabled=!1,this.parent.patch.isEditorMode()&&(this.parent.patch.emitEvent("exception",e,t.parent),this.parent.patch.emitEvent("opcrash",t),t.parent.onError&&t.parent.onError(e)),this._log.warn("exception!"),this._log.error("ontriggered exception cought",e),this._log.error(e.stack),this._log.warn("exception in: "+t.parent.name)}},et.prototype.call=function(){this._log.warn("call deprecated - use trigger() "),this.trigger()},et.prototype.execute=function(){this._log.warn("### execute port: "+this.getName(),this.goals.length)},et.prototype.setVariableName=function(t){this._useVariableName=t},et.prototype.getVariableName=function(){return this._useVariableName},et.prototype.setVariable=function(t){this.setAnimated(!1);const e={useVariable:!1};this._variableIn&&this._varChangeListenerId&&(this._variableIn.off(this._varChangeListenerId),this._variableIn=null),t?(this._variableIn=this.parent.patch.getVar(t),this._variableIn?(this.type==l.OP_PORT_TYPE_OBJECT?this._varChangeListenerId=this._variableIn.on("change",()=>{this.set(null),this.set(this._variableIn.getValue())}):this._varChangeListenerId=this._variableIn.on("change",this.set.bind(this)),this.set(this._variableIn.getValue())):this._log.warn("PORT VAR NOT FOUND!!!",t),this._useVariableName=t,e.useVariable=!0,e.variableName=this._useVariableName):(e.variableName=this._useVariableName=null,e.useVariable=!1),this.setUiAttribs(e),this.parent.patch.emitEvent("portSetVariable",this.parent,this,t)},et.prototype._handleNoTriggerOpAnimUpdates=function(t){let e=!1;for(let t=0;t<this.parent.portsIn.length;t++)if(this.parent.portsIn.type==l.OP_PORT_TYPE_FUNCTION){e=!0;break}e||(t?this._notriggerAnimUpdate=this.parent.patch.on("onRenderFrame",()=>{this.updateAnim()}):this.parent.patch.removeEventListener(this._notriggerAnimUpdate))},et.prototype.setAnimated=function(t){this._animated!=t&&(this._animated=t,this._animated&&!this.anim&&(this.anim=new $,this.anim.addEventListener("onChange",()=>{this.parent.patch.emitEvent("portAnimUpdated",this.parent,this,this.anim)})),this._onAnimToggle()),this._handleNoTriggerOpAnimUpdates(t),this.setUiAttribs({isAnimated:this._animated})},et.prototype.toggleAnim=function(){this._animated=!this._animated,this._animated&&!this.anim&&(this.anim=new $,this.anim.addEventListener("onChange",()=>{this.parent.patch.emitEvent("portAnimUpdated",this.parent,this,this.anim)})),this.setAnimated(this._animated),this._onAnimToggle(),this.setUiAttribs({isAnimated:this._animated})},et.prototype.getType=function(){return this.type},et.prototype.isLinked=function(){return this.links.length>0||this._animated||null!=this._useVariableName},et.prototype.isBoundToVar=function(){return null!=this._useVariableName},et.prototype.isAnimated=function(){return this._animated},et.prototype.isHidden=function(){return this.uiAttribs.hidePort},et.prototype._onTriggered=function(t){this._activity(),this.parent.updateAnims(),this.parent.enabled&&this.onTriggered&&this.onTriggered(t)},et.prototype._onSetProfiling=function(t){this.parent.patch.profiler.add("port",this),this.setValue(t),this.parent.patch.profiler.add("port",null)},et.prototype._onTriggeredProfiling=function(){this.parent.enabled&&this.onTriggered&&(this.parent.patch.profiler.add("port",this),this.onTriggered(),this.parent.patch.profiler.add("port",null))},et.prototype.onValueChange=function(t){this.onChange=t},et.prototype.getUiActiveState=function(){return this._uiActiveState},et.prototype.setUiActiveState=function(t){this._uiActiveState=t,this.onUiActiveStateChange&&this.onUiActiveStateChange()},et.prototype.hidePort=function(){this._log.warn("op.hideport() is deprecated, do not use it!")},et.portTypeNumberToString=function(t){return t==l.OP_PORT_TYPE_VALUE?"value":t==l.OP_PORT_TYPE_FUNCTION?"function":t==l.OP_PORT_TYPE_OBJECT?"object":t==l.OP_PORT_TYPE_ARRAY?"array":t==l.OP_PORT_TYPE_STRING?"string":t==l.OP_PORT_TYPE_DYNAMIC?"dynamic":"unknown"};class it extends et{constructor(t,e,i,s,r){super(t,e,i,s),this.indexPort=r,this.indexPort.set=t=>{const e=s.values;if(!e)return;let i=Math.floor(t);i=Math.min(i,e.length-1),i=Math.max(i,0),this.indexPort.setValue(i),this.set(e[i]),this.parent.patch.isEditorMode()&&window.gui&&gui.patchView.isCurrentOp(this.parent)&&gui.opParams.show(this.parent)}}setUiAttribs(t){const e=t.hidePort;t.hidePort=!0,super.setUiAttribs(t),void 0!==e&&this.indexPort.setUiAttribs({hidePort:e})}}class st extends it{setUiAttribs(t){if(this.indexPort.isLinked())for(const e in t)"greyout"!=e||t[e]||(t[e]="true");super.setUiAttribs(t)}}var rt=class{constructor(t,e,i,s,r,n,o,h,l,c){if(this._log=new a("cg_uniform"),this._type=e,this._name=i,this._shader=t,this._value=1e-5,this._oldValue=null,this._port=null,this._structName=l,this._structUniformName=h,this._propertyName=c,this._shader._addUniform(this),this.needsUpdate=!0,this.shaderType=null,this.comment=null,"f"==e)this.set=this.setValue=this.setValueF.bind(this),this.updateValue=this.updateValueF.bind(this);else if("f[]"==e)this.set=this.setValue=this.setValueArrayF.bind(this),this.updateValue=this.updateValueArrayF.bind(this);else if("2f[]"==e)this.set=this.setValue=this.setValueArray2F.bind(this),this.updateValue=this.updateValueArray2F.bind(this);else if("3f[]"==e)this.set=this.setValue=this.setValueArray3F.bind(this),this.updateValue=this.updateValueArray3F.bind(this);else if("4f[]"==e)this.set=this.setValue=this.setValueArray4F.bind(this),this.updateValue=this.updateValueArray4F.bind(this);else if("i"==e)this.set=this.setValue=this.setValueI.bind(this),this.updateValue=this.updateValueI.bind(this);else if("2i"==e)this.set=this.setValue=this.setValue2I.bind(this),this.updateValue=this.updateValue2I.bind(this);else if("3i"==e)this.set=this.setValue=this.setValue3I.bind(this),this.updateValue=this.updateValue3I.bind(this);else if("4i"==e)this.set=this.setValue=this.setValue4I.bind(this),this.updateValue=this.updateValue4I.bind(this);else if("b"==e)this.set=this.setValue=this.setValueBool.bind(this),this.updateValue=this.updateValueBool.bind(this);else if("4f"==e)this.set=this.setValue=this.setValue4F.bind(this),this.updateValue=this.updateValue4F.bind(this);else if("3f"==e)this.set=this.setValue=this.setValue3F.bind(this),this.updateValue=this.updateValue3F.bind(this);else if("2f"==e)this.set=this.setValue=this.setValue2F.bind(this),this.updateValue=this.updateValue2F.bind(this);else if("t"==e)this.set=this.setValue=this.setValueT.bind(this),this.updateValue=this.updateValueT.bind(this);else if("tc"==e)this.set=this.setValue=this.setValueT.bind(this),this.updateValue=this.updateValueT.bind(this);else if("t[]"==e)this.set=this.setValue=this.setValueArrayT.bind(this),this.updateValue=this.updateValueArrayT.bind(this);else{if("m4"!=e&&"m4[]"!=e)throw new Error("Unknown uniform type");this.set=this.setValue=this.setValueM4.bind(this),this.updateValue=this.updateValueM4.bind(this)}"object"==typeof s&&s instanceof et?(this._port=s,this._value=this._port.get(),r&&n&&o?(r instanceof et&&n instanceof et&&o instanceof et||this._log.error("[cgl_uniform] mixed port/value parameter for vec4 ",this._name),this._value=[0,0,0,0],this._port2=r,this._port3=n,this._port4=o,this._port.on("change",this.updateFromPort4f.bind(this)),this._port2.on("change",this.updateFromPort4f.bind(this)),this._port3.on("change",this.updateFromPort4f.bind(this)),this._port4.on("change",this.updateFromPort4f.bind(this)),this.updateFromPort4f()):r&&n?(r instanceof et&&n instanceof et||this._log.error("[cgl_uniform] mixed port/value parameter for vec4 ",this._name),this._value=[0,0,0],this._port2=r,this._port3=n,this._port.on("change",this.updateFromPort3f.bind(this)),this._port2.on("change",this.updateFromPort3f.bind(this)),this._port3.on("change",this.updateFromPort3f.bind(this)),this.updateFromPort3f()):r?(r instanceof et||this._log.error("[cgl_uniform] mixed port/value parameter for vec4 ",this._name),this._value=[0,0],this._port2=r,this._port.on("change",this.updateFromPort2f.bind(this)),this._port2.on("change",this.updateFromPort2f.bind(this)),this.updateFromPort2f()):this._port.on("change",this.updateFromPort.bind(this))):this._value=s,this.setValue(this._value),this.needsUpdate=!0}getType(){return this._type}getName(){return this._name}getValue(){return this._value}getShaderType(){return this.shaderType}isStructMember(){return!!this._structName}updateFromPort4f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this._value[2]=this._port3.get(),this._value[3]=this._port4.get(),this.setValue(this._value)}updateFromPort3f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this._value[2]=this._port3.get(),this.setValue(this._value)}updateFromPort2f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this.setValue(this._value)}updateFromPort(){this.setValue(this._port.get())}};class nt extends rt{constructor(t,e,i,s,r,n,o,a,h,l){super(t,e,i,s,r,n,o,a,h,l),this._loc=-1,this._cgl=t._cgl}copy(t){const e=new nt(t,this._type,this._name,this._value,this._port2,this._port3,this._port4,this._structUniformName,this._structName,this._propertyName);return e.shaderType=this.shaderType,e}getGlslTypeString(){return nt.glslTypeString(this._type)}_isValidLoc(){return-1!=this._loc}resetLoc(){this._loc=-1,this.needsUpdate=!0}bindTextures(){}getLoc(){return this._loc}updateFromPort4f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this._value[2]=this._port3.get(),this._value[3]=this._port4.get(),this.setValue(this._value)}updateFromPort3f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this._value[2]=this._port3.get(),this.setValue(this._value)}updateFromPort2f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this.setValue(this._value)}updateFromPort(){this.setValue(this._port.get())}updateValueF(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._shader.getCgl().gl.uniform1f(this._loc,this._value),this._cgl.profileData.profileUniformCount++}setValueF(t){t!=this._value&&(this.needsUpdate=!0,this._value=t)}updateValueI(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._shader.getCgl().gl.uniform1i(this._loc,this._value),this._cgl.profileData.profileUniformCount++}updateValue2I(){this._value&&(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform2i(this._loc,this._value[0],this._value[1]),this.needsUpdate=!1,this._cgl.profileData.profileUniformCount++)}updateValue3I(){this._value&&(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform3i(this._loc,this._value[0],this._value[1],this._value[2]),this.needsUpdate=!1,this._cgl.profileData.profileUniformCount++)}updateValue4I(){this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform4i(this._loc,this._value[0],this._value[1],this._value[2],this._value[3]),this._cgl.profileData.profileUniformCount++}setValueI(t){t!=this._value&&(this.needsUpdate=!0,this._value=t)}setValue2I(t){t&&(this._oldValue?t[0]==this._oldValue[0]&&t[1]==this._oldValue[1]||(this._oldValue[0]=t[0],this._oldValue[1]=t[1],this.needsUpdate=!0):(this._oldValue=[t[0]-1,1],this.needsUpdate=!0),this._value=t)}setValue3I(t){t&&(this._oldValue?t[0]==this._oldValue[0]&&t[1]==this._oldValue[1]&&t[2]==this._oldValue[2]||(this._oldValue[0]=t[0],this._oldValue[1]=t[1],this._oldValue[2]=t[2],this.needsUpdate=!0):(this._oldValue=[t[0]-1,1,2],this.needsUpdate=!0),this._value=t)}setValue4I(t){this.needsUpdate=!0,this._value=t||vec4.create()}updateValueBool(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._shader.getCgl().gl.uniform1i(this._loc,this._value?1:0),this._cgl.profileData.profileUniformCount++}setValueBool(t){t!=this._value&&(this.needsUpdate=!0,this._value=t)}setValueArray4F(t){this.needsUpdate=!0,this._value=t}updateValueArray4F(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform4fv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}setValueArray3F(t){this.needsUpdate=!0,this._value=t}updateValueArray3F(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform3fv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}setValueArray2F(t){this.needsUpdate=!0,this._value=t}updateValueArray2F(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform2fv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}setValueArrayF(t){this.needsUpdate=!0,this._value=t}updateValueArrayF(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform1fv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}setValueArrayT(t){this.needsUpdate=!0,this._value=t}updateValue3F(){this._value&&(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform3f(this._loc,this._value[0],this._value[1],this._value[2]),this.needsUpdate=!1,this._cgl.profileData.profileUniformCount++)}setValue3F(t){t&&(this._oldValue?t[0]==this._oldValue[0]&&t[1]==this._oldValue[1]&&t[2]==this._oldValue[2]||(this._oldValue[0]=t[0],this._oldValue[1]=t[1],this._oldValue[2]=t[2],this.needsUpdate=!0):(this._oldValue=[t[0]-1,1,2],this.needsUpdate=!0),this._value=t)}updateValue2F(){this._value&&(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform2f(this._loc,this._value[0],this._value[1]),this.needsUpdate=!1,this._cgl.profileData.profileUniformCount++)}setValue2F(t){t&&(this._oldValue?t[0]==this._oldValue[0]&&t[1]==this._oldValue[1]||(this._oldValue[0]=t[0],this._oldValue[1]=t[1],this.needsUpdate=!0):(this._oldValue=[t[0]-1,1],this.needsUpdate=!0),this._value=t)}updateValue4F(){this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._value||(this._log.warn("no value for uniform",this._name,this),this._value=[0,0,0,0]),this.needsUpdate=!1,this._shader.getCgl().gl.uniform4f(this._loc,this._value[0],this._value[1],this._value[2],this._value[3]),this._cgl.profileData.profileUniformCount++}setValue4F(t){"number"==typeof this.value&&(this.value=vec4.create()),t&&(this._oldValue?t[0]==this._oldValue[0]&&t[1]==this._oldValue[1]&&t[2]==this._oldValue[2]&&t[3]==this._oldValue[3]||(this._oldValue[0]=t[0],this._oldValue[1]=t[1],this._oldValue[2]=t[2],this.needsUpdate=!0):(this._oldValue=[t[0]-1,1,2,3],this.needsUpdate=!0),this._value=t)}updateValueM4(){if(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),!this._value||this._value.length%16!=0)return console.log("this.name",this._name,this._value);this._shader.getCgl().gl.uniformMatrix4fv(this._loc,!1,this._value),this._cgl.profileData.profileUniformCount++}setValueM4(t){this.needsUpdate=!0,this._value=t||mat4.create()}updateValueArrayT(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform1iv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}updateValueT(){this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._cgl.profileData.profileUniformCount++,this._shader.getCgl().gl.uniform1i(this._loc,this._value),this.needsUpdate=!1}setValueT(t){this.needsUpdate=!0,this._value=t}}nt.glslTypeString=t=>"f"==t?"float":"b"==t?"bool":"i"==t?"int":"2i"==t?"ivec2":"2f"==t?"vec2":"3f"==t?"vec3":"4f"==t?"vec4":"m4"==t?"mat4":"t"==t?"sampler2D":"tc"==t?"samplerCube":"3f[]"==t||"m4[]"==t||"f[]"==t?null:void(void 0)._log.warn("[CGL UNIFORM] unknown glsl type string ",t);const ot=180/Math.PI,at={MATH:{DEG2RAD:Math.PI/180,RAD2DEG:ot},SHADER:{SHADERVAR_VERTEX_POSITION:"vPosition",SHADERVAR_VERTEX_NUMBER:"attrVertIndex",SHADERVAR_VERTEX_NORMAL:"attrVertNormal",SHADERVAR_VERTEX_TEXCOORD:"attrTexCoord",SHADERVAR_INSTANCE_MMATRIX:"instMat",SHADERVAR_VERTEX_COLOR:"attrVertColor",SHADERVAR_UNI_PROJMAT:"projMatrix",SHADERVAR_UNI_VIEWMAT:"viewMatrix",SHADERVAR_UNI_MODELMAT:"modelMatrix",SHADERVAR_UNI_NORMALMAT:"normalMatrix",SHADERVAR_UNI_INVVIEWMAT:"inverseViewMatrix",SHADERVAR_UNI_INVPROJMAT:"invProjMatrix",SHADERVAR_UNI_VIEWPOS:"camPos"},BLEND_MODES:{BLEND_NONE:0,BLEND_NORMAL:1,BLEND_ADD:2,BLEND_SUB:3,BLEND_MUL:4}};const ht={lastMesh:null},lt=function(t,e,i){this._cgl=t,this._log=new a("cgl_mesh"),this._bufVertexAttrib=null,this._bufVerticesIndizes=this._cgl.gl.createBuffer(),this._indexType=this._cgl.gl.UNSIGNED_SHORT,this._attributes=[],this._attribLocs={},this._geom=null,this._lastShader=null,this._numInstances=0,this._glPrimitive=i,this._preWireframeGeom=null,this.addVertexNumbers=!1,this.feedBackAttributes=[],this.setGeom(e),this._feedBacks=[],this._feedBacksChanged=!1,this._transformFeedBackLoc=-1,this._lastAttrUpdate=0,this._name="unknown",this._cgl.profileData.addHeavyEvent("mesh constructed",this._name),this._queryExt=null,Object.defineProperty(this,"numInstances",{get(){return this._numInstances},set(t){this.setNumInstances(t)}})};var ct;lt.prototype.updateVertices=function(t){this.setAttribute(at.SHADER.SHADERVAR_VERTEX_POSITION,t.vertices,3),this._numVerts=t.vertices.length/3},lt.prototype.setAttributePointer=function(t,e,i,s){for(let r=0;r<this._attributes.length;r++)this._attributes[r].name==t&&(this._attributes[r].pointer||(this._attributes[r].pointer=[]),this._attributes[r].pointer.push({loc:-1,name:e,stride:i,offset:s,instanced:t==at.SHADER.SHADERVAR_INSTANCE_MMATRIX}))},lt.prototype.getAttribute=function(t){for(let e=0;e<this._attributes.length;e++)if(this._attributes[e].name==t)return this._attributes[e]},lt.prototype.setAttributeRange=function(t,e,i,s){t&&(i||s)&&(t.name||(console.log(t),this._log.stack("no attrname?!")),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,t.buffer),this._cgl.profileData.profileMeshAttributes+=s-i||0,this._cgl.profileData.profileSingleMeshAttribute[this._name]=this._cgl.profileData.profileSingleMeshAttribute[this._name]||0,this._cgl.profileData.profileSingleMeshAttribute[this._name]+=s-i||0,t.numItems<e.length/t.itemSize&&this._resizeAttr(e,t),s>=e.length-1&&this._log.log(this._cgl.canvas.id+" "+t.name+" buffersubdata out of bounds ?",e.length,s,i,t),1==this._cgl.glVersion?this._cgl.gl.bufferSubData(this._cgl.gl.ARRAY_BUFFER,0,e):this._cgl.gl.bufferSubData(this._cgl.gl.ARRAY_BUFFER,4*i,e,i,s-i))},lt.prototype._resizeAttr=function(t,e){e.buffer&&this._cgl.gl.deleteBuffer(e.buffer),e.buffer=this._cgl.gl.createBuffer(),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,e.buffer),this._bufferArray(t,e),e.numItems=t.length/e.itemSize},lt.prototype._bufferArray=function(t,e){let i=null;t&&(this._cgl.debugOneFrame&&console.log("_bufferArray",t.length,e.name),t instanceof Float32Array?i=t:e&&i&&i.length==t.length?i.set(t):(i=new Float32Array(t),this._cgl.debugOneFrame&&console.log("_bufferArray create new float32array",t.length,e.name),this._cgl.profileData.profileNonTypedAttrib++,this._cgl.profileData.profileNonTypedAttribNames="("+this._name+":"+e.name+")"),e.arrayLength=i.length,this._cgl.gl.bufferData(this._cgl.gl.ARRAY_BUFFER,i,this._cgl.gl.DYNAMIC_DRAW))},lt.prototype.addAttribute=lt.prototype.updateAttribute=lt.prototype.setAttribute=function(t,e,i,s){if(!e)throw this._log.error("mesh addAttribute - no array given! "+t),new Error;let r=null,n=!1,o=0;const a=e.length/i;for(this._cgl.profileData.profileMeshAttributes+=a||0,"function"==typeof s&&(r=s),"object"==typeof s&&(s.cb&&(r=s.cb),s.instanced&&(n=s.instanced)),t==at.SHADER.SHADERVAR_INSTANCE_MMATRIX&&(n=!0),o=0;o<this._attributes.length;o++){const i=this._attributes[o];if(i.name==t)return i.numItems===a||this._resizeAttr(e,i),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,i.buffer),this._bufferArray(e,i),i}const h=this._cgl.gl.createBuffer();this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,h);let l=this._cgl.gl.FLOAT;s&&s.type&&(l=s.type);const c={buffer:h,name:t,cb:r,itemSize:i,numItems:a,startItem:0,instanced:n,type:l};return this._bufferArray(e,c),t==at.SHADER.SHADERVAR_VERTEX_POSITION&&(this._bufVertexAttrib=c),this._attributes.push(c),this._attribLocs={},c},lt.prototype.getAttributes=function(){return this._attributes},lt.prototype.updateTexCoords=function(t){if(t.texCoords&&t.texCoords.length>0)this.setAttribute(at.SHADER.SHADERVAR_VERTEX_TEXCOORD,t.texCoords,2);else{const e=new Float32Array(Math.round(t.vertices.length/3*2));this.setAttribute(at.SHADER.SHADERVAR_VERTEX_TEXCOORD,e,2)}},lt.prototype.updateNormals=function(t){if(t.vertexNormals&&t.vertexNormals.length>0)this.setAttribute(at.SHADER.SHADERVAR_VERTEX_NORMAL,t.vertexNormals,3);else{const e=new Float32Array(Math.round(t.vertices.length));this.setAttribute(at.SHADER.SHADERVAR_VERTEX_NORMAL,e,3)}},lt.prototype._setVertexNumbers=function(t){if(!this._verticesNumbers||this._verticesNumbers.length!=this._numVerts||t){if(t)this._verticesNumbers=t;else{this._verticesNumbers=new Float32Array(this._numVerts);for(let t=0;t<this._numVerts;t++)this._verticesNumbers[t]=t}this.setAttribute(at.SHADER.SHADERVAR_VERTEX_NUMBER,this._verticesNumbers,1,(t,e,i)=>{i.uniformNumVertices||(i.uniformNumVertices=new nt(i,"f","numVertices",this._numVerts)),i.uniformNumVertices.setValue(this._numVerts)})}},lt.prototype.setVertexIndices=function(t){if(this._bufVerticesIndizes)if(t.length>0){for(let e=0;e<t.length;e++)if(t[e]>=this._numVerts)return void this._log.warn("invalid index in "+this._name);this._cgl.gl.bindBuffer(this._cgl.gl.ELEMENT_ARRAY_BUFFER,this._bufVerticesIndizes),t instanceof Float32Array&&this._log.warn("vertIndices float32Array: "+this._name),t instanceof Uint32Array?(this.vertIndicesTyped=t,this._indexType=this._cgl.gl.UNSIGNED_INT):t instanceof Uint16Array?this.vertIndicesTyped=t:this.vertIndicesTyped=new Uint16Array(t),this._cgl.gl.bufferData(this._cgl.gl.ELEMENT_ARRAY_BUFFER,this.vertIndicesTyped,this._cgl.gl.DYNAMIC_DRAW),this._bufVerticesIndizes.itemSize=1,this._bufVerticesIndizes.numItems=t.length}else this._bufVerticesIndizes.numItems=0;else this._log.warn("no bufVerticesIndizes: "+this._name)},lt.prototype.setGeom=function(t,e){this._geom=t,null!=t.glPrimitive&&(this._glPrimitive=t.glPrimitive),this._geom&&this._geom.name&&(this._name="mesh "+this._geom.name),ht.lastMesh=null,this._cgl.profileData.profileMeshSetGeom++,this._disposeAttributes(),this.updateVertices(this._geom),this.setVertexIndices(this._geom.verticesIndices),this.addVertexNumbers&&this._setVertexNumbers();const i=this._geom.getAttributes(),s={texCoords:at.SHADER.SHADERVAR_VERTEX_TEXCOORD,vertexNormals:at.SHADER.SHADERVAR_VERTEX_NORMAL,vertexColors:at.SHADER.SHADERVAR_VERTEX_COLOR,tangents:"attrTangent",biTangents:"attrBiTangent"};for(const t in i)i[t].data&&i[t].data.length&&this.setAttribute(s[t]||t,i[t].data,i[t].itemSize);e&&(this._geom=null)},lt.prototype._preBind=function(t){for(let e=0;e<this._attributes.length;e++)this._attributes[e].cb&&this._attributes[e].cb(this._attributes[e],this._geom,t)},lt.prototype._checkAttrLengths=function(){for(let t=0;t<this._attributes.length;t++)if(this._attributes[t].arrayLength/this._attributes[t].itemSize<this._attributes[0].arrayLength/this._attributes[0].itemSize){let t="unknown";this._geom&&(t=this._geom.name)}},lt.prototype._bind=function(t){if(!t.isValid())return;let e=[];if(this._attribLocs[t.id]?e=this._attribLocs[t.id]:this._attribLocs[t.id]=e,this._lastShader=t,t.lastCompile>this._lastAttrUpdate||e.length!=this._attributes.length){this._lastAttrUpdate=t.lastCompile;for(let t=0;t<this._attributes.length;t++)e[t]=-1}for(let i=0;i<this._attributes.length;i++){const s=this._attributes[i];if(-1==e[i]&&s._attrLocationLastShaderTime!=t.lastCompile&&(s._attrLocationLastShaderTime=t.lastCompile,e[i]=this._cgl.glGetAttribLocation(t.getProgram(),s.name),this._cgl.profileData.profileAttrLoc++),-1!=e[i])if(this._cgl.gl.enableVertexAttribArray(e[i]),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,s.buffer),s.instanced)if(s.itemSize<=4)s.itemSize&&0!=s.itemSize||this._log.warn("instanced attrib itemsize error",this._geom.name,s),this._cgl.gl.vertexAttribPointer(e[i],s.itemSize,s.type,!1,4*s.itemSize,0),this._cgl.gl.vertexAttribDivisor(e[i],1);else if(16==s.itemSize){const t=64;this._cgl.gl.vertexAttribPointer(e[i],4,s.type,!1,t,0),this._cgl.gl.enableVertexAttribArray(e[i]+1),this._cgl.gl.vertexAttribPointer(e[i]+1,4,s.type,!1,t,16),this._cgl.gl.enableVertexAttribArray(e[i]+2),this._cgl.gl.vertexAttribPointer(e[i]+2,4,s.type,!1,t,32),this._cgl.gl.enableVertexAttribArray(e[i]+3),this._cgl.gl.vertexAttribPointer(e[i]+3,4,s.type,!1,t,48),this._cgl.gl.vertexAttribDivisor(e[i],1),this._cgl.gl.vertexAttribDivisor(e[i]+1,1),this._cgl.gl.vertexAttribDivisor(e[i]+2,1),this._cgl.gl.vertexAttribDivisor(e[i]+3,1)}else this._log.warn("unknown instance attrib size",s.name);else{if(s.itemSize&&0!=s.itemSize||this._log.warn("attrib itemsize error",this._name,s),this._cgl.gl.vertexAttribPointer(e[i],s.itemSize,s.type,!1,4*s.itemSize,0),s.pointer)for(let e=0;e<s.pointer.length;e++){const i=s.pointer[e];-1==i.loc&&(i.loc=this._cgl.glGetAttribLocation(t.getProgram(),i.name)),this._cgl.profileData.profileAttrLoc++,this._cgl.gl.enableVertexAttribArray(i.loc),this._cgl.gl.vertexAttribPointer(i.loc,s.itemSize,s.type,!1,i.stride,i.offset)}this.bindFeedback(s)}}0!==this._bufVerticesIndizes.numItems&&this._cgl.gl.bindBuffer(this._cgl.gl.ELEMENT_ARRAY_BUFFER,this._bufVerticesIndizes)},lt.prototype.unBind=function(){const t=this._lastShader;if(this._lastShader=null,!t)return;let e=[];this._attribLocs[t.id]?e=this._attribLocs[t.id]:this._attribLocs[t.id]=e,ht.lastMesh=null;for(let t=0;t<this._attributes.length;t++)this._attributes[t].instanced&&(this._attributes[t].itemSize<=4?(-1!=e[t]&&this._cgl.gl.vertexAttribDivisor(e[t],0),e[t]>=0&&this._cgl.gl.disableVertexAttribArray(e[t])):(this._cgl.gl.vertexAttribDivisor(e[t],0),this._cgl.gl.vertexAttribDivisor(e[t]+1,0),this._cgl.gl.vertexAttribDivisor(e[t]+2,0),this._cgl.gl.vertexAttribDivisor(e[t]+3,0),this._cgl.gl.disableVertexAttribArray(e[t]+1),this._cgl.gl.disableVertexAttribArray(e[t]+2),this._cgl.gl.disableVertexAttribArray(e[t]+3))),-1!=e[t]&&this._cgl.gl.disableVertexAttribArray(e[t])},lt.prototype.meshChanged=function(){return this._cgl.lastMesh&&this._cgl.lastMesh!=this},lt.prototype.printDebug=function(t){console.log("--attributes");for(let t=0;t<this._attributes.length;t++)console.log("attribute "+t+" "+this._attributes[t].name)},lt.prototype.setNumVertices=function(t){this._bufVertexAttrib.numItems=t},lt.prototype.getNumVertices=function(){return this._bufVertexAttrib.numItems},lt.prototype.render=function(t){if(!t||!t.isValid())return;if(this._checkAttrLengths(),this._geom&&(!this._preWireframeGeom||t.wireframe||this._geom.isIndexed()||(this.setGeom(this._preWireframeGeom),this._preWireframeGeom=null),t.wireframe)){let t=!1;this._geom.isIndexed()&&(this._preWireframeGeom||(this._preWireframeGeom=this._geom,this._geom=this._geom.copy()),this._geom.unIndex(),t=!0),this._geom.getAttribute("attrBarycentric")||(this._preWireframeGeom||(this._preWireframeGeom=this._geom,this._geom=this._geom.copy()),t=!0,this._geom.calcBarycentric()),t&&this.setGeom(this._geom)}let e=!1;ht.lastMesh!=this&&(ht.lastMesh&&ht.lastMesh.unBind(),e=!0),e&&this._preBind(t),t.bind(),this._bind(t),this.addVertexNumbers&&this._setVertexNumbers(),ht.lastMesh=this;let i=this._cgl.gl.TRIANGLES;void 0!==this._glPrimitive&&(i=this._glPrimitive),null!==t.glPrimitive&&(i=t.glPrimitive);let s=1,r=this._cgl.profileData.doProfileGlQuery,n=!1;if(r){let e=this._name+" "+t.getName()+" #"+t.id;this._numInstances&&(e+=" instanced "+this._numInstances+"x");let i=this._cgl.profileData.glQueryData[e];if(i||(i={id:e,num:0},this._cgl.profileData.glQueryData[e]=i),this._queryExt||!1===this._queryExt||(this._queryExt=this._cgl.gl.getExtension("EXT_disjoint_timer_query_webgl2")||!1),this._queryExt){if(i._drawQuery){if(this._cgl.gl.getQueryParameter(i._drawQuery,this._cgl.gl.QUERY_RESULT_AVAILABLE)){const t=this._cgl.gl.getQueryParameter(i._drawQuery,this._cgl.gl.QUERY_RESULT)/1e6;i._times+=t,i._numcount++,i.when=performance.now(),i._drawQuery=null,i.queryStarted=!1}}i.queryStarted||(i._drawQuery=this._cgl.gl.createQuery(),this._cgl.gl.beginQuery(this._queryExt.TIME_ELAPSED_EXT,i._drawQuery),n=i.queryStarted=!0)}}if(this.hasFeedbacks()?this.drawFeedbacks(t,i):0===this._bufVerticesIndizes.numItems?(i==this._cgl.gl.TRIANGLES&&(s=3),0===this._numInstances?this._cgl.gl.drawArrays(i,this._bufVertexAttrib.startItem,this._bufVertexAttrib.numItems-this._bufVertexAttrib.startItem):this._cgl.gl.drawArraysInstanced(i,this._bufVertexAttrib.startItem,this._bufVertexAttrib.numItems,this._numInstances)):0===this._numInstances?this._cgl.gl.drawElements(i,this._bufVerticesIndizes.numItems,this._indexType,0):this._cgl.gl.drawElementsInstanced(i,this._bufVerticesIndizes.numItems,this._indexType,0,this._numInstances),this._cgl.debugOneFrame&&this._cgl.gl.getError()!=this._cgl.gl.NO_ERROR){this._log.error("mesh draw gl error"),this._log.error("mesh",this),this._log.error("shader",t);for(let e=0;e<this._cgl.gl.getProgramParameter(t.getProgram(),this._cgl.gl.ACTIVE_ATTRIBUTES);e++){const i=this._cgl.gl.getActiveAttrib(t.getProgram(),e).name;this._log.error("attrib ",i)}}this._cgl.profileData.profileMeshNumElements+=this._bufVertexAttrib.numItems/s*(this._numInstances||1),this._cgl.profileData.profileMeshDraw++,r&&n&&this._cgl.gl.endQuery(this._queryExt.TIME_ELAPSED_EXT),this.unBind()},lt.prototype.setNumInstances=function(t){if(t=Math.max(0,t),this._numInstances!=t){this._numInstances=t;const e=new Float32Array(t);for(let i=0;i<t;i++)e[i]=i;this.setAttribute("instanceIndex",e,1,{instanced:!0})}},lt.prototype._disposeAttributes=function(){if(this._attributes){for(let t=0;t<this._attributes.length;t++)this._attributes[t].buffer&&(this._cgl.gl.deleteBuffer(this._attributes[t].buffer),this._attributes[t].buffer=null);this._attributes.length=0}},lt.prototype.dispose=function(){this._bufVertexAttrib&&this._bufVertexAttrib.buffer&&this._cgl.gl.deleteBuffer(this._bufVertexAttrib.buffer),this._bufVerticesIndizes&&this._cgl.gl.deleteBuffer(this._bufVerticesIndizes),this._bufVerticesIndizes=null,this._disposeAttributes()},(ct=lt).prototype.hasFeedbacks=function(){return this._feedBacks.length>0},ct.prototype.removeFeedbacks=function(t){this._feedbacks&&(this._feedbacks.length=0,this._feedBacksChanged=!0)},ct.prototype.setAttributeFeedback=function(){},ct.prototype.setFeedback=function(t,e,i){let s={nameOut:e},r=!1;this.unBindFeedbacks();for(let t=0;t<this._feedBacks.length;t++)this._feedBacks[t].nameOut==e&&(s=this._feedBacks[t],r=!0);return r||(this._feedBacksChanged=!0),s.initialArr=i,s.attrib=t,s.outBuffer&&this._cgl.gl.deleteBuffer(s.outBuffer),s.outBuffer=this._cgl.gl.createBuffer(),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,s.outBuffer),this._cgl.gl.bufferData(this._cgl.gl.ARRAY_BUFFER,s.initialArr,this._cgl.gl.STATIC_DRAW),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,s.attrib.buffer),this._cgl.gl.bufferData(this._cgl.gl.ARRAY_BUFFER,s.initialArr,this._cgl.gl.STATIC_DRAW),r||this._feedBacks.push(s),s},ct.prototype.bindFeedback=function(t){if(!this._feedBacks||0===this._feedBacks.length)return;-1==this._transformFeedBackLoc&&(this._transformFeedBackLoc=this._cgl.gl.createTransformFeedback()),this._cgl.gl.bindTransformFeedback(this._cgl.gl.TRANSFORM_FEEDBACK,this._transformFeedBackLoc);let e=!1;for(let i=0;i<this._feedBacks.length;i++){const s=this._feedBacks[i];s.attrib==t&&(e=!0,this._cgl.gl.bindBufferBase(this._cgl.gl.TRANSFORM_FEEDBACK_BUFFER,i,s.outBuffer))}},ct.prototype.drawFeedbacks=function(t,e){let i=0;if(this._feedBacksChanged){const e=[];for(this._cgl.gl.bindTransformFeedback(this._cgl.gl.TRANSFORM_FEEDBACK,this._transformFeedBackLoc),i=0;i<this._feedBacks.length;i++)e.push(this._feedBacks[i].nameOut);return t.setFeedbackNames(e),console.log("feedbacknames",e),t.compile(),this._feedBacksChanged=!1,this._cgl.gl.bindTransformFeedback(this._cgl.gl.TRANSFORM_FEEDBACK,null),void console.log("changed finished")}this._cgl.gl.beginTransformFeedback(this.glPrimitive),this._cgl.gl.drawArrays(e,0,this._feedBacks[0].attrib.numItems),this._cgl.gl.endTransformFeedback(),this.unBindFeedbacks(),this.feedBacksSwapBuffers()},ct.prototype.unBindFeedbacks=function(){for(let t=0;t<this._feedBacks.length;t++)this._cgl.gl.bindBufferBase(this._cgl.gl.TRANSFORM_FEEDBACK_BUFFER,t,null);this._cgl.gl.bindTransformFeedback(this._cgl.gl.TRANSFORM_FEEDBACK,null)},ct.prototype.feedBacksSwapBuffers=function(){for(let t=0;t<this._feedBacks.length;t++){const e=this._feedBacks[t].attrib.buffer;this._feedBacks[t].attrib.buffer=this._feedBacks[t].outBuffer,this._feedBacks[t].outBuffer=e}};const ut={getSimpleRect:function(t,e){const i=new W(e);return i.vertices=[1,1,0,-1,1,0,1,-1,0,-1,-1,0],i.texCoords=[1,1,0,1,1,0,0,0],i.verticesIndices=[0,1,2,2,1,3],i.vertexNormals=[0,0,0,0,0,0,0,0,0,0,0,0],new lt(t,i)}},gt=function(t,e){this._cgl=t,this._log=new a("cgl_TextureEffect"),t.TextureEffectMesh||this.createMesh(),this._textureSource=null,this._options=e,this.imgCompVer=0,this.aspectRatio=1,this._textureTarget=null,this._frameBuf=this._cgl.gl.createFramebuffer(),this._frameBuf2=this._cgl.gl.createFramebuffer(),this._renderbuffer=this._cgl.gl.createRenderbuffer(),this._renderbuffer2=this._cgl.gl.createRenderbuffer(),this.switched=!1,this.depth=!1};gt.prototype.getWidth=function(){return this._textureSource.width},gt.prototype.getHeight=function(){return this._textureSource.height},gt.prototype.setSourceTexture=function(t){t.textureType==B.TYPE_FLOAT&&this._cgl.gl.getExtension("EXT_color_buffer_float"),null===t?(this._textureSource=new B(this._cgl),this._textureSource.setSize(16,16)):this._textureSource=t,this._textureSource.compareSettings(this._textureTarget)||(this._textureTarget&&this._textureTarget.delete(),this._textureTarget=this._textureSource.clone(),this._cgl.profileData.profileEffectBuffercreate++,this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuf),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,this._renderbuffer),this.depth&&this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,this._cgl.gl.DEPTH_COMPONENT16,this._textureSource.width,this._textureSource.height),this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0,this._cgl.gl.TEXTURE_2D,this._textureTarget.tex,0),this.depth&&this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.RENDERBUFFER,this._renderbuffer),this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,null),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,null),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,null),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuf2),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,this._renderbuffer2),this.depth&&this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,this._cgl.gl.DEPTH_COMPONENT16,this._textureSource.width,this._textureSource.height),this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0,this._cgl.gl.TEXTURE_2D,this._textureSource.tex,0),this.depth&&this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.RENDERBUFFER,this._renderbuffer2),this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,null),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,null),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,null)),this.aspectRatio=this._textureSource.width/this._textureSource.height},gt.prototype.continueEffect=function(){this._cgl.pushDepthTest(!1),this._cgl.pushModelMatrix(),this._cgl.pushPMatrix(),this._cgl.gl.viewport(0,0,this.getCurrentTargetTexture().width,this.getCurrentTargetTexture().height),mat4.perspective(this._cgl.pMatrix,45,this.getCurrentTargetTexture().width/this.getCurrentTargetTexture().height,.1,1100),this._cgl.pushPMatrix(),mat4.identity(this._cgl.pMatrix),this._cgl.pushViewMatrix(),mat4.identity(this._cgl.vMatrix),this._cgl.pushModelMatrix(),mat4.identity(this._cgl.mvMatrix)},gt.prototype.startEffect=function(t){this._textureTarget?(this.switched=!1,this.continueEffect(),t&&(this._bgTex=t),this._countEffects=0):this._log.warn("effect has no target")},gt.prototype.endEffect=function(){this._cgl.popDepthTest(),this._cgl.popModelMatrix(),this._cgl.popPMatrix(),this._cgl.popModelMatrix(),this._cgl.popViewMatrix(),this._cgl.popPMatrix(),this._cgl.resetViewPort()},gt.prototype.bind=function(){null!==this._textureSource?this.switched?(this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuf2),this._cgl.pushGlFrameBuffer(this._frameBuf2)):(this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuf),this._cgl.pushGlFrameBuffer(this._frameBuf)):this._log.warn("no base texture set!")},gt.prototype.finish=function(){null!==this._textureSource?(this._cgl.TextureEffectMesh.render(this._cgl.getShader()),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.popGlFrameBuffer()),this._cgl.profileData.profileTextureEffect++,this._textureTarget.filter==B.FILTER_MIPMAP&&(this.switched?(this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,this._textureSource.tex),this._textureSource.updateMipMap()):(this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,this._textureTarget.tex),this._textureTarget.updateMipMap()),this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,null)),this.switched=!this.switched,this._countEffects++):this._log.warn("no base texture set!")},gt.prototype.getCurrentTargetTexture=function(){return this.switched?this._textureSource:this._textureTarget},gt.prototype.getCurrentSourceTexture=function(){return 0==this._countEffects&&this._bgTex?this._bgTex:this.switched?this._textureTarget:this._textureSource},gt.prototype.delete=function(){this._textureTarget&&this._textureTarget.delete(),this._textureSource&&this._textureSource.delete(),this._cgl.gl.deleteRenderbuffer(this._renderbuffer),this._cgl.gl.deleteFramebuffer(this._frameBuf)},gt.prototype.createMesh=function(){this._cgl.TextureEffectMesh=ut.getSimpleRect(this._cgl,"texEffectRect")},gt.checkOpNotInTextureEffect=function(t){return t.uiAttribs.error&&!t.patch.cgl.currentTextureEffect?(t.setUiError("textureeffect",null),!0):!t.patch.cgl.currentTextureEffect||(t.patch.cgl.currentTextureEffect&&!t.uiAttribs.error?(t.setUiError("textureeffect","This op can not be a child of a ImageCompose/texture effect! imagecompose should only have textureeffect childs.",0),!1):!t.patch.cgl.currentTextureEffect)},gt.checkOpInEffect=function(t,e){if(e=e||0,t.patch.cgl.currentTextureEffect){if(t.uiAttribs.uierrors&&t.patch.cgl.currentTextureEffect.imgCompVer>=e)return t.setUiError("texeffect",null),!0;e&&t.patch.cgl.currentTextureEffect.imgCompVer<e&&t.setUiError("texeffect","This op must be a child of an ImageCompose op with version >="+e+' <span class="button-small" onclick="gui.patchView.downGradeOp(\''+t.id+"','"+t.name+"')\">Downgrade</span> to previous version",1)}return!!t.patch.cgl.currentTextureEffect||(t.patch.cgl.currentTextureEffect||t.uiAttribs.uierrors&&0!=t.uiAttribs.uierrors.length?!!t.patch.cgl.currentTextureEffect:(t.setUiError("texeffect",'This op must be a child of an ImageCompose op! More infos <a href="https://docs.cables.gl/image_composition/image_composition.html" target="_blank">here</a>. ',1),!1))},gt.getBlendCode=function(t){let e="".endl()+"vec3 _blend(vec3 base,vec3 blend)".endl()+"{".endl()+"   vec3 colNew=blend;".endl()+"   #ifdef BM_MULTIPLY".endl()+"       colNew=base*blend;".endl()+"   #endif".endl()+"   #ifdef BM_MULTIPLY_INV".endl()+"       colNew=base* vec3(1.0)-blend;".endl()+"   #endif".endl()+"   #ifdef BM_AVERAGE".endl()+"       colNew=((base + blend) / 2.0);".endl()+"   #endif".endl()+"   #ifdef BM_ADD".endl()+"       colNew=min(base + blend, vec3(1.0));".endl()+"   #endif".endl()+"   #ifdef BM_SUBTRACT_ONE".endl()+"       colNew=max(base + blend - vec3(1.0), vec3(0.0));".endl()+"   #endif".endl()+"   #ifdef BM_SUBTRACT".endl()+"       colNew=base - blend;".endl()+"   #endif".endl()+"   #ifdef BM_DIFFERENCE".endl()+"       colNew=abs(base - blend);".endl()+"   #endif".endl()+"   #ifdef BM_NEGATION".endl()+"       colNew=(vec3(1.0) - abs(vec3(1.0) - base - blend));".endl()+"   #endif".endl()+"   #ifdef BM_EXCLUSION".endl()+"       colNew=(base + blend - 2.0 * base * blend);".endl()+"   #endif".endl()+"   #ifdef BM_LIGHTEN".endl()+"       colNew=max(blend, base);".endl()+"   #endif".endl()+"   #ifdef BM_DARKEN".endl()+"       colNew=min(blend, base);".endl()+"   #endif".endl()+"   #ifdef BM_OVERLAY".endl()+"      #define BlendOverlayf(base, blend)  (base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))".endl()+"      colNew=vec3(BlendOverlayf(base.r, blend.r),BlendOverlayf(base.g, blend.g),BlendOverlayf(base.b, blend.b));".endl()+"   #endif".endl()+"   #ifdef BM_SCREEN".endl()+"      #define BlendScreenf(base, blend)       (1.0 - ((1.0 - base) * (1.0 - blend)))".endl()+"      colNew=vec3(BlendScreenf(base.r, blend.r),BlendScreenf(base.g, blend.g),BlendScreenf(base.b, blend.b));".endl()+"   #endif".endl()+"   #ifdef BM_SOFTLIGHT".endl()+"      #define BlendSoftLightf(base, blend)    ((blend < 0.5) ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend)))".endl()+"      colNew=vec3(BlendSoftLightf(base.r, blend.r),BlendSoftLightf(base.g, blend.g),BlendSoftLightf(base.b, blend.b));".endl()+"   #endif".endl()+"   #ifdef BM_HARDLIGHT".endl()+"      #define BlendOverlayf(base, blend)  (base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))".endl()+"      colNew=vec3(BlendOverlayf(base.r, blend.r),BlendOverlayf(base.g, blend.g),BlendOverlayf(base.b, blend.b));".endl()+"   #endif".endl()+"   #ifdef BM_COLORDODGE".endl()+"      #define BlendColorDodgef(base, blend)   ((blend == 1.0) ? blend : min(base / (1.0 - blend), 1.0))".endl()+"      colNew=vec3(BlendColorDodgef(base.r, blend.r),BlendColorDodgef(base.g, blend.g),BlendColorDodgef(base.b, blend.b));".endl()+"   #endif".endl()+"   #ifdef BM_COLORBURN".endl()+"      #define BlendColorBurnf(base, blend)    ((blend == 0.0) ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0))".endl()+"      colNew=vec3(BlendColorBurnf(base.r, blend.r),BlendColorBurnf(base.g, blend.g),BlendColorBurnf(base.b, blend.b));".endl()+"   #endif".endl()+"   return colNew;".endl()+"}".endl();return t||(e+="vec4 cgl_blend(vec4 oldColor,vec4 newColor,float amount)".endl()+"{".endl()+"vec4 col=vec4( _blend(oldColor.rgb,newColor.rgb) ,1.0);".endl()+"col=vec4( mix( col.rgb, oldColor.rgb ,1.0-oldColor.a*amount),1.0);".endl()+"return col;".endl()+"}".endl()),t>=3&&(e+="vec4 cgl_blendPixel(vec4 base,vec4 col,float amount)".endl()+"{".endl()+"vec3 colNew=_blend(base.rgb,col.rgb);".endl()+"float newA=clamp(base.a+(col.a*amount),0.,1.);".endl()+"#ifdef BM_ALPHAMASKED".endl()+"newA=base.a;".endl()+"#endif".endl()+"return vec4(".endl()+"mix(colNew,base.rgb,1.0-(amount*col.a)),".endl()+"newA);".endl()+"}".endl()),e},gt.onChangeBlendSelect=function(t,e,i){t.toggleDefine("BM_NORMAL","normal"==e),t.toggleDefine("BM_MULTIPLY","multiply"==e),t.toggleDefine("BM_MULTIPLY_INV","multiply invert"==e),t.toggleDefine("BM_AVERAGE","average"==e),t.toggleDefine("BM_ADD","add"==e),t.toggleDefine("BM_SUBTRACT_ONE","subtract one"==e),t.toggleDefine("BM_SUBTRACT","subtract"==e),t.toggleDefine("BM_DIFFERENCE","difference"==e),t.toggleDefine("BM_NEGATION","negation"==e),t.toggleDefine("BM_EXCLUSION","exclusion"==e),t.toggleDefine("BM_LIGHTEN","lighten"==e),t.toggleDefine("BM_DARKEN","darken"==e),t.toggleDefine("BM_OVERLAY","overlay"==e),t.toggleDefine("BM_SCREEN","screen"==e),t.toggleDefine("BM_SOFTLIGHT","softlight"==e),t.toggleDefine("BM_HARDLIGHT","hardlight"==e),t.toggleDefine("BM_COLORDODGE","color dodge"==e),t.toggleDefine("BM_COLORBURN","color burn"==e),t.toggleDefine("BM_ALPHAMASKED",i)},gt.AddBlendSelect=function(t,e,i){return t.inValueSelect(e||"Blend Mode",["normal","lighten","darken","multiply","multiply invert","average","add","subtract","difference","negation","exclusion","overlay","screen","color dodge","color burn","softlight","hardlight","subtract one"],i||"normal")},gt.AddBlendAlphaMask=function(t,e,i){return t.inSwitch(e||"Alpha Mask",["Off","On"],i||"Off")},gt.setupBlending=function(t,e,i,s,r){const n=()=>{let s=!1;r&&(s="On"==r.get()),gt.onChangeBlendSelect(e,i.get(),s);let n=i.get();"normal"==n?n=null:"multiply"==n?n="mul":"multiply invert"==n?n="mulinv":"lighten"==n?n="light":"darken"==n?n="darken":"average"==n?n="avg":"subtract one"==n?n="sub one":"subtract"==n?n="sub":"difference"==n?n="diff":"negation"==n||"negation"==n||"negation"==n?n="neg":"exclusion"==n?n="exc":"overlay"==n?n="ovl":"color dodge"==n?n="dodge":"color burn"==n?n="burn":"softlight"==n?n="soft":"hardlight"==n&&(n="hard"),t.setUiAttrib({extendTitle:n})};t.setPortGroup("Blending",[i,s,r]);let o=!1;i.onChange=n,r&&(r.onChange=n,o="On"==r.get()),gt.onChangeBlendSelect(e,i.get(),o)};const pt={"CGL.BLENDMODES":function(){this.name="blendmodes",this.srcHeadFrag=gt.getBlendCode()},"CGL.BLENDMODES3":function(){this.name="blendmodes3",this.srcHeadFrag=gt.getBlendCode(3)},"CGL.LUMINANCE":function(){this.name="luminance",this.srcHeadFrag="".endl()+"float cgl_luminance(vec3 c)".endl()+"{".endl()+"    return dot(vec3(0.2126,0.7152,0.0722),c);".endl()+"}".endl()},"CGL.RANDOM_OLD":function(){this.name="randomNumber",this.srcHeadFrag="".endl()+"float cgl_random(vec2 co)".endl()+"{".endl()+"    return fract(sin(dot(co.xy ,vec2(12.9898,4.1414))) * 432758.5453);".endl()+"}".endl()+"vec3 cgl_random3(vec2 co)".endl()+"{".endl()+"    return vec3( cgl_random(co),cgl_random(co+0.5711),cgl_random(co+1.5711));".endl()+"}"},"CGL.RANDOM_LOW":function(){this.name="randomNumber",this.srcHeadFrag="".endl()+"float cgl_random(vec2 co)".endl()+"{".endl()+"    return fract(sin(dot(co.xy ,vec2(12.9898,4.1414))) * 358.5453);".endl()+"}".endl()+"vec3 cgl_random3(vec2 co)".endl()+"{".endl()+"    return vec3( cgl_random(co),cgl_random(co+0.5711),cgl_random(co+1.5711));".endl()+"}"},"CGL.RANDOM_TEX":function(){this.name="randomNumbertex",this.srcHeadFrag="".endl()+"UNI sampler2D CGLRNDTEX;".endl()+"float cgl_random(vec2 co)".endl()+"{".endl()+"    return texture(CGLRNDTEX,co*5711.0).r;".endl()+"}".endl()+"vec3 cgl_random3(vec2 co)".endl()+"{".endl()+"    return texture(CGLRNDTEX,co*5711.0).rgb;".endl()+"}",this.initUniforms=function(t){return[new nt(t,"t","CGLRNDTEX",7)]},this.onBind=function(t,e){B.getRandomTexture(t),t.setTexture(7,B.getRandomTexture(t).tex)}}},_t=function(){return window.performance.now()},dt=function(){return _t()},ft=function(){CABLES.EventTarget.apply(this),this._timeStart=_t(),this._timeOffset=0,this._currentTime=0,this._lastTime=0,this._paused=!0,this._delay=0,this.overwriteTime=-1};ft.prototype._getTime=function(){return this._lastTime=(_t()-this._timeStart)/1e3,this._lastTime+this._timeOffset},ft.prototype.setDelay=function(t){this._delay=t,this.emitEvent("timeChange")},ft.prototype.isPlaying=function(){return!this._paused},ft.prototype.update=function(){if(!this._paused)return this._currentTime=this._getTime(),this._currentTime},ft.prototype.getMillis=function(){return 1e3*this.get()},ft.prototype.get=ft.prototype.getTime=function(){return this.overwriteTime>=0?this.overwriteTime-this._delay:this._currentTime-this._delay},ft.prototype.togglePlay=function(){this._paused?this.play():this.pause()},ft.prototype.setTime=function(t){(isNaN(t)||t<0)&&(t=0),this._timeStart=_t(),this._timeOffset=t,this._currentTime=t,this.emitEvent("timeChange")},ft.prototype.setOffset=function(t){this._currentTime+t<0?(this._timeStart=_t(),this._timeOffset=0,this._currentTime=0):(this._timeOffset+=t,this._currentTime=this._lastTime+this._timeOffset),this.emitEvent("timeChange")},ft.prototype.play=function(){this._timeStart=_t(),this._paused=!1,this.emitEvent("playPause")},ft.prototype.pause=function(){this._timeOffset=this._currentTime,this._paused=!0,this.emitEvent("playPause")};const mt=Math.PI/180,Et=(Math.PI,-1!=window.navigator.userAgent.indexOf("Windows")),Tt=function(t){let e;if(t.wheelDelta)e=t.wheelDelta%120-0==-0?t.wheelDelta/120:t.wheelDelta/30,e*=-1.5,Et&&(e*=2);else{let i=t.deltaY;t.shiftKey&&(i=t.deltaX);const s=i||t.detail;e=-(s%3?10*s:s/3),e*=-3}return e>20&&(e=20),e<-20&&(e=-20),e},At=Tt,bt=Tt,xt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},vt=/[&<>"']/g,yt=RegExp(vt.source);const It=function(t,e){if(!t)throw new Error("shader constructed without cgl "+e);this._log=new a("cgl_shader"),this._cgl=t,e||this._log.stack("no shader name given"),this._name=e||"unknown",this.glslVersion=0,t.glVersion>1&&(this.glslVersion=300),this.id=x(),this._isValid=!0,this._program=null,this._uniforms=[],this._drawBuffers=[!0],this._defines=[],this._needsRecompile=!0,this._compileReason="initial",this._projMatrixUniform=null,this._mvMatrixUniform=null,this._mMatrixUniform=null,this._vMatrixUniform=null,this._camPosUniform=null,this._normalMatrixUniform=null,this._inverseViewMatrixUniform=null,this._attrVertexPos=-1,this.precision=t.patch.config.glslPrecision||"highp",this._pMatrixState=-1,this._vMatrixState=-1,this._modGroupCount=0,this._feedBackNames=[],this._attributes=[],this.glPrimitive=null,this.offScreenPass=!1,this._extensions=[],this.srcVert=this.getDefaultVertexShader(),this.srcFrag=this.getDefaultFragmentShader(),this.lastCompile=0,this._moduleNames=[],this._modules=[],this._moduleNumId=0,this._libs=[],this._structNames=[],this._structUniformNames=[],this._textureStackUni=[],this._textureStackTex=[],this._textureStackType=[],this._textureStackTexCgl=[],this._tempNormalMatrix=mat4.create(),this._tempCamPosMatrix=mat4.create(),this._tempInverseViewMatrix=mat4.create(),this._tempInverseProjMatrix=mat4.create(),this.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"])};It.prototype.isValid=function(){return this._isValid},It.prototype.getCgl=function(){return this._cgl},It.prototype.getName=function(){return this._name},It.prototype.enableExtension=function(t){this.setWhyCompile("enable extension "+t),this._needsRecompile=!0,this._extensions.push(t)},It.prototype.getAttrVertexPos=function(){return this._attrVertexPos},It.prototype.hasTextureUniforms=function(){for(let t=0;t<this._uniforms.length;t++)if("t"==this._uniforms[t].getType())return!0;return!1},It.prototype.setWhyCompile=function(t){this._compileReason=t},It.prototype.copyUniformValues=function(t){for(let e=0;e<t._uniforms.length;e++)this._uniforms[e]?(-1!=t._uniforms[e].getName().indexOf("pathPoints")&&console.log("copyUniformValues",t._uniforms[e].getName(),t._uniforms[e].getValue()),this.getUniform(t._uniforms[e].getName()).set(t._uniforms[e].getValue())):this._log.log("unknown uniform?!");this.popTextures();for(let e=0;e<t._textureStackUni.length;e++)this._textureStackUni[e]=t._textureStackUni[e],this._textureStackTex[e]=t._textureStackTex[e],this._textureStackType[e]=t._textureStackType[e],this._textureStackTexCgl[e]=t._textureStackTexCgl[e]},It.prototype.copy=function(){const t=new It(this._cgl,this._name+" copy");t.setSource(this.srcVert,this.srcFrag),t._modules=JSON.parse(JSON.stringify(this._modules)),t._defines=JSON.parse(JSON.stringify(this._defines)),t._modGroupCount=this._modGroupCount,t._moduleNames=this._moduleNames,t.glPrimitive=this.glPrimitive,t.offScreenPass=this.offScreenPass,t._extensions=this._extensions,t.wireframe=this.wireframe,t._attributes=this._attributes;for(let e=0;e<this._uniforms.length;e++){this._uniforms[e].copy(t).resetLoc()}return this.setWhyCompile("copy"),t._needsRecompile=!0,t},It.prototype.setSource=function(t,e){this.srcVert=t,this.srcFrag=e,this.setWhyCompile("Source changed"),this._needsRecompile=!0},It.prototype._addLibs=function(t){for(const e in pt)if(t.indexOf(e)>-1){const i=new pt[e];t=t.replace("{{"+e+"}}",i.srcHeadFrag),this._libs.push(i),i.initUniforms&&i.initUniforms(this)}return t},It.prototype.createStructUniforms=function(){let t="",e="";this._structNames=[],this._injectedStringsFrag={},this._injectedStringsVert={},this._structUniformNamesIndicesFrag=[],this._structUniformNamesIndicesVert=[];for(let i=0;i<this._uniforms.length;i++)if(this._uniforms[i].isStructMember()){const s="{{INJECTION_POINT_STRUCT_"+this._uniforms[i]._structName+"}}";if(-1===this._structNames.indexOf(this._uniforms[i]._structName)){const r="struct "+this._uniforms[i]._structName+" {".endl()+s+"};".endl().endl();"both"!==this._uniforms[i].getShaderType()&&"frag"!==this._uniforms[i].getShaderType()||(t=t.concat(r)),"both"!==this._uniforms[i].getShaderType()&&"vert"!==this._uniforms[i].getShaderType()||(e=e.concat(r)),this._structNames.push(this._uniforms[i]._structName),this._injectedStringsFrag[this._uniforms[i]._structName]=[],this._injectedStringsVert[this._uniforms[i]._structName]=[]}let r="";this._uniforms[i].comment&&(r=" // "+this._uniforms[i].comment);let n="";if(null==this._uniforms[i].getGlslTypeString()&&(n+="//"),n+="  "+this._uniforms[i].getGlslTypeString()+" "+this._uniforms[i]._propertyName+";"+r,"both"===this._uniforms[i].getShaderType()){if(-1===this._injectedStringsFrag[this._uniforms[i]._structName].indexOf(n)&&-1===this._injectedStringsVert[this._uniforms[i]._structName].indexOf(n)){const r=t.lastIndexOf(s),o=e.lastIndexOf(s);t=t.slice(0,r)+n+t.slice(r-1),e=e.slice(0,o)+n+e.slice(o-1),this._injectedStringsFrag[this._uniforms[i]._structName].push(n),this._injectedStringsVert[this._uniforms[i]._structName].push(n)}-1===this._structUniformNamesIndicesFrag.indexOf(i)&&this._structUniformNamesIndicesFrag.push(i),-1===this._structUniformNamesIndicesVert.indexOf(i)&&this._structUniformNamesIndicesVert.push(i)}else if("frag"===this._uniforms[i].getShaderType()){if(-1===this._injectedStringsFrag[this._uniforms[i]._structName].indexOf(n)){const e=t.lastIndexOf(s);t=t.slice(0,e)+n+t.slice(e-1),this._injectedStringsFrag[this._uniforms[i]._structName].push(n)}-1===this._structUniformNamesIndicesFrag.indexOf(i)&&this._structUniformNamesIndicesFrag.push(i)}else if("vert"===this._uniforms[i].getShaderType()){if(-1===this._injectedStringsVert[this._uniforms[i]._structName].indexOf(n)){const t=e.lastIndexOf(s);e=e.slice(0,t)+n+e.slice(t-1),this._injectedStringsVert[this._uniforms[i]._structName].push(n)}-1===this._structUniformNamesIndicesVert.indexOf(i)&&this._structUniformNamesIndicesVert.push(i)}}this._uniDeclarationsFrag=[],this._uniDeclarationsVert=[];for(let e=0;e<this._structUniformNamesIndicesFrag.length;e+=1){const i=this._structUniformNamesIndicesFrag[e],s="UNI "+this._uniforms[i]._structName+" "+this._uniforms[i]._structUniformName+";".endl();if(-1===this._uniDeclarationsFrag.indexOf(s)){const e="{{INJECTION_POINT_STRUCT_"+this._uniforms[i]._structName+"}}";t=t.replace(e,""),t+=s,this._uniDeclarationsFrag.push(s)}}for(let t=0;t<this._structUniformNamesIndicesVert.length;t+=1){const i=this._structUniformNamesIndicesVert[t],s="UNI "+this._uniforms[i]._structName+" "+this._uniforms[i]._structUniformName+";".endl();if(-1===this._uniDeclarationsVert.indexOf(s)){const t="{{INJECTION_POINT_STRUCT_"+this._uniforms[i]._structName+"}}";e=e.replace(t,""),e+=s,this._uniDeclarationsVert.push(s)}}return[e,t]},It.prototype._getAttrSrc=function(t,e){const i={};return t.name&&t.type&&(i.srcHeadVert="",e||(i.srcHeadVert+="#ifndef ATTRIB_"+t.name.endl()),i.srcHeadVert+="#define ATTRIB_"+t.name.endl(),i.srcHeadVert+="IN "+t.type+" "+t.name+";".endl(),e||(i.srcHeadVert+="#endif".endl()),t.nameFrag&&(i.srcHeadVert+="",e||(i.srcHeadVert+="#ifndef ATTRIB_"+t.nameFrag.endl()),i.srcHeadVert+="#define ATTRIB_"+t.nameFrag.endl(),i.srcHeadVert+="OUT "+t.type+" "+t.nameFrag+";".endl(),e||(i.srcHeadVert+="#endif".endl()),i.srcVert="".endl()+t.nameFrag+"="+t.name+";",i.srcHeadFrag="",e||(i.srcHeadFrag+="#ifndef ATTRIB_"+t.nameFrag.endl()),i.srcHeadFrag+="#define ATTRIB_"+t.nameFrag.endl(),i.srcHeadFrag+="IN "+t.type+" "+t.nameFrag+";".endl(),e||(i.srcHeadFrag+="#endif".endl()))),i},It.prototype.compile=function(){const t=performance.now();this._cgl.profileData.profileShaderCompiles++,this._cgl.profileData.profileShaderCompileName=this._name+" ["+this._compileReason+"]";let e="";if(this._extensions)for(let t=0;t<this._extensions.length;t++)e+="#extension "+this._extensions[t]+" : enable".endl();let i="";this._defines.length&&(i="\n// cgl generated".endl());for(let t=0;t<this._defines.length;t++)i+="#define "+this._defines[t][0]+" "+this._defines[t][1]+"".endl();const s=this.createStructUniforms();if(this._cgl.profileData.addHeavyEvent("shader compile",this._name+" ["+this._compileReason+"]"),this._compileReason="",this._uniforms){const t=this._uniforms.map(t=>t._name),e=[];for(let i=0;i<this._uniforms.length;i++){const s=this._uniforms[i];t.indexOf(s._name,i+1)>-1&&e.push(i)}for(let t=this._uniforms.length-1;t>=0;t-=1)e.indexOf(t)>-1?this._uniforms.splice(t,1):this._uniforms[t].resetLoc()}this._cgl.printError("uniform resets"),this.hasTextureUniforms()&&(i+="#define HAS_TEXTURES".endl());let r="",n="";this.srcFrag||(this._log.error("[cgl shader] has no fragment source!",this),this.srcVert=this.getDefaultVertexShader(),this.srcFrag=this.getDefaultFragmentShader()),300==this.glslVersion?(r="#version 300 es".endl()+"// ".endl()+"// vertex shader "+this._name.endl()+"// ".endl()+"precision "+this.precision+" float;".endl()+"precision "+this.precision+" sampler2D;".endl()+"".endl()+"#define WEBGL2".endl()+"#define texture2D texture".endl()+"#define UNI uniform".endl()+"#define IN in".endl()+"#define OUT out".endl(),n="#version 300 es".endl()+"// ".endl()+"// fragment shader "+this._name.endl()+"// ".endl()+"precision "+this.precision+" float;".endl()+"precision "+this.precision+" sampler2D;".endl()+"".endl()+"#define WEBGL2".endl()+"#define texture2D texture".endl()+"#define IN in".endl()+"#define UNI uniform".endl()+"{{DRAWBUFFER}}".endl()):(n="".endl()+"// ".endl()+"// fragment shader "+this._name.endl()+"// ".endl()+"#define WEBGL1".endl()+"#define texture texture2D".endl()+"#define outColor gl_FragColor".endl()+"#define IN varying".endl()+"#define UNI uniform".endl(),r="".endl()+"// ".endl()+"// vertex shader "+this._name.endl()+"// ".endl()+"#define WEBGL1".endl()+"#define texture texture2D".endl()+"#define OUT varying".endl()+"#define IN attribute".endl()+"#define UNI uniform".endl());let o="\n// cgl generated".endl(),a="\n// cgl generated".endl();n+="\n// active mods: --------------- ",r+="\n// active mods: --------------- ";let h=!1,l=!1;for(let t=0;t<this._moduleNames.length;t++)for(let e=0;e<this._modules.length;e++)this._modules[e].name==this._moduleNames[t]&&((this._modules[e].srcBodyFrag||this._modules[e].srcHeadFrag)&&(h=!0,n+="\n// "+t+"."+e+". "+this._modules[e].title+" ("+this._modules[e].name+")"),(this._modules[e].srcBodyVert||this._modules[e].srcHeadVert)&&(r+="\n// "+t+"."+e+". "+this._modules[e].title+" ("+this._modules[e].name+")",l=!0));l||(n+="\n// no mods used..."),h||(n+="\n// no mods used..."),n+="\n",r+="\n";for(let t=0;t<this._uniforms.length;t++)if(this._uniforms[t].shaderType&&!this._uniforms[t].isStructMember()){let e="";this._uniforms[t].getGlslTypeString()||(e+="// "),e+="UNI "+this._uniforms[t].getGlslTypeString()+" "+this._uniforms[t].getName();let i="";this._uniforms[t].comment&&(i=" // "+this._uniforms[t].comment),"vert"!=this._uniforms[t].shaderType&&"both"!=this._uniforms[t].shaderType||-1==this.srcVert.indexOf(e)&&-1==this.srcVert.indexOf("uniform "+this._uniforms[t].getGlslTypeString()+" "+this._uniforms[t].getName())&&(o+=e+";"+i.endl()),"frag"!=this._uniforms[t].shaderType&&"both"!=this._uniforms[t].shaderType||-1==this.srcFrag.indexOf(e)&&-1==this.srcFrag.indexOf("uniform "+this._uniforms[t].getGlslTypeString()+" "+this._uniforms[t].getName())&&(a+=e+";"+i.endl())}let c=0,u=0;for(let t=0;t<this._uniforms.length;t++)this._uniforms[t].shaderType&&!this._uniforms[t].isStructMember()&&("vert"!=this._uniforms[t].shaderType&&"both"!=this._uniforms[t].shaderType||u++,"frag"!=this._uniforms[t].shaderType&&"both"!=this._uniforms[t].shaderType||c++);c>=this._cgl.maxUniformsFrag&&this._log.warn("[cgl_shader] num uniforms frag: "+c+" / "+this._cgl.maxUniformsFrag),u>=this._cgl.maxUniformsVert&&this._log.warn("[cgl_shader] num uniforms vert: "+u+" / "+this._cgl.maxUniformsVert),-1==n.indexOf("precision")&&(n="precision "+this.precision+" float;".endl()+n),-1==r.indexOf("precision")&&(r="precision "+this.precision+" float;".endl()+r),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(n+="#define MOBILE".endl(),r+="#define MOBILE".endl()),r=e+r+i+s[0]+o+"\n// -- \n"+this.srcVert,n=e+n+i+s[1]+a+"\n// -- \n"+this.srcFrag;let g="",p="";this._modules.sort((function(t,e){return t.group-e.group})),this._modules.sort((function(t,e){return t.priority||0-e.priority||0}));let _=!1;for(let t=0;t<this._moduleNames.length;t++){let e="",i="";if(!_){_=!0;for(let t=0;t<this._attributes.length;t++){const i=this._getAttrSrc(this._attributes[t],!0);i.srcHeadVert&&(g+=i.srcHeadVert),i.srcVert&&(e+=i.srcVert),i.srcHeadFrag&&(p+=i.srcHeadFrag)}}for(let s=0;s<this._modules.length;s++){const r=this._modules[s];if(r.name==this._moduleNames[t]){if(g+="\n//---- MOD: group:"+r.group+": idx:"+s+" - prfx:"+r.prefix+" - "+r.title+" ------\n",p+="\n//---- MOD: group:"+r.group+": idx:"+s+" - prfx:"+r.prefix+" - "+r.title+" ------\n",e+="\n\n//---- MOD: "+r.title+" / "+r.priority+" ------\n",i+="\n\n//---- MOD: "+r.title+" / "+r.priority+" ------\n",r.attributes)for(let t=0;t<r.attributes.length;t++){const i=this._getAttrSrc(r.attributes[t],!1);i.srcHeadVert&&(g+=i.srcHeadVert),i.srcVert&&(e+=i.srcVert),i.srcHeadFrag&&(p+=i.srcHeadFrag)}g+=r.srcHeadVert||"",p+=r.srcHeadFrag||"",e+=r.srcBodyVert||"",i+=r.srcBodyFrag||"",g+="\n//---- end mod ------\n",p+="\n//---- end mod ------\n",e+="\n//---- end mod ------\n",i+="\n//---- end mod ------\n",e=e.replace(/{{mod}}/g,r.prefix),i=i.replace(/{{mod}}/g,r.prefix),g=g.replace(/{{mod}}/g,r.prefix),p=p.replace(/{{mod}}/g,r.prefix),e=e.replace(/MOD_/g,r.prefix),i=i.replace(/MOD_/g,r.prefix),g=g.replace(/MOD_/g,r.prefix),p=p.replace(/MOD_/g,r.prefix)}}r=r.replace("{{"+this._moduleNames[t]+"}}",e),n=n.replace("{{"+this._moduleNames[t]+"}}",i)}r=r.replace("{{MODULES_HEAD}}",g),n=n.replace("{{MODULES_HEAD}}",p),r=this._addLibs(r),n=this._addLibs(n);let d="";if(n.indexOf("outColor0")>-1&&(this._drawBuffers[0]=!0),n.indexOf("outColor1")>-1&&(this._drawBuffers[1]=!0),n.indexOf("outColor2")>-1&&(this._drawBuffers[2]=!0),n.indexOf("outColor3")>-1&&(this._drawBuffers[3]=!0),1==this._drawBuffers.length)d="out vec4 outColor;".endl(),d+="#define gl_FragColor outColor".endl();else{d+="#define MULTI_COLORTARGETS".endl(),d+="vec4 outColor;".endl();let t=0;for(let e=0;e<this._drawBuffers.length;e++)0==t&&(d+="#define gl_FragColor outColor"+e+"".endl()),d+="layout(location = "+e+") out vec4 outColor"+e+";".endl(),t++}if(n=n.replace("{{DRAWBUFFER}}",d),this._program){this._program=this._createProgram(r,n),this._projMatrixUniform=null;for(let t=0;t<this._uniforms.length;t++)this._uniforms[t].resetLoc()}else this._program=this._createProgram(r,n);this.finalShaderFrag=n,this.finalShaderVert=r,ht.lastMesh=null,ht.lastShader=null,this._needsRecompile=!1,this.lastCompile=dt(),this._cgl.profileData.shaderCompileTime+=performance.now()-t},It.hasChanged=function(){return this._needsRecompile},It.prototype.bind=function(){if(this._isValid&&(ht.lastShader=this,this._program&&!this._needsRecompile||this.compile(),this._isValid)){if(!this._projMatrixUniform){this._attrVertexPos=this._cgl.glGetAttribLocation(this._program,at.SHADER.SHADERVAR_VERTEX_POSITION),this._projMatrixUniform=this._cgl.gl.getUniformLocation(this._program,at.SHADER.SHADERVAR_UNI_PROJMAT),this._mvMatrixUniform=this._cgl.gl.getUniformLocation(this._program,"mvMatrix"),this._vMatrixUniform=this._cgl.gl.getUniformLocation(this._program,at.SHADER.SHADERVAR_UNI_VIEWMAT),this._mMatrixUniform=this._cgl.gl.getUniformLocation(this._program,at.SHADER.SHADERVAR_UNI_MODELMAT),this._camPosUniform=this._cgl.gl.getUniformLocation(this._program,at.SHADER.SHADERVAR_UNI_VIEWPOS),this._normalMatrixUniform=this._cgl.gl.getUniformLocation(this._program,at.SHADER.SHADERVAR_UNI_NORMALMAT),this._inverseViewMatrixUniform=this._cgl.gl.getUniformLocation(this._program,at.SHADER.SHADERVAR_UNI_INVVIEWMAT),this._inverseProjMatrixUniform=this._cgl.gl.getUniformLocation(this._program,at.SHADER.SHADERVAR_UNI_INVPROJMAT);for(let t=0;t<this._uniforms.length;t++)this._uniforms[t].needsUpdate=!0}this._cgl.currentProgram!=this._program&&(this._cgl.profileData.profileShaderBinds++,this._cgl.gl.useProgram(this._program),this._cgl.currentProgram=this._program);for(let t=0;t<this._uniforms.length;t++)this._uniforms[t].needsUpdate&&this._uniforms[t].updateValue();if(this._pMatrixState!=this._cgl.getProjectionMatrixStateCount()&&(this._pMatrixState=this._cgl.getProjectionMatrixStateCount(),this._cgl.gl.uniformMatrix4fv(this._projMatrixUniform,!1,this._cgl.pMatrix),this._cgl.profileData.profileMVPMatrixCount++),this._vMatrixUniform)this._vMatrixState!=this._cgl.getViewMatrixStateCount()&&(this._cgl.gl.uniformMatrix4fv(this._vMatrixUniform,!1,this._cgl.vMatrix),this._cgl.profileData.profileMVPMatrixCount++,this._vMatrixState=this._cgl.getViewMatrixStateCount(),this._inverseViewMatrixUniform&&(mat4.invert(this._tempInverseViewMatrix,this._cgl.vMatrix),this._cgl.gl.uniformMatrix4fv(this._inverseViewMatrixUniform,!1,this._tempInverseViewMatrix),this._cgl.profileData.profileMVPMatrixCount++),this._inverseProjMatrixUniform&&(mat4.invert(this._tempInverseProjMatrix,this._cgl.pMatrix),this._cgl.gl.uniformMatrix4fv(this._inverseProjMatrixUniform,!1,this._tempInverseProjMatrix),this._cgl.profileData.profileMVPMatrixCount++)),this._cgl.gl.uniformMatrix4fv(this._mMatrixUniform,!1,this._cgl.mMatrix),this._cgl.profileData.profileMVPMatrixCount++,this._camPosUniform&&(mat4.invert(this._tempCamPosMatrix,this._cgl.vMatrix),this._cgl.gl.uniform3f(this._camPosUniform,this._tempCamPosMatrix[12],this._tempCamPosMatrix[13],this._tempCamPosMatrix[14]),this._cgl.profileData.profileMVPMatrixCount++);else{const t=mat4.create();mat4.mul(t,this._cgl.vMatrix,this._cgl.mMatrix),this._cgl.gl.uniformMatrix4fv(this._mvMatrixUniform,!1,t),this._cgl.profileData.profileMVPMatrixCount++}this._normalMatrixUniform&&(mat4.invert(this._tempNormalMatrix,this._cgl.mMatrix),mat4.transpose(this._tempNormalMatrix,this._tempNormalMatrix),this._cgl.gl.uniformMatrix4fv(this._normalMatrixUniform,!1,this._tempNormalMatrix),this._cgl.profileData.profileMVPMatrixCount++);for(let t=0;t<this._libs.length;t++)this._libs[t].onBind&&this._libs[t].onBind.bind(this._libs[t])(this._cgl,this);this._bindTextures()}},It.prototype.toggleDefine=function(t,e){e&&"object"==typeof e&&e.addEventListener&&(e.changeListener&&e.removeEventListener(e.changeListener),e.onToggleDefine=e=>{this.toggleDefine(t,e)},e.changeListener=e.on("change",e.onToggleDefine),e=e.get()),e?this.define(t):this.removeDefine(t)},It.prototype.define=function(t,e){null==e&&(e=""),"object"==typeof e&&(e.removeEventListener("change",e.onDefineChange),e.onDefineChange=e=>{this.define(t,e)},e.on("change",e.onDefineChange),e=e.get());for(let i=0;i<this._defines.length;i++){if(this._defines[i][0]==t&&this._defines[i][1]==e)return;if(this._defines[i][0]==t)return this._defines[i][1]=e,this.setWhyCompile("define "+t+" "+e),void(this._needsRecompile=!0)}this.setWhyCompile("define "+t+" "+e),this._needsRecompile=!0,this._defines.push([t,e])},It.prototype.getDefines=function(){return this._defines},It.prototype.getDefine=function(t){for(let e=0;e<this._defines.length;e++)if(this._defines[e][0]==t)return this._defines[e][1];return null},It.prototype.hasDefine=function(t){for(let e=0;e<this._defines.length;e++)if(this._defines[e][0]==t)return!0},It.prototype.removeDefine=function(t){for(let e=0;e<this._defines.length;e++)if(this._defines[e][0]==t)return this._defines.splice(e,1),this._needsRecompile=!0,void this.setWhyCompile("define removed:"+t)},It.prototype.removeModule=function(t){for(let e=0;e<this._modules.length;e++)if(t&&t.id&&(this._modules[e].id==t.id||!this._modules[e])){let i=!0;for(;i;){i=!1;for(let e=0;e<this._uniforms.length;e++)0!=this._uniforms[e].getName().indexOf(t.prefix)||(this._uniforms.splice(e,1),i=!0)}this._needsRecompile=!0,this.setWhyCompile("remove module "+t.title),this._modules.splice(e,1);break}},It.prototype.getNumModules=function(){return this._modules.length},It.prototype.getCurrentModules=function(){return this._modules},It.prototype.addModule=function(t,e){return t.id||(t.id=A()),t.numId||(t.numId=this._moduleNumId),t.num||(t.num=this._modules.length),e&&!e.group&&(e.group=x()),t.group||(t.group=e?e.group:x()),t.prefix="mod"+t.group+"_",this._modules.push(t),this._needsRecompile=!0,this.setWhyCompile("add module "+t.title),this._moduleNumId++,t},It.prototype.hasModule=function(t){for(let e=0;e<this._modules.length;e++)if(this._modules[e].id==t)return!0;return!1},It.prototype.setModules=function(t){this._moduleNames=t},It.prototype.dispose=function(){this._cgl.gl.deleteProgram(this._program)},It.prototype.needsRecompile=function(){return this._needsRecompile},It.prototype.setDrawBuffers=function(t){if(this._drawBuffers.length!==t.length)return this._drawBuffers=t,this._needsRecompile=!0,void this.setWhyCompile("setDrawBuffers");for(let e=0;e<t.length;e++)if(t[e]!==this._drawBuffers[e])return this._drawBuffers=t,this._needsRecompile=!0,void this.setWhyCompile("setDrawBuffers")},It.prototype.getUniforms=function(){return this._uniforms},It.prototype.getUniform=function(t){for(let e=0;e<this._uniforms.length;e++)if(this._uniforms[e].getName()==t)return this._uniforms[e];return null},It.prototype.removeAllUniforms=function(){this._uniforms=[]},It.prototype.removeUniform=function(t){for(let e=0;e<this._uniforms.length;e++)this._uniforms[e].getName()==t&&this._uniforms.splice(e,1);this._needsRecompile=!0,this.setWhyCompile("remove uniform "+t)},It.prototype._addUniform=function(t){this._uniforms.push(t),this.setWhyCompile("add uniform "+name),this._needsRecompile=!0},It.prototype.addUniformFrag=function(t,e,i,s,r,n){const o=new CGL.Uniform(this,t,e,i,s,r,n);return o.shaderType="frag",o},It.prototype.addUniformVert=function(t,e,i,s,r,n){const o=new CGL.Uniform(this,t,e,i,s,r,n);return o.shaderType="vert",o},It.prototype.addUniformBoth=function(t,e,i,s,r,n){const o=new CGL.Uniform(this,t,e,i,s,r,n);return o.shaderType="both",o},It.prototype.addUniformStructFrag=function(t,e,i){const s={};if(!i)return s;for(let r=0;r<i.length;r+=1){const n=i[r];if(!this.hasUniform(e+"."+n.name)){const i=new CGL.Uniform(this,n.type,e+"."+n.name,n.v1,n.v2,n.v3,n.v4,e,t,n.name);i.shaderType="frag",s[e+"."+n.name]=i}}return s},It.prototype.addUniformStructVert=function(t,e,i){const s={};if(!i)return s;for(let r=0;r<i.length;r+=1){const n=i[r];if(!this.hasUniform(e+"."+n.name)){const i=new CGL.Uniform(this,n.type,e+"."+n.name,n.v1,n.v2,n.v3,n.v4,e,t,n.name);i.shaderType="vert",s[e+"."+n.name]=i}}return s},It.prototype.addUniformStructBoth=function(t,e,i){const s={};if(!i)return s;for(let r=0;r<i.length;r+=1){const n=i[r];if("2i"!==n.type&&"i"!==n.type&&"3i"!==n.type||this._log.error("Adding an integer struct member to both shaders can potentially error. Please use different structs for each shader. Error occured in struct:",t," with member:",n.name," of type:",n.type,"."),!this.hasUniform(e+"."+n.name)){const i=new CGL.Uniform(this,n.type,e+"."+n.name,n.v1,n.v2,n.v3,n.v4,e,t,n.name);i.shaderType="both",s[e+"."+n.name]=i}}return s},It.prototype.hasUniform=function(t){for(let e=0;e<this._uniforms.length;e++)if(this._uniforms[e].getName()==t)return!0;return!1},It.prototype._createProgram=function(t,e){this._cgl.printError("before _createprogram");const i=this._cgl.gl.createProgram();return this.vshader=It.createShader(this._cgl,t,this._cgl.gl.VERTEX_SHADER,this),this.fshader=It.createShader(this._cgl,e,this._cgl.gl.FRAGMENT_SHADER,this),this._cgl.gl.attachShader(i,this.vshader),this._cgl.gl.attachShader(i,this.fshader),this._linkProgram(i,t,e),this._cgl.printError("shader _createProgram"),i},It.prototype.hasErrors=function(){return this._hasErrors},It.prototype._linkProgram=function(t,e,i){this._cgl.printError("before _linkprogram"),this._feedBackNames.length>0&&this._cgl.gl.transformFeedbackVaryings(t,this._feedBackNames,this._cgl.gl.SEPARATE_ATTRIBS),this._cgl.gl.linkProgram(t),this._cgl.printError("gl.linkprogram"),this._isValid=!0,this._hasErrors=!1,!1!==this._cgl.patch.config.glValidateShader&&(this._cgl.gl.validateProgram(t),this._cgl.gl.getProgramParameter(t,this._cgl.gl.VALIDATE_STATUS)||(console.log("shaderprogram validation failed..."),console.log(this._name+" programinfo: ",this._cgl.gl.getProgramInfoLog(t))),this._cgl.gl.getProgramParameter(t,this._cgl.gl.LINK_STATUS)||(this._hasErrors=!0,this._log.warn(this._cgl.gl.getShaderInfoLog(this.fshader)||"empty shader infolog"),this._log.warn(this._cgl.gl.getShaderInfoLog(this.vshader)||"empty shader infolog"),this._log.error(this._name+" shader linking fail..."),console.log(this._name+" programinfo: ",this._cgl.gl.getProgramInfoLog(t)),console.log("--------------------------------------"),console.log(this),console.log("--------------------------------------"),this._isValid=!1,this._name="errorshader",this.setSource(It.getDefaultVertexShader(),It.getErrorFragmentShader()),this._cgl.printError("shader link err")))},It.prototype.getProgram=function(){return this._program},It.prototype.setFeedbackNames=function(t){this.setWhyCompile("setFeedbackNames"),this._needsRecompile=!0,this._feedBackNames=t},It.prototype.getDefaultVertexShader=It.getDefaultVertexShader=function(){return"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},It.prototype.getDefaultFragmentShader=It.getDefaultFragmentShader=function(t,e,i){return null==t&&(t=.5,e=.5,i=.5),"".endl()+"IN vec2 texCoord;".endl()+"{{MODULES_HEAD}}".endl()+"void main()".endl()+"{".endl()+"    vec4 col=vec4("+t+","+e+","+i+",1.0);".endl()+"    {{MODULE_COLOR}}".endl()+"    outColor = col;".endl()+"}"},It.prototype.addAttribute=function(t){for(let e=0;e<this._attributes.length;e++)if(this._attributes[e].name==t.name&&this._attributes[e].nameFrag==t.nameFrag)return;this._attributes.push(t),this._needsRecompile=!0,this.setWhyCompile("addAttribute")},It.prototype.bindTextures=It.prototype._bindTextures=function(){this._textureStackTex.length>this._cgl.maxTextureUnits&&this._log.warn("[shader._bindTextures] too many textures bound",this._textureStackTex.length+"/"+this._cgl.maxTextureUnits);for(let t=0;t<this._textureStackTex.length;t++)if(this._textureStackTex[t]||this._textureStackTexCgl[t]){let e=this._textureStackTex[t];this._textureStackTexCgl[t]&&(e=this._textureStackTexCgl[t].tex||CGL.Texture.getEmptyTexture(this._cgl).tex);let i=!0;this._textureStackUni[t]?(this._textureStackUni[t].setValue(t),i=this._cgl.setTexture(t,e,this._textureStackType[t])):(this._log.warn("no uniform for pushtexture",this._name),i=this._cgl.setTexture(t,e,this._textureStackType[t])),i||this._log.warn("tex bind failed",this.getName(),this._textureStackUni[t])}else this._log.warn("no texture for pushtexture",this._name)},It.prototype.setUniformTexture=function(t,e){for(let i=0;i<this._textureStackUni.length;i++)if(this._textureStackUni[i]==t){const t=this._textureStackTex[i]||this._textureStackTexCgl[i];return e.hasOwnProperty("tex")?(this._textureStackTexCgl[i]=e,this._textureStackTex[i]=null):(this._textureStackTexCgl[i]=null,this._textureStackTex[i]=e),t}return null},It.prototype.pushTexture=function(t,e,i){if(!t)throw new Error("no uniform given to texturestack");if(e){if(!(e.hasOwnProperty("tex")||e instanceof WebGLTexture))return this._log.warn(new Error("invalid texture").stack),void this._log.warn("[cgl_shader] invalid texture...",e);this._textureStackUni.push(t),e.hasOwnProperty("tex")?(this._textureStackTexCgl.push(e),this._textureStackTex.push(null)):(this._textureStackTexCgl.push(null),this._textureStackTex.push(e)),this._textureStackType.push(i)}},It.prototype.popTexture=function(){this._textureStackUni.pop(),this._textureStackTex.pop(),this._textureStackTexCgl.pop(),this._textureStackType.pop()},It.prototype.popTextures=function(){this._textureStackTex.length=this._textureStackTexCgl.length=this._textureStackType.length=this._textureStackUni.length=0},It.prototype.getInfo=function(){const t={};return t.name=this._name,t.defines=this.getDefines(),t.hasErrors=this.hasErrors(),t},It.getErrorFragmentShader=function(){return"".endl()+"void main()".endl()+"{".endl()+"   float g=mod((gl_FragCoord.y+gl_FragCoord.x),50.0)/50.0;".endl()+"   g= step(0.1,g);".endl()+"   outColor = vec4( g+0.5, 0.0, 0.0, 1.0);".endl()+"}"},It.createShader=function(t,e,i,s){if(t.aborted)return;const r=t.gl.createShader(i);if(t.gl.shaderSource(r,e),t.gl.compileShader(r),!t.gl.getShaderParameter(r,t.gl.COMPILE_STATUS)){console.log("compile status: "),i==t.gl.VERTEX_SHADER&&console.log("VERTEX_SHADER"),i==t.gl.FRAGMENT_SHADER&&console.log("FRAGMENT_SHADER");let o=t.gl.getShaderInfoLog(r)||"empty shader info log";const a=function(t){const e=[],i=t.split("\n");for(const t in i){const s=i[t].split(":");parseInt(s[2],10)&&e.push(parseInt(s[2],10))}return e}(o);let h='<pre style="margin-bottom:0px;"><code class="shaderErrorCode language-glsl" style="padding-bottom:0px;max-height: initial;max-width: initial;">';const l=e.match(/^.*((\r\n|\n|\r)|$)/gm);for(const t in l){const e=parseInt(t,10)+1,i=e+": "+l[t];console.log(i);let s=!1;for(const t in a)a[t]==e&&(s=!0);s&&(h+="</code></pre>",h+='<pre style="margin:0"><code class="language-glsl" style="background-color:#660000;padding-top:0px;padding-bottom:0px">'),h+=(n=i)&&yt.test(n)?n.replace(vt,(function(t){return xt[t]})):n||"",s&&(h+="</code></pre>",h+='<pre style="margin:0"><code class="language-glsl" style=";padding-top:0px;padding-bottom:0px">')}console.warn(o),o=o.replace(/\n/g,"<br/>"),h=o+"<br/>"+h+"<br/><br/>",h+="</code></pre>",t.patch.emitEvent("criticalError",{title:"Shader error "+this._name,text:h}),t.patch.isEditorMode()&&console.log("Shader error "+this._name,h),this._name="errorshader",s.setSource(It.getDefaultVertexShader(),It.getErrorFragmentShader())}var n;return r};class St{constructor(t){this._cgl=t,this._lastTime=0,this.pause=!1,this.profileUniformCount=0,this.profileShaderBinds=0,this.profileUniformCount=0,this.profileShaderCompiles=0,this.profileVideosPlaying=0,this.profileMVPMatrixCount=0,this.profileEffectBuffercreate=0,this.profileShaderGetUniform=0,this.profileFrameBuffercreate=0,this.profileMeshSetGeom=0,this.profileTextureNew=0,this.profileGenMipMap=0,this.profileOnAnimFrameOps=0,this.profileMainloopMs=0,this.profileMeshDraw=0,this.profileTextureEffect=0,this.profileTexPreviews=0,this.shaderCompileTime=0,this.profileMeshNumElements=0,this.profileMeshAttributes=0,this.profileSingleMeshAttribute=[],this.heavyEvents=[],this.doProfileGlQuery=!1,this.glQueryData={}}clear(){this.profileSingleMeshAttribute={},this.profileMeshAttributes=0,this.profileUniformCount=0,this.profileShaderGetUniform=0,this.profileShaderCompiles=0,this.profileShaderBinds=0,this.profileTextureResize=0,this.profileFrameBuffercreate=0,this.profileEffectBuffercreate=0,this.profileTextureDelete=0,this.profileMeshSetGeom=0,this.profileVideosPlaying=0,this.profileMVPMatrixCount=0,this.profileNonTypedAttrib=0,this.profileNonTypedAttribNames="",this.profileTextureNew=0,this.profileGenMipMap=0,this.profileFramebuffer=0,this.profileMeshDraw=0,this.profileTextureEffect=0,this.profileTexPreviews=0,this.profileMeshNumElements=0}clearGlQuery(){for(let t in this.glQueryData)(!this.glQueryData[t].lastClear||performance.now()-this.glQueryData[t].lastClear>1e3)&&(this.glQueryData[t].time=this.glQueryData[t]._times/this.glQueryData[t]._numcount,this.glQueryData[t].num=this.glQueryData[t]._numcount,this.glQueryData[t]._times=0,this.glQueryData[t]._numcount=0,this.glQueryData[t].lastClear=performance.now())}addHeavyEvent(t,e,i){const s={event:t,name:e,info:i,date:performance.now()};this.heavyEvents.push(s),this._cgl.emitEvent("heavyEvent",s)}}const Rt={GAPI_WEBGL:0,GAPI_WEBGPU:1,Geometry:W,BoundingBox:z,FpsCounter:class extends Y{constructor(){super(),this._timeStartFrame=0,this._timeStartSecond=0,this._fpsCounter=0,this._msCounter=0,this.stats={ms:0,fps:0}}startFrame(){this._timeStartFrame=CABLES.now()}endFrame(){this._fpsCounter++;const t=CABLES.now()-this._timeStartFrame;this._msCounter+=t,CABLES.now()-this._timeStartSecond>1e3&&this.endSecond()}endSecond(){this.stats.fps=this._fpsCounter,this.stats.ms=Math.round(this._msCounter/this._fpsCounter*100)/100,this.emitEvent("performance",this.stats),this._fpsCounter=0,this._msCounter=0,this._timeStartSecond=CABLES.now()}}},Pt=function(t){Ut.apply(this),this.patch=t,this.gApi=Rt.GAPI_WEBGPU,this._viewport=[0,0,256,256],this._shaderStack=[],this.getViewPort=function(){return[0,0,this.canvasWidth,this.canvasHeight]},this.renderStart=function(t,e,i){this.fpsCounter.startFrame(),this._startMatrixStacks(e,i),this.setViewPort(0,0,this.canvasWidth,this.canvasHeight),this.emitEvent("beginFrame")},this.renderEnd=function(t){this._endMatrixStacks(),this.emitEvent("endFrame"),this.fpsCounter.endFrame()}};Pt.prototype.setViewPort=function(t,e,i,s){this._viewport=[t,e,i,s]},Pt.prototype.getViewPort=function(){return this._viewPort},Pt.prototype.createMesh=function(t,e){return new CGP.Mesh(this,t,e)},Pt.prototype.getShader=function(){return{}},Pt.prototype.pushShader=function(t){this._shaderStack.push(t)},Pt.prototype.popShader=function(){if(0===this._shaderStack.length)throw new Error("Invalid shader stack pop!");this._shaderStack.pop()},Pt.prototype.getShader=function(){return this._shaderStack[this._shaderStack.length-1]},Pt.prototype.pushErrorScope=function(){this.device.pushErrorScope("validation")},Pt.prototype.popErrorScope=function(t,e){this.device.popErrorScope().then(i=>{i&&(this.patch.emitEvent("criticalError",{title:'WebGPU error "'+t+'"',codeText:i.message}),console.warn("[cgp]",t,i.message,i,e),e&&e(i))})};class Ot extends rt{constructor(t,e,i,s,r,n,o,a,h,l){super(t,e,i,s,r,n,o,a,h,l),this._loc=-1,this._cgl=t._cgl}updateValueF(){}setValueF(t){this.needsUpdate=!0,this._value=t}updateValue2F(){}setValue2F(t){this.needsUpdate=!0,this._value=t}updateValue3F(){}setValue3F(t){this.needsUpdate=!0,this._value=t}updateValue4F(){}setValue4F(t){this.needsUpdate=!0,this._value=t}getSizeBytes(){return"f"==this._type||"i"==this._type?4:"2i"==this._type||"2f"==this._type?8:"3f"==this._type?12:"4f"==this._type?16:"m4"==this._type?64:void this._log.warn("unknown type getSizeBytes")}}class Nt{constructor(t,e){this._shaderType=e,this._shader=t,this._cgp=t._cgp,this._gpuBuffer=null,this._values=null,this._sizeBytes=0,this.update()}update(){this._sizeBytes=0;for(let t=0;t<this._shader.uniforms.length;t++){const e=this._shader.uniforms[t];this._shaderType==e.shaderType&&(this._sizeBytes+=e.getSizeBytes())}this._gpuBuffer=this._cgp.device.createBuffer({size:this._sizeBytes,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this._values=new Float32Array(this._sizeBytes/4),this.updateUniformValues()}updateUniformValues(){let t=0;for(let e=0;e<this._shader.uniforms.length;e++){const i=this._shader.uniforms[e];if(i.shaderType==this._shaderType)if(i.getSizeBytes()/4>1)for(let e=0;e<i.getValue().length;e++)this._values[t]=i.getValue()[e],t++;else this._values[t]=i.getValue(),t++}this._cgp.device.queue.writeBuffer(this._gpuBuffer,0,this._values.buffer,this._values.byteOffset,this._values.byteLength)}}class Ft{constructor(t,e){if(!t)throw new Error("Pipeline constructed without cgp "+e);this._cgp=t,this._isValid=!0,this._pipeCfg=null,this._renderPipeline=null,this._fsUniformBuffer=null,this._vsUniformBuffer=null,this._old={}}get isValid(){return this._isValid}setPipeline(t,e){if(!e||!t)return void console.log("pipeline unknown shader/mesh");(!this._renderPipeline||!this._pipeCfg||this._old.mesh!=e||this._old.shader!=t||e.needsPipelineUpdate||t.needsPipelineUpdate)&&(this._old.shader=t,this._old.mesh=e,this._pipeCfg=this.getPiplelineObject(t,e),console.log(this._pipeCfg),this._renderPipeline=this._cgp.device.createRenderPipeline(this._pipeCfg),this._bindUniforms(t)),this._renderPipeline&&this._isValid&&(mat4.copy(this._matModel,this._cgp.mMatrix),mat4.copy(this._matView,this._cgp.vMatrix),mat4.copy(this._matProj,this._cgp.pMatrix),this._cgp.device.queue.writeBuffer(this._vsUniformBuffer,0,this._vsUniformValues.buffer,this._vsUniformValues.byteOffset,this._vsUniformValues.byteLength),this._uniBufFrag.updateUniformValues(),this._cgp.passEncoder.setPipeline(this._renderPipeline),this._cgp.passEncoder.setBindGroup(0,this._bindGroup))}getPiplelineObject(t,e){return{layout:"auto",vertex:{module:t.shaderModule,entryPoint:"myVSMain",buffers:[{arrayStride:12,attributes:[{shaderLocation:0,offset:0,format:"float32x3"}]},{arrayStride:12,attributes:[{shaderLocation:1,offset:0,format:"float32x3"}]},{arrayStride:8,attributes:[{shaderLocation:2,offset:0,format:"float32x2"}]}]},fragment:{module:t.shaderModule,entryPoint:"myFSMain",targets:[{format:this._cgp.presentationFormat}]},primitive:{topology:"triangle-list",cullMode:"none"},depthStencil:{depthWriteEnabled:!0,depthCompare:"less",format:"depth24plus"}}}_bindUniforms(t){this._cgp.pushErrorScope(),this._uniBufFrag=new Nt(t,"frag");this._vsUniformBuffer=this._cgp.device.createBuffer({size:192,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this._vsUniformValues=new Float32Array(48),this._matModel=this._vsUniformValues.subarray(0,16),this._matView=this._vsUniformValues.subarray(16,32),this._matProj=this._vsUniformValues.subarray(32,48),this._bindGroup=this._cgp.device.createBindGroup({layout:this._renderPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this._vsUniformBuffer}},{binding:1,resource:{buffer:this._uniBufFrag._gpuBuffer}}]}),this._cgp.device.queue.writeBuffer(this._vsUniformBuffer,0,this._vsUniformValues.buffer,this._vsUniformValues.byteOffset,this._vsUniformValues.byteLength),this._uniBufFrag.updateUniformValues(),this._cgp.popErrorScope("cgp_pipeline end",t=>{this._isValid=!1})}}class Ct{constructor(t,e){if(!t)throw new Error("no cgp");this._log=new a("cgp_texture"),this._cgp=t,this.id=CABLES.uuid(),e=e||{},this.name=e.name||"unknown"}initTexture(t,e){this.width=t.width,this.height=t.height,this.textureType="rgba8unorm";const i={size:{width:t.width,height:t.height},format:this.textureType,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST},s=this._cgp.device.createTexture(i);return this._cgp.device.queue.copyExternalImageToTexture({source:t},{texture:s},i.size),s}getInfo(){const t={};return t.name=this.name,t.size=this.width+" x "+this.height,t.textureType=this.textureType,t}}Ct.load=function(t,e,i,s){fetch(e).then(s=>{s.blob().then(s=>{createImageBitmap(s).then(s=>{const r=new Ct(t,{name:e});r.initTexture(s),i?i(r):console.log("Texture.load no onFinished callback")})})})};const wt=Object.assign({Context:Pt,Shader:class{constructor(t,e){if(!t)throw new Error("shader constructed without cgp "+e);this._log=new a("cgp_shader"),this._cgp=t,this._name=e,this._uniforms=[],e||this._log.stack("no shader name given"),this._name=e||"unknown",this.id=x(),this._isValid=!0,this._compileReason="",this.shaderModule=null,this._needsRecompile=!0,this._src=""}get isValid(){return this._isValid}get uniforms(){return this._uniforms}getName(){return this._name}setWhyCompile(t){this._compileReason=t}setSource(t){this._src=t,this.setWhyCompile("Source changed"),this._needsRecompile=!0}compile(){this._isValid=!0,console.log("compiling shader...",this._compileReason),this._cgp.pushErrorScope(),this.shaderModule=this._cgp.device.createShaderModule({code:this._src}),this._cgp.popErrorScope("cgp_shader "+this._name,this.error.bind(this)),this._needsRecompile=!1}error(t){this._isValid=!1}bind(){for(let t=0;t<this._uniforms.length;t++);this._needsRecompile&&this.compile()}addUniformFrag(t,e,i,s,r,n){const o=new Ot(this,t,e,i,s,r,n);return o.shaderType="frag",o}addUniformVert(t,e,i,s,r,n){const o=new Ot(this,t,e,i,s,r,n);return o.shaderType="vert",o}addUniform(t,e,i,s,r,n){const o=new Ot(this,t,e,i,s,r,n);return o.shaderType="both",o}_addUniform(t){this._uniforms.push(t),this.setWhyCompile("add uniform "+name),this._needsRecompile=!0}},Mesh:class{constructor(t,e){this._log=new a("cgl_mesh"),this._cgp=t,this._geom=null,this.numIndex=0,this._pipe=new Ft(this._cgp),this._numNonIndexed=0,this._positionBuffer=null,this._bufVerticesIndizes=null,this._attributes=[],this._needsPipelineUpdate=!1,e&&this.setGeom(e)}_createBuffer(t,e,i){const s=t.createBuffer({size:e.byteLength,usage:i,mappedAtCreation:!0});return new e.constructor(s.getMappedRange()).set(e),s.unmap(),s}setGeom(t,e){this._needsPipelineUpdate=!0,this._geom=t,this._disposeAttributes(),this._positionBuffer=this._createBuffer(this._cgp.device,new Float32Array(t.vertices),GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST);let i=t.verticesIndices;t.isIndexed()||(i=Array.from(Array(t.vertices.length/3).keys())),this._numIndices=i.length,this._indicesBuffer=this._createBuffer(this._cgp.device,new Uint32Array(i),GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST),t.texCoords&&t.texCoords.length&&this.setAttribute("texCoords",t.texCoords,2),t.vertexNormals&&t.vertexNormals.length&&this.setAttribute("normals",t.vertexNormals,3)}_disposeAttributes(){this._needsPipelineUpdate=!0;for(let t=0;t<this._attributes.length;t++)this._attributes[t].buffer.destroy();this._attributes.length=0}dispose(){this._disposeAttributes()}setAttribute(t,e,i,s){if(!e)throw this._log.error("mesh addAttribute - no array given! "+t),new Error;for(let e=0;e<this._attributes.length;e++){const i=this._attributes[e];if(i.name==t)return i}const r={buffer:this._createBuffer(this._cgp.device,new Float32Array(e),GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST),name:t};return this._attributes.push(r),r}render(){if(this._positionBuffer&&(this._cgp.getShader().bind(),this._cgp.getShader().isValid&&(this._pipe.setPipeline(this._cgp.getShader(),this),this._pipe.isValid))){this._cgp.passEncoder.setVertexBuffer(0,this._positionBuffer);for(let t=0;t<this._attributes.length;t++)this._cgp.passEncoder.setVertexBuffer(t+1,this._attributes[t].buffer);this._cgp.passEncoder.setIndexBuffer(this._indicesBuffer,"uint32"),this._numNonIndexed?this._cgp.passEncoder.draw(this._numIndices):this._cgp.passEncoder.drawIndexed(this._numIndices)}}},Pipeline:Ft,Texture:Ct});window.CGP=wt;const Mt=function(){this._arr=[mat4.create()],this._index=0,this.stateCounter=0};Mt.prototype.push=function(t){if(this._index++,this.stateCounter++,this._index==this._arr.length){const t=mat4.create();this._arr.push(t)}return mat4.copy(this._arr[this._index],t||this._arr[this._index-1]),this._arr[this._index]},Mt.prototype.pop=function(){return this.stateCounter++,this._index--,this._index<0&&(this._index=0),this._arr[this._index]},Mt.prototype.length=function(){return this._index};i(1);const Ut=function(){Y.apply(this),this.canvas=null,this.fpsCounter=new CABLES.CG.FpsCounter,this._identView=vec3.create(),this._ident=vec3.create(),vec3.set(this._identView,0,0,-2),vec3.set(this._ident,0,0,0),this.pMatrix=mat4.create(),this.mMatrix=mat4.create(),this.vMatrix=mat4.create(),this._textureslots=[],this._pMatrixStack=new Mt,this._mMatrixStack=new Mt,this._vMatrixStack=new Mt,this.canvasWidth=-1,this.canvasHeight=-1,this.canvasScale=1,this.canvas=null,this.pixelDensity=1,mat4.identity(this.mMatrix),mat4.identity(this.vMatrix),this.getGApiName=()=>["WebGL","WebGPU"][this.gApi],this.setCanvas=function(t){this.canvas="string"==typeof t?document.getElementById(t):t,this._setCanvas&&this._setCanvas(t),this.updateSize()},this.updateSize=function(){this.canvas.width=this.canvasWidth=this.canvas.clientWidth*this.pixelDensity,this.canvas.height=this.canvasHeight=this.canvas.clientHeight*this.pixelDensity},this.setSize=function(t,e,i){i||(this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"),this.canvas.width=t*this.pixelDensity,this.canvas.height=e*this.pixelDensity,this.updateSize()},this._resizeToWindowSize=function(){this.setSize(window.innerWidth,window.innerHeight),this.updateSize()},this._resizeToParentSize=function(){const t=this.canvas.parentElement;t?(this.setSize(t.clientWidth,t.clientHeight),this.updateSize()):this._log.error("cables: can not resize to container element")},this.setAutoResize=function(t){window.removeEventListener("resize",this._resizeToWindowSize.bind(this)),window.removeEventListener("resize",this._resizeToParentSize.bind(this)),"window"==t&&(window.addEventListener("resize",this._resizeToWindowSize.bind(this)),window.addEventListener("orientationchange",this._resizeToWindowSize.bind(this)),this._resizeToWindowSize()),"parent"==t&&(window.addEventListener("resize",this._resizeToParentSize.bind(this)),this._resizeToParentSize())},this.pushPMatrix=function(){this.pMatrix=this._pMatrixStack.push(this.pMatrix)},this.popPMatrix=function(){return this.pMatrix=this._pMatrixStack.pop(),this.pMatrix},this.getProjectionMatrixStateCount=function(){return this._pMatrixStack.stateCounter},this.pushModelMatrix=function(){this.mMatrix=this._mMatrixStack.push(this.mMatrix)},this.popModelMatrix=function(){return this.mMatrix=this._mMatrixStack.pop(),this.mMatrix},this.modelMatrix=function(){return this.mMatrix},this.pushViewMatrix=function(){this.vMatrix=this._vMatrixStack.push(this.vMatrix)},this.popViewMatrix=function(){this.vMatrix=this._vMatrixStack.pop()},this.getViewMatrixStateCount=function(){return this._vMatrixStack.stateCounter},this._startMatrixStacks=(t,e)=>{t=t||this._ident,e=e||this._identView,mat4.perspective(this.pMatrix,45,this.canvasWidth/this.canvasHeight,.1,1e3),mat4.identity(this.mMatrix),mat4.identity(this.vMatrix),mat4.translate(this.mMatrix,this.mMatrix,t),mat4.translate(this.vMatrix,this.vMatrix,e),this.pushPMatrix(),this.pushModelMatrix(),this.pushViewMatrix()},this._endMatrixStacks=()=>{this.popViewMatrix(),this.popModelMatrix(),this.popPMatrix()}},Bt=function(t){Ut.apply(this),this.gApi=Rt.GAPI_WEBGL,this.pushMvMatrix=this.pushModelMatrix,this.popMvMatrix=this.popmMatrix=this.popModelMatrix,this.profileData=new St(this),this._log=new a("cgl_context");const e=[0,0,0,0];this.glVersion=0,this.glUseHalfFloatTex=!1,this.clearCanvasTransparent=!0,this.clearCanvasDepth=!0,this.patch=t,this.debugOneFrame=!1,this.checkGlErrors=!0,this.maxTextureUnits=0,this.maxVaryingVectors=0,this.currentProgram=null,this._hadStackError=!1,this.glSlowRenderer=!1,this._isSafariCrap=!1,this.temporaryTexture=null,this.frameStore={},this._onetimeCallbacks=[],this.gl=null,this._cursor="auto",this._currentCursor="",this._glFrameBufferStack=[],this._frameBufferStack=[],this._shaderStack=[],this._stackDepthTest=[],Object.defineProperty(this,"mvMatrix",{get(){return this.mMatrix},set(t){this.mMatrix=t}});const i=new It(this,"simpleshader");i.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]),i.setSource(It.getDefaultVertexShader(),It.getDefaultFragmentShader());let s=i;this.aborted=!1;const r=[];this.exitError=function(t,e){this.patch.exitError(t,e),this.aborted=!0},this._setCanvas=function(t){if(this.patch.config.canvas||(this.patch.config.canvas={}),this.patch.config.canvas.hasOwnProperty("preserveDrawingBuffer")||(this.patch.config.canvas.preserveDrawingBuffer=!1),this.patch.config.canvas.hasOwnProperty("premultipliedAlpha")||(this.patch.config.canvas.premultipliedAlpha=!1),this.patch.config.canvas.hasOwnProperty("alpha")||(this.patch.config.canvas.alpha=!1),this.patch.config.canvas.stencil=!0,this.patch.config.hasOwnProperty("clearCanvasColor")&&(this.clearCanvasTransparent=this.patch.config.clearCanvasColor),this.patch.config.hasOwnProperty("clearCanvasDepth")&&(this.clearCanvasDepth=this.patch.config.clearCanvasDepth),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&(this._isSafariCrap=!0),this.patch.config.canvas.forceWebGl1||(this.gl=this.canvas.getContext("webgl2",this.patch.config.canvas)),this.gl&&"WebGL 1.0"!=this.gl.getParameter(this.gl.VERSION)?this.glVersion=2:(this.gl=this.canvas.getContext("webgl",this.patch.config.canvas)||this.canvas.getContext("experimental-webgl",this.patch.config.canvas),this.glVersion=1,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&navigator.userAgent.match(/iPhone/i)&&(this.glUseHalfFloatTex=!0),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&(this.patch.config.canvas.hasOwnProperty("powerPreference")||(this.patch.config.canvas.powerPreference="high-performance"))),!this.gl)return void this.exitError("NO_WEBGL","sorry, could not initialize WebGL. Please check if your Browser supports WebGL or try to restart your browser.");const e=this.gl.getExtension("WEBGL_debug_renderer_info");e&&(this.glRenderer=this.gl.getParameter(e.UNMASKED_RENDERER_WEBGL),"Google SwiftShader"===this.glRenderer&&(this.glSlowRenderer=!0)),this.gl.getExtension("OES_standard_derivatives");const i=this.gl.getExtension("ANGLE_instanced_arrays")||this.gl;this.canvas.addEventListener("webglcontextlost",t=>{this._log.error("canvas lost...",t),this.emitEvent("webglcontextlost"),this.aborted=!0}),this.maxVaryingVectors=this.gl.getParameter(this.gl.MAX_VARYING_VECTORS),this.maxTextureUnits=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.maxTexSize=this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),this.maxUniformsFrag=this.gl.getParameter(this.gl.MAX_FRAGMENT_UNIFORM_VECTORS),this.maxUniformsVert=this.gl.getParameter(this.gl.MAX_VERTEX_UNIFORM_VECTORS),this.maxSamples=0,this.gl.MAX_SAMPLES&&(this.maxSamples=this.gl.getParameter(this.gl.MAX_SAMPLES)),i.vertexAttribDivisorANGLE&&(this.gl.vertexAttribDivisor=i.vertexAttribDivisorANGLE.bind(i),this.gl.drawElementsInstanced=i.drawElementsInstancedANGLE.bind(i))},this.getInfo=function(){return{glVersion:this.glVersion,glRenderer:this.glRenderer,glUseHalfFloatTex:this.glUseHalfFloatTex,maxVaryingVectors:this.maxVaryingVectors,maxTextureUnits:this.maxTextureUnits,maxTexSize:this.maxTexSize,maxUniformsFrag:this.maxUniformsFrag,maxUniformsVert:this.maxUniformsVert,maxSamples:this.maxSamples}};let n=-1,o=-1;this.getViewPort=function(){return e},this.resetViewPort=function(){this.gl.viewport(e[0],e[1],e[2],e[3])},this.setViewPort=function(t,i,s,r){e[0]=Math.round(t),e[1]=Math.round(i),e[2]=Math.round(s),e[3]=Math.round(r),this.gl.viewport(e[0],e[1],e[2],e[3])},this.screenShot=function(t,e,i,s){e&&(this.gl.clearColor(1,1,1,1),this.gl.colorMask(!1,!1,!1,!0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.colorMask(!0,!0,!0,!0)),this.canvas&&this.canvas.toBlob&&this.canvas.toBlob(e=>{t?t(e):this._log.log("no screenshot callback...")},i,s)},this.endFrame=function(){if(this.patch.isEditorMode()&&CABLES.GL_MARKER.drawMarkerLayer(this),this.setPreviousShader(),this._vMatrixStack.length()>0&&this.logStackError("view matrix stack length !=0 at end of rendering..."),this._mMatrixStack.length()>0&&this.logStackError("mvmatrix stack length !=0 at end of rendering..."),this._pMatrixStack.length()>0&&this.logStackError("pmatrix stack length !=0 at end of rendering..."),this._glFrameBufferStack.length>0&&this.logStackError("glFrameBuffer stack length !=0 at end of rendering..."),this._stackDepthTest.length>0&&this.logStackError("depthtest stack length !=0 at end of rendering..."),this._stackDepthWrite.length>0&&this.logStackError("depthwrite stack length !=0 at end of rendering..."),this._stackDepthFunc.length>0&&this.logStackError("depthfunc stack length !=0 at end of rendering..."),this._stackBlend.length>0&&this.logStackError("blend stack length !=0 at end of rendering..."),this._stackBlendMode.length>0&&this.logStackError("blendMode stack length !=0 at end of rendering..."),this._shaderStack.length>0&&this.logStackError("this._shaderStack length !=0 at end of rendering..."),this._stackCullFace.length>0&&this.logStackError("this._stackCullFace length !=0 at end of rendering..."),this._stackCullFaceFacing.length>0&&this.logStackError("this._stackCullFaceFacing length !=0 at end of rendering..."),this._frameStarted=!1,n!=this.canvasWidth||o!=this.canvasHeight){n=this.canvasWidth,o=this.canvasHeight,this.setSize(this.canvasWidth/this.pixelDensity,this.canvasHeight/this.pixelDensity),this.updateSize();for(let t=0;t<r.length;t++)r[t]();this.emitEvent("resize")}this._cursor!=this._currentCursor&&(this._currentCursor=this.canvas.style.cursor=this._cursor),this.fpsCounter.endFrame()},this.logStackError=function(t){this._hadStackError||(this._hadStackError=!0,this._log.warn("["+this.canvas.id+"]: ",t))},this.getShader=function(){if(s&&(!this.frameStore||!0===this.frameStore.renderOffscreen==s.offScreenPass==!0))return s;for(let t=this._shaderStack.length-1;t>=0;t--)if(this._shaderStack[t]&&this.frameStore.renderOffscreen==this._shaderStack[t].offScreenPass)return this._shaderStack[t]},this.getDefaultShader=function(){return i},this.pushShader=this.setShader=function(t){this._shaderStack.push(t),s=t},this.popShader=this.setPreviousShader=function(){if(0===this._shaderStack.length)throw new Error("Invalid shader stack pop!");this._shaderStack.pop(),s=this._shaderStack[this._shaderStack.length-1]},this.pushGlFrameBuffer=function(t){this._glFrameBufferStack.push(t)},this.popGlFrameBuffer=function(){return 0==this._glFrameBufferStack.length?null:(this._glFrameBufferStack.pop(),this._glFrameBufferStack[this._glFrameBufferStack.length-1])},this.getCurrentGlFrameBuffer=function(){return 0===this._glFrameBufferStack.length?null:this._glFrameBufferStack[this._glFrameBufferStack.length-1]},this.pushFrameBuffer=function(t){this._frameBufferStack.push(t)},this.popFrameBuffer=function(){return 0==this._frameBufferStack.length?null:(this._frameBufferStack.pop(),this._frameBufferStack[this._frameBufferStack.length-1])},this.getCurrentFrameBuffer=function(){return 0===this._frameBufferStack.length?null:this._frameBufferStack[this._frameBufferStack.length-1]},this.renderStart=function(t,e,s){this.fpsCounter.startFrame(),this.pushDepthTest(!0),this.pushDepthWrite(!0),this.pushDepthFunc(t.gl.LEQUAL),this.pushCullFaceFacing(t.gl.BACK),this.pushCullFace(!1),this.clearCanvasTransparent&&(t.gl.clearColor(0,0,0,0),t.gl.clear(t.gl.COLOR_BUFFER_BIT)),this.clearCanvasDepth&&t.gl.clear(t.gl.DEPTH_BUFFER_BIT),t.setViewPort(0,0,t.canvasWidth,t.canvasHeight),this._startMatrixStacks(e,s),t.pushBlendMode(at.BLEND_MODES.BLEND_NORMAL,!1);for(let t=0;t<this._textureslots.length;t++)this._textureslots[t]=null;if(this.pushShader(i),this._frameStarted=!0,this._onetimeCallbacks.length>0){for(let t=0;t<this._onetimeCallbacks.length;t++)this._onetimeCallbacks[t]();this._onetimeCallbacks.length=0}this.emitEvent("beginFrame")},this.renderEnd=function(t){this._endMatrixStacks(),this.popDepthTest(),this.popDepthWrite(),this.popDepthFunc(),this.popCullFaceFacing(),this.popCullFace(),this.popBlend(),this.popBlendMode(),t.endFrame(),this.emitEvent("endFrame")},this.getTexture=function(t){return this._textureslots[t]},this.checkFrameStarted=function(t){this._frameStarted||(this._log.warn("frame not started "+t),this.patch.printTriggerStack())},this.setTexture=function(t,e,i){return this.checkFrameStarted("cgl setTexture"),null===e&&(e=CGL.Texture.getEmptyTexture(this).tex),this._textureslots[t]!=e&&(this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(i||this.gl.TEXTURE_2D,e),this._textureslots[t]=e),!0},this.fullScreen=function(){this.canvas.requestFullscreen?this.canvas.requestFullscreen():this.canvas.mozRequestFullScreen?this.canvas.mozRequestFullScreen():this.canvas.webkitRequestFullscreen?this.canvas.webkitRequestFullscreen():this.canvas.msRequestFullscreen&&this.canvas.msRequestFullscreen()},this.printError=function(t){if(!this.checkGlErrors)return;let e=!1,i=this.gl.getError();if(i!=this.gl.NO_ERROR){let s="";i==this.gl.OUT_OF_MEMORY&&(s="OUT_OF_MEMORY"),i==this.gl.INVALID_ENUM&&(s="INVALID_ENUM"),i==this.gl.INVALID_OPERATION&&(s="INVALID_OPERATION"),i==this.gl.INVALID_FRAMEBUFFER_OPERATION&&(s="INVALID_FRAMEBUFFER_OPERATION"),i==this.gl.INVALID_VALUE&&(s="INVALID_VALUE"),i==this.gl.CONTEXT_LOST_WEBGL&&(this.aborted=!0,s="CONTEXT_LOST_WEBGL"),i==this.gl.NO_ERROR&&(s="NO_ERROR"),e=!0,this._log.warn("gl error ["+this.canvas.id+"]: ",t,i,s),-1==this.canvas.id.indexOf("glGuiCanvas")&&(this._loggedGlError||(this.patch.printTriggerStack(),this._log.stack("glerror"),this._loggedGlError=!0))}return i=this.gl.getError(),e},this.saveScreenshot=function(t,e,i,s,r){this.patch.renderOneFrame();let n=this.canvas.clientWidth,o=this.canvas.clientHeight;function a(t,e,i){return Array(e-String(t).length+1).join(i||"0")+t}i&&(this.canvas.width=i,n=i),s&&(this.canvas.height=s,o=s);const h=new Date,l="".concat(String(h.getFullYear())+String(h.getMonth()+1)+String(h.getDate()),"_").concat(a(h.getHours(),2)).concat(a(h.getMinutes(),2)).concat(a(h.getSeconds(),2));t?t+=".png":t="cables_"+l+".png",this.patch.cgl.screenShot(function(i){if(this.canvas.width=n,this.canvas.height=o,i){const s=document.createElement("a");s.download=t,s.href=URL.createObjectURL(i),setTimeout((function(){s.click(),e&&e(i)}),100)}else this._log.log("screenshot: no blob")}.bind(this),r)}};Bt.prototype.addNextFrameOnceCallback=function(t){t&&this._onetimeCallbacks.push(t)},Bt.prototype._stackDepthTest=[],Bt.prototype.pushDepthTest=function(t){this._stackDepthTest.push(t),t?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST)},Bt.prototype.stateDepthTest=function(){return this._stackDepthTest[this._stackDepthTest.length-1]},Bt.prototype.popDepthTest=function(){this._stackDepthTest.pop(),this._stackDepthTest[this._stackDepthTest.length-1]?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST)},Bt.prototype._stackDepthWrite=[],Bt.prototype.pushDepthWrite=function(t){t=t||!1,this._stackDepthWrite.push(t),this.gl.depthMask(t)},Bt.prototype.stateDepthWrite=function(){return this._stackDepthWrite[this._stackDepthWrite.length-1]},Bt.prototype.popDepthWrite=function(){this._stackDepthWrite.pop(),this.gl.depthMask(this._stackDepthWrite[this._stackDepthWrite.length-1]||!1)},Bt.prototype._stackCullFace=[],Bt.prototype.pushCullFace=function(t){this._stackCullFace.push(t),t?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE)},Bt.prototype.stateCullFace=function(){return this._stackCullFace[this._stackCullFace.length-1]},Bt.prototype.popCullFace=function(){this._stackCullFace.pop(),this._stackCullFace[this._stackCullFace.length-1]?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE)},Bt.prototype._stackCullFaceFacing=[],Bt.prototype.pushCullFaceFacing=function(t){this._stackCullFaceFacing.push(t),this.gl.cullFace(this._stackCullFaceFacing[this._stackCullFaceFacing.length-1])},Bt.prototype.stateCullFaceFacing=function(){return this._stackCullFaceFacing[this._stackCullFaceFacing.length-1]},Bt.prototype.popCullFaceFacing=function(){this._stackCullFaceFacing.pop(),this._stackCullFaceFacing.length>0&&this.gl.cullFace(this._stackCullFaceFacing[this._stackCullFaceFacing.length-1])},Bt.prototype._stackDepthFunc=[],Bt.prototype.pushDepthFunc=function(t){this._stackDepthFunc.push(t),this.gl.depthFunc(t)},Bt.prototype.stateDepthFunc=function(){return this._stackDepthFunc.length>0&&this._stackDepthFunc[this._stackDepthFunc.length-1]},Bt.prototype.popDepthFunc=function(){this._stackDepthFunc.pop(),this._stackDepthFunc.length>0&&this.gl.depthFunc(this._stackDepthFunc[this._stackDepthFunc.length-1])},Bt.prototype._stackBlend=[],Bt.prototype.pushBlend=function(t){this._stackBlend.push(t),t?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND)},Bt.prototype.popBlend=function(){this._stackBlend.pop(),this._stackBlend[this._stackBlend.length-1]?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND)},Bt.prototype.stateBlend=function(){return this._stackBlend[this._stackBlend.length-1]};Bt.prototype._stackBlendMode=[],Bt.prototype._stackBlendModePremul=[],Bt.prototype.pushBlendMode=function(t,e){this._stackBlendMode.push(t),this._stackBlendModePremul.push(e);const i=this._stackBlendMode.length-1;this.pushBlend(this._stackBlendMode[i]!==at.BLEND_MODES.BLEND_NONE),this._setBlendMode(this._stackBlendMode[i],this._stackBlendModePremul[i])},Bt.prototype.popBlendMode=function(){this._stackBlendMode.pop(),this._stackBlendModePremul.pop();const t=this._stackBlendMode.length-1;this.popBlend(this._stackBlendMode[t]!==at.BLEND_MODES.BLEND_NONE),t>=0&&this._setBlendMode(this._stackBlendMode[t],this._stackBlendModePremul[t])},Bt.prototype._stackStencil=[],Bt.prototype.pushStencil=function(t){this._stackStencil.push(t),t?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST)},Bt.prototype.popStencil=function(){this._stackStencil.pop(),this._stackStencil[this._stackStencil.length-1]?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST)},Bt.prototype.glGetAttribLocation=function(t,e){return this.gl.getAttribLocation(t,e)},Bt.prototype.shouldDrawHelpers=function(t){if(this.frameStore.shadowPass)return!1;if(!t.patch.isEditorMode())return!1;const e=this.getCurrentFrameBuffer();if(e&&e.getWidth){if(!(this.canvasWidth/this.canvasHeight==e.getWidth()/e.getHeight()))return!1}return CABLES.UI.renderHelper||CABLES.UI.renderHelperCurrent&&t.isCurrentUiOp()},Bt.prototype._setBlendMode=function(t,e){const i=this.gl;t==at.BLEND_MODES.BLEND_NONE||(t==at.BLEND_MODES.BLEND_ADD?e?(i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.ONE,i.ONE,i.ONE,i.ONE)):(i.blendEquation(i.FUNC_ADD),i.blendFunc(i.SRC_ALPHA,i.ONE)):t==at.BLEND_MODES.BLEND_SUB?e?(i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.ZERO,i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ONE_MINUS_SRC_ALPHA)):(i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ZERO,i.ONE_MINUS_SRC_COLOR)):t==at.BLEND_MODES.BLEND_MUL?e?(i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA)):(i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ZERO,i.SRC_COLOR)):t==at.BLEND_MODES.BLEND_NORMAL?e?(i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA)):(i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA)):this._log.log("setblendmode: unknown blendmode"))},Bt.prototype.createMesh=function(t,e){return new CGL.Mesh(this,t,e)},Bt.prototype.setCursor=function(t){this._cursor=t};const Lt=Object.assign({Framebuffer:function(t,e,i,s){const r=t;this._log=new a("Framebuffer");const n=r.gl.getExtension("WEBGL_depth_texture")||r.gl.getExtension("WEBKIT_WEBGL_depth_texture")||r.gl.getExtension("MOZ_WEBGL_depth_texture")||r.gl.DEPTH_TEXTURE;n||r.exitError("NO_DEPTH_TEXTURE","no depth texture support");let o=e||512,h=i||512;(s=s||{isFloatingPointTexture:!1}).hasOwnProperty("clear")||(s.clear=!0),s.hasOwnProperty("filter")||(s.filter=B.FILTER_LINEAR);const l=new B(r,{isFloatingPointTexture:s.isFloatingPointTexture,filter:s.filter,wrap:s.wrap||B.CLAMP_TO_EDGE});let c=null;n&&(c=new B(r,{isDepthTexture:!0})),this._options=s;const u=r.gl.createFramebuffer(),g=r.gl.createRenderbuffer();this.getWidth=function(){return o},this.getHeight=function(){return h},this.getGlFrameBuffer=function(){return u},this.getDepthRenderBuffer=function(){return g},this.getTextureColor=function(){return l},this.getTextureDepth=function(){return c},this.setFilter=function(t){l.filter=t,l.setSize(o,h)},this.setSize=function(t,e){if(t<2&&(t=2),e<2&&(e=2),o=Math.ceil(t),h=Math.ceil(e),r.profileData.profileFrameBuffercreate++,r.gl.bindFramebuffer(r.gl.FRAMEBUFFER,u),r.gl.bindRenderbuffer(r.gl.RENDERBUFFER,g),l.setSize(o,h),c&&c.setSize(o,h),n&&r.gl.renderbufferStorage(r.gl.RENDERBUFFER,r.gl.DEPTH_COMPONENT16,o,h),r.gl.framebufferTexture2D(r.gl.FRAMEBUFFER,r.gl.COLOR_ATTACHMENT0,r.gl.TEXTURE_2D,l.tex,0),n&&(r.gl.framebufferRenderbuffer(r.gl.FRAMEBUFFER,r.gl.DEPTH_ATTACHMENT,r.gl.RENDERBUFFER,g),r.gl.framebufferTexture2D(r.gl.FRAMEBUFFER,r.gl.DEPTH_ATTACHMENT,r.gl.TEXTURE_2D,c.tex,0)),!r.gl.isFramebuffer(u))throw new Error("Invalid framebuffer");const i=r.gl.checkFramebufferStatus(r.gl.FRAMEBUFFER);switch(i){case r.gl.FRAMEBUFFER_COMPLETE:break;case r.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw this._log.warn("FRAMEBUFFER_INCOMPLETE_ATTACHMENT...",o,h,l.tex,g),new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");case r.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw this._log.warn("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT"),new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");case r.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw this._log.warn("FRAMEBUFFER_INCOMPLETE_DIMENSIONS"),new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");case r.gl.FRAMEBUFFER_UNSUPPORTED:throw this._log.warn("FRAMEBUFFER_UNSUPPORTED"),new Error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");case 36059:this._log.warn("Incomplete: FRAMEBUFFER_INCOMPLETE_DRAW_BUFFER from ext. Or Safari/iOS undefined behaviour.");break;default:throw this._log.warn("incomplete framebuffer",i),new Error("Incomplete framebuffer: "+i)}r.gl.bindTexture(r.gl.TEXTURE_2D,null),r.gl.bindRenderbuffer(r.gl.RENDERBUFFER,null),r.gl.bindFramebuffer(r.gl.FRAMEBUFFER,null)},this.renderStart=function(){r.pushModelMatrix(),r.gl.bindFramebuffer(r.gl.FRAMEBUFFER,u),r.pushGlFrameBuffer(u),r.pushFrameBuffer(this),r.pushPMatrix(),r.gl.viewport(0,0,o,h),this._options.clear&&(r.gl.clearColor(0,0,0,0),r.gl.clear(r.gl.COLOR_BUFFER_BIT|r.gl.DEPTH_BUFFER_BIT))},this.renderEnd=function(){r.popPMatrix(),r.gl.bindFramebuffer(r.gl.FRAMEBUFFER,r.popGlFrameBuffer()),r.popFrameBuffer(),r.popModelMatrix(),r.resetViewPort()},this.delete=function(){l.delete(),c&&c.delete(),r.gl.deleteRenderbuffer(g),r.gl.deleteFramebuffer(u)},this.setSize(o,h)},Framebuffer2:L,Geometry:W,BoundingBox:z,Marker:function(t){const e=new W("marker");e.setPointVertices([1e-5,0,0,1,0,0,0,1e-5,0,0,1,0,0,0,1e-5,0,0,1]);const i=new lt(t,e,t.gl.LINES);i.setGeom(e);const s=new It(t,"markermaterial"),r="".endl()+"precision highp float;".endl()+"IN vec3 axisColor;".endl()+"void main()".endl()+"{".endl()+"    vec4 col=vec4(axisColor,1.0);".endl()+"    outColor = col;".endl()+"}",n="".endl()+"IN vec3 vPosition;".endl()+"UNI mat4 projMatrix;".endl()+"UNI mat4 mvMatrix;".endl()+"OUT vec3 axisColor;".endl()+"void main()".endl()+"{".endl()+"   vec4 pos=vec4(vPosition, 1.0);".endl()+"   if(pos.x!=0.0)axisColor=vec3(1.0,0.3,0.0);".endl()+"   if(pos.y!=0.0)axisColor=vec3(0.0,1.0,0.2);".endl()+"   if(pos.z!=0.0)axisColor=vec3(0.0,0.5,1.0);".endl()+"   gl_Position = projMatrix * mvMatrix * pos;".endl()+"}";s.setSource(n,r),this._vScale=vec3.create(),this.draw=function(t,e,r){const n=e||2;t.pushModelMatrix(),t.pushShader(s),vec3.set(this._vScale,n,n,n),mat4.scale(t.mvMatrix,t.mvMatrix,this._vScale),t.pushDepthTest(1==r),i.render(t.getShader()),t.popDepthTest(),t.popShader(),t.popModelMatrix()}},WirePoint:function(t){const e=t.gl.createBuffer(),i=vec3.create();this.render=function(t,s){t.pushModelMatrix(),vec3.set(i,s,s,s),mat4.scale(t.mvMatrix,t.mvMatrix,i);const r=t.getShader();r&&(r.bind(),t.gl.bindBuffer(t.gl.ARRAY_BUFFER,e),t.gl.vertexAttribPointer(r.getAttrVertexPos(),e.itemSize,t.gl.FLOAT,!1,0,0),t.gl.enableVertexAttribArray(r.getAttrVertexPos()),t.gl.bindBuffer(t.gl.ARRAY_BUFFER,e),t.gl.drawArrays(t.gl.LINE_STRIP,0,e.numItems)),t.popModelMatrix()},function(){const i=[];let s=0,r=0;for(s=0;s<=Math.round(24);s++)r=360/Math.round(24)*s*mt,i.push(.5*Math.cos(r)),i.push(0),i.push(.5*Math.sin(r));for(s=0;s<=Math.round(24);s++)r=360/Math.round(24)*s*mt,i.push(.5*Math.cos(r)),i.push(.5*Math.sin(r)),i.push(0);for(s=0;s<=Math.round(24);s++)r=360/Math.round(24)*s*mt,i.push(0),i.push(.5*Math.cos(r)),i.push(.5*Math.sin(r));t.gl.bindBuffer(t.gl.ARRAY_BUFFER,e),t.gl.bufferData(t.gl.ARRAY_BUFFER,new Float32Array(i),t.gl.STATIC_DRAW),e.itemSize=3,e.numItems=i.length/e.itemSize}()},WireCube:function(t){const e=t.gl.createBuffer(),i=vec3.create();this.render=function(t,s,r,n){t.pushModelMatrix(),vec3.set(i,s||1,r||1,n||1),mat4.scale(t.mvMatrix,t.mvMatrix,i);const o=t.getShader();o&&(o.bind(),t.gl.bindBuffer(t.gl.ARRAY_BUFFER,e),t.gl.vertexAttribPointer(o.getAttrVertexPos(),e.itemSize,t.gl.FLOAT,!1,0,0),t.gl.enableVertexAttribArray(o.getAttrVertexPos()),t.gl.bindBuffer(t.gl.ARRAY_BUFFER,e),t.gl.drawArrays(t.gl.LINE_STRIP,0,e.numItems)),t.popModelMatrix()},function(){const i=[];i.push(-1,-1,1),i.push(1,-1,1),i.push(1,1,1),i.push(-1,1,1),i.push(-1,-1,1),i.push(-1,-1,-1),i.push(1,-1,-1),i.push(1,1,-1),i.push(-1,1,-1),i.push(-1,-1,-1),i.push(-1,-1,-1),i.push(-1,1,-1),i.push(-1,1,1),i.push(-1,-1,1),i.push(-1,-1,-1),i.push(1,-1,-1),i.push(1,1,-1),i.push(1,1,1),i.push(1,-1,1),i.push(1,-1,-1),t.gl.bindBuffer(t.gl.ARRAY_BUFFER,e),t.gl.bufferData(t.gl.ARRAY_BUFFER,new Float32Array(i),t.gl.STATIC_DRAW),e.itemSize=3,e.numItems=i.length/e.itemSize}()},MatrixStack:Mt,Mesh:lt,MESH:ht,ShaderLibMods:pt,Shader:It,Uniform:nt,MESHES:ut,Context:Bt,Texture:B,TextureEffect:gt,isWindows:Et,getWheelSpeed:At,getWheelDelta:bt,onLoadingAssetsFinished:null,ProfileData:St,UniColorShader:class{constructor(t){this.shader=new CGL.Shader(t,"markermaterial");const e="".endl()+"void main()".endl()+"{".endl()+"    outColor = vec4(color.rgb,1.0);".endl()+"}",i="".endl()+"IN vec3 vPosition;".endl()+"UNI mat4 projMatrix;".endl()+"UNI mat4 mvMatrix;".endl()+"void main()".endl()+"{".endl()+"   gl_Position = projMatrix * mvMatrix * vec4(vPosition,1.0);".endl()+"}";this.shader.setSource(i,e),this.coloruni=this.shader.addUniformFrag("4f","color",[1,.777,1,1])}setColor(t,e,i,s){this.coloruni.set(t,e,i,s)}}},at.BLEND_MODES,at.SHADER,at.MATH,at.BLEND_MODES);window.CGL=Lt;const kt=function(t){Y.apply(this),this.id=CABLES.uuid(),this.portIn=null,this.portOut=null,this.scene=t,this.activityCounter=0,this.ignoreInSerialize=!1};kt.prototype.setValue=function(t){void 0===t?this._setValue():this.portIn.set(t)},kt.prototype.activity=function(){this.activityCounter++},kt.prototype._setValue=function(){if(!this.portOut)return void this.remove();const t=this.portOut.get();t==t&&(this.portIn.type!=l.OP_PORT_TYPE_FUNCTION&&this.activity(),(this.portIn.get()!==t||this.portIn.changeAlways)&&this.portIn.set(t))},kt.prototype.getOtherPort=function(t){return t==this.portIn?this.portOut:this.portIn},kt.prototype.remove=function(){this.portIn&&this.portIn.removeLink(this),this.portOut&&this.portOut.removeLink(this),this.scene&&this.scene.emitEvent("onUnLink",this.portIn,this.portOut,this),!this.portIn||this.portIn.type!=l.OP_PORT_TYPE_OBJECT&&this.portIn.type!=l.OP_PORT_TYPE_ARRAY||(this.portIn.set(null),this.portIn.links.length>0&&this.portIn.set(this.portIn.links[0].getOtherPort(this.portIn).get())),this.portIn&&this.portIn.parent._checkLinksNeededToWork(),this.portOut&&this.portOut.parent._checkLinksNeededToWork(),this.portIn=null,this.portOut=null,this.scene=null},kt.prototype.link=function(t,e){if(!kt.canLink(t,e))return console.warn("[core_link] cannot link ports!",t,e),!1;t.direction==c.PORT_DIR_IN?(this.portIn=t,this.portOut=e):(this.portIn=e,this.portOut=t),t.addLink(this),e.addLink(this),this.setValue(),t.onLink&&t.onLink(this),e.onLink&&e.onLink(this),t.parent._checkLinksNeededToWork(),e.parent._checkLinksNeededToWork()},kt.prototype.getSerialized=function(){const t={};return t.portIn=this.portIn.getName(),t.portOut=this.portOut.getName(),t.objIn=this.portIn.parent.id,t.objOut=this.portOut.parent.id,t},kt.canLinkText=function(t,e){if(t.direction==e.direction){let t="(out)";return e.direction==c.PORT_DIR_IN&&(t="(in)"),"can not link: same direction "+t}return t.parent==e.parent?"can not link: same op":t.type!=l.OP_PORT_TYPE_DYNAMIC&&e.type!=l.OP_PORT_TYPE_DYNAMIC&&t.type!=e.type?"can not link: different type":t?e?t.direction==c.PORT_DIR_IN&&t.isAnimated()||e.direction==c.PORT_DIR_IN&&e.isAnimated()?"can not link: is animated":t.isLinkedTo(e)?"ports already linked":t.canLink&&!t.canLink(e)||e.canLink&&!e.canLink(t)?"Incompatible":"can link":"can not link: port 2 invalid":"can not link: port 1 invalid"},kt.canLink=function(t,e){return!!t&&(!!e&&((t.direction!=c.PORT_DIR_IN||!t.isAnimated())&&((e.direction!=c.PORT_DIR_IN||!e.isAnimated())&&(!t.isHidden()&&!e.isHidden()&&(!t.isLinkedTo(e)&&(t.direction!=e.direction&&((t.type==e.type||t.type==l.OP_PORT_TYPE_DYNAMIC||e.type==l.OP_PORT_TYPE_DYNAMIC)&&(t.type==l.OP_PORT_TYPE_DYNAMIC||e.type==l.OP_PORT_TYPE_DYNAMIC||t.parent!=e.parent&&(!(t.canLink&&!t.canLink(e))&&!(e.canLink&&!e.canLink(t)))))))))))};const Vt=function(){Y.apply(this),this._log=new a("core_op"),this.data={},this.storage={},this.objName="",this.portsOut=[],this.portsIn=[],this.portsInData=[],this.opId="",this.uiAttribs={},this.enabled=!0,this.patch=arguments[0],this.name=arguments[1],this._needsLinkedToWork=[],this._needsParentOp=null,this._shortOpName="",this.hasUiErrors=!1,this._uiErrors={},arguments[1]&&(this._shortOpName=CABLES.getShortOpName(arguments[1]),this.getTitle()),this.id=arguments[2]||T(),this.onAddPort=null,this.onCreate=null,this.onResize=null,this.onLoaded=null,this.onDelete=null,this.onUiAttrChange=null,this.onError=null,this._instances=null,this.preRender=null,this.init=null};{Vt.prototype.clearUiAttrib=function(t){const e={name:null};this.uiAttrib(e)},Vt.prototype.getTitle=function(){return this.uiAttribs?(void 0!==this.uiAttribs.title&&""!==this.uiAttribs.title||-1!=this.objName.indexOf("Ops.Ui.")||(this.uiAttribs.title=this._shortOpName),void 0===this.uiAttribs.title&&(this.uiAttribs.title=this._shortOpName),this.uiAttribs.title):"nouiattribs"+this.name},Vt.prototype.setTitle=function(t){const e=this.name!=t;this.name=t,this.uiAttr({title:t}),e&&this.emitEvent("onTitleChange",t)};const t=function(t){if(!t)return;(t.error||t.warning||t.hint)&&this._log.warn("old ui error/warning attribute in "+this.name+", use op.setUiError !",t),"object"!=typeof t&&this._log.error("op.uiAttrib attribs are not of type object"),this.uiAttribs||(this.uiAttribs={});let e=!1;for(const i in t)this.uiAttribs[i]!=t[i]&&(e=!0),this.uiAttribs[i]=t[i];this.uiAttribs.hasOwnProperty("selected")&&0==this.uiAttribs.selected&&delete this.uiAttribs.selected,t.title&&t.title!=this.name&&this.setTitle(t.title),e&&(this.emitEvent("onUiAttribsChange",t),this.patch.emitEvent("onUiAttribsChange",this,t))};Vt.prototype.setUiAttribs=Vt.prototype.setUiAttrib=Vt.prototype.uiAttr=t,Vt.prototype.getName=function(){return this.uiAttribs.name?this.uiAttribs.name:this.objName.split(".")},Vt.prototype.addOutPort=function(t){return t.direction=c.PORT_DIR_OUT,t.parent=this,this.portsOut.push(t),this.emitEvent("onPortAdd",t),t},Vt.prototype.hasDynamicPort=function(){let t=0;for(t=0;t<this.portsIn.length;t++){if(this.portsIn[t].type==l.OP_PORT_TYPE_DYNAMIC)return!0;if("dyn"==this.portsIn[t].getName())return!0}for(t=0;t<this.portsOut.length;t++){if(this.portsOut[t].type==l.OP_PORT_TYPE_DYNAMIC)return!0;if("dyn"==this.portsOut[t].getName())return!0}return!1},Vt.prototype.addInPort=function(t){if(!(t instanceof et))throw new Error("parameter is not a port!");return t.direction=c.PORT_DIR_IN,t.parent=this,this.portsIn.push(t),this.emitEvent("onPortAdd",t),t},Vt.prototype.inFunction=Vt.prototype.inTrigger=function(t,e){const i=this.addInPort(new et(this,t,l.OP_PORT_TYPE_FUNCTION));return void 0!==e&&i.set(e),i},Vt.prototype.inFunctionButton=Vt.prototype.inTriggerButton=function(t,e){const i=this.addInPort(new et(this,t,l.OP_PORT_TYPE_FUNCTION,{display:"button"}));return void 0!==e&&i.set(e),i},Vt.prototype.inFunctionButton=Vt.prototype.inUiTriggerButtons=function(t,e){const i=this.addInPort(new et(this,t,l.OP_PORT_TYPE_FUNCTION,{display:"buttons"}));return void 0!==e&&i.set(e),i},Vt.prototype.inValueFloat=Vt.prototype.inValue=Vt.prototype.inFloat=function(t,e){const i=this.addInPort(new et(this,t,l.OP_PORT_TYPE_VALUE));return void 0!==e&&(i.set(e),i.defaultValue=e),i},Vt.prototype.inValueBool=Vt.prototype.inBool=function(t,e){const i=this.addInPort(new et(this,t,l.OP_PORT_TYPE_VALUE,{display:"bool"}));return void 0!==e&&(i.set(e),i.defaultValue=i.get()),i},Vt.prototype.inValueString=function(t,e){const i=this.addInPort(new et(this,t,l.OP_PORT_TYPE_VALUE,{type:"string"}));return i.value="",void 0!==e&&(i.set(e),i.defaultValue=e),i},Vt.prototype.inString=function(t,e){const i=this.addInPort(new et(this,t,l.OP_PORT_TYPE_STRING,{type:"string"}));return e=e||"",i.value=e,i.set(e),i.defaultValue=e,i},Vt.prototype.inValueText=function(t,e){const i=this.addInPort(new et(this,t,l.OP_PORT_TYPE_VALUE,{type:"string",display:"text"}));return i.value="",void 0!==e&&(i.set(e),i.defaultValue=e),i},Vt.prototype.inTextarea=function(t,e){const i=this.addInPort(new et(this,t,l.OP_PORT_TYPE_STRING,{type:"string",display:"text"}));return i.value="",void 0!==e&&(i.set(e),i.defaultValue=e),i},Vt.prototype.inStringEditor=function(t,e,i,s=!0){const r=this.addInPort(new et(this,t,l.OP_PORT_TYPE_STRING,{type:"string",display:"editor",editorSyntax:i,hideFormatButton:s}));return r.value="",void 0!==e&&(r.set(e),r.defaultValue=e),r},Vt.prototype.inValueEditor=function(t,e,i,s=!0){const r=this.addInPort(new et(this,t,l.OP_PORT_TYPE_VALUE,{type:"string",display:"editor",editorSyntax:i,hideFormatButton:s}));return r.value="",void 0!==e&&(r.set(e),r.defaultValue=e),r},Vt.prototype.inValueSelect=Vt.prototype.inDropDown=function(t,e,i,s){let r=null;if(s){const i=new et(this,t,l.OP_PORT_TYPE_VALUE,{display:"dropdown",hidePort:!0,type:"string",values:e});r=this.addInPort(i)}else{const s=new et(this,t+" index",l.OP_PORT_TYPE_VALUE,{increment:"integer",hideParam:!0}),n=this.addInPort(s),o=new st(this,t,l.OP_PORT_TYPE_VALUE,{display:"dropdown",hidePort:!0,type:"string",values:e},n);if(o.indexPort=s,s.onLinkChanged=function(){o.setUiAttribs({greyout:s.isLinked()})},r=this.addInPort(o),void 0!==i){r.set(i);const t=e.findIndex(t=>t==i);n.setValue(t),r.defaultValue=i,n.defaultValue=t}}return r},Vt.prototype.inSwitch=function(t,e,i,s){let r=null;if(s){const i=new et(this,t,l.OP_PORT_TYPE_STRING,{display:"switch",hidePort:!0,type:"string",values:e});r=this.addInPort(i)}else{const s=new et(this,t+" index",l.OP_PORT_TYPE_VALUE,{increment:"integer",hideParam:!0}),n=this.addInPort(s),o=new it(this,t,l.OP_PORT_TYPE_STRING,{display:"switch",hidePort:!0,type:"string",values:e},n);if(s.onLinkChanged=function(){o.setUiAttribs({greyout:s.isLinked()})},r=this.addInPort(o),void 0!==i){r.set(i);const t=e.findIndex(t=>t==i);n.setValue(t),r.defaultValue=i,n.defaultValue=t}}return r},Vt.prototype.inValueInt=Vt.prototype.inInt=function(t,e){const i=this.addInPort(new et(this,t,l.OP_PORT_TYPE_VALUE,{increment:"integer"}));return void 0!==e&&(i.set(e),i.defaultValue=e),i},Vt.prototype.inFile=function(t,e,i){const s=this.addInPort(new et(this,t,l.OP_PORT_TYPE_VALUE,{display:"file",type:"string",filter:e}));return void 0!==i&&(s.set(i),s.defaultValue=i),s},Vt.prototype.inUrl=function(t,e,i){const s=this.addInPort(new et(this,t,l.OP_PORT_TYPE_STRING,{display:"file",type:"string",filter:e}));return void 0!==i&&(s.set(i),s.defaultValue=i),s},Vt.prototype.inTexture=function(t,e){const i=this.addInPort(new et(this,t,l.OP_PORT_TYPE_OBJECT,{display:"texture",objType:"texture",preview:!0}));return void 0!==e&&i.set(e),i},Vt.prototype.inObject=function(t,e,i){const s=this.addInPort(new et(this,t,l.OP_PORT_TYPE_OBJECT,{objType:i}));return void 0!==e&&s.set(e),s},Vt.prototype.inGradient=function(t,e){const i=this.addInPort(new et(this,t,l.OP_PORT_TYPE_VALUE,{display:"gradient",hidePort:!0}));return void 0!==e&&i.set(e),i},Vt.prototype.inArray=function(t,e,i){!i&&CABLES.UTILS.isNumeric(e)&&(i=e);const s=this.addInPort(new et(this,t,l.OP_PORT_TYPE_ARRAY,{stride:i}));return void 0===e||!Array.isArray(e)&&null!=e||s.set(e),s},Vt.prototype.inValueSlider=Vt.prototype.inFloatSlider=function(t,e,i,s){const r={display:"range"};null!=i&&null!=s&&(r.min=i,r.max=s);const n=this.addInPort(new et(this,t,l.OP_PORT_TYPE_VALUE,r));return void 0!==e&&(n.set(e),n.defaultValue=e),n},Vt.prototype.outFunction=Vt.prototype.outTrigger=function(t,e){const i=this.addOutPort(new et(this,t,l.OP_PORT_TYPE_FUNCTION));return void 0!==e&&i.set(e),i},Vt.prototype.outValue=Vt.prototype.outNumber=function(t,e){const i=this.addOutPort(new et(this,t,l.OP_PORT_TYPE_VALUE));return void 0!==e&&i.set(e),i},Vt.prototype.outValueBool=Vt.prototype.outBool=function(t,e){const i=this.addOutPort(new et(this,t,l.OP_PORT_TYPE_VALUE,{display:"bool"}));return void 0!==e?i.set(e):i.set(0),i},Vt.prototype.outBoolNum=function(t,e){const i=this.addOutPort(new et(this,t,l.OP_PORT_TYPE_VALUE,{display:"boolnum"}));return i.set=function(t){this.setValue(t?1:0)}.bind(i),void 0!==e?i.set(e):i.set(0),i},Vt.prototype.outValueString=function(t,e){const i=this.addOutPort(new et(this,t,l.OP_PORT_TYPE_VALUE,{type:"string"}));return void 0!==e&&i.set(e),i},Vt.prototype.outString=function(t,e){const i=this.addOutPort(new et(this,t,l.OP_PORT_TYPE_STRING,{type:"string"}));return void 0!==e?i.set(e):i.set(""),i},Vt.prototype.outObject=function(t,e,i){const s=this.addOutPort(new et(this,t,l.OP_PORT_TYPE_OBJECT,{objType:i||null}));return s.set(e||null),s.ignoreValueSerialize=!0,s},Vt.prototype.outArray=function(t,e,i){!i&&CABLES.UTILS.isNumeric(e)&&(i=e);const s=this.addOutPort(new et(this,t,l.OP_PORT_TYPE_ARRAY,{stride:i}));return void 0===e||!Array.isArray(e)&&null!=e||s.set(e),s.ignoreValueSerialize=!0,s},Vt.prototype.outTexture=function(t,e){const i=this.addOutPort(new et(this,t,l.OP_PORT_TYPE_OBJECT,{preview:!0,objType:"texture"}));return void 0!==e&&i.set(e),i.ignoreValueSerialize=!0,i},Vt.prototype.inDynamic=function(t,e,i,s){const r=new et(this,t,l.OP_PORT_TYPE_DYNAMIC,i);return r.shouldLink=function(t,i){if(e&&g.isArray(e)){for(let s=0;s<e.length;s++){if(t==this&&i.type===e[s])return!0;if(i==this&&t.type===e[s])return!0}return!1}return!0},this.addInPort(r),void 0!==s&&(r.set(s),r.defaultValue=s),r},Vt.prototype.printInfo=function(){for(let t=0;t<this.portsIn.length;t++)console.log("in: "+this.portsIn[t].getName());for(const t in this.portsOut)console.log("out: "+this.portsOut[t].getName())},Vt.prototype.selectChilds=function(){this.setUiAttrib({selected:!0});for(const t in this.portsOut)for(const e in this.portsOut[t].links)this.portsOut[t].parent.setUiAttrib({selected:!0}),this.portsOut[t].links[e].portIn.parent!=this&&this.portsOut[t].links[e].portIn.parent.selectChilds()},Vt.prototype.removeLinks=function(){for(let t=0;t<this.portsIn.length;t++)this.portsIn[t].removeLinks();for(let t=0;t<this.portsOut.length;t++)this.portsOut[t].removeLinks()},Vt.prototype.getSerialized=function(){const t={};this.opId&&(t.opId=this.opId),t.objName=this.objName,t.id=this.id,t.uiAttribs=JSON.parse(JSON.stringify(this.uiAttribs)),this.storage&&Object.keys(this.storage).length>0&&(t.storage=this.storage),this.uiAttribs.hasOwnProperty("working")&&1==this.uiAttribs.working&&delete this.uiAttribs.working,t.portsIn=[],t.portsOut=[];for(let e=0;e<this.portsIn.length;e++)t.portsIn.push(this.portsIn[e].getSerialized());for(const e in this.portsOut)t.portsOut.push(this.portsOut[e].getSerialized());return t},Vt.prototype.getFirstOutPortByType=function(t){for(const e in this.portsOut)if(this.portsOut[e].type==t)return this.portsOut[e]},Vt.prototype.getFirstInPortByType=function(t){for(const e in this.portsIn)if(this.portsIn[e].type==t)return this.portsIn[e]},Vt.prototype.getPort=Vt.prototype.getPortByName=function(t,e){if(e){for(let e=0;e<this.portsIn.length;e++)if(this.portsIn[e].getName().toLowerCase()==t)return this.portsIn[e];for(let e=0;e<this.portsOut.length;e++)if(this.portsOut[e].getName().toLowerCase()==t)return this.portsOut[e]}else{for(let e=0;e<this.portsIn.length;e++)if(this.portsIn[e].getName()==t)return this.portsIn[e];for(let e=0;e<this.portsOut.length;e++)if(this.portsOut[e].getName()==t)return this.portsOut[e]}},Vt.prototype.getPortById=function(t){for(let e=0;e<this.portsIn.length;e++)if(this.portsIn[e].id==t)return this.portsIn[e];for(let e=0;e<this.portsOut.length;e++)if(this.portsOut[e].id==t)return this.portsOut[e]},Vt.prototype.updateAnims=function(){for(let t=0;t<this.portsIn.length;t++)this.portsIn[t].updateAnim()},Vt.prototype.log=function(){const t="op "+this.objName;if(CABLES.UI&&!CABLES.UI.logFilter.shouldPrint(t,...arguments))return;if(!CABLES.UI&&this.patch.silent)return;const e=["[op "+CABLES.getShortOpName(this.objName)+"]"];e.push.apply(e,arguments),Function.prototype.apply.apply(console.log,[console,e])},Vt.prototype.error=Vt.prototype.logError=function(){if(!this)return void console.log("no this...!!!");const t=["[op "+CABLES.getShortOpName(this.objName)+"]"];t.push.apply(t,arguments),Function.prototype.apply.apply(console.error,[console,t]),window.gui&&window.gui.emitEvent("opLogEvent",this.objName,"error",arguments)},Vt.prototype.warn=Vt.prototype.logWarn=function(){const t=["[op "+CABLES.getShortOpName(this.objName)+"]"];t.push.apply(t,arguments),Function.prototype.apply.apply(console.warn,[console,t])},Vt.prototype.verbose=Vt.prototype.logVerbose=function(){const t="op "+CABLES.getShortOpName(this.objName);if(CABLES.UI&&!CABLES.UI.logFilter.shouldPrint(t,...arguments))return;if(!CABLES.UI&&this.patch.silent)return;const e=["["+t+"]"];e.push.apply(e,arguments),Function.prototype.apply.apply(console.info,[console,e])},Vt.prototype.profile=function(t){for(let t=0;t<this.portsIn.length;t++)this.portsIn[t]._onTriggered=this.portsIn[t]._onTriggeredProfiling,this.portsIn[t].set=this.portsIn[t]._onSetProfiling},Vt.prototype.findParent=function(t){for(let e=0;e<this.portsIn.length;e++)if(this.portsIn[e].isLinked()){if(this.portsIn[e].links[0].portOut.parent.objName==t)return this.portsIn[e].links[0].portOut.parent;let i=null;if(i=this.portsIn[e].links[0].portOut.parent.findParent(t),i)return i}return null},Vt.prototype.cleanUp=function(){if(this._instances){for(let t=0;t<this._instances.length;t++)this._instances[t].onDelete&&this._instances[t].onDelete();this._instances.length=0}},Vt.prototype.instanced=function(t){if(console.log("instanced",this.patch.instancing.numCycles()),0===this.patch.instancing.numCycles())return!1;let e=0,i=0;if(!this._instances||this._instances.length!=this.patch.instancing.numCycles()){for(this._instances||(this._instances=[]),this._.log("creating instances of ",this.objName,this.patch.instancing.numCycles(),this._instances.length),this._instances.length=this.patch.instancing.numCycles(),e=0;e<this._instances.length;e++){this._instances[e]=this.patch.createOp(this.objName,!0),this._instances[e].instanced=function(){return!1},this._instances[e].uiAttr(this.uiAttribs);for(let t=0;t<this.portsOut.length;t++)this.portsOut[t].type==l.OP_PORT_TYPE_FUNCTION&&(this._instances[e].getPortByName(this.portsOut[t].name).trigger=this.portsOut[t].trigger.bind(this.portsOut[t]))}for(i=0;i<this.portsIn.length;i++)this.portsIn[i].onChange=null,this.portsIn[i].onValueChanged=null}for(i=0;i<this.portsIn.length;i++)this.portsIn[i].type!=l.OP_PORT_TYPE_VALUE&&this.portsIn[i].type!=l.OP_PORT_TYPE_ARRAY||this._instances[this.patch.instancing.index()].portsIn[i].set(this.portsIn[i].get()),this.portsIn[i].type,l.OP_PORT_TYPE_FUNCTION;for(i=0;i<this.portsOut.length;i++)this.portsOut[i].type==l.OP_PORT_TYPE_VALUE&&this.portsOut[i].set(this._instances[this.patch.instancing.index()].portsOut[i].get());return!0},Vt.prototype.initInstancable=function(){},Vt.prototype.setValues=function(t){for(const e in t){const i=this.getPortByName(e);i?i.set(t[e]):this._log.warn("op.setValues: port not found:",e)}},Vt.prototype.hasUiError=function(t){return this._uiErrors.hasOwnProperty(t)&&this._uiErrors[t]},Vt.prototype.setUiError=function(t,e,i){if(!e&&!this.hasUiErrors)return;if(!e&&!this._uiErrors.hasOwnProperty(t))return;if(this._uiErrors.hasOwnProperty(t)&&this._uiErrors[t].txt==e)return;t.indexOf(" ")>-1&&this._log.warn("setuierror id cant have spaces! ",t),!e&&this._uiErrors.hasOwnProperty(t)?delete this._uiErrors[t]:!e||this._uiErrors.hasOwnProperty(t)&&this._uiErrors[t].txt==e||(null==i&&(i=2),this._uiErrors[t]={txt:e,level:i,id:t});const s=[];for(const t in this._uiErrors)s.push(this._uiErrors[t]);this.uiAttr({uierrors:s}),this.hasUiErrors=Object.keys(this._uiErrors).length,this.emitEvent("uiErrorChange")},Vt.prototype.setError=function(t,e){this._log.warn("old error message op.error() - use op.setUiError()")},Vt.prototype.setEnabled=function(t){this.enabled=t,this.emitEvent("onEnabledChange",t)},Vt.prototype.setPortGroup=function(t,e){for(let i=0;i<e.length;i++)e[i]&&(e[i].setUiAttribs?e[i].setUiAttribs({group:t}):this._log.error("setPortGroup: invalid port!"))},Vt.prototype.setUiAxisPorts=function(t,e,i){t&&t.setUiAttribs({axis:"X"}),e&&e.setUiAttribs({axis:"Y"}),i&&i.setUiAttribs({axis:"Z"})},Vt.prototype.removePort=function(t){for(let e=0;e<this.portsIn.length;e++)if(this.portsIn[e]==t)return this.portsIn.splice(e,1),this.emitEvent("onUiAttribsChange",{}),void this.emitEvent("onPortRemoved",{})},Vt.prototype._checkLinksNeededToWork=function(){},Vt.prototype.toWorkNeedsParent=function(t){this.patch.isEditorMode()&&(this._needsParentOp=t)},Vt.prototype.toWorkPortsNeedToBeLinked=function(){if(this.patch.isEditorMode())for(let t=0;t<arguments.length;t++)-1==this._needsLinkedToWork.indexOf(arguments[t])&&this._needsLinkedToWork.push(arguments[t])},Vt.prototype.toWorkPortsNeedToBeLinkedReset=function(){this.patch.isEditorMode()&&(this._needsLinkedToWork.length=0,this.checkLinkTimeWarnings&&this.checkLinkTimeWarnings())},Vt.prototype.initVarPorts=function(){for(let t=0;t<this.portsIn.length;t++)this.portsIn[t].getVariableName()&&this.portsIn[t].setVariable(this.portsIn[t].getVariableName())},Vt.prototype.refreshParams=function(){this.patch&&this.patch.isEditorMode()&&this.isCurrentUiOp()&&gui.opParams.show(this)},Vt.prototype.isCurrentUiOp=function(){if(this.patch.isEditorMode())return gui.patchView.isCurrentOp(this)},Vt.prototype.renderVizLayer=null}Vt.isSubpatchOp=function(t){return"Ops.Ui.Patch"==t||"Ops.Ui.SubPatch"==t};const Dt=function(t){CABLES.EventTarget.apply(this),this._log=new a("LoadingStatus"),this._loadingAssets={},this._cbFinished=[],this._assetTasks=[],this._percent=0,this._count=0,this._countFinished=0,this._order=0,this._startTime=0,this._patch=t,this._wasFinishedPrinted=!1,this._loadingAssetTaskCb=!1};Dt.prototype.setOnFinishedLoading=function(t){this._cbFinished.push(t)},Dt.prototype.getNumAssets=function(){return this._countFinished},Dt.prototype.getProgress=function(){return this._percent},Dt.prototype.checkStatus=function(){this._countFinished=0,this._count=0;for(const t in this._loadingAssets)this._count++,this._loadingAssets[t].finished||this._countFinished++;if(this._percent=(this._count-this._countFinished)/this._count,0===this._countFinished){for(let t=0;t<this._cbFinished.length;t++)if(this._cbFinished[t]){const e=this._cbFinished[t];setTimeout(()=>{e(this._patch),this.emitEvent("finishedAll")},100)}this._wasFinishedPrinted||(this._wasFinishedPrinted=!0,this.print()),this.emitEvent("finishedAll")}},Dt.prototype.getList=function(){let t=[];for(const e in this._loadingAssets)t.push(this._loadingAssets[e]);return t},Dt.prototype.getListJobs=function(){let t=[];for(const e in this._loadingAssets)this._loadingAssets[e].finished||t.push(this._loadingAssets[e].name);return t},Dt.prototype.print=function(){if(this._patch.config.silent)return;const t=[];for(const e in this._loadingAssets)t.push([this._loadingAssets[e].order,this._loadingAssets[e].type,this._loadingAssets[e].name,(this._loadingAssets[e].timeEnd-this._loadingAssets[e].timeStart)/1e3+"s"]);this._log.groupCollapsed("finished loading "+this._order+" assets in "+(Date.now()-this._startTime)/1e3+"s"),this._log.table(t),this._log.groupEnd()},Dt.prototype.finished=function(t){this._loadingAssets[t]&&(this._loadingAssets[t].finished=!0,this._loadingAssets[t].timeEnd=Date.now()),this.checkStatus(),this.emitEvent("finishedTask")},Dt.prototype._startAssetTasks=function(){for(let t=0;t<this._assetTasks.length;t++)this._assetTasks[t]();this._assetTasks.length=0},Dt.prototype.addAssetLoadingTask=function(t){this._patch.isEditorMode()&&!CABLES.UI.loaded?(this._assetTasks.push(t),this._loadingAssetTaskCb||window.gui.addEventListener("uiloaded",this._startAssetTasks.bind(this)),this._loadingAssetTaskCb=!0):t(),this.emitEvent("addAssetTask")},Dt.prototype.existByName=function(t){for(let e in this._loadingAssets)if(this._loadingAssets[e].name==t&&!this._loadingAssets[e].finished)return!0},Dt.prototype.start=function(t,e){0==this._startTime&&(this._startTime=Date.now());const i=A();return this._loadingAssets[i]={id:i,type:t,name:e,finished:!1,timeStart:Date.now(),order:this._order},this._order++,this.emitEvent("startTask"),i};const Gt=function(){this._loops=[],this._indizes=[],this._index=0};Gt.prototype.pushLoop=function(t){this._loops.push(Math.abs(Math.floor(t))),this._indizes.push(this._index)},Gt.prototype.popLoop=function(){this._loops.pop(),this._index=this._indizes.pop(),0===this._loops.length&&(this._index=0)},Gt.prototype.numLoops=function(){return this._loops.length},Gt.prototype.numCycles=function(){if(0===this._loops.length)return 0;let t=this._loops[0];for(let e=1;e<this._loops.length;e++)t*=this._loops[e];return t},Gt.prototype.inLoop=function(){return this._loops.length>0},Gt.prototype.increment=function(){this._index++},Gt.prototype.index=function(){return this._index};const Ht=function(t){this.startFrame=t.getFrameNum();let e={},i=null,s=0;this.getItems=function(){return e},this.clear=function(){e={}},this.add=function(r,n){null!==i&&(n&&n.id==i||e[i]&&(e[i].timeUsed+=performance.now()-s,(!e[i].peakTime||dt()-e[i].peakTime>5e3)&&(e[i].peak=0,e[i].peakTime=dt()),e[i].peak=Math.max(e[i].peak,performance.now()-s))),null!==n?(e[n.id]||(e[n.id]={numTriggers:0,timeUsed:0}),e[n.id].lastFrame!=t.getFrameNum()&&(e[n.id].numTriggers=0),e[n.id].lastFrame=t.getFrameNum(),e[n.id].numTriggers++,e[n.id].opid=n.parent.id,e[n.id].title=n.parent.name+"."+n.name,e[n.id].subPatch=n.parent.uiAttribs.subPatch,i=n.id,s=performance.now()):i=null},this.print=function(){console.log("--------");for(const t in e)console.log(e[t].title+": "+e[t].numTriggers+" / "+e[t].timeUsed)}};var zt=class extends Y{constructor(t,e,i){super(),this._name=t,this.type=i,this.setValue(e)}addListener(t){this.on("change",t,"var")}getValue(){return this._v}getName(){return this._name}setValue(t){this._v=t,this.emitEvent("change",t,this)}};const Wt=function(t){Y.apply(this),this._log=new a("core_patch"),this.ops=[],this.settings={},this.config=t||{glCanvasResizeToWindow:!1,prefixAssetPath:"",prefixJsPath:"",silent:!0,onError:null,onFinishedLoading:null,onFirstFrameRendered:null,onPatchLoaded:null,fpsLimit:0},this.timer=new ft,this.freeTimer=new ft,this.animFrameOps=[],this.animFrameCallbacks=[],this.gui=!1,CABLES.logSilent=this.silent=!0,this.profiler=null,this.aborted=!1,this._crashedOps=[],this._renderOneFrame=!1,this._animReq=null,this._opIdCache={},this._triggerStack=[],this.loading=new Dt(this),this._volumeListeners=[],this._paused=!1,this._frameNum=0,this.instancing=new Gt,this.onOneFrameRendered=null,this.namedTriggers={},this._origData=null,this._frameNext=0,this._frameInterval=0,this._lastFrameTime=0,this._frameWasdelayed=!0,function(){return!this}()||this._log.warn("not in strict mode: core patch"),this._isLocal=0===document.location.href.indexOf("file:"),this.config.hasOwnProperty("silent")&&(this.silent=CABLES.logSilent=this.config.silent),this.config.hasOwnProperty("doRequestAnimation")||(this.config.doRequestAnimation=!0),this.config.prefixAssetPath||(this.config.prefixAssetPath=""),this.config.prefixJsPath||(this.config.prefixJsPath=""),this.config.masterVolume||(this.config.masterVolume=1),this._variables={},this._variableListeners=[],this.vars={},t&&t.vars&&(this.vars=t.vars),this.cgl=new Bt(this),this.cgp=null,this.cgl.setCanvas(this.config.glCanvasId||this.config.glCanvas||"glcanvas"),!0===this.config.glCanvasResizeToWindow&&this.cgl.setAutoResize("window"),!0===this.config.glCanvasResizeToParent&&this.cgl.setAutoResize("parent"),this.loading.setOnFinishedLoading(this.config.onFinishedLoading),this.cgl.aborted&&(this.aborted=!0),this.cgl.silent&&(this.silent=!0),this.freeTimer.play(),this.exec(),this.aborted||(this.config.patch?this.deSerialize(this.config.patch):this.config.patchFile&&w(this.config.patchFile,(t,e)=>{const i=JSON.parse(e);if(t){return this._log.error("err",t),this._log.error("data",i),void this._log.error("data",i.msg)}this.deSerialize(i)}),this.timer.play()),console.log("made with https://cables.gl")};Wt.prototype.isPlaying=function(){return!this._paused},Wt.prototype.isRenderingOneFrame=function(){return this._renderOneFrame},Wt.prototype.renderOneFrame=function(){this._paused=!0,this._renderOneFrame=!0,this.exec(),this._renderOneFrame=!1},Wt.prototype.getFPS=function(){return console.log("deprecated getfps"),0},Wt.prototype.isEditorMode=function(){return!0===this.config.editorMode},Wt.prototype.pause=function(){cancelAnimationFrame(this._animReq),this.emitEvent("pause"),this._animReq=null,this._paused=!0,this.freeTimer.pause()},Wt.prototype.resume=function(){this._paused&&(cancelAnimationFrame(this._animReq),this._paused=!1,this.freeTimer.play(),this.emitEvent("resume"),this.exec())},Wt.prototype.setVolume=function(t){this.config.masterVolume=t;for(let e=0;e<this._volumeListeners.length;e++)this._volumeListeners[e].onMasterVolumeChanged(t)},Wt.prototype.getAssetPath=function(t=null){if(this.isEditorMode()){return"/assets/"+(t||gui.project()._id)+"/"}if(document.location.href.indexOf("cables.gl")>0||document.location.href.indexOf("cables.local")>0){const e=document.location.pathname.split("/");return"/assets/"+(t||e[e.length-1])+"/"}return this.config.hasOwnProperty("assetPath")?this.config.assetPath:"assets/"},Wt.prototype.getJsPath=function(){return this.config.hasOwnProperty("jsPath")?this.config.jsPath:"js/"},Wt.prototype.getFilePath=function(t){return this._isLocal&&!this.config.allowLocalFileAccess&&this.exitError("localAccess","Browser security forbids loading files directly without a webserver. Upload files to a server to work. use allowLocalFileAccess:true to ignore this."),t?0===(t=String(t)).indexOf("https:")||0===t.indexOf("http:")||0===t.indexOf("data:")?t:(t=t.replace("//","/"),this.config.prefixAssetPath+t+(this.config.suffixAssetPath||"")):t},Wt.prototype.clear=function(){for(this.emitEvent("patchClearStart"),this.cgl.TextureEffectMesh=null,this.animFrameOps.length=0,this.timer=new ft;this.ops.length>0;)this.deleteOp(this.ops[0].id);this.emitEvent("patchClearEnd")},Wt.getOpClass=function(t){const e=t.split(".");let i=null;try{return 2==e.length?i=window[e[0]][e[1]]:3==e.length?i=window[e[0]][e[1]][e[2]]:4==e.length?i=window[e[0]][e[1]][e[2]][e[3]]:5==e.length?i=window[e[0]][e[1]][e[2]][e[3]][e[4]]:6==e.length?i=window[e[0]][e[1]][e[2]][e[3]][e[4]][e[5]]:7==e.length?i=window[e[0]][e[1]][e[2]][e[3]][e[4]][e[5]][e[6]]:8==e.length?i=window[e[0]][e[1]][e[2]][e[3]][e[4]][e[5]][e[6]][e[7]]:9==e.length?i=window[e[0]][e[1]][e[2]][e[3]][e[4]][e[5]][e[6]][e[7]][e[8]]:10==e.length&&(i=window[e[0]][e[1]][e[2]][e[3]][e[4]][e[5]][e[6]][e[7]][e[8]][e[9]]),i}catch(t){return null}},Wt.prototype.createOp=function(t,e,i=null){let s=null,r="";try{if(-1===t.indexOf("Ops.")){const n=t;if(CABLES.OPS[n])r=CABLES.OPS[n].objName,s=new CABLES.OPS[n].f(this,r,e,n),s.opId=n;else{if(!i)throw new Error("could not find op by id: "+n);t=i,this._log.warn("could not find op by id: "+n)}}if(!s){r=t;const i=t.split(".");if(!Wt.getOpClass(r))throw this.emitEvent("criticalError",{title:"unknown op",text:"unknown op: "+r}),this._log.error("unknown op: "+r),new Error("unknown op: "+r);if(2==i.length?s=new window[i[0]][i[1]](this,r,e):3==i.length?s=new window[i[0]][i[1]][i[2]](this,r,e):4==i.length?s=new window[i[0]][i[1]][i[2]][i[3]](this,r,e):5==i.length?s=new window[i[0]][i[1]][i[2]][i[3]][i[4]](this,r,e):6==i.length?s=new window[i[0]][i[1]][i[2]][i[3]][i[4]][i[5]](this,r,e):7==i.length?s=new window[i[0]][i[1]][i[2]][i[3]][i[4]][i[5]][i[6]](this,r,e):8==i.length?s=new window[i[0]][i[1]][i[2]][i[3]][i[4]][i[5]][i[6]][i[7]](this,r,e):9==i.length?s=new window[i[0]][i[1]][i[2]][i[3]][i[4]][i[5]][i[6]][i[7]][i[8]](this,r,e):10==i.length?s=new window[i[0]][i[1]][i[2]][i[3]][i[4]][i[5]][i[6]][i[7]][i[8]][i[9]](this,r,e):this._log.warn("parts.length",i.length),s){s.opId=null;for(const t in CABLES.OPS)CABLES.OPS[t].objName==r&&(s.opId=t)}}}catch(t){if(this._crashedOps.push(r),this.emitEvent("exceptionOp",t,r,s),!this.isEditorMode())throw this._log.error(t),this._log.error("[instancing error] "+r,t),CABLES.api&&CABLES.api.sendErrorReport(t),this.exitError("INSTANCE_ERR","Instancing Error "+r,t),new Error("instancing error "+r)}return s?(s.objName=r,s.patch=this):this._log.log("no op was created!?",t,e),s},Wt.prototype.addOp=function(t,e,i,s,r){const n=this.createOp(t,i,r);if(n){if((e=e||{}).hasOwnProperty("errors")&&delete e.errors,e.hasOwnProperty("error")&&delete e.error,e.subPatch=e.subPatch||0,n.uiAttr(e),n.onCreate&&n.onCreate(),n.hasOwnProperty("onAnimFrame")&&this.addOnAnimFrame(n),n.hasOwnProperty("onMasterVolumeChanged")&&this._volumeListeners.push(n),this._opIdCache[n.id])return void this._log.warn("opid with id "+n.id+" already exists in patch!");this.ops.push(n),this._opIdCache[n.id]=n,this.emitEvent("onOpAdd",n,s),n.init&&n.init()}else this._log.error("addop: no op.....");return n},Wt.prototype.addOnAnimFrame=function(t){for(let e=0;e<this.animFrameOps.length;e++)if(this.animFrameOps[e]==t)return;this.animFrameOps.push(t)},Wt.prototype.removeOnAnimFrame=function(t){for(let e=0;e<this.animFrameOps.length;e++)if(this.animFrameOps[e]==t)return void this.animFrameOps.splice(e,1)},Wt.prototype.addOnAnimFrameCallback=function(t){this.animFrameCallbacks.push(t)},Wt.prototype.removeOnAnimCallback=function(t){for(let e=0;e<this.animFrameCallbacks.length;e++)if(this.animFrameCallbacks[e]==t)return void this.animFrameCallbacks.splice(e,1)},Wt.prototype.deleteOp=function(t,e,i){let s=!1;for(const r in this.ops)if(this.ops[r].id==t){const n=this.ops[r];let o=null,a=null;if(n){s=!0,e&&n.portsIn.length>0&&n.portsIn[0].isLinked()&&n.portsOut.length>0&&n.portsOut[0].isLinked()&&n.portsIn[0].getType()==n.portsOut[0].getType()&&n.portsIn[0].links[0]&&(o=n.portsIn[0].links[0].getOtherPort(n.portsIn[0]),a=n.portsOut[0].links[0].getOtherPort(n.portsOut[0]));const h=this.ops[r];h.removeLinks(),h.emitEvent("onDelete",this.ops[r]),this.onDelete&&(this._log.warn("deprecated this.onDelete",this.onDelete),this.onDelete(h)),this.ops.splice(r,1),this.emitEvent("onOpDelete",h,i),h.onDelete&&h.onDelete(i),h.cleanUp(),null!==o&&null!==a&&this.link(o.parent,o.getName(),a.parent,a.getName()),delete this._opIdCache[t];break}}s||this._log.warn("core patch deleteop: not found...")},Wt.prototype.getFrameNum=function(){return this._frameNum},Wt.prototype.emitOnAnimFrameEvent=function(t){t=t||this.timer.getTime();for(let e=0;e<this.animFrameCallbacks.length;++e)this.animFrameCallbacks[e]&&this.animFrameCallbacks[e](t,this._frameNum);for(let e=0;e<this.animFrameOps.length;++e)this.animFrameOps[e].onAnimFrame&&this.animFrameOps[e].onAnimFrame(t)},Wt.prototype.renderFrame=function(t){this.timer.update(),this.freeTimer.update();const e=this.timer.getTime(),i=performance.now();this.emitOnAnimFrameEvent(e),this.cgl.profileData.profileOnAnimFrameOps=performance.now()-i,this.emitEvent("onRenderFrame",e),this._frameNum++,1==this._frameNum&&this.config.onFirstFrameRendered&&this.config.onFirstFrameRendered()},Wt.prototype.exec=function(t){if(!this._renderOneFrame&&(this._paused||this.aborted))return;this.config.fpsLimit=this.config.fpsLimit||0,this.config.fpsLimit&&(this._frameInterval=1e3/this.config.fpsLimit);const e=CABLES.now(),i=e-this._frameNext;if(this.isEditorMode()&&!this._renderOneFrame&&e-this._lastFrameTime>=500&&0!==this._lastFrameTime&&!this._frameWasdelayed)return this._lastFrameTime=0,setTimeout(this.exec.bind(this),500),this.emitEvent("renderDelayStart"),void(this._frameWasdelayed=!0);if(this._renderOneFrame||0===this.config.fpsLimit||i>this._frameInterval||this._frameWasdelayed){CABLES.now();this.renderFrame(),this._frameInterval&&(this._frameNext=e-i%this._frameInterval)}this._frameWasdelayed&&(this.emitEvent("renderDelayEnd"),this._frameWasdelayed=!1),this._renderOneFrame&&(this.onOneFrameRendered&&this.onOneFrameRendered(),this.emitEvent("renderedOneFrame"),this._renderOneFrame=!1),this.config.doRequestAnimation&&(this._animReq=requestAnimationFrame(this.exec.bind(this)))},Wt.prototype.link=function(t,e,i,s,r,n){if(!t)return void this._log.warn("link: op1 is null ");if(!i)return void this._log.warn("link: op2 is null");const o=t.getPort(e,r),a=i.getPort(s,r);if(o)if(a){if(!o.shouldLink(o,a)||!a.shouldLink(o,a))return!1;if(kt.canLink(o,a)){const t=new kt(this);return t.link(o,a),this.emitEvent("onLink",o,a,t,n),t}}else this._log.warn("port not found! "+s+" of "+i.name+"("+i.objName+")");else this._log.warn("port not found! "+e+"("+t.objName+")")},Wt.prototype.serialize=function(t){const e={};t=t||{},e.ops=[],e.settings=this.settings;for(const t in this.ops){const i=this.ops[t];e.ops.push(i.getSerialized())}return t.asObject?e:JSON.stringify(e)},Wt.prototype.getOpById=function(t){return this._opIdCache[t]},Wt.prototype.getOpsByName=function(t){const e=[];for(const i in this.ops)this.ops[i].name==t&&e.push(this.ops[i]);return e},Wt.prototype.getOpsByObjName=function(t){const e=[];for(const i in this.ops)this.ops[i].objName==t&&e.push(this.ops[i]);return e},Wt.prototype.loadLib=function(t){C("/ui/libs/"+t+".js",(t,e)=>{const i=document.createElement("script");i.type="text/javascript",i.text=e,document.getElementsByTagName("head")[0].appendChild(i)},"GET")},Wt.prototype.reloadOp=function(t,e){let i=0;const s=[],r=[];for(const e in this.ops)this.ops[e].objName==t&&r.push(this.ops[e]);for(let e=0;e<r.length;e++){i++;const n=r[e];n.deleted=!0;const o=this,a=this.addOp(t,n.uiAttribs);if(!a)continue;let h,l;for(h in n&&n.storage&&(a.storage=n.storage),s.push(a),n.portsIn)if(0===n.portsIn[h].links.length){const t=a.getPort(n.portsIn[h].name);t?(t.set(n.portsIn[h].get()),n.portsIn[h].getVariableName()&&t.setVariable(n.portsIn[h].getVariableName())):this._log.error("[reloadOp] could not set port "+n.portsIn[h].name+", propably renamed port ?")}else for(;n.portsIn[h].links.length;){const t=n.portsIn[h].links[0].portIn.name,e=n.portsIn[h].links[0].portOut.name,i=n.portsIn[h].links[0].portOut.parent;n.portsIn[h].links[0].remove(),l=o.link(a,t,i,e),l?l.setValue():this._log.warn("[reloadOp] relink after op reload not successfull for port "+e)}for(h in n.portsOut)for(;n.portsOut[h].links.length;){const t=n.portsOut[h].links[0].portOut.name,e=n.portsOut[h].links[0].portIn.name,i=n.portsOut[h].links[0].portIn.parent;n.portsOut[h].links[0].remove(),l=o.link(a,t,i,e),l?l.setValue():this._log.warn("relink after op reload not successfull for port "+e)}this.deleteOp(n.id,!1,!0)}e(i,s)},Wt.prototype.getSubPatchOps=function(t){const e=[];for(const i in this.ops)this.ops[i].uiAttribs&&this.ops[i].uiAttribs.subPatch==t&&e.push(this.ops[i]);return e},Wt.prototype.getSubPatchOp=function(t,e){for(const i in this.ops)if(this.ops[i].uiAttribs&&this.ops[i].uiAttribs.subPatch==t&&this.ops[i].objName==e)return this.ops[i];return!1},Wt.prototype._addLink=function(t,e,i,s){this.link(this.getOpById(t),i,this.getOpById(e),s,!1,!0)},Wt.prototype.deSerialize=function(t,e){if(this.aborted)return;const i=[],s=this.loading.start("core","deserialize");this.namespace=t.namespace||"",this.name=t.name||"","string"==typeof t&&(t=JSON.parse(t)),this.settings=t.settings,this.emitEvent("patchLoadStart");for(const s in t.ops){const r=CABLES.now(),n=t.ops[s];let o=null;try{o=n.opId?this.addOp(n.opId,n.uiAttribs,n.id,!0,n.objName):this.addOp(n.objName,n.uiAttribs,n.id,!0)}catch(t){throw this._log.warn("[instancing error] op data:",n,t),new Error("instancing error: "+n.objName)}if(o){e&&(o.id=T()),o.portsInData=n.portsIn,o._origData=n,o.storage=n.storage;for(const t in n.portsIn){const e=n.portsIn[t],i=o.getPort(e.name);!i||"bool"!=i.uiAttribs.display&&"bool"!=i.uiAttribs.type||isNaN(e.value)||(e.value=!0===e.value),i&&void 0!==e.value&&i.type!=l.OP_PORT_TYPE_TEXTURE&&i.set(e.value),i&&i.deSerializeSettings(e)}for(const e in n.portsOut){const i=o.getPort(n.portsOut[e].name);i&&i.type!=l.OP_PORT_TYPE_TEXTURE&&n.portsOut[e].hasOwnProperty("value")&&i.set(t.ops[s].portsOut[e].value)}i.push(o)}const a=Math.round(100*(CABLES.now()-r))/100;!this.silent&&a>200&&this._log.warn("long op init ",t.ops[s].objName,a)}for(const t in this.ops)this.ops[t].onLoadedValueSet&&(this.ops[t].onLoadedValueSet(this.ops[t]._origData),this.ops[t].onLoadedValueSet=null,this.ops[t]._origData=null),this.ops[t].emitEvent("loadedValueSet");if(t.ops)for(let e=0;e<t.ops.length;e++){if(t.ops[e].portsIn)for(let i=0;i<t.ops[e].portsIn.length;i++)if(t.ops[e].portsIn[i].links)for(let s=0;s<t.ops[e].portsIn[i].links.length;s++){t.ops[e].portsIn[i].links[s]&&this._addLink(t.ops[e].portsIn[i].links[s].objIn,t.ops[e].portsIn[i].links[s].objOut,t.ops[e].portsIn[i].links[s].portIn,t.ops[e].portsIn[i].links[s].portOut)}if(t.ops[e].portsOut)for(let i=0;i<t.ops[e].portsOut.length;i++)if(t.ops[e].portsOut[i].links)for(let s=0;s<t.ops[e].portsOut[i].links.length;s++){let r=!1;t.ops[e].portsOut[i].links[s]&&(r=!0,this._addLink(t.ops[e].portsOut[i].links[s].objIn,t.ops[e].portsOut[i].links[s].objOut,t.ops[e].portsOut[i].links[s].portIn,t.ops[e].portsOut[i].links[s].portOut))}}for(const t in this.ops)this.ops[t].onLoaded&&(this.ops[t].onLoaded(),this.ops[t].onLoaded=null);for(const t in this.ops)this.ops[t].init&&(this.ops[t].init(),this.ops[t].init=null);if(this.config.variables)for(const t in this.config.variables)this.setVarValue(t,this.config.variables[t]);for(const t in this.ops)this.ops[t].initVarPorts(),delete this.ops[t].uiAttribs.pasted;setTimeout(()=>{this.loading.finished(s)},100),this.config.onPatchLoaded&&this.config.onPatchLoaded(this),this.emitEvent("patchLoadEnd",i,t,e)},Wt.prototype.profile=function(t){this.profiler=new Ht(this);for(const e in this.ops)this.ops[e].profile(t)},Wt.prototype.setVariable=function(t,e){void 0!==this._variables[t]?this._variables[t].setValue(e):this._log.warn("variable "+t+" not found!")},Wt.prototype._sortVars=function(){if(!this.isEditorMode())return;const t={};Object.keys(this._variables).sort((t,e)=>t.localeCompare(e,"en",{sensitivity:"base"})).forEach(e=>{t[e]=this._variables[e]}),this._variables=t},Wt.prototype.hasVar=function(t){return void 0!==this._variables[t]},Wt.prototype.setVarValue=function(t,e,i){return this.hasVar(t)?this._variables[t].setValue(e):(this._variables[t]=new zt(t,e,i),this._sortVars(),this.emitEvent("variablesChanged")),this._variables[t]},Wt.prototype.getVarValue=function(t,e){if(this._variables.hasOwnProperty(t))return this._variables[t].getValue()},Wt.prototype.getVar=function(t){if(this._variables.hasOwnProperty(t))return this._variables[t]},Wt.prototype.deleteVar=function(t){for(let e=0;e<this.ops.length;e++)for(let i=0;i<this.ops[e].portsIn.length;i++)this.ops[e].portsIn[i].getVariableName()==t&&this.ops[e].portsIn[i].setVariable(null);delete this._variables[t],this.emitEvent("variableDeleted",t),this.emitEvent("variablesChanged")},Wt.prototype.getVars=function(t){if(void 0===t)return this._variables;const e=[];t==CABLES.OP_PORT_TYPE_STRING&&(t="string"),t==CABLES.OP_PORT_TYPE_VALUE&&(t="number"),t==CABLES.OP_PORT_TYPE_ARRAY&&(t="array"),t==CABLES.OP_PORT_TYPE_OBJECT&&(t="object");for(const i in this._variables)this._variables[i].type&&this._variables[i].type!=t||e.push(this._variables[i]);return e},Wt.prototype.exitError=function(t,e,i){if(this.aborted=!0,this&&this.config&&this.config.onError)this.config.onError(t,e);else if(!this.isEditorMode()){const s=document.createElement("div"),r=this.cgl.canvas.getBoundingClientRect();s.setAttribute("style","position:absolute;border:5px solid red;padding:15px;background-color:black;color:white;font-family:monospace;"),s.style.top=r.top+"px",s.style.left=r.left+"px";let n="cables - An error occured:<br/>";n+="["+t+"] - "+e,i&&(n+="<br/>Exception: "+i.message),s.innerHTML=n;const o=this.cgl.canvas.parentElement;for(;o.hasChildNodes();)o.removeChild(o.lastChild);document.body.appendChild(s)}},Wt.prototype.preRenderOps=function(){this._log.log("prerendering...");for(let t=0;t<this.ops.length;t++)this.ops[t].preRender&&(this.ops[t].preRender(),this._log.log("prerender "+this.ops[t].objName))},Wt.prototype.dispose=function(){this.pause(),this.clear()},Wt.prototype.pushTriggerStack=function(t){this._triggerStack.push(t)},Wt.prototype.popTriggerStack=function(){this._triggerStack.pop()},Wt.prototype.printTriggerStack=function(){if(0==this._triggerStack.length)return void console.log("stack length",this._triggerStack.length);console.groupCollapsed("trigger port stack "+this._triggerStack[this._triggerStack.length-1].parent.name+"."+this._triggerStack[this._triggerStack.length-1].name);const t=[];for(let e=0;e<this._triggerStack.length;e++)t.push(e+". "+this._triggerStack[e].parent.name+" "+this._triggerStack[e].name);console.table(t),console.groupEnd()},Wt.replaceOpIds=function(t){for(const e in t.ops){const i=t.ops[e].id,s=t.ops[e].id=CABLES.generateUUID();for(const e in t.ops){if(t.ops[e].portsIn)for(const r in t.ops[e].portsIn)if(t.ops[e].portsIn[r].links){let n=t.ops[e].portsIn[r].links.length;for(;n--;)null===t.ops[e].portsIn[r].links[n]&&t.ops[e].portsIn[r].links.splice(n,1);for(n in t.ops[e].portsIn[r].links)t.ops[e].portsIn[r].links[n].objIn==i&&(t.ops[e].portsIn[r].links[n].objIn=s),t.ops[e].portsIn[r].links[n].objOut==i&&(t.ops[e].portsIn[r].links[n].objOut=s)}if(t.ops[e].portsOut)for(const r in t.ops[e].portsOut)if(t.ops[e].portsOut[r].links){let n=t.ops[e].portsOut[r].links.length;for(;n--;)null===t.ops[e].portsOut[r].links[n]&&t.ops[e].portsOut[r].links.splice(n,1);for(n in t.ops[e].portsOut[r].links)t.ops[e].portsOut[r].links[n].objIn==i&&(t.ops[e].portsOut[r].links[n].objIn=s),t.ops[e].portsOut[r].links[n].objOut==i&&(t.ops[e].portsOut[r].links[n].objOut=s)}}}return t};var Yt=Wt;const Xt={addPatch:function(t,e){let i=t,s=A();if("string"==typeof t&&(s=t,i=document.getElementById(s),!i))return void console.error(s+" Polyshape Container Element not found!");const r=document.createElement("canvas");return r.id="glcanvas_"+s,r.width=i.clientWidth,r.height=i.clientHeight,window.addEventListener("resize",function(){this.setAttribute("width",i.clientWidth),this.height=i.clientHeight}.bind(r)),i.appendChild(r),(e=e||{}).glCanvasId=r.id,e.onError||(e.onError=function(t){console.error(t)}),CABLES.patch=new Yt(e),r}},jt={toneJsInitialized:!1,createAudioContext:function(t){if(window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext)return window.audioContext||(window.audioContext=new AudioContext),window.Tone&&!jt.toneJsInitialized&&(Tone.setContext(window.audioContext),jt.toneJsInitialized=!0),window.audioContext;t.patch.config.onError("NO_WEBAUDIO","Web Audio is not supported in this browser.")},getAudioContext:function(){return window.audioContext},createAudioInPort:function(t,e,i,s){if(!t||!e||!i){const e="ERROR: createAudioInPort needs three parameters, op, portName and audioNode";throw t.log(e),new Error(e)}s||(s=0),t.webAudio=t.webAudio||{},t.webAudio.audioInPorts=t.webAudio.audioInPorts||[];const r=t.inObject(e);return r.webAudio={},r.webAudio.previousAudioInNode=null,r.webAudio.audioNode=i,t.webAudio.audioInPorts[e]=r,r.onChange=function(){const e=r.get();if(e)try{e.connect?(e.connect(r.webAudio.audioNode,0,s),t.setUiError("audioCtx",null)):t.setUiError("audioCtx","The passed input is not an audio context. Please make sure you connect an audio context to the input.",2)}catch(i){throw t.log("Error: Failed to connect web audio node!",i),t.log("port.webAudio.audioNode",r.webAudio.audioNode),t.log("audioInNode: ",e),t.log("inputChannelIndex:",s),t.log("audioInNode.connect: ",e.connect),i}else if(r.webAudio.previousAudioInNode)try{r.webAudio.previousAudioInNode.disconnect&&r.webAudio.previousAudioInNode.disconnect(r.webAudio.audioNode,0,s),t.setUiError("audioCtx",null)}catch(e){try{r.webAudio.previousAudioInNode.disconnect(r.webAudio.audioNode)}catch(i){throw t.log("Disconnecting audio node with in/out port index, as well as without in/out-port-index did not work ",e),e.printStackTrace&&e.printStackTrace(),e}}r.webAudio.previousAudioInNode=e},r},replaceNodeInPort:function(t,e,i){const s=t.webAudio.previousAudioInNode;if(s&&s.disconnect){try{s.disconnect(e)}catch(t){throw t.printStackTrace&&t.printStackTrace(),new Error("replaceNodeInPort: Could not disconnect old audio node. "+t.name+" "+t.message)}t.webAudio.audioNode=i;try{s.connect(i)}catch(t){throw t.printStackTrace&&t.printStackTrace(),new Error("replaceNodeInPort: Could not connect to new node. "+t.name+" "+t.message)}}},createAudioOutPort:function(t,e,i){if(!t||!e||!i){const e="ERROR: createAudioOutPort needs three parameters, op, portName and audioNode";throw t.log(e),new Error(e)}const s=t.outObject(e);return s.set(i),s},createAudioParamInPort:function(t,e,i,s,r){if(!t||!e||!i)return t.log("ERROR: createAudioParamInPort needs three parameters, op, portName and audioNode"),t&&t.name&&t.log("opname: ",t.name),t.log("portName",e),void t.log("audioNode: ",i);t.webAudio=t.webAudio||{},t.webAudio.audioInPorts=t.webAudio.audioInPorts||[];const n=t.inDynamic(e,[l.OP_PORT_TYPE_VALUE,l.OP_PORT_TYPE_OBJECT],s,r);return n.webAudio={},n.webAudio.previousAudioInNode=null,n.webAudio.audioNode=i,t.webAudio.audioInPorts[e]=n,n.onChange=function(){const e=n.get(),i=n.webAudio.audioNode,s=jt.getAudioContext();if(null!=e)if("object"==typeof e&&e.connect){try{e.connect(i)}catch(e){throw t.log("Could not connect audio node: ",e),e.printStackTrace&&e.printStackTrace(),e}n.webAudio.previousAudioInNode=e}else{if(i._param&&i._param.minValue&&i._param.maxValue)if(e>=i._param.minValue&&e<=i._param.maxValue)try{i.setValueAtTime?i.setValueAtTime(e,s.currentTime):i.value=e}catch(e){throw t.log("Possible AudioParam problem with tone.js op: ",e),e.printStackTrace&&e.printStackTrace(),e}else t.log("Warning: The value for an audio parameter is out of range!");else if(i.minValue&&i.maxValue)if(e>=i.minValue&&e<=i.maxValue)try{i.setValueAtTime?i.setValueAtTime(e,s.currentTime):i.value=e}catch(e){throw t.log("AudioParam has minValue / maxValue defined, and value is in range, but setting the value failed! ",e),e.printStackTrace&&e.printStackTrace(),e}else t.log("Warning: The value for an audio parameter is out of range!");else try{i.setValueAtTime?i.setValueAtTime(e,s.currentTime):i.value=e}catch(e){throw t.log("Possible AudioParam problem (without minValue / maxValue): ",e),e.printStackTrace&&e.printStackTrace(),e}if(n.webAudio.previousAudioInNode&&n.webAudio.previousAudioInNode.disconnect){try{n.webAudio.previousAudioInNode.disconnect(i)}catch(e){throw t.log("Could not disconnect previous audio node: ",e),e}n.webAudio.previousAudioInNode=void 0}}else n.webAudio.previousAudioInNode},n},loadAudioFile:function(t,e,i,s,r){const n=jt.createAudioContext();let o=null;(r||void 0===r)&&(o=t.loading.start("audio",e),t.isEditorMode()&&gui.jobs().start({id:"loadaudio"+o,title:" loading audio ("+e+")"}));const a=new XMLHttpRequest;e&&(a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(){t.loading.finished(o),t.isEditorMode()&&gui.jobs().finish("loadaudio"+o),n.decodeAudioData(a.response,i,s)},a.send())},isValidToneTime:function(t){try{new Tone.Time(t)}catch(t){return!1}return!0},isValidToneNote:function(t){try{Tone.Frequency(t)}catch(t){return!1}return!0}},Kt=function(t,e,i){this._patch=t,this.connector=i,this._log=new a("PatchConnectionReceiver")};Kt.prototype._addOp=function(t){let e=null;t.vars.uiAttribs&&(e=t.vars.uiAttribs);const i=this._patch.addOp(t.vars.objName,e,t.vars.opId,!0);i&&(i.id=t.vars.opId,t.vars.portsIn&&t.vars.portsIn.forEach(t=>{const e=i.getPortByName(t.name);e&&e.set(t.value)}))},Kt.prototype._receive=function(t){let e={};if(e=t.hasOwnProperty("event")?t:JSON.parse(t.data),e.event==u.PACO_OP_CREATE){if(this._patch.getOpById(e.vars.opId))return;this._log.verbose("op create:",e.vars.objName),window.gui?gui.serverOps.loadOpLibs(e.vars.objName,()=>{this._addOp(e)}):this._addOp(e)}else if(e.event==u.PACO_DESERIALIZE)e.vars.json&&(window.gui?gui.serverOps.loadProjectDependencies(e.vars.json,()=>{this._patch.deSerialize(e.vars.json,e.vars.genIds)}):this._patch.deSerialize(e.vars.json,e.vars.genIds));else if(e.event==u.PACO_LOAD)this._log.verbose("PACO load patch....."),this._patch.clear(),window.gui?gui.serverOps.loadProjectDependencies(JSON.parse(e.vars.patch),()=>{this._patch.deSerialize(e.vars.patch)}):this._patch.deSerialize(e.vars.patch);else if(e.event==u.PACO_CLEAR)this._patch.clear(),this._log.log("clear");else if(e.event==u.PACO_OP_DELETE){this._log.verbose("op delete",e.vars.objName);this._patch.getOpById(e.vars.op);this._patch.deleteOp(e.vars.op,!0)}else if(e.event==u.PACO_OP_ENABLE){const t=this._patch.getOpById(e.vars.op);t&&(t.enabled=!0)}else if(e.event==u.PACO_OP_DISABLE){const t=this._patch.getOpById(e.vars.op);t&&(t.enabled=!1)}else if(e.event==u.PACO_UIATTRIBS){const t=this._patch.getOpById(e.vars.op);t&&t.setUiAttrib(e.vars.uiAttribs)}else if(e.event==u.PACO_UNLINK){const t=this._patch.getOpById(e.vars.op1),i=this._patch.getOpById(e.vars.op2);if(!t||!i)return;const s=t.getPort(e.vars.port1),r=i.getPort(e.vars.port2);s&&r?s.removeLinkTo(r):this._log.warn("paco unlink could not find port...")}else if(e.event==u.PACO_LINK){const t=this._patch.getOpById(e.vars.op1),i=this._patch.getOpById(e.vars.op2);t&&i&&this._patch.link(t,e.vars.port1,i,e.vars.port2)}else if(e.event==u.PACO_VALUECHANGE){if("+ create new one"===e.vars.v)return;const t=this._patch.getOpById(e.vars.op);if(t){const i=t.getPort(e.vars.port);i&&i.set(e.vars.v)}}else if(e.event==u.PACO_VARIABLES){const t=this._patch.getOpById(e.vars.opId);t&&t.varName&&t.varName.set(e.vars.varName)}else if(e.event==u.PACO_TRIGGERS){const t=this._patch.getOpById(e.vars.opId);t&&t.varName&&t.varName.set(e.vars.varName)}else if(e.event==u.PACO_PORT_SETVARIABLE){const t=this._patch.getOpById(e.vars.opId);if(t){const i=t.getPortByName(e.vars.portName);i&&i.setVariable(e.vars.variableName)}}else if(e.event==u.PACO_PORT_SETANIMATED){const t=this._patch.getOpById(e.vars.opId);if(t){t.portsIn[e.vars.portIndex]&&e.vars.hasOwnProperty("targetState")&&this._patch.emitEvent("pacoPortValueSetAnimated",t,e.vars.portIndex,e.vars.targetState,e.vars.defaultValue)}}else if(e.event==u.PACO_PORT_ANIM_UPDATED){const t=this._patch.getOpById(e.vars.opId);if(t){const i=t.getPortByName(e.vars.portName);if(i){const t=i.getSerialized();t.anim=e.vars.anim,i.anim=null,i.deSerializeSettings(t),this._patch.emitEvent("pacoPortAnimUpdated",i)}}}else this._log.warn("unknown patchConnectionEvent!",t)};const Qt=function(t){this.connectors=[],this.paused=!1,t.addEventListener("onOpDelete",t=>{this.send(CABLES.PACO_OP_DELETE,{op:t.id,objName:t.objName})}),t.addEventListener("patchClearStart",()=>{this.paused=!0}),t.addEventListener("patchClearEnd",()=>{this.paused=!1}),t.addEventListener("patchLoadStart",()=>{this.paused=!0}),t.addEventListener("patchLoadEnd",(t,e,i)=>{this.paused=!1,this.send(CABLES.PACO_DESERIALIZE,{json:e,genIds:i})}),t.addEventListener("onOpAdd",t=>{const e=[];t.portsIn.forEach(t=>{const i={id:t.id,name:t.name,value:t.get()};e.push(i)});let i={};t.uiAttribs&&(i={...t.uiAttribs}),this.send(CABLES.PACO_OP_CREATE,{opId:t.id,objName:t.objName,uiAttribs:i,portsIn:e})}),t.addEventListener("onUnLink",(t,e)=>{this.send(CABLES.PACO_UNLINK,{op1:t.parent.id,op2:e.parent.id,port1:t.getName(),port2:e.getName()})}),t.addEventListener("onUiAttribsChange",(t,e)=>{e&&(delete e.extendTitle,delete e.history,delete e.translate,Object.keys(e).length>0&&this.send(CABLES.PACO_UIATTRIBS,{op:t.id,uiAttribs:e}))}),t.addEventListener("opVariableNameChanged",(t,e)=>{const i={opId:t.id,varName:e};this.send(CABLES.PACO_VARIABLES,i)}),t.addEventListener("opTriggerNameChanged",(t,e)=>{const i={opId:t.id,varName:e};this.send(CABLES.PACO_TRIGGERS,i)}),t.addEventListener("onLink",(t,e)=>{this.send(CABLES.PACO_LINK,{op1:t.parent.id,op2:e.parent.id,port1:t.name,port2:e.name})}),t.addEventListener("portSetVariable",(t,e,i)=>{const s={opId:t.id,portName:e.name,variableName:i};this.send(CABLES.PACO_PORT_SETVARIABLE,s)}),t.addEventListener("portAnimUpdated",(t,e,i)=>{if(t&&e){const s={opId:t.id,portName:e.name,anim:i.getSerialized()};this.send(CABLES.PACO_PORT_ANIM_UPDATED,s)}})};Qt.prototype.send=function(t,e){if(!this.paused&&(t!==CABLES.PACO_VALUECHANGE||"+ create new one"!==e.v))for(let i=0;i<this.connectors.length;i++)this.connectors[i].send(t,e)};const qt=function(){window.BroadcastChannel&&(this.bc=new BroadcastChannel("test_channel"))};qt.prototype.receive=function(t){this.bc&&(this._log.log("init"),this.bc.onmessage=t._receive.bind(t))},qt.prototype.send=function(t,e){if(!this.bc)return;const i={};i.event=t,i.vars=e,this.bc.postMessage(JSON.stringify(i))};class Jt{constructor(t){this.name=t,this.dur=0,this._startTime=0,this.childs=[]}start(){this._startTime=performance.now()}end(){this.dur=performance.now()-this._startTime}push(t){const e=new Jt(t);return this.childs.push(e),e.start(),e}print(t){t=t||0;let e="";for(let i=0;i<t;i++)e+="  ";for(let e=0;e<this.childs.length;e++)this.childs[e].print(t+1)}}window.CABLES=window.CABLES||{},CABLES.CG=Rt,CABLES.CGP=wt,CABLES.EventTarget=Y,CABLES.EMBED=Xt,CABLES.Link=kt,CABLES.Port=et,CABLES.Op=Vt,CABLES.Profiler=Ht,CABLES.Patch=Yt,CABLES.Instancing=Gt,CABLES.Timer=ft,CABLES.WEBAUDIO=jt,CABLES.Variable=function(){let t=null;const e=[];this.onChanged=function(t){e.push(t)},this.getValue=function(){return t},this.setValue=function(e){t=e,this.emitChanged()},this.emitChanged=function(){for(let t=0;t<e.length;t++)e[t]()}},CABLES.LoadingStatus=Dt,CABLES.now=dt,CABLES.internalNow=_t,CABLES.BranchStack=class{constructor(){}start(){this.root=new Jt("Root"),this.root.start(),this.current=this.root}push(t){this.current||this.start();const e=this.current;return this.current=this.current.push(t),this.current.prev=e,this.current.start(),this.current}pop(){this.current&&(this.current.end(),this.current=this.current.prev)}finish(){this.current.end(),this.root.print(),this.current=null}},CABLES.Branch=Jt,CABLES=Object.assign(CABLES,r,s,n,h,o,c,u,h,l);e.default=CABLES;(function(){return!this})()||console.warn("not in strict mode: index core")}]).default;
//# originalSourceMappingURL=cables.min.js.map

var CABLES = CABLES || {}; CABLES.build = {"timestamp":1682341866190,"created":"2023-04-24T13:11:06.190Z","git":{"branch":"master","commit":"a8912bdbb85d335fb4b58c228bba4c8be8498ebd","date":"2023-04-24T13:08:49.000Z","message":"fix duplicate ids"}};
/*!
@fileoverview gl-matrix - High performance matrix and vector operations
@author Brandon Jones
@author Colin MacKenzie IV
@version 3.1.0

Copyright (c) 2015-2019, Brandon Jones, Colin MacKenzie IV.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).glMatrix={})}(this,function(t){"use strict";var n=1e-6,a="undefined"!=typeof Float32Array?Float32Array:Array,r=Math.random;var u=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,n=arguments.length;n--;)t+=arguments[n]*arguments[n];return Math.sqrt(t)});var e=Object.freeze({EPSILON:n,get ARRAY_TYPE(){return a},RANDOM:r,setMatrixArrayType:function(t){a=t},toRadian:function(t){return t*u},equals:function(t,a){return Math.abs(t-a)<=n*Math.max(1,Math.abs(t),Math.abs(a))}});function o(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=a[0],c=a[1],h=a[2],s=a[3];return t[0]=r*i+e*c,t[1]=u*i+o*c,t[2]=r*h+e*s,t[3]=u*h+o*s,t}function i(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t}var c=o,h=i,s=Object.freeze({create:function(){var t=new a(4);return a!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},clone:function(t){var n=new a(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},fromValues:function(t,n,r,u){var e=new a(4);return e[0]=t,e[1]=n,e[2]=r,e[3]=u,e},set:function(t,n,a,r,u){return t[0]=n,t[1]=a,t[2]=r,t[3]=u,t},transpose:function(t,n){if(t===n){var a=n[1];t[1]=n[2],t[2]=a}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t},invert:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=a*e-u*r;return o?(o=1/o,t[0]=e*o,t[1]=-r*o,t[2]=-u*o,t[3]=a*o,t):null},adjoint:function(t,n){var a=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=a,t},determinant:function(t){return t[0]*t[3]-t[2]*t[1]},multiply:o,rotate:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=Math.sin(a),c=Math.cos(a);return t[0]=r*c+e*i,t[1]=u*c+o*i,t[2]=r*-i+e*c,t[3]=u*-i+o*c,t},scale:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=a[0],c=a[1];return t[0]=r*i,t[1]=u*i,t[2]=e*c,t[3]=o*c,t},fromRotation:function(t,n){var a=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=a,t[2]=-a,t[3]=r,t},fromScaling:function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t},str:function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},frob:function(t){return Math.hypot(t[0],t[1],t[2],t[3])},LDU:function(t,n,a,r){return t[2]=r[2]/r[0],a[0]=r[0],a[1]=r[1],a[3]=r[3]-t[2]*a[1],[t,n,a]},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t},subtract:i,exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]},equals:function(t,a){var r=t[0],u=t[1],e=t[2],o=t[3],i=a[0],c=a[1],h=a[2],s=a[3];return Math.abs(r-i)<=n*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(u-c)<=n*Math.max(1,Math.abs(u),Math.abs(c))&&Math.abs(e-h)<=n*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(o-s)<=n*Math.max(1,Math.abs(o),Math.abs(s))},multiplyScalar:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t},multiplyScalarAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t[2]=n[2]+a[2]*r,t[3]=n[3]+a[3]*r,t},mul:c,sub:h});function M(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=a[0],s=a[1],M=a[2],f=a[3],l=a[4],v=a[5];return t[0]=r*h+e*s,t[1]=u*h+o*s,t[2]=r*M+e*f,t[3]=u*M+o*f,t[4]=r*l+e*v+i,t[5]=u*l+o*v+c,t}function f(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t[4]=n[4]-a[4],t[5]=n[5]-a[5],t}var l=M,v=f,b=Object.freeze({create:function(){var t=new a(6);return a!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},clone:function(t){var n=new a(6);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},fromValues:function(t,n,r,u,e,o){var i=new a(6);return i[0]=t,i[1]=n,i[2]=r,i[3]=u,i[4]=e,i[5]=o,i},set:function(t,n,a,r,u,e,o){return t[0]=n,t[1]=a,t[2]=r,t[3]=u,t[4]=e,t[5]=o,t},invert:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=n[4],i=n[5],c=a*e-r*u;return c?(c=1/c,t[0]=e*c,t[1]=-r*c,t[2]=-u*c,t[3]=a*c,t[4]=(u*i-e*o)*c,t[5]=(r*o-a*i)*c,t):null},determinant:function(t){return t[0]*t[3]-t[1]*t[2]},multiply:M,rotate:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=Math.sin(a),s=Math.cos(a);return t[0]=r*s+e*h,t[1]=u*s+o*h,t[2]=r*-h+e*s,t[3]=u*-h+o*s,t[4]=i,t[5]=c,t},scale:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=a[0],s=a[1];return t[0]=r*h,t[1]=u*h,t[2]=e*s,t[3]=o*s,t[4]=i,t[5]=c,t},translate:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=a[0],s=a[1];return t[0]=r,t[1]=u,t[2]=e,t[3]=o,t[4]=r*h+e*s+i,t[5]=u*h+o*s+c,t},fromRotation:function(t,n){var a=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=a,t[2]=-a,t[3]=r,t[4]=0,t[5]=0,t},fromScaling:function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t[4]=0,t[5]=0,t},fromTranslation:function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=n[0],t[5]=n[1],t},str:function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},frob:function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t[4]=n[4]+a[4],t[5]=n[5]+a[5],t},subtract:f,multiplyScalar:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*a,t[5]=n[5]*a,t},multiplyScalarAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t[2]=n[2]+a[2]*r,t[3]=n[3]+a[3]*r,t[4]=n[4]+a[4]*r,t[5]=n[5]+a[5]*r,t},exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]},equals:function(t,a){var r=t[0],u=t[1],e=t[2],o=t[3],i=t[4],c=t[5],h=a[0],s=a[1],M=a[2],f=a[3],l=a[4],v=a[5];return Math.abs(r-h)<=n*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(u-s)<=n*Math.max(1,Math.abs(u),Math.abs(s))&&Math.abs(e-M)<=n*Math.max(1,Math.abs(e),Math.abs(M))&&Math.abs(o-f)<=n*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(i-l)<=n*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(c-v)<=n*Math.max(1,Math.abs(c),Math.abs(v))},mul:l,sub:v});function m(){var t=new a(9);return a!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function d(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=n[8],f=a[0],l=a[1],v=a[2],b=a[3],m=a[4],d=a[5],x=a[6],p=a[7],y=a[8];return t[0]=f*r+l*o+v*h,t[1]=f*u+l*i+v*s,t[2]=f*e+l*c+v*M,t[3]=b*r+m*o+d*h,t[4]=b*u+m*i+d*s,t[5]=b*e+m*c+d*M,t[6]=x*r+p*o+y*h,t[7]=x*u+p*i+y*s,t[8]=x*e+p*c+y*M,t}function x(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t[4]=n[4]-a[4],t[5]=n[5]-a[5],t[6]=n[6]-a[6],t[7]=n[7]-a[7],t[8]=n[8]-a[8],t}var p=d,y=x,q=Object.freeze({create:m,fromMat4:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t},clone:function(t){var n=new a(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},fromValues:function(t,n,r,u,e,o,i,c,h){var s=new a(9);return s[0]=t,s[1]=n,s[2]=r,s[3]=u,s[4]=e,s[5]=o,s[6]=i,s[7]=c,s[8]=h,s},set:function(t,n,a,r,u,e,o,i,c,h){return t[0]=n,t[1]=a,t[2]=r,t[3]=u,t[4]=e,t[5]=o,t[6]=i,t[7]=c,t[8]=h,t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},transpose:function(t,n){if(t===n){var a=n[1],r=n[2],u=n[5];t[1]=n[3],t[2]=n[6],t[3]=a,t[5]=n[7],t[6]=r,t[7]=u}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t},invert:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=n[4],i=n[5],c=n[6],h=n[7],s=n[8],M=s*o-i*h,f=-s*e+i*c,l=h*e-o*c,v=a*M+r*f+u*l;return v?(v=1/v,t[0]=M*v,t[1]=(-s*r+u*h)*v,t[2]=(i*r-u*o)*v,t[3]=f*v,t[4]=(s*a-u*c)*v,t[5]=(-i*a+u*e)*v,t[6]=l*v,t[7]=(-h*a+r*c)*v,t[8]=(o*a-r*e)*v,t):null},adjoint:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=n[4],i=n[5],c=n[6],h=n[7],s=n[8];return t[0]=o*s-i*h,t[1]=u*h-r*s,t[2]=r*i-u*o,t[3]=i*c-e*s,t[4]=a*s-u*c,t[5]=u*e-a*i,t[6]=e*h-o*c,t[7]=r*c-a*h,t[8]=a*o-r*e,t},determinant:function(t){var n=t[0],a=t[1],r=t[2],u=t[3],e=t[4],o=t[5],i=t[6],c=t[7],h=t[8];return n*(h*e-o*c)+a*(-h*u+o*i)+r*(c*u-e*i)},multiply:d,translate:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=n[8],f=a[0],l=a[1];return t[0]=r,t[1]=u,t[2]=e,t[3]=o,t[4]=i,t[5]=c,t[6]=f*r+l*o+h,t[7]=f*u+l*i+s,t[8]=f*e+l*c+M,t},rotate:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=n[8],f=Math.sin(a),l=Math.cos(a);return t[0]=l*r+f*o,t[1]=l*u+f*i,t[2]=l*e+f*c,t[3]=l*o-f*r,t[4]=l*i-f*u,t[5]=l*c-f*e,t[6]=h,t[7]=s,t[8]=M,t},scale:function(t,n,a){var r=a[0],u=a[1];return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=u*n[3],t[4]=u*n[4],t[5]=u*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},fromTranslation:function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t},fromRotation:function(t,n){var a=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=a,t[2]=0,t[3]=-a,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromScaling:function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat2d:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t},fromQuat:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=a+a,i=r+r,c=u+u,h=a*o,s=r*o,M=r*i,f=u*o,l=u*i,v=u*c,b=e*o,m=e*i,d=e*c;return t[0]=1-M-v,t[3]=s-d,t[6]=f+m,t[1]=s+d,t[4]=1-h-v,t[7]=l-b,t[2]=f-m,t[5]=l+b,t[8]=1-h-M,t},normalFromMat4:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=n[4],i=n[5],c=n[6],h=n[7],s=n[8],M=n[9],f=n[10],l=n[11],v=n[12],b=n[13],m=n[14],d=n[15],x=a*i-r*o,p=a*c-u*o,y=a*h-e*o,q=r*c-u*i,g=r*h-e*i,A=u*h-e*c,w=s*b-M*v,R=s*m-f*v,z=s*d-l*v,P=M*m-f*b,j=M*d-l*b,I=f*d-l*m,S=x*I-p*j+y*P+q*z-g*R+A*w;return S?(S=1/S,t[0]=(i*I-c*j+h*P)*S,t[1]=(c*z-o*I-h*R)*S,t[2]=(o*j-i*z+h*w)*S,t[3]=(u*j-r*I-e*P)*S,t[4]=(a*I-u*z+e*R)*S,t[5]=(r*z-a*j-e*w)*S,t[6]=(b*A-m*g+d*q)*S,t[7]=(m*y-v*A-d*p)*S,t[8]=(v*g-b*y+d*x)*S,t):null},projection:function(t,n,a){return t[0]=2/n,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/a,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},str:function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},frob:function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t[4]=n[4]+a[4],t[5]=n[5]+a[5],t[6]=n[6]+a[6],t[7]=n[7]+a[7],t[8]=n[8]+a[8],t},subtract:x,multiplyScalar:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=n[7]*a,t[8]=n[8]*a,t},multiplyScalarAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t[2]=n[2]+a[2]*r,t[3]=n[3]+a[3]*r,t[4]=n[4]+a[4]*r,t[5]=n[5]+a[5]*r,t[6]=n[6]+a[6]*r,t[7]=n[7]+a[7]*r,t[8]=n[8]+a[8]*r,t},exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]},equals:function(t,a){var r=t[0],u=t[1],e=t[2],o=t[3],i=t[4],c=t[5],h=t[6],s=t[7],M=t[8],f=a[0],l=a[1],v=a[2],b=a[3],m=a[4],d=a[5],x=a[6],p=a[7],y=a[8];return Math.abs(r-f)<=n*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(u-l)<=n*Math.max(1,Math.abs(u),Math.abs(l))&&Math.abs(e-v)<=n*Math.max(1,Math.abs(e),Math.abs(v))&&Math.abs(o-b)<=n*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(i-m)<=n*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(c-d)<=n*Math.max(1,Math.abs(c),Math.abs(d))&&Math.abs(h-x)<=n*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(s-p)<=n*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(M-y)<=n*Math.max(1,Math.abs(M),Math.abs(y))},mul:p,sub:y});function g(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function A(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=n[8],f=n[9],l=n[10],v=n[11],b=n[12],m=n[13],d=n[14],x=n[15],p=a[0],y=a[1],q=a[2],g=a[3];return t[0]=p*r+y*i+q*M+g*b,t[1]=p*u+y*c+q*f+g*m,t[2]=p*e+y*h+q*l+g*d,t[3]=p*o+y*s+q*v+g*x,p=a[4],y=a[5],q=a[6],g=a[7],t[4]=p*r+y*i+q*M+g*b,t[5]=p*u+y*c+q*f+g*m,t[6]=p*e+y*h+q*l+g*d,t[7]=p*o+y*s+q*v+g*x,p=a[8],y=a[9],q=a[10],g=a[11],t[8]=p*r+y*i+q*M+g*b,t[9]=p*u+y*c+q*f+g*m,t[10]=p*e+y*h+q*l+g*d,t[11]=p*o+y*s+q*v+g*x,p=a[12],y=a[13],q=a[14],g=a[15],t[12]=p*r+y*i+q*M+g*b,t[13]=p*u+y*c+q*f+g*m,t[14]=p*e+y*h+q*l+g*d,t[15]=p*o+y*s+q*v+g*x,t}function w(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=r+r,c=u+u,h=e+e,s=r*i,M=r*c,f=r*h,l=u*c,v=u*h,b=e*h,m=o*i,d=o*c,x=o*h;return t[0]=1-(l+b),t[1]=M+x,t[2]=f-d,t[3]=0,t[4]=M-x,t[5]=1-(s+b),t[6]=v+m,t[7]=0,t[8]=f+d,t[9]=v-m,t[10]=1-(s+l),t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t}function R(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function z(t,n){var a=n[0],r=n[1],u=n[2],e=n[4],o=n[5],i=n[6],c=n[8],h=n[9],s=n[10];return t[0]=Math.hypot(a,r,u),t[1]=Math.hypot(e,o,i),t[2]=Math.hypot(c,h,s),t}function P(t,n){var r=new a(3);z(r,n);var u=1/r[0],e=1/r[1],o=1/r[2],i=n[0]*u,c=n[1]*e,h=n[2]*o,s=n[4]*u,M=n[5]*e,f=n[6]*o,l=n[8]*u,v=n[9]*e,b=n[10]*o,m=i+M+b,d=0;return m>0?(d=2*Math.sqrt(m+1),t[3]=.25*d,t[0]=(f-v)/d,t[1]=(l-h)/d,t[2]=(c-s)/d):i>M&&i>b?(d=2*Math.sqrt(1+i-M-b),t[3]=(f-v)/d,t[0]=.25*d,t[1]=(c+s)/d,t[2]=(l+h)/d):M>b?(d=2*Math.sqrt(1+M-i-b),t[3]=(l-h)/d,t[0]=(c+s)/d,t[1]=.25*d,t[2]=(f+v)/d):(d=2*Math.sqrt(1+b-i-M),t[3]=(c-s)/d,t[0]=(l+h)/d,t[1]=(f+v)/d,t[2]=.25*d),t}function j(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t[4]=n[4]-a[4],t[5]=n[5]-a[5],t[6]=n[6]-a[6],t[7]=n[7]-a[7],t[8]=n[8]-a[8],t[9]=n[9]-a[9],t[10]=n[10]-a[10],t[11]=n[11]-a[11],t[12]=n[12]-a[12],t[13]=n[13]-a[13],t[14]=n[14]-a[14],t[15]=n[15]-a[15],t}var I=A,S=j,E=Object.freeze({create:function(){var t=new a(16);return a!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},clone:function(t){var n=new a(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},fromValues:function(t,n,r,u,e,o,i,c,h,s,M,f,l,v,b,m){var d=new a(16);return d[0]=t,d[1]=n,d[2]=r,d[3]=u,d[4]=e,d[5]=o,d[6]=i,d[7]=c,d[8]=h,d[9]=s,d[10]=M,d[11]=f,d[12]=l,d[13]=v,d[14]=b,d[15]=m,d},set:function(t,n,a,r,u,e,o,i,c,h,s,M,f,l,v,b,m){return t[0]=n,t[1]=a,t[2]=r,t[3]=u,t[4]=e,t[5]=o,t[6]=i,t[7]=c,t[8]=h,t[9]=s,t[10]=M,t[11]=f,t[12]=l,t[13]=v,t[14]=b,t[15]=m,t},identity:g,transpose:function(t,n){if(t===n){var a=n[1],r=n[2],u=n[3],e=n[6],o=n[7],i=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=a,t[6]=n[9],t[7]=n[13],t[8]=r,t[9]=e,t[11]=n[14],t[12]=u,t[13]=o,t[14]=i}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t},invert:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=n[4],i=n[5],c=n[6],h=n[7],s=n[8],M=n[9],f=n[10],l=n[11],v=n[12],b=n[13],m=n[14],d=n[15],x=a*i-r*o,p=a*c-u*o,y=a*h-e*o,q=r*c-u*i,g=r*h-e*i,A=u*h-e*c,w=s*b-M*v,R=s*m-f*v,z=s*d-l*v,P=M*m-f*b,j=M*d-l*b,I=f*d-l*m,S=x*I-p*j+y*P+q*z-g*R+A*w;return S?(S=1/S,t[0]=(i*I-c*j+h*P)*S,t[1]=(u*j-r*I-e*P)*S,t[2]=(b*A-m*g+d*q)*S,t[3]=(f*g-M*A-l*q)*S,t[4]=(c*z-o*I-h*R)*S,t[5]=(a*I-u*z+e*R)*S,t[6]=(m*y-v*A-d*p)*S,t[7]=(s*A-f*y+l*p)*S,t[8]=(o*j-i*z+h*w)*S,t[9]=(r*z-a*j-e*w)*S,t[10]=(v*g-b*y+d*x)*S,t[11]=(M*y-s*g-l*x)*S,t[12]=(i*R-o*P-c*w)*S,t[13]=(a*P-r*R+u*w)*S,t[14]=(b*p-v*q-m*x)*S,t[15]=(s*q-M*p+f*x)*S,t):null},adjoint:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=n[4],i=n[5],c=n[6],h=n[7],s=n[8],M=n[9],f=n[10],l=n[11],v=n[12],b=n[13],m=n[14],d=n[15];return t[0]=i*(f*d-l*m)-M*(c*d-h*m)+b*(c*l-h*f),t[1]=-(r*(f*d-l*m)-M*(u*d-e*m)+b*(u*l-e*f)),t[2]=r*(c*d-h*m)-i*(u*d-e*m)+b*(u*h-e*c),t[3]=-(r*(c*l-h*f)-i*(u*l-e*f)+M*(u*h-e*c)),t[4]=-(o*(f*d-l*m)-s*(c*d-h*m)+v*(c*l-h*f)),t[5]=a*(f*d-l*m)-s*(u*d-e*m)+v*(u*l-e*f),t[6]=-(a*(c*d-h*m)-o*(u*d-e*m)+v*(u*h-e*c)),t[7]=a*(c*l-h*f)-o*(u*l-e*f)+s*(u*h-e*c),t[8]=o*(M*d-l*b)-s*(i*d-h*b)+v*(i*l-h*M),t[9]=-(a*(M*d-l*b)-s*(r*d-e*b)+v*(r*l-e*M)),t[10]=a*(i*d-h*b)-o*(r*d-e*b)+v*(r*h-e*i),t[11]=-(a*(i*l-h*M)-o*(r*l-e*M)+s*(r*h-e*i)),t[12]=-(o*(M*m-f*b)-s*(i*m-c*b)+v*(i*f-c*M)),t[13]=a*(M*m-f*b)-s*(r*m-u*b)+v*(r*f-u*M),t[14]=-(a*(i*m-c*b)-o*(r*m-u*b)+v*(r*c-u*i)),t[15]=a*(i*f-c*M)-o*(r*f-u*M)+s*(r*c-u*i),t},determinant:function(t){var n=t[0],a=t[1],r=t[2],u=t[3],e=t[4],o=t[5],i=t[6],c=t[7],h=t[8],s=t[9],M=t[10],f=t[11],l=t[12],v=t[13],b=t[14],m=t[15];return(n*o-a*e)*(M*m-f*b)-(n*i-r*e)*(s*m-f*v)+(n*c-u*e)*(s*b-M*v)+(a*i-r*o)*(h*m-f*l)-(a*c-u*o)*(h*b-M*l)+(r*c-u*i)*(h*v-s*l)},multiply:A,translate:function(t,n,a){var r,u,e,o,i,c,h,s,M,f,l,v,b=a[0],m=a[1],d=a[2];return n===t?(t[12]=n[0]*b+n[4]*m+n[8]*d+n[12],t[13]=n[1]*b+n[5]*m+n[9]*d+n[13],t[14]=n[2]*b+n[6]*m+n[10]*d+n[14],t[15]=n[3]*b+n[7]*m+n[11]*d+n[15]):(r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=n[8],f=n[9],l=n[10],v=n[11],t[0]=r,t[1]=u,t[2]=e,t[3]=o,t[4]=i,t[5]=c,t[6]=h,t[7]=s,t[8]=M,t[9]=f,t[10]=l,t[11]=v,t[12]=r*b+i*m+M*d+n[12],t[13]=u*b+c*m+f*d+n[13],t[14]=e*b+h*m+l*d+n[14],t[15]=o*b+s*m+v*d+n[15]),t},scale:function(t,n,a){var r=a[0],u=a[1],e=a[2];return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*u,t[5]=n[5]*u,t[6]=n[6]*u,t[7]=n[7]*u,t[8]=n[8]*e,t[9]=n[9]*e,t[10]=n[10]*e,t[11]=n[11]*e,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},rotate:function(t,a,r,u){var e,o,i,c,h,s,M,f,l,v,b,m,d,x,p,y,q,g,A,w,R,z,P,j,I=u[0],S=u[1],E=u[2],O=Math.hypot(I,S,E);return O<n?null:(I*=O=1/O,S*=O,E*=O,e=Math.sin(r),i=1-(o=Math.cos(r)),c=a[0],h=a[1],s=a[2],M=a[3],f=a[4],l=a[5],v=a[6],b=a[7],m=a[8],d=a[9],x=a[10],p=a[11],y=I*I*i+o,q=S*I*i+E*e,g=E*I*i-S*e,A=I*S*i-E*e,w=S*S*i+o,R=E*S*i+I*e,z=I*E*i+S*e,P=S*E*i-I*e,j=E*E*i+o,t[0]=c*y+f*q+m*g,t[1]=h*y+l*q+d*g,t[2]=s*y+v*q+x*g,t[3]=M*y+b*q+p*g,t[4]=c*A+f*w+m*R,t[5]=h*A+l*w+d*R,t[6]=s*A+v*w+x*R,t[7]=M*A+b*w+p*R,t[8]=c*z+f*P+m*j,t[9]=h*z+l*P+d*j,t[10]=s*z+v*P+x*j,t[11]=M*z+b*P+p*j,a!==t&&(t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t)},rotateX:function(t,n,a){var r=Math.sin(a),u=Math.cos(a),e=n[4],o=n[5],i=n[6],c=n[7],h=n[8],s=n[9],M=n[10],f=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=e*u+h*r,t[5]=o*u+s*r,t[6]=i*u+M*r,t[7]=c*u+f*r,t[8]=h*u-e*r,t[9]=s*u-o*r,t[10]=M*u-i*r,t[11]=f*u-c*r,t},rotateY:function(t,n,a){var r=Math.sin(a),u=Math.cos(a),e=n[0],o=n[1],i=n[2],c=n[3],h=n[8],s=n[9],M=n[10],f=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=e*u-h*r,t[1]=o*u-s*r,t[2]=i*u-M*r,t[3]=c*u-f*r,t[8]=e*r+h*u,t[9]=o*r+s*u,t[10]=i*r+M*u,t[11]=c*r+f*u,t},rotateZ:function(t,n,a){var r=Math.sin(a),u=Math.cos(a),e=n[0],o=n[1],i=n[2],c=n[3],h=n[4],s=n[5],M=n[6],f=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=e*u+h*r,t[1]=o*u+s*r,t[2]=i*u+M*r,t[3]=c*u+f*r,t[4]=h*u-e*r,t[5]=s*u-o*r,t[6]=M*u-i*r,t[7]=f*u-c*r,t},fromTranslation:function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},fromScaling:function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotation:function(t,a,r){var u,e,o,i=r[0],c=r[1],h=r[2],s=Math.hypot(i,c,h);return s<n?null:(i*=s=1/s,c*=s,h*=s,u=Math.sin(a),o=1-(e=Math.cos(a)),t[0]=i*i*o+e,t[1]=c*i*o+h*u,t[2]=h*i*o-c*u,t[3]=0,t[4]=i*c*o-h*u,t[5]=c*c*o+e,t[6]=h*c*o+i*u,t[7]=0,t[8]=i*h*o+c*u,t[9]=c*h*o-i*u,t[10]=h*h*o+e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},fromXRotation:function(t,n){var a=Math.sin(n),r=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=a,t[7]=0,t[8]=0,t[9]=-a,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromYRotation:function(t,n){var a=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=0,t[2]=-a,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=a,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromZRotation:function(t,n){var a=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=a,t[2]=0,t[3]=0,t[4]=-a,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotationTranslation:w,fromQuat2:function(t,n){var r=new a(3),u=-n[0],e=-n[1],o=-n[2],i=n[3],c=n[4],h=n[5],s=n[6],M=n[7],f=u*u+e*e+o*o+i*i;return f>0?(r[0]=2*(c*i+M*u+h*o-s*e)/f,r[1]=2*(h*i+M*e+s*u-c*o)/f,r[2]=2*(s*i+M*o+c*e-h*u)/f):(r[0]=2*(c*i+M*u+h*o-s*e),r[1]=2*(h*i+M*e+s*u-c*o),r[2]=2*(s*i+M*o+c*e-h*u)),w(t,n,r),t},getTranslation:R,getScaling:z,getRotation:P,fromRotationTranslationScale:function(t,n,a,r){var u=n[0],e=n[1],o=n[2],i=n[3],c=u+u,h=e+e,s=o+o,M=u*c,f=u*h,l=u*s,v=e*h,b=e*s,m=o*s,d=i*c,x=i*h,p=i*s,y=r[0],q=r[1],g=r[2];return t[0]=(1-(v+m))*y,t[1]=(f+p)*y,t[2]=(l-x)*y,t[3]=0,t[4]=(f-p)*q,t[5]=(1-(M+m))*q,t[6]=(b+d)*q,t[7]=0,t[8]=(l+x)*g,t[9]=(b-d)*g,t[10]=(1-(M+v))*g,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},fromRotationTranslationScaleOrigin:function(t,n,a,r,u){var e=n[0],o=n[1],i=n[2],c=n[3],h=e+e,s=o+o,M=i+i,f=e*h,l=e*s,v=e*M,b=o*s,m=o*M,d=i*M,x=c*h,p=c*s,y=c*M,q=r[0],g=r[1],A=r[2],w=u[0],R=u[1],z=u[2],P=(1-(b+d))*q,j=(l+y)*q,I=(v-p)*q,S=(l-y)*g,E=(1-(f+d))*g,O=(m+x)*g,T=(v+p)*A,D=(m-x)*A,F=(1-(f+b))*A;return t[0]=P,t[1]=j,t[2]=I,t[3]=0,t[4]=S,t[5]=E,t[6]=O,t[7]=0,t[8]=T,t[9]=D,t[10]=F,t[11]=0,t[12]=a[0]+w-(P*w+S*R+T*z),t[13]=a[1]+R-(j*w+E*R+D*z),t[14]=a[2]+z-(I*w+O*R+F*z),t[15]=1,t},fromQuat:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=a+a,i=r+r,c=u+u,h=a*o,s=r*o,M=r*i,f=u*o,l=u*i,v=u*c,b=e*o,m=e*i,d=e*c;return t[0]=1-M-v,t[1]=s+d,t[2]=f-m,t[3]=0,t[4]=s-d,t[5]=1-h-v,t[6]=l+b,t[7]=0,t[8]=f+m,t[9]=l-b,t[10]=1-h-M,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},frustum:function(t,n,a,r,u,e,o){var i=1/(a-n),c=1/(u-r),h=1/(e-o);return t[0]=2*e*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*e*c,t[6]=0,t[7]=0,t[8]=(a+n)*i,t[9]=(u+r)*c,t[10]=(o+e)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*e*2*h,t[15]=0,t},perspective:function(t,n,a,r,u){var e,o=1/Math.tan(n/2);return t[0]=o/a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=u&&u!==1/0?(e=1/(r-u),t[10]=(u+r)*e,t[14]=2*u*r*e):(t[10]=-1,t[14]=-2*r),t},perspectiveFromFieldOfView:function(t,n,a,r){var u=Math.tan(n.upDegrees*Math.PI/180),e=Math.tan(n.downDegrees*Math.PI/180),o=Math.tan(n.leftDegrees*Math.PI/180),i=Math.tan(n.rightDegrees*Math.PI/180),c=2/(o+i),h=2/(u+e);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-(o-i)*c*.5,t[9]=(u-e)*h*.5,t[10]=r/(a-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*a/(a-r),t[15]=0,t},ortho:function(t,n,a,r,u,e,o){var i=1/(n-a),c=1/(r-u),h=1/(e-o);return t[0]=-2*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(n+a)*i,t[13]=(u+r)*c,t[14]=(o+e)*h,t[15]=1,t},lookAt:function(t,a,r,u){var e,o,i,c,h,s,M,f,l,v,b=a[0],m=a[1],d=a[2],x=u[0],p=u[1],y=u[2],q=r[0],A=r[1],w=r[2];return Math.abs(b-q)<n&&Math.abs(m-A)<n&&Math.abs(d-w)<n?g(t):(M=b-q,f=m-A,l=d-w,e=p*(l*=v=1/Math.hypot(M,f,l))-y*(f*=v),o=y*(M*=v)-x*l,i=x*f-p*M,(v=Math.hypot(e,o,i))?(e*=v=1/v,o*=v,i*=v):(e=0,o=0,i=0),c=f*i-l*o,h=l*e-M*i,s=M*o-f*e,(v=Math.hypot(c,h,s))?(c*=v=1/v,h*=v,s*=v):(c=0,h=0,s=0),t[0]=e,t[1]=c,t[2]=M,t[3]=0,t[4]=o,t[5]=h,t[6]=f,t[7]=0,t[8]=i,t[9]=s,t[10]=l,t[11]=0,t[12]=-(e*b+o*m+i*d),t[13]=-(c*b+h*m+s*d),t[14]=-(M*b+f*m+l*d),t[15]=1,t)},targetTo:function(t,n,a,r){var u=n[0],e=n[1],o=n[2],i=r[0],c=r[1],h=r[2],s=u-a[0],M=e-a[1],f=o-a[2],l=s*s+M*M+f*f;l>0&&(s*=l=1/Math.sqrt(l),M*=l,f*=l);var v=c*f-h*M,b=h*s-i*f,m=i*M-c*s;return(l=v*v+b*b+m*m)>0&&(v*=l=1/Math.sqrt(l),b*=l,m*=l),t[0]=v,t[1]=b,t[2]=m,t[3]=0,t[4]=M*m-f*b,t[5]=f*v-s*m,t[6]=s*b-M*v,t[7]=0,t[8]=s,t[9]=M,t[10]=f,t[11]=0,t[12]=u,t[13]=e,t[14]=o,t[15]=1,t},str:function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},frob:function(t){return Math.hypot(t[0],t[1],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t[4]=n[4]+a[4],t[5]=n[5]+a[5],t[6]=n[6]+a[6],t[7]=n[7]+a[7],t[8]=n[8]+a[8],t[9]=n[9]+a[9],t[10]=n[10]+a[10],t[11]=n[11]+a[11],t[12]=n[12]+a[12],t[13]=n[13]+a[13],t[14]=n[14]+a[14],t[15]=n[15]+a[15],t},subtract:j,multiplyScalar:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=n[7]*a,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=n[11]*a,t[12]=n[12]*a,t[13]=n[13]*a,t[14]=n[14]*a,t[15]=n[15]*a,t},multiplyScalarAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t[2]=n[2]+a[2]*r,t[3]=n[3]+a[3]*r,t[4]=n[4]+a[4]*r,t[5]=n[5]+a[5]*r,t[6]=n[6]+a[6]*r,t[7]=n[7]+a[7]*r,t[8]=n[8]+a[8]*r,t[9]=n[9]+a[9]*r,t[10]=n[10]+a[10]*r,t[11]=n[11]+a[11]*r,t[12]=n[12]+a[12]*r,t[13]=n[13]+a[13]*r,t[14]=n[14]+a[14]*r,t[15]=n[15]+a[15]*r,t},exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]},equals:function(t,a){var r=t[0],u=t[1],e=t[2],o=t[3],i=t[4],c=t[5],h=t[6],s=t[7],M=t[8],f=t[9],l=t[10],v=t[11],b=t[12],m=t[13],d=t[14],x=t[15],p=a[0],y=a[1],q=a[2],g=a[3],A=a[4],w=a[5],R=a[6],z=a[7],P=a[8],j=a[9],I=a[10],S=a[11],E=a[12],O=a[13],T=a[14],D=a[15];return Math.abs(r-p)<=n*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(u-y)<=n*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(e-q)<=n*Math.max(1,Math.abs(e),Math.abs(q))&&Math.abs(o-g)<=n*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(i-A)<=n*Math.max(1,Math.abs(i),Math.abs(A))&&Math.abs(c-w)<=n*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(h-R)<=n*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(s-z)<=n*Math.max(1,Math.abs(s),Math.abs(z))&&Math.abs(M-P)<=n*Math.max(1,Math.abs(M),Math.abs(P))&&Math.abs(f-j)<=n*Math.max(1,Math.abs(f),Math.abs(j))&&Math.abs(l-I)<=n*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(v-S)<=n*Math.max(1,Math.abs(v),Math.abs(S))&&Math.abs(b-E)<=n*Math.max(1,Math.abs(b),Math.abs(E))&&Math.abs(m-O)<=n*Math.max(1,Math.abs(m),Math.abs(O))&&Math.abs(d-T)<=n*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(x-D)<=n*Math.max(1,Math.abs(x),Math.abs(D))},mul:I,sub:S});function O(){var t=new a(3);return a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function T(t){var n=t[0],a=t[1],r=t[2];return Math.hypot(n,a,r)}function D(t,n,r){var u=new a(3);return u[0]=t,u[1]=n,u[2]=r,u}function F(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t}function L(t,n,a){return t[0]=n[0]*a[0],t[1]=n[1]*a[1],t[2]=n[2]*a[2],t}function V(t,n,a){return t[0]=n[0]/a[0],t[1]=n[1]/a[1],t[2]=n[2]/a[2],t}function Q(t,n){var a=n[0]-t[0],r=n[1]-t[1],u=n[2]-t[2];return Math.hypot(a,r,u)}function Y(t,n){var a=n[0]-t[0],r=n[1]-t[1],u=n[2]-t[2];return a*a+r*r+u*u}function X(t){var n=t[0],a=t[1],r=t[2];return n*n+a*a+r*r}function Z(t,n){var a=n[0],r=n[1],u=n[2],e=a*a+r*r+u*u;return e>0&&(e=1/Math.sqrt(e)),t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t}function _(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function B(t,n,a){var r=n[0],u=n[1],e=n[2],o=a[0],i=a[1],c=a[2];return t[0]=u*c-e*i,t[1]=e*o-r*c,t[2]=r*i-u*o,t}var N,k=F,U=L,W=V,C=Q,G=Y,H=T,J=X,K=(N=O(),function(t,n,a,r,u,e){var o,i;for(n||(n=3),a||(a=0),i=r?Math.min(r*n+a,t.length):t.length,o=a;o<i;o+=n)N[0]=t[o],N[1]=t[o+1],N[2]=t[o+2],u(N,N,e),t[o]=N[0],t[o+1]=N[1],t[o+2]=N[2];return t}),$=Object.freeze({create:O,clone:function(t){var n=new a(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},length:T,fromValues:D,copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},set:function(t,n,a,r){return t[0]=n,t[1]=a,t[2]=r,t},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t},subtract:F,multiply:L,divide:V,ceil:function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t},floor:function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t},min:function(t,n,a){return t[0]=Math.min(n[0],a[0]),t[1]=Math.min(n[1],a[1]),t[2]=Math.min(n[2],a[2]),t},max:function(t,n,a){return t[0]=Math.max(n[0],a[0]),t[1]=Math.max(n[1],a[1]),t[2]=Math.max(n[2],a[2]),t},round:function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t},scale:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t},scaleAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t[2]=n[2]+a[2]*r,t},distance:Q,squaredDistance:Y,squaredLength:X,negate:function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t},inverse:function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t},normalize:Z,dot:_,cross:B,lerp:function(t,n,a,r){var u=n[0],e=n[1],o=n[2];return t[0]=u+r*(a[0]-u),t[1]=e+r*(a[1]-e),t[2]=o+r*(a[2]-o),t},hermite:function(t,n,a,r,u,e){var o=e*e,i=o*(2*e-3)+1,c=o*(e-2)+e,h=o*(e-1),s=o*(3-2*e);return t[0]=n[0]*i+a[0]*c+r[0]*h+u[0]*s,t[1]=n[1]*i+a[1]*c+r[1]*h+u[1]*s,t[2]=n[2]*i+a[2]*c+r[2]*h+u[2]*s,t},bezier:function(t,n,a,r,u,e){var o=1-e,i=o*o,c=e*e,h=i*o,s=3*e*i,M=3*c*o,f=c*e;return t[0]=n[0]*h+a[0]*s+r[0]*M+u[0]*f,t[1]=n[1]*h+a[1]*s+r[1]*M+u[1]*f,t[2]=n[2]*h+a[2]*s+r[2]*M+u[2]*f,t},random:function(t,n){n=n||1;var a=2*r()*Math.PI,u=2*r()-1,e=Math.sqrt(1-u*u)*n;return t[0]=Math.cos(a)*e,t[1]=Math.sin(a)*e,t[2]=u*n,t},transformMat4:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=a[3]*r+a[7]*u+a[11]*e+a[15];return o=o||1,t[0]=(a[0]*r+a[4]*u+a[8]*e+a[12])/o,t[1]=(a[1]*r+a[5]*u+a[9]*e+a[13])/o,t[2]=(a[2]*r+a[6]*u+a[10]*e+a[14])/o,t},transformMat3:function(t,n,a){var r=n[0],u=n[1],e=n[2];return t[0]=r*a[0]+u*a[3]+e*a[6],t[1]=r*a[1]+u*a[4]+e*a[7],t[2]=r*a[2]+u*a[5]+e*a[8],t},transformQuat:function(t,n,a){var r=a[0],u=a[1],e=a[2],o=a[3],i=n[0],c=n[1],h=n[2],s=u*h-e*c,M=e*i-r*h,f=r*c-u*i,l=u*f-e*M,v=e*s-r*f,b=r*M-u*s,m=2*o;return s*=m,M*=m,f*=m,l*=2,v*=2,b*=2,t[0]=i+s+l,t[1]=c+M+v,t[2]=h+f+b,t},rotateX:function(t,n,a,r){var u=[],e=[];return u[0]=n[0]-a[0],u[1]=n[1]-a[1],u[2]=n[2]-a[2],e[0]=u[0],e[1]=u[1]*Math.cos(r)-u[2]*Math.sin(r),e[2]=u[1]*Math.sin(r)+u[2]*Math.cos(r),t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t},rotateY:function(t,n,a,r){var u=[],e=[];return u[0]=n[0]-a[0],u[1]=n[1]-a[1],u[2]=n[2]-a[2],e[0]=u[2]*Math.sin(r)+u[0]*Math.cos(r),e[1]=u[1],e[2]=u[2]*Math.cos(r)-u[0]*Math.sin(r),t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t},rotateZ:function(t,n,a,r){var u=[],e=[];return u[0]=n[0]-a[0],u[1]=n[1]-a[1],u[2]=n[2]-a[2],e[0]=u[0]*Math.cos(r)-u[1]*Math.sin(r),e[1]=u[0]*Math.sin(r)+u[1]*Math.cos(r),e[2]=u[2],t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t},angle:function(t,n){var a=D(t[0],t[1],t[2]),r=D(n[0],n[1],n[2]);Z(a,a),Z(r,r);var u=_(a,r);return u>1?0:u<-1?Math.PI:Math.acos(u)},zero:function(t){return t[0]=0,t[1]=0,t[2]=0,t},str:function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]},equals:function(t,a){var r=t[0],u=t[1],e=t[2],o=a[0],i=a[1],c=a[2];return Math.abs(r-o)<=n*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(u-i)<=n*Math.max(1,Math.abs(u),Math.abs(i))&&Math.abs(e-c)<=n*Math.max(1,Math.abs(e),Math.abs(c))},sub:k,mul:U,div:W,dist:C,sqrDist:G,len:H,sqrLen:J,forEach:K});function tt(){var t=new a(4);return a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function nt(t){var n=new a(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function at(t,n,r,u){var e=new a(4);return e[0]=t,e[1]=n,e[2]=r,e[3]=u,e}function rt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function ut(t,n,a,r,u){return t[0]=n,t[1]=a,t[2]=r,t[3]=u,t}function et(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t}function ot(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t}function it(t,n,a){return t[0]=n[0]*a[0],t[1]=n[1]*a[1],t[2]=n[2]*a[2],t[3]=n[3]*a[3],t}function ct(t,n,a){return t[0]=n[0]/a[0],t[1]=n[1]/a[1],t[2]=n[2]/a[2],t[3]=n[3]/a[3],t}function ht(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t}function st(t,n){var a=n[0]-t[0],r=n[1]-t[1],u=n[2]-t[2],e=n[3]-t[3];return Math.hypot(a,r,u,e)}function Mt(t,n){var a=n[0]-t[0],r=n[1]-t[1],u=n[2]-t[2],e=n[3]-t[3];return a*a+r*r+u*u+e*e}function ft(t){var n=t[0],a=t[1],r=t[2],u=t[3];return Math.hypot(n,a,r,u)}function lt(t){var n=t[0],a=t[1],r=t[2],u=t[3];return n*n+a*a+r*r+u*u}function vt(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=a*a+r*r+u*u+e*e;return o>0&&(o=1/Math.sqrt(o)),t[0]=a*o,t[1]=r*o,t[2]=u*o,t[3]=e*o,t}function bt(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}function mt(t,n,a,r){var u=n[0],e=n[1],o=n[2],i=n[3];return t[0]=u+r*(a[0]-u),t[1]=e+r*(a[1]-e),t[2]=o+r*(a[2]-o),t[3]=i+r*(a[3]-i),t}function dt(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function xt(t,a){var r=t[0],u=t[1],e=t[2],o=t[3],i=a[0],c=a[1],h=a[2],s=a[3];return Math.abs(r-i)<=n*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(u-c)<=n*Math.max(1,Math.abs(u),Math.abs(c))&&Math.abs(e-h)<=n*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(o-s)<=n*Math.max(1,Math.abs(o),Math.abs(s))}var pt=ot,yt=it,qt=ct,gt=st,At=Mt,wt=ft,Rt=lt,zt=function(){var t=tt();return function(n,a,r,u,e,o){var i,c;for(a||(a=4),r||(r=0),c=u?Math.min(u*a+r,n.length):n.length,i=r;i<c;i+=a)t[0]=n[i],t[1]=n[i+1],t[2]=n[i+2],t[3]=n[i+3],e(t,t,o),n[i]=t[0],n[i+1]=t[1],n[i+2]=t[2],n[i+3]=t[3];return n}}(),Pt=Object.freeze({create:tt,clone:nt,fromValues:at,copy:rt,set:ut,add:et,subtract:ot,multiply:it,divide:ct,ceil:function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t[3]=Math.ceil(n[3]),t},floor:function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t[3]=Math.floor(n[3]),t},min:function(t,n,a){return t[0]=Math.min(n[0],a[0]),t[1]=Math.min(n[1],a[1]),t[2]=Math.min(n[2],a[2]),t[3]=Math.min(n[3],a[3]),t},max:function(t,n,a){return t[0]=Math.max(n[0],a[0]),t[1]=Math.max(n[1],a[1]),t[2]=Math.max(n[2],a[2]),t[3]=Math.max(n[3],a[3]),t},round:function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t[3]=Math.round(n[3]),t},scale:ht,scaleAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t[2]=n[2]+a[2]*r,t[3]=n[3]+a[3]*r,t},distance:st,squaredDistance:Mt,length:ft,squaredLength:lt,negate:function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t},inverse:function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t[3]=1/n[3],t},normalize:vt,dot:bt,cross:function(t,n,a,r){var u=a[0]*r[1]-a[1]*r[0],e=a[0]*r[2]-a[2]*r[0],o=a[0]*r[3]-a[3]*r[0],i=a[1]*r[2]-a[2]*r[1],c=a[1]*r[3]-a[3]*r[1],h=a[2]*r[3]-a[3]*r[2],s=n[0],M=n[1],f=n[2],l=n[3];return t[0]=M*h-f*c+l*i,t[1]=-s*h+f*o-l*e,t[2]=s*c-M*o+l*u,t[3]=-s*i+M*e-f*u,t},lerp:mt,random:function(t,n){var a,u,e,o,i,c;n=n||1;do{i=(a=2*r()-1)*a+(u=2*r()-1)*u}while(i>=1);do{c=(e=2*r()-1)*e+(o=2*r()-1)*o}while(c>=1);var h=Math.sqrt((1-i)/c);return t[0]=n*a,t[1]=n*u,t[2]=n*e*h,t[3]=n*o*h,t},transformMat4:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3];return t[0]=a[0]*r+a[4]*u+a[8]*e+a[12]*o,t[1]=a[1]*r+a[5]*u+a[9]*e+a[13]*o,t[2]=a[2]*r+a[6]*u+a[10]*e+a[14]*o,t[3]=a[3]*r+a[7]*u+a[11]*e+a[15]*o,t},transformQuat:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=a[0],i=a[1],c=a[2],h=a[3],s=h*r+i*e-c*u,M=h*u+c*r-o*e,f=h*e+o*u-i*r,l=-o*r-i*u-c*e;return t[0]=s*h+l*-o+M*-c-f*-i,t[1]=M*h+l*-i+f*-o-s*-c,t[2]=f*h+l*-c+s*-i-M*-o,t[3]=n[3],t},zero:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},str:function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},exactEquals:dt,equals:xt,sub:pt,mul:yt,div:qt,dist:gt,sqrDist:At,len:wt,sqrLen:Rt,forEach:zt});function jt(){var t=new a(4);return a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function It(t,n,a){a*=.5;var r=Math.sin(a);return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=Math.cos(a),t}function St(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=a[0],c=a[1],h=a[2],s=a[3];return t[0]=r*s+o*i+u*h-e*c,t[1]=u*s+o*c+e*i-r*h,t[2]=e*s+o*h+r*c-u*i,t[3]=o*s-r*i-u*c-e*h,t}function Et(t,n,a){a*=.5;var r=n[0],u=n[1],e=n[2],o=n[3],i=Math.sin(a),c=Math.cos(a);return t[0]=r*c+o*i,t[1]=u*c+e*i,t[2]=e*c-u*i,t[3]=o*c-r*i,t}function Ot(t,n,a){a*=.5;var r=n[0],u=n[1],e=n[2],o=n[3],i=Math.sin(a),c=Math.cos(a);return t[0]=r*c-e*i,t[1]=u*c+o*i,t[2]=e*c+r*i,t[3]=o*c-u*i,t}function Tt(t,n,a){a*=.5;var r=n[0],u=n[1],e=n[2],o=n[3],i=Math.sin(a),c=Math.cos(a);return t[0]=r*c+u*i,t[1]=u*c-r*i,t[2]=e*c+o*i,t[3]=o*c-e*i,t}function Dt(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=Math.sqrt(a*a+r*r+u*u),i=Math.exp(e),c=o>0?i*Math.sin(o)/o:0;return t[0]=a*c,t[1]=r*c,t[2]=u*c,t[3]=i*Math.cos(o),t}function Ft(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=Math.sqrt(a*a+r*r+u*u),i=o>0?Math.atan2(o,e)/o:0;return t[0]=a*i,t[1]=r*i,t[2]=u*i,t[3]=.5*Math.log(a*a+r*r+u*u+e*e),t}function Lt(t,a,r,u){var e,o,i,c,h,s=a[0],M=a[1],f=a[2],l=a[3],v=r[0],b=r[1],m=r[2],d=r[3];return(o=s*v+M*b+f*m+l*d)<0&&(o=-o,v=-v,b=-b,m=-m,d=-d),1-o>n?(e=Math.acos(o),i=Math.sin(e),c=Math.sin((1-u)*e)/i,h=Math.sin(u*e)/i):(c=1-u,h=u),t[0]=c*s+h*v,t[1]=c*M+h*b,t[2]=c*f+h*m,t[3]=c*l+h*d,t}function Vt(t,n){var a,r=n[0]+n[4]+n[8];if(r>0)a=Math.sqrt(r+1),t[3]=.5*a,a=.5/a,t[0]=(n[5]-n[7])*a,t[1]=(n[6]-n[2])*a,t[2]=(n[1]-n[3])*a;else{var u=0;n[4]>n[0]&&(u=1),n[8]>n[3*u+u]&&(u=2);var e=(u+1)%3,o=(u+2)%3;a=Math.sqrt(n[3*u+u]-n[3*e+e]-n[3*o+o]+1),t[u]=.5*a,a=.5/a,t[3]=(n[3*e+o]-n[3*o+e])*a,t[e]=(n[3*e+u]+n[3*u+e])*a,t[o]=(n[3*o+u]+n[3*u+o])*a}return t}var Qt,Yt,Xt,Zt,_t,Bt,Nt=nt,kt=at,Ut=rt,Wt=ut,Ct=et,Gt=St,Ht=ht,Jt=bt,Kt=mt,$t=ft,tn=$t,nn=lt,an=nn,rn=vt,un=dt,en=xt,on=(Qt=O(),Yt=D(1,0,0),Xt=D(0,1,0),function(t,n,a){var r=_(n,a);return r<-.999999?(B(Qt,Yt,n),H(Qt)<1e-6&&B(Qt,Xt,n),Z(Qt,Qt),It(t,Qt,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(B(Qt,n,a),t[0]=Qt[0],t[1]=Qt[1],t[2]=Qt[2],t[3]=1+r,rn(t,t))}),cn=(Zt=jt(),_t=jt(),function(t,n,a,r,u,e){return Lt(Zt,n,u,e),Lt(_t,a,r,e),Lt(t,Zt,_t,2*e*(1-e)),t}),hn=(Bt=m(),function(t,n,a,r){return Bt[0]=a[0],Bt[3]=a[1],Bt[6]=a[2],Bt[1]=r[0],Bt[4]=r[1],Bt[7]=r[2],Bt[2]=-n[0],Bt[5]=-n[1],Bt[8]=-n[2],rn(t,Vt(t,Bt))}),sn=Object.freeze({create:jt,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},setAxisAngle:It,getAxisAngle:function(t,a){var r=2*Math.acos(a[3]),u=Math.sin(r/2);return u>n?(t[0]=a[0]/u,t[1]=a[1]/u,t[2]=a[2]/u):(t[0]=1,t[1]=0,t[2]=0),r},getAngle:function(t,n){var a=Jt(t,n);return Math.acos(2*a*a-1)},multiply:St,rotateX:Et,rotateY:Ot,rotateZ:Tt,calculateW:function(t,n){var a=n[0],r=n[1],u=n[2];return t[0]=a,t[1]=r,t[2]=u,t[3]=Math.sqrt(Math.abs(1-a*a-r*r-u*u)),t},exp:Dt,ln:Ft,pow:function(t,n,a){return Ft(t,n),Ht(t,t,a),Dt(t,t),t},slerp:Lt,random:function(t){var n=r(),a=r(),u=r(),e=Math.sqrt(1-n),o=Math.sqrt(n);return t[0]=e*Math.sin(2*Math.PI*a),t[1]=e*Math.cos(2*Math.PI*a),t[2]=o*Math.sin(2*Math.PI*u),t[3]=o*Math.cos(2*Math.PI*u),t},invert:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=a*a+r*r+u*u+e*e,i=o?1/o:0;return t[0]=-a*i,t[1]=-r*i,t[2]=-u*i,t[3]=e*i,t},conjugate:function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t},fromMat3:Vt,fromEuler:function(t,n,a,r){var u=.5*Math.PI/180;n*=u,a*=u,r*=u;var e=Math.sin(n),o=Math.cos(n),i=Math.sin(a),c=Math.cos(a),h=Math.sin(r),s=Math.cos(r);return t[0]=e*c*s-o*i*h,t[1]=o*i*s+e*c*h,t[2]=o*c*h-e*i*s,t[3]=o*c*s+e*i*h,t},str:function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},clone:Nt,fromValues:kt,copy:Ut,set:Wt,add:Ct,mul:Gt,scale:Ht,dot:Jt,lerp:Kt,length:$t,len:tn,squaredLength:nn,sqrLen:an,normalize:rn,exactEquals:un,equals:en,rotationTo:on,sqlerp:cn,setAxes:hn});function Mn(t,n,a){var r=.5*a[0],u=.5*a[1],e=.5*a[2],o=n[0],i=n[1],c=n[2],h=n[3];return t[0]=o,t[1]=i,t[2]=c,t[3]=h,t[4]=r*h+u*c-e*i,t[5]=u*h+e*o-r*c,t[6]=e*h+r*i-u*o,t[7]=-r*o-u*i-e*c,t}function fn(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t}var ln=Ut;var vn=Ut;function bn(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=a[4],c=a[5],h=a[6],s=a[7],M=n[4],f=n[5],l=n[6],v=n[7],b=a[0],m=a[1],d=a[2],x=a[3];return t[0]=r*x+o*b+u*d-e*m,t[1]=u*x+o*m+e*b-r*d,t[2]=e*x+o*d+r*m-u*b,t[3]=o*x-r*b-u*m-e*d,t[4]=r*s+o*i+u*h-e*c+M*x+v*b+f*d-l*m,t[5]=u*s+o*c+e*i-r*h+f*x+v*m+l*b-M*d,t[6]=e*s+o*h+r*c-u*i+l*x+v*d+M*m-f*b,t[7]=o*s-r*i-u*c-e*h+v*x-M*b-f*m-l*d,t}var mn=bn;var dn=Jt;var xn=$t,pn=xn,yn=nn,qn=yn;var gn=Object.freeze({create:function(){var t=new a(8);return a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},clone:function(t){var n=new a(8);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n},fromValues:function(t,n,r,u,e,o,i,c){var h=new a(8);return h[0]=t,h[1]=n,h[2]=r,h[3]=u,h[4]=e,h[5]=o,h[6]=i,h[7]=c,h},fromRotationTranslationValues:function(t,n,r,u,e,o,i){var c=new a(8);c[0]=t,c[1]=n,c[2]=r,c[3]=u;var h=.5*e,s=.5*o,M=.5*i;return c[4]=h*u+s*r-M*n,c[5]=s*u+M*t-h*r,c[6]=M*u+h*n-s*t,c[7]=-h*t-s*n-M*r,c},fromRotationTranslation:Mn,fromTranslation:function(t,n){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*n[0],t[5]=.5*n[1],t[6]=.5*n[2],t[7]=0,t},fromRotation:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},fromMat4:function(t,n){var r=jt();P(r,n);var u=new a(3);return R(u,n),Mn(t,r,u),t},copy:fn,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},set:function(t,n,a,r,u,e,o,i,c){return t[0]=n,t[1]=a,t[2]=r,t[3]=u,t[4]=e,t[5]=o,t[6]=i,t[7]=c,t},getReal:ln,getDual:function(t,n){return t[0]=n[4],t[1]=n[5],t[2]=n[6],t[3]=n[7],t},setReal:vn,setDual:function(t,n){return t[4]=n[0],t[5]=n[1],t[6]=n[2],t[7]=n[3],t},getTranslation:function(t,n){var a=n[4],r=n[5],u=n[6],e=n[7],o=-n[0],i=-n[1],c=-n[2],h=n[3];return t[0]=2*(a*h+e*o+r*c-u*i),t[1]=2*(r*h+e*i+u*o-a*c),t[2]=2*(u*h+e*c+a*i-r*o),t},translate:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=.5*a[0],c=.5*a[1],h=.5*a[2],s=n[4],M=n[5],f=n[6],l=n[7];return t[0]=r,t[1]=u,t[2]=e,t[3]=o,t[4]=o*i+u*h-e*c+s,t[5]=o*c+e*i-r*h+M,t[6]=o*h+r*c-u*i+f,t[7]=-r*i-u*c-e*h+l,t},rotateX:function(t,n,a){var r=-n[0],u=-n[1],e=-n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=i*o+s*r+c*e-h*u,f=c*o+s*u+h*r-i*e,l=h*o+s*e+i*u-c*r,v=s*o-i*r-c*u-h*e;return Et(t,n,a),r=t[0],u=t[1],e=t[2],o=t[3],t[4]=M*o+v*r+f*e-l*u,t[5]=f*o+v*u+l*r-M*e,t[6]=l*o+v*e+M*u-f*r,t[7]=v*o-M*r-f*u-l*e,t},rotateY:function(t,n,a){var r=-n[0],u=-n[1],e=-n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=i*o+s*r+c*e-h*u,f=c*o+s*u+h*r-i*e,l=h*o+s*e+i*u-c*r,v=s*o-i*r-c*u-h*e;return Ot(t,n,a),r=t[0],u=t[1],e=t[2],o=t[3],t[4]=M*o+v*r+f*e-l*u,t[5]=f*o+v*u+l*r-M*e,t[6]=l*o+v*e+M*u-f*r,t[7]=v*o-M*r-f*u-l*e,t},rotateZ:function(t,n,a){var r=-n[0],u=-n[1],e=-n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=i*o+s*r+c*e-h*u,f=c*o+s*u+h*r-i*e,l=h*o+s*e+i*u-c*r,v=s*o-i*r-c*u-h*e;return Tt(t,n,a),r=t[0],u=t[1],e=t[2],o=t[3],t[4]=M*o+v*r+f*e-l*u,t[5]=f*o+v*u+l*r-M*e,t[6]=l*o+v*e+M*u-f*r,t[7]=v*o-M*r-f*u-l*e,t},rotateByQuatAppend:function(t,n,a){var r=a[0],u=a[1],e=a[2],o=a[3],i=n[0],c=n[1],h=n[2],s=n[3];return t[0]=i*o+s*r+c*e-h*u,t[1]=c*o+s*u+h*r-i*e,t[2]=h*o+s*e+i*u-c*r,t[3]=s*o-i*r-c*u-h*e,i=n[4],c=n[5],h=n[6],s=n[7],t[4]=i*o+s*r+c*e-h*u,t[5]=c*o+s*u+h*r-i*e,t[6]=h*o+s*e+i*u-c*r,t[7]=s*o-i*r-c*u-h*e,t},rotateByQuatPrepend:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=a[0],c=a[1],h=a[2],s=a[3];return t[0]=r*s+o*i+u*h-e*c,t[1]=u*s+o*c+e*i-r*h,t[2]=e*s+o*h+r*c-u*i,t[3]=o*s-r*i-u*c-e*h,i=a[4],c=a[5],h=a[6],s=a[7],t[4]=r*s+o*i+u*h-e*c,t[5]=u*s+o*c+e*i-r*h,t[6]=e*s+o*h+r*c-u*i,t[7]=o*s-r*i-u*c-e*h,t},rotateAroundAxis:function(t,a,r,u){if(Math.abs(u)<n)return fn(t,a);var e=Math.hypot(r[0],r[1],r[2]);u*=.5;var o=Math.sin(u),i=o*r[0]/e,c=o*r[1]/e,h=o*r[2]/e,s=Math.cos(u),M=a[0],f=a[1],l=a[2],v=a[3];t[0]=M*s+v*i+f*h-l*c,t[1]=f*s+v*c+l*i-M*h,t[2]=l*s+v*h+M*c-f*i,t[3]=v*s-M*i-f*c-l*h;var b=a[4],m=a[5],d=a[6],x=a[7];return t[4]=b*s+x*i+m*h-d*c,t[5]=m*s+x*c+d*i-b*h,t[6]=d*s+x*h+b*c-m*i,t[7]=x*s-b*i-m*c-d*h,t},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t[4]=n[4]+a[4],t[5]=n[5]+a[5],t[6]=n[6]+a[6],t[7]=n[7]+a[7],t},multiply:bn,mul:mn,scale:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=n[7]*a,t},dot:dn,lerp:function(t,n,a,r){var u=1-r;return dn(n,a)<0&&(r=-r),t[0]=n[0]*u+a[0]*r,t[1]=n[1]*u+a[1]*r,t[2]=n[2]*u+a[2]*r,t[3]=n[3]*u+a[3]*r,t[4]=n[4]*u+a[4]*r,t[5]=n[5]*u+a[5]*r,t[6]=n[6]*u+a[6]*r,t[7]=n[7]*u+a[7]*r,t},invert:function(t,n){var a=yn(n);return t[0]=-n[0]/a,t[1]=-n[1]/a,t[2]=-n[2]/a,t[3]=n[3]/a,t[4]=-n[4]/a,t[5]=-n[5]/a,t[6]=-n[6]/a,t[7]=n[7]/a,t},conjugate:function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t[4]=-n[4],t[5]=-n[5],t[6]=-n[6],t[7]=n[7],t},length:xn,len:pn,squaredLength:yn,sqrLen:qn,normalize:function(t,n){var a=yn(n);if(a>0){a=Math.sqrt(a);var r=n[0]/a,u=n[1]/a,e=n[2]/a,o=n[3]/a,i=n[4],c=n[5],h=n[6],s=n[7],M=r*i+u*c+e*h+o*s;t[0]=r,t[1]=u,t[2]=e,t[3]=o,t[4]=(i-r*M)/a,t[5]=(c-u*M)/a,t[6]=(h-e*M)/a,t[7]=(s-o*M)/a}return t},str:function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]},equals:function(t,a){var r=t[0],u=t[1],e=t[2],o=t[3],i=t[4],c=t[5],h=t[6],s=t[7],M=a[0],f=a[1],l=a[2],v=a[3],b=a[4],m=a[5],d=a[6],x=a[7];return Math.abs(r-M)<=n*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(u-f)<=n*Math.max(1,Math.abs(u),Math.abs(f))&&Math.abs(e-l)<=n*Math.max(1,Math.abs(e),Math.abs(l))&&Math.abs(o-v)<=n*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(i-b)<=n*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(c-m)<=n*Math.max(1,Math.abs(c),Math.abs(m))&&Math.abs(h-d)<=n*Math.max(1,Math.abs(h),Math.abs(d))&&Math.abs(s-x)<=n*Math.max(1,Math.abs(s),Math.abs(x))}});function An(){var t=new a(2);return a!=Float32Array&&(t[0]=0,t[1]=0),t}function wn(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t}function Rn(t,n,a){return t[0]=n[0]*a[0],t[1]=n[1]*a[1],t}function zn(t,n,a){return t[0]=n[0]/a[0],t[1]=n[1]/a[1],t}function Pn(t,n){var a=n[0]-t[0],r=n[1]-t[1];return Math.hypot(a,r)}function jn(t,n){var a=n[0]-t[0],r=n[1]-t[1];return a*a+r*r}function In(t){var n=t[0],a=t[1];return Math.hypot(n,a)}function Sn(t){var n=t[0],a=t[1];return n*n+a*a}var En=In,On=wn,Tn=Rn,Dn=zn,Fn=Pn,Ln=jn,Vn=Sn,Qn=function(){var t=An();return function(n,a,r,u,e,o){var i,c;for(a||(a=2),r||(r=0),c=u?Math.min(u*a+r,n.length):n.length,i=r;i<c;i+=a)t[0]=n[i],t[1]=n[i+1],e(t,t,o),n[i]=t[0],n[i+1]=t[1];return n}}(),Yn=Object.freeze({create:An,clone:function(t){var n=new a(2);return n[0]=t[0],n[1]=t[1],n},fromValues:function(t,n){var r=new a(2);return r[0]=t,r[1]=n,r},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t},set:function(t,n,a){return t[0]=n,t[1]=a,t},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t},subtract:wn,multiply:Rn,divide:zn,ceil:function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t},floor:function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t},min:function(t,n,a){return t[0]=Math.min(n[0],a[0]),t[1]=Math.min(n[1],a[1]),t},max:function(t,n,a){return t[0]=Math.max(n[0],a[0]),t[1]=Math.max(n[1],a[1]),t},round:function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t},scale:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t},scaleAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t},distance:Pn,squaredDistance:jn,length:In,squaredLength:Sn,negate:function(t,n){return t[0]=-n[0],t[1]=-n[1],t},inverse:function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t},normalize:function(t,n){var a=n[0],r=n[1],u=a*a+r*r;return u>0&&(u=1/Math.sqrt(u)),t[0]=n[0]*u,t[1]=n[1]*u,t},dot:function(t,n){return t[0]*n[0]+t[1]*n[1]},cross:function(t,n,a){var r=n[0]*a[1]-n[1]*a[0];return t[0]=t[1]=0,t[2]=r,t},lerp:function(t,n,a,r){var u=n[0],e=n[1];return t[0]=u+r*(a[0]-u),t[1]=e+r*(a[1]-e),t},random:function(t,n){n=n||1;var a=2*r()*Math.PI;return t[0]=Math.cos(a)*n,t[1]=Math.sin(a)*n,t},transformMat2:function(t,n,a){var r=n[0],u=n[1];return t[0]=a[0]*r+a[2]*u,t[1]=a[1]*r+a[3]*u,t},transformMat2d:function(t,n,a){var r=n[0],u=n[1];return t[0]=a[0]*r+a[2]*u+a[4],t[1]=a[1]*r+a[3]*u+a[5],t},transformMat3:function(t,n,a){var r=n[0],u=n[1];return t[0]=a[0]*r+a[3]*u+a[6],t[1]=a[1]*r+a[4]*u+a[7],t},transformMat4:function(t,n,a){var r=n[0],u=n[1];return t[0]=a[0]*r+a[4]*u+a[12],t[1]=a[1]*r+a[5]*u+a[13],t},rotate:function(t,n,a,r){var u=n[0]-a[0],e=n[1]-a[1],o=Math.sin(r),i=Math.cos(r);return t[0]=u*i-e*o+a[0],t[1]=u*o+e*i+a[1],t},angle:function(t,n){var a=t[0],r=t[1],u=n[0],e=n[1],o=a*a+r*r;o>0&&(o=1/Math.sqrt(o));var i=u*u+e*e;i>0&&(i=1/Math.sqrt(i));var c=(a*u+r*e)*o*i;return c>1?0:c<-1?Math.PI:Math.acos(c)},zero:function(t){return t[0]=0,t[1]=0,t},str:function(t){return"vec2("+t[0]+", "+t[1]+")"},exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]},equals:function(t,a){var r=t[0],u=t[1],e=a[0],o=a[1];return Math.abs(r-e)<=n*Math.max(1,Math.abs(r),Math.abs(e))&&Math.abs(u-o)<=n*Math.max(1,Math.abs(u),Math.abs(o))},len:En,sub:On,mul:Tn,div:Dn,dist:Fn,sqrDist:Ln,sqrLen:Vn,forEach:Qn});t.glMatrix=e,t.mat2=s,t.mat2d=b,t.mat3=q,t.mat4=E,t.quat=sn,t.quat2=gn,t.vec2=Yn,t.vec3=$,t.vec4=Pt,Object.defineProperty(t,"__esModule",{value:!0})});

// ["glMatrix", "mat2", "mat2d", "mat3", "mat4", "quat", "quat2", "vec2", "vec3", "vec4"]
window.glMatrix = glMatrix;
window.mat2 = glMatrix.mat2;
window.mat2d = glMatrix.mat2d;
window.mat3 = glMatrix.mat3;
window.mat4 = glMatrix.mat4;
window.quat = glMatrix.quat;
window.quat2 = glMatrix.quat2;
window.vec2 = glMatrix.vec2;
window.vec3 = glMatrix.vec3;
window.vec4 = glMatrix.vec4;



var CABLES = CABLES || {}; CABLES.build = {"timestamp":1682341866190,"created":"2023-04-24T13:11:06.190Z","git":{"branch":"master","commit":"a8912bdbb85d335fb4b58c228bba4c8be8498ebd","date":"2023-04-24T13:08:49.000Z","message":"fix duplicate ids"}};
if(!CABLES.exportedPatches)CABLES.exportedPatches={};CABLES.exportedPatches["hIpo_u"]={settings:{opExample:[],licence:"none",isPublic:false},ops:[{objName:"Ops.Gl.Shader.CustomShader_v2",id:"0",uiAttribs:{},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat sdArc(vec2 p, float a1, float a2, float ra, float rb) {\n\tfloat amid = 0.5*(a1+a2)+1.6+3.14*step(a1, a2);\n\tfloat alength = 0.5*(a1-a2)-1.6+3.14*step(a1, a2);\n\tvec2 sca = vec2(cos(amid), sin(amid));\n\tvec2 scb = vec2(cos(alength), sin(alength));\n    p *= mat2(vec2(sca.x,sca.y),vec2(-sca.y,sca.x));\n    p.x = abs(p.x);\n    float k = (scb.y*p.x>scb.x*p.y) ? dot(p.xy,scb) : length(p.xy);\n    return sqrt( dot(p,p) + ra*ra - 2.0*ra*k ) - rb;\n}\nvec2 sdLine(vec2 p, vec2 a, vec2 b) {\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp(dot(pa,ba)/dot(ba,ba), 0.0, 1.0);\n    return vec2(length(pa-ba*h), h);\n}\nconst float p_o119967_gradient_0_pos = 0.209090909;\nconst float p_o119967_gradient_0_r = 1.000000000;\nconst float p_o119967_gradient_0_g = 0.000000000;\nconst float p_o119967_gradient_0_b = 0.000000000;\nconst float p_o119967_gradient_0_a = 1.000000000;\nconst float p_o119967_gradient_1_pos = 0.827272727;\nconst float p_o119967_gradient_1_r = 0.000000000;\nconst float p_o119967_gradient_1_g = 0.062500000;\nconst float p_o119967_gradient_1_b = 1.000000000;\nconst float p_o119967_gradient_1_a = 1.000000000;\nvec4 o119967_gradient_gradient_fct(float x) {\n  if (x < p_o119967_gradient_0_pos) {\n    return vec4(p_o119967_gradient_0_r,p_o119967_gradient_0_g,p_o119967_gradient_0_b,p_o119967_gradient_0_a);\n  } else if (x < p_o119967_gradient_1_pos) {\n    return mix(vec4(p_o119967_gradient_0_r,p_o119967_gradient_0_g,p_o119967_gradient_0_b,p_o119967_gradient_0_a), vec4(p_o119967_gradient_1_r,p_o119967_gradient_1_g,p_o119967_gradient_1_b,p_o119967_gradient_1_a), 0.5-0.5*cos(3.14159265359*(x-p_o119967_gradient_0_pos)/(p_o119967_gradient_1_pos-p_o119967_gradient_0_pos)));\n  }\n  return vec4(p_o119967_gradient_1_r,p_o119967_gradient_1_g,p_o119967_gradient_1_b,p_o119967_gradient_1_a);\n}\nconst float p_o47866_radius = 0.980000019;\nconst float p_o36150_d = 0.390000000;\nconst float p_o14099_a1 = 30.000000000;\nconst float p_o14099_a2 = 150.000000000;\nconst float p_o14099_r1 = 0.300000000;\nconst float p_o14099_r2 = 0.100000000;\nconst float p_o20177_ax = -0.300000000;\nconst float p_o20177_ay = -0.300000000;\nconst float p_o20177_bx = 0.270000000;\nconst float p_o20177_by = 0.300000000;\nconst float p_o20177_r = 0.050000000;\nvec2 o44908_input_sdf(vec3 p, float _seed_variation_) {\nvec2 o36150_0_q = vec2(length((p).xy)-p_o36150_d+0.5, (p).z+0.5);\nfloat o14099_0_1_sdf2d = sdArc((o36150_0_q)-vec2(0.5), mod(p_o14099_a1, 360.0)*0.01745329251, mod(p_o14099_a2, 360.0)*0.01745329251, p_o14099_r1, p_o14099_r2);\nvec2 o20177_0_sdl = sdLine((o36150_0_q), vec2(p_o20177_ax+0.5, p_o20177_ay+0.5), vec2(p_o20177_bx+0.5, p_o20177_by+0.5));float o20177_0_1_sdf2d = o20177_0_sdl.x-p_o20177_r*1.0;\nfloat o8300_0_1_sdf2d = mix(o14099_0_1_sdf2d, o20177_0_1_sdf2d, (cos(iTime) * 5.6 * 3.1426));\nfloat o36150_0_1_sdf3d = o8300_0_1_sdf2d;\n\nreturn vec2(o36150_0_1_sdf3d, 0.0);\n}\nvec2 raymarch_o44908(vec2 uv, float _seed_variation_) {\n\tvec3 ro = vec3(uv-vec2(0.5), 1.0);\n\tvec3 rd = vec3(0.0, 0.0, -1.0);\n\tfloat dO = 0.0;\n\tfloat c = 0.0;\n    for (int i=0; i < 100; i++) {\n    \tvec3 p = ro + rd*dO;\n        vec2 dS = o44908_input_sdf(p, _seed_variation_);\n        dO += dS.x;\n\n        if (dO >= 1.0) {\n\t\t\tbreak;\n\t\t} else if (dS.x < 0.0001) {\n\t\t\tc = dS.y;\n\t\t\tbreak;\n\t\t}\n    }\n    \n    return vec2(dO, c);\n}\n\nvec3 normal_o44908(vec3 p, float _seed_variation_) {\n\tif (p.z <= 0.0) {\n\t\treturn vec3(0.0, 0.0, 1.0);\n\t}\n\n\tfloat d = o44908_input_sdf(p, _seed_variation_).x;\n    float e = .001;\n    \n    vec3 n = d - vec3(\n        o44908_input_sdf(p-vec3(e, 0.0, 0.0), _seed_variation_).x,\n        o44908_input_sdf(p-vec3(0.0, e, 0.0), _seed_variation_).x,\n        o44908_input_sdf(p-vec3(0.0, 0.0, e), _seed_variation_).x);\n    \n    return vec3(-1.0, -1.0, -1.0)*normalize(n);\n}\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nvec2 o44908_0_d = raymarch_o44908((vec2(fract((tan(iTime))*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o47866_radius*length((UV)-vec2(0.5))))), _seed_variation_);\nvec3 o44908_1_1_rgb = vec3(0.5)+0.5*normal_o44908(vec3((vec2(fract((tan(iTime))*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o47866_radius*length((UV)-vec2(0.5)))))-vec2(0.5), 1.0-o44908_0_d.x), _seed_variation_);\nvec4 o47866_0_1_rgba = vec4(o44908_1_1_rgb, 1.0);\nvec4 o119967_0_1_rgba = o119967_gradient_gradient_fct((dot((o47866_0_1_rgba).rgb, vec3(1.0))/3.0));\ngl_FragColor = o119967_0_1_rgba;\n}\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"1",objOut:"0"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"1",objOut:"0"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"1",uiAttribs:{},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"mirrored repeat"},{name:"Floating Point",value:true},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",value:0},{name:"Texture"},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Sequence",id:"2",uiAttribs:{},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"0",objOut:"2"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Ui.VizTexture",id:"3",uiAttribs:{},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"4",objOut:"3"},{portIn:"Base Texture",portOut:"Texture Out",objIn:"21",objOut:"3"}]},{name:"Info",value:"640x709 8bit linear repeat"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"4",uiAttribs:{},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"9",objOut:"4"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v2",id:"5",uiAttribs:{},portsIn:[{name:"Render"},{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"2",objOut:"5"},{portIn:"Execute",portOut:"Next",objIn:"478",objOut:"5"}]},{name:"texture_out",links:[{portIn:"Base Texture",portOut:"texture_out",objIn:"12",objOut:"5"}]},{name:"Aspect Ratio",value:.9026798307475318}]},{objName:"Ops.Gl.Meshes.Rectangle_v2",id:"6",uiAttribs:{},portsIn:[{name:"render",value:null},{name:"width",value:1},{name:"height",value:1},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"num columns",value:1},{name:"num rows",value:1},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Active",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.GradientTexture",id:"7",uiAttribs:{},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":8.881784197001252e-16,"g":0,"b":1},{"pos":0.02,"r":8.881784197001252e-16,"g":0,"b":1},{"pos":0.21,"r":1,"g":0,"b":0},{"pos":0.488,"r":0.7520159698207888,"g":0.2980955505283348,"b":0.7255181847110971},{"pos":1,"r":0.7520159698207888,"g":0.2980955505283348,"b":0.7255181847110971}]}'},{name:"Direction index",value:0},{name:"Direction",value:"X"},{name:"Smoothstep",value:false},{name:"Step",value:false},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:256},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Gradient Array",value:0},{name:"Randomize Colors",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Mask",portOut:"Texture",objIn:"9",objOut:"7"}]},{name:"Colors"},{name:"Colors Pos"}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"8",uiAttribs:{},portsIn:[{name:"render",value:0},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat box(vec2 uv, vec3 center, vec3 rad, vec3 rot) {\n\tvec3 ro = vec3(uv, 1.0)-center;\n\tvec3 rd = vec3(0.0000001, 0.0000001, -1.0);\n\tmat3 r = mat3(vec3(1, 0, 0), vec3(0, cos(rot.x), -sin(rot.x)), vec3(0, sin(rot.x), cos(rot.x)));\n\tr *= mat3(vec3(cos(rot.y), 0, -sin(rot.y)), vec3(0, 1, 0), vec3(sin(rot.y), 0, cos(rot.y)));\n\tr *= mat3(vec3(cos(rot.z), -sin(rot.z), 0), vec3(sin(rot.z), cos(rot.z), 0), vec3(0, 0, 1));\n\tro = r * ro;\n\trd = r * rd;\n    vec3 m = 1.0/rd;\n    vec3 n = m*ro;\n    vec3 k = abs(m)*rad;\n    vec3 t1 = -n - k;\n    vec3 t2 = -n + k;\n\n    float tN = max(max(t1.x, t1.y), t1.z);\n    float tF = min(min(t2.x, t2.y), t2.z);\n    if(tN>tF || tF<0.0) return 1.0;\n    return tN;\n}float sphere(vec2 uv, vec2 c, float r) {\n\tuv -= c;\n\tuv /= r;\n\treturn 2.0*r*sqrt(max(0.0, 1.0-dot(uv, uv)));\n}\nvec3 blend_normal(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1 + (1.0-opacity)*c2;\n}\n\nvec3 blend_dissolve(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\tif (rand(uv) < opacity) {\n\t\treturn c1;\n\t} else {\n\t\treturn c2;\n\t}\n}\n\nvec3 blend_multiply(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1*c2 + (1.0-opacity)*c2;\n}\n\nvec3 blend_screen(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*(1.0-(1.0-c1)*(1.0-c2)) + (1.0-opacity)*c2;\n}\n\nfloat blend_overlay_f(float c1, float c2) {\n\treturn (c1 < 0.5) ? (2.0*c1*c2) : (1.0-2.0*(1.0-c1)*(1.0-c2));\n}\n\nvec3 blend_overlay(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_overlay_f(c1.x, c2.x), blend_overlay_f(c1.y, c2.y), blend_overlay_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_hard_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*0.5*(c1*c2+blend_overlay(uv, c1, c2, 1.0)) + (1.0-opacity)*c2;\n}\n\nfloat blend_soft_light_f(float c1, float c2) {\n\treturn (c2 < 0.5) ? (2.0*c1*c2+c1*c1*(1.0-2.0*c2)) : 2.0*c1*(1.0-c2)+sqrt(c1)*(2.0*c2-1.0);\n}\n\nvec3 blend_soft_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_soft_light_f(c1.x, c2.x), blend_soft_light_f(c1.y, c2.y), blend_soft_light_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_burn_f(float c1, float c2) {\n\treturn (c1==0.0)?c1:max((1.0-((1.0-c2)/c1)),0.0);\n}\n\nvec3 blend_burn(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_burn_f(c1.x, c2.x), blend_burn_f(c1.y, c2.y), blend_burn_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_dodge_f(float c1, float c2) {\n\treturn (c1==1.0)?c1:min(c2/(1.0-c1),1.0);\n}\n\nvec3 blend_dodge(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_dodge_f(c1.x, c2.x), blend_dodge_f(c1.y, c2.y), blend_dodge_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_lighten(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*max(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_darken(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*min(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_difference(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*clamp(c2-c1, vec3(0.0), vec3(1.0)) + (1.0-opacity)*c2;\n}\nconst float p_o419741_gradient_0_pos = 0.000000000;\nconst float p_o419741_gradient_0_r = 1.000000000;\nconst float p_o419741_gradient_0_g = 0.000000000;\nconst float p_o419741_gradient_0_b = 0.000000000;\nconst float p_o419741_gradient_0_a = 1.000000000;\nconst float p_o419741_gradient_1_pos = 0.144273793;\nconst float p_o419741_gradient_1_r = 1.000000000;\nconst float p_o419741_gradient_1_g = 0.968750000;\nconst float p_o419741_gradient_1_b = 0.000000000;\nconst float p_o419741_gradient_1_a = 1.000000000;\nconst float p_o419741_gradient_2_pos = 0.274273404;\nconst float p_o419741_gradient_2_r = 1.000000000;\nconst float p_o419741_gradient_2_g = 0.000000000;\nconst float p_o419741_gradient_2_b = 0.000000000;\nconst float p_o419741_gradient_2_a = 1.000000000;\nconst float p_o419741_gradient_3_pos = 0.414273349;\nconst float p_o419741_gradient_3_r = 0.843750000;\nconst float p_o419741_gradient_3_g = 0.000000000;\nconst float p_o419741_gradient_3_b = 1.000000000;\nconst float p_o419741_gradient_3_a = 1.000000000;\nconst float p_o419741_gradient_4_pos = 0.854273571;\nconst float p_o419741_gradient_4_r = 0.000000000;\nconst float p_o419741_gradient_4_g = 0.062500000;\nconst float p_o419741_gradient_4_b = 1.000000000;\nconst float p_o419741_gradient_4_a = 1.000000000;\nvec4 o419741_gradient_gradient_fct(float x) {\n  if (x < p_o419741_gradient_0_pos) {\n    return vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a);\n  } else if (x < p_o419741_gradient_1_pos) {\n    return mix(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)), mix(vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a), vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), (x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos)), 1.0-0.5*(x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos));\n  } else if (x < p_o419741_gradient_2_pos) {\n    return 0.5*(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)) + mix(mix(vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a), vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), (x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos)), mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)), 0.5-0.5*cos(3.14159265359*(x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos))));\n  } else if (x < p_o419741_gradient_3_pos) {\n    return 0.5*(mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)) + mix(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)), mix(vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a), (x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos)), 0.5-0.5*cos(3.14159265359*(x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos))));\n  } else if (x < p_o419741_gradient_4_pos) {\n    return mix(mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)), mix(vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a), (x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos)), 0.5+0.5*(x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos));\n  }\n  return vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a);\n}\nconst float p_o398645_amount = 11.760000000;\nconst float p_o479214_gradient_0_pos = 0.025183105;\nconst float p_o479214_gradient_0_r = 1.000000000;\nconst float p_o479214_gradient_0_g = 0.000000000;\nconst float p_o479214_gradient_0_b = 0.000000000;\nconst float p_o479214_gradient_0_a = 1.000000000;\nconst float p_o479214_gradient_1_pos = 0.435182884;\nconst float p_o479214_gradient_1_r = 1.000000000;\nconst float p_o479214_gradient_1_g = 0.968750000;\nconst float p_o479214_gradient_1_b = 0.000000000;\nconst float p_o479214_gradient_1_a = 1.000000000;\nconst float p_o479214_gradient_2_pos = 0.590909368;\nconst float p_o479214_gradient_2_r = 0.000000000;\nconst float p_o479214_gradient_2_g = 1.000000000;\nconst float p_o479214_gradient_2_b = 0.125000000;\nconst float p_o479214_gradient_2_a = 1.000000000;\nconst float p_o479214_gradient_3_pos = 0.915182218;\nconst float p_o479214_gradient_3_r = 0.000000000;\nconst float p_o479214_gradient_3_g = 0.062500000;\nconst float p_o479214_gradient_3_b = 1.000000000;\nconst float p_o479214_gradient_3_a = 1.000000000;\nvec4 o479214_gradient_gradient_fct(float x) {\n  if (x < p_o479214_gradient_0_pos) {\n    return vec4(p_o479214_gradient_0_r,p_o479214_gradient_0_g,p_o479214_gradient_0_b,p_o479214_gradient_0_a);\n  } else if (x < p_o479214_gradient_1_pos) {\n    return mix(vec4(p_o479214_gradient_0_r,p_o479214_gradient_0_g,p_o479214_gradient_0_b,p_o479214_gradient_0_a), vec4(p_o479214_gradient_1_r,p_o479214_gradient_1_g,p_o479214_gradient_1_b,p_o479214_gradient_1_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_0_pos)/(p_o479214_gradient_1_pos-p_o479214_gradient_0_pos)));\n  } else if (x < p_o479214_gradient_2_pos) {\n    return mix(vec4(p_o479214_gradient_1_r,p_o479214_gradient_1_g,p_o479214_gradient_1_b,p_o479214_gradient_1_a), vec4(p_o479214_gradient_2_r,p_o479214_gradient_2_g,p_o479214_gradient_2_b,p_o479214_gradient_2_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_1_pos)/(p_o479214_gradient_2_pos-p_o479214_gradient_1_pos)));\n  } else if (x < p_o479214_gradient_3_pos) {\n    return mix(vec4(p_o479214_gradient_2_r,p_o479214_gradient_2_g,p_o479214_gradient_2_b,p_o479214_gradient_2_a), vec4(p_o479214_gradient_3_r,p_o479214_gradient_3_g,p_o479214_gradient_3_b,p_o479214_gradient_3_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_2_pos)/(p_o479214_gradient_3_pos-p_o479214_gradient_2_pos)));\n  }\n  return vec4(p_o479214_gradient_3_r,p_o479214_gradient_3_g,p_o479214_gradient_3_b,p_o479214_gradient_3_a);\n}\nconst float p_o520101_repeat = 6.000000000;\nconst float p_o270325_cx = 0.500000000;\nconst float p_o270325_cy = 0.500000000;\nconst float p_o270325_cz = 0.500000000;\nconst float p_o270325_sx = 0.250000000;\nconst float p_o270325_sy = 0.250000000;\nconst float p_o270325_sz = 0.250000000;\nconst float p_o270325_ry = 2.000000000;\nconst float p_o207924_d = 0.710000000;\nconst float p_o553530_radius = 0.320000000;\nconst float p_o553530_repeat = 5.000000000;\nconst float p_o57201_cx = 0.500000000;\nconst float p_o57201_cy = 0.710000000;\nconst float p_o254341_r = 0.500000000;\n\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o270325_0_1_f = 1.0-box((vec2(fract(p_o520101_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/(cos(iTime*0.001))*length((UV)-vec2(0.5))))), vec3(p_o270325_cx, p_o270325_cy, p_o270325_cz), vec3(p_o270325_sx, p_o270325_sy, p_o270325_sz), 0.01745329251*vec3((sin(iTime*0.9)*sin(iTime*0.9)), p_o270325_ry, (sin(iTime*0.9)*sin(iTime*0.9)*abs(iTime))));\nvec4 o520101_0_1_rgba = vec4(vec3(o270325_0_1_f), 1.0);\nvec4 o479214_0_1_rgba = o479214_gradient_gradient_fct((dot((o520101_0_1_rgba).rgb, vec3(1.0))/3.0));\nfloat o57201_0_1_f = sphere((vec2(fract(p_o553530_repeat*atan(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5)).y-0.5, ((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o553530_radius*length(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5))-vec2(0.5))))), vec2(p_o57201_cx, p_o57201_cy), (sin(iTime*0.2)*sin(iTime*0.9)));\nvec4 o553530_0_1_rgba = vec4(vec3(o57201_0_1_f), 1.0);\nvec3 o241986_0_1_tex3d = ((o553530_0_1_rgba).rgb);\nvec2 o254341_0_q = vec2(length(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xyz).xy)-(sin(iTime*0.2)),((vec4(((o479214_0_1_rgba).rgb), 0.0)).xyz).z);\nfloat o254341_0_1_sdf3d = length(o254341_0_q)-p_o254341_r;\nvec3 o207924_0_1_tex3d = mix(o241986_0_1_tex3d, vec3(0.5), clamp(o254341_0_1_sdf3d/max(p_o207924_d, 0.0001), 0.0, 1.0));\nvec3 o245261_0_1_rgb = o207924_0_1_tex3d;\nvec3 o241986_0_3_tex3d = ((o553530_0_1_rgba).rgb);\nvec3 o818931_0_1_rgb = o241986_0_3_tex3d;\nfloat o57201_0_3_f = sphere((vec2(fract(p_o553530_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o553530_radius*length((UV)-vec2(0.5))))), vec2(p_o57201_cx, p_o57201_cy), (sin(iTime*0.2)*sin(iTime*0.9)));\nvec4 o553530_0_3_rgba = vec4(vec3(o57201_0_3_f), 1.0);\nvec4 o398645_0_s1 = vec4(o245261_0_1_rgb, 1.0);\nvec4 o398645_0_s2 = vec4(o818931_0_1_rgb, 1.0);\nfloat o398645_0_a = p_o398645_amount*(dot((o553530_0_3_rgba).rgb, vec3(1.0))/3.0);\nvec4 o398645_0_1_rgba = vec4(blend_soft_light((UV), o398645_0_s1.rgb, o398645_0_s2.rgb, o398645_0_a*o398645_0_s1.a), min(1.0, o398645_0_s2.a+o398645_0_a*o398645_0_s1.a));\nvec4 o419741_0_1_rgba = o419741_gradient_gradient_fct((dot((o398645_0_1_rgba).rgb, vec3(1.0))/3.0));\ngl_FragColor = o419741_0_1_rgba;\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime",value:0}],portsOut:[{name:"trigger",value:0},{name:"Shader"},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.TextureEffects.ChromaticAberration",id:"9",uiAttribs:{},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"add"},{name:"Amount",value:.716},{name:"Pixel",value:5.01},{name:"Lens Distort",value:.762},{name:"Smooth",value:false},{name:"Mask"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"10",uiAttribs:{},portsIn:[{name:"render",value:0},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat shape_circle(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float distance = length(uv);\n    return clamp((1.0-distance/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_polygon(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y)+3.14159265359;\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(0.5+angle/slice)*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(angle*sides/6.28318530718-0.5+2.0*step(fract(angle*sides/6.28318530718), 0.5))*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_curved_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = 2.0*(atan(uv.x, uv.y)+3.14159265359);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-cos(floor(0.5+0.5*angle/slice)*2.0*slice-angle)*length(uv)/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_rays(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = 0.5*max(edge, 1.0e-8)*size;\n\tfloat slice = 6.28318530718/sides;\n    float angle = mod(atan(uv.x, uv.y)+3.14159265359, slice)/slice;\n    return clamp(min((size-angle)/edge, angle/edge), 0.0, 1.0);\n}\n\nvec2 rotate(vec2 uv, vec2 center, float rotate) {\n \tvec2 rv;\n\tuv -= center;\n\trv.x = cos(rotate)*uv.x + sin(rotate)*uv.y;\n\trv.y = -sin(rotate)*uv.x + cos(rotate)*uv.y;\n\trv += center;\n    return rv;\t\n}const float p_o370586_cx = 0.000000000;\nconst float p_o370586_cy = 0.000000000;\nconst float p_o265706_gradient_0_pos = 0.000000000;\nconst float p_o265706_gradient_0_r = 1.000000000;\nconst float p_o265706_gradient_0_g = 0.000000000;\nconst float p_o265706_gradient_0_b = 0.000000000;\nconst float p_o265706_gradient_0_a = 1.000000000;\nconst float p_o265706_gradient_1_pos = 0.399003462;\nconst float p_o265706_gradient_1_r = 0.035911076;\nconst float p_o265706_gradient_1_g = 0.145327628;\nconst float p_o265706_gradient_1_b = 0.574577212;\nconst float p_o265706_gradient_1_a = 1.000000000;\nconst float p_o265706_gradient_2_pos = 0.662364613;\nconst float p_o265706_gradient_2_r = 0.098464966;\nconst float p_o265706_gradient_2_g = 0.185065985;\nconst float p_o265706_gradient_2_b = 0.933593750;\nconst float p_o265706_gradient_2_a = 1.000000000;\nconst float p_o265706_gradient_3_pos = 1.000000000;\nconst float p_o265706_gradient_3_r = 0.000000000;\nconst float p_o265706_gradient_3_g = 0.062500000;\nconst float p_o265706_gradient_3_b = 1.000000000;\nconst float p_o265706_gradient_3_a = 1.000000000;\nvec4 o265706_gradient_gradient_fct(float x) {\n  if (x < p_o265706_gradient_0_pos) {\n    return vec4(p_o265706_gradient_0_r,p_o265706_gradient_0_g,p_o265706_gradient_0_b,p_o265706_gradient_0_a);\n  } else if (x < p_o265706_gradient_1_pos) {\n    return mix(vec4(p_o265706_gradient_0_r,p_o265706_gradient_0_g,p_o265706_gradient_0_b,p_o265706_gradient_0_a), vec4(p_o265706_gradient_1_r,p_o265706_gradient_1_g,p_o265706_gradient_1_b,p_o265706_gradient_1_a), ((x-p_o265706_gradient_0_pos)/(p_o265706_gradient_1_pos-p_o265706_gradient_0_pos)));\n  } else if (x < p_o265706_gradient_2_pos) {\n    return mix(vec4(p_o265706_gradient_1_r,p_o265706_gradient_1_g,p_o265706_gradient_1_b,p_o265706_gradient_1_a), vec4(p_o265706_gradient_2_r,p_o265706_gradient_2_g,p_o265706_gradient_2_b,p_o265706_gradient_2_a), ((x-p_o265706_gradient_1_pos)/(p_o265706_gradient_2_pos-p_o265706_gradient_1_pos)));\n  } else if (x < p_o265706_gradient_3_pos) {\n    return mix(vec4(p_o265706_gradient_2_r,p_o265706_gradient_2_g,p_o265706_gradient_2_b,p_o265706_gradient_2_a), vec4(p_o265706_gradient_3_r,p_o265706_gradient_3_g,p_o265706_gradient_3_b,p_o265706_gradient_3_a), ((x-p_o265706_gradient_2_pos)/(p_o265706_gradient_3_pos-p_o265706_gradient_2_pos)));\n  }\n  return vec4(p_o265706_gradient_3_r,p_o265706_gradient_3_g,p_o265706_gradient_3_b,p_o265706_gradient_3_a);\n}\nconst float p_o27497_radius = 1.000000000;\nconst float p_o27497_repeat = 7.000000000;\nconst float p_o22106_radius = 1.000000000;\nconst float p_o22106_repeat = 1.000000000;\nconst float p_o15531_radius = 1.500000000;\nconst float p_o15531_repeat = 1.000000000;\nconst float p_o35637_cx = 0.000000000;\nconst float p_o9383_sides = 5.000000000;\nconst float p_o9383_radius = 0.640000000;\nconst float p_o9383_edge = 0.500000000;\nvec3 o559231_input_in(vec2 uv, float _seed_variation_) {\nfloat o9383_0_1_f = shape_polygon((rotate((vec2(fract(p_o15531_repeat*atan((vec2(fract(p_o22106_repeat*atan((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o22106_radius*length((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5))))).y-0.5, (vec2(fract(p_o22106_repeat*atan((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o22106_radius*length((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o15531_radius*length((vec2(fract(p_o22106_repeat*atan((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o22106_radius*length((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5)))))-vec2(0.5))))), vec2(0.5+p_o35637_cx, 0.5+(sin(iTime * 0.009) * (iTime * 0.0005))), (sin(iTime * 0.05) * (iTime))*0.01745329251)), p_o9383_sides, p_o9383_radius*1.0, p_o9383_edge*1.0);\nvec4 o35637_0_1_rgba = vec4(vec3(o9383_0_1_f), 1.0);\nvec4 o15531_0_1_rgba = o35637_0_1_rgba;\nvec4 o22106_0_1_rgba = o15531_0_1_rgba;\nvec4 o27497_0_1_rgba = o22106_0_1_rgba;\nvec4 o265706_0_1_rgba = o265706_gradient_gradient_fct((dot((o27497_0_1_rgba).rgb, vec3(1.0))/3.0));\nvec4 o370586_0_1_rgba = o265706_0_1_rgba;\n\nreturn ((o370586_0_1_rgba).rgb);\n}\nfloat o559231_fct(vec2 uv, float _seed_variation_) {\n\tvec2 e = vec2(1.0/512.000000000, -1.0/512.000000000);\n\tvec3 rv = 4.0*o559231_input_in(uv, _seed_variation_);\n\trv -= o559231_input_in(uv+e.xy, _seed_variation_);\n\trv -= o559231_input_in(uv-e.xy, _seed_variation_);\n\trv -= o559231_input_in(uv+e.xx, _seed_variation_);\n\trv -= o559231_input_in(uv-e.xx, _seed_variation_);\n\trv = abs(rv);\n\treturn max(rv.x, max(rv.y ,rv.z))*512.000000000;\n}\n\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o559231_0_1_f = clamp(o559231_fct((UV), _seed_variation_), 0.0, 1.0);\ngl_FragColor = vec4(vec3(o559231_0_1_f), 1.0);\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime",value:0}],portsOut:[{name:"trigger",value:0},{name:"Shader"},{name:"Has Errors",value:false}]},{objName:"Ops.Sequence",id:"11",uiAttribs:{},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"Render",portOut:"trigger 0",objIn:"5",objOut:"11"},{portIn:"exe",portOut:"trigger 0",objIn:"44",objOut:"11"}]},{name:"trigger 1",links:[{portIn:"Render",portOut:"trigger 1",objIn:"12",objOut:"11"},{portIn:"exe",portOut:"trigger 1",objIn:"55",objOut:"11"}]},{name:"trigger 2",links:[{portIn:"Render",portOut:"trigger 2",objIn:"14",objOut:"11"}]},{name:"trigger 3",links:[{portIn:"Render",portOut:"trigger 3",objIn:"21",objOut:"11"}]},{name:"trigger 4",links:[{portIn:"exe",portOut:"trigger 4",objIn:"299",objOut:"11"}]},{name:"trigger 5",links:[{portIn:"Render",portOut:"trigger 5",objIn:"26",objOut:"11"}]},{name:"trigger 6",links:[{portIn:"Render",portOut:"trigger 6",objIn:"33",objOut:"11"}]},{name:"trigger 7",links:[{portIn:"exe",portOut:"trigger 7",objIn:"54",objOut:"11"}]},{name:"trigger 8",links:[{portIn:"render",portOut:"trigger 8",objIn:"273",objOut:"11"}]},{name:"trigger 9",value:0},{name:"trigger 10",links:[{portIn:"Render",portOut:"trigger 10",objIn:"39",objOut:"11"}]},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"12",uiAttribs:{},portsIn:[{name:"Render"},{name:"Base Texture"},{name:"Size index",value:0},{name:"Size",value:"Auto"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 8bit ubyte"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",links:[{portIn:"Execute",portOut:"Next",objIn:"17",objOut:"12"}]},{name:"texture_out",links:[{portIn:"Texture In",portOut:"texture_out",objIn:"13",objOut:"12"}]},{name:"Aspect Ratio",value:.9026798307475318},{name:"Texture Width",value:640},{name:"Texture Height",value:709}]},{objName:"Ops.Ui.VizTexture",id:"13",uiAttribs:{},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"15",objOut:"13"}]},{name:"Info",value:"640x709 8bit linear repeat"}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"14",uiAttribs:{},portsIn:[{name:"Render"},{name:"Base Texture",value:0},{name:"Size index",value:0},{name:"Size",value:"Manual"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 32bit float"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"19",objOut:"14"}]},{name:"texture_out",links:[{portIn:"Texture In",portOut:"texture_out",objIn:"16",objOut:"14"}]},{name:"Aspect Ratio",value:1.3333333333333333},{name:"Texture Width",value:640},{name:"Texture Height",value:480}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"15",uiAttribs:{},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"color burn"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"18",objOut:"15"}]}]},{objName:"Ops.Ui.VizTexture",id:"16",uiAttribs:{},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"28",objOut:"16"}]},{name:"Info",value:"640x480 32bit linear repeat"}]},{objName:"Ops.Gl.ColorMask",id:"17",uiAttribs:{},portsIn:[{name:"Execute"},{name:"Red",value:false},{name:"Green",value:false},{name:"Blue",value:true},{name:"Alpha",value:false}],portsOut:[{name:"Next",value:0}]},{objName:"Ops.Gl.TextureEffects.ColorChannel_v2",id:"18",uiAttribs:{},portsIn:[{name:"render"},{name:"channelR",value:false},{name:"channelG",value:false},{name:"channelB",value:true},{name:"channelA",value:false},{name:"mono",value:false}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.TextureEffects.ColorBalance_v2",id:"19",uiAttribs:{},portsIn:[{name:"render"},{name:"Tone index",value:0},{name:"Tone",value:"Shadows"},{name:"r",value:0},{name:"g",value:0},{name:"b",value:8.05}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"15",objOut:"19"}]}]},{objName:"Ops.Anim.Timer_v2",id:"20",uiAttribs:{},portsIn:[{name:"Speed",value:1},{name:"Play",value:true},{name:"Reset",value:0},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"iTime",portOut:"Time",objIn:"0",objOut:"20"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"21",uiAttribs:{},portsIn:[{name:"Render"},{name:"Base Texture"},{name:"Size index",value:0},{name:"Size",value:"Manual"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 32bit float"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"22",objOut:"21"}]},{name:"texture_out",links:[{portIn:"Texture In",portOut:"texture_out",objIn:"24",objOut:"21"}]},{name:"Aspect Ratio",value:1.3333333333333333},{name:"Texture Width",value:640},{name:"Texture Height",value:480}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"22",uiAttribs:{},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"color dodge"},{name:"amount",value:1},{name:"Image",value:0},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"23",objOut:"22"}]}]},{objName:"Ops.Gl.TextureEffects.ColorChannel_v2",id:"23",uiAttribs:{},portsIn:[{name:"render"},{name:"channelR",value:true},{name:"channelG",value:false},{name:"channelB",value:false},{name:"channelA",value:false},{name:"mono",value:false}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Ui.VizTexture",id:"24",uiAttribs:{},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"25",objOut:"24"}]},{name:"Info",value:"640x480 32bit linear repeat"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"25",uiAttribs:{},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount"},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"28",objOut:"25"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"26",uiAttribs:{},portsIn:[{name:"Render"},{name:"Base Texture",value:0},{name:"Size index",value:0},{name:"Size",value:"Auto"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 8bit ubyte"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"25",objOut:"26"},{portIn:"render",portOut:"Next",objIn:"40",objOut:"26"}]},{name:"texture_out",links:[{portIn:"Base Texture",portOut:"texture_out",objIn:"33",objOut:"26"},{portIn:"Base Texture",portOut:"texture_out",objIn:"39",objOut:"26"}]},{name:"Aspect Ratio",value:.9026798307475318},{name:"Texture Width",value:640},{name:"Texture Height",value:709}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"27",uiAttribs:{},portsIn:[{name:"render"},{name:"Scale index",value:1},{name:"Scale",value:"Fit"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"308",objOut:"27"}]}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"28",uiAttribs:{},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount"},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Sidebar.Sidebar",id:"29",uiAttribs:{},portsIn:[{name:"Visible",value:true},{name:"Opacity",value:1},{name:"Default Minimized",value:false},{name:"Minimized Opacity",value:.5},{name:"Show undo button",value:false},{name:"Show Minimize",value:false},{name:"Title",value:"Sidebar"},{name:"Side",value:false}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"42",objOut:"29"},{portIn:"link",portOut:"childs",objIn:"30",objOut:"29"},{portIn:"link",portOut:"childs",objIn:"62",objOut:"29"},{portIn:"link",portOut:"childs",objIn:"66",objOut:"29"},{portIn:"link",portOut:"childs",objIn:"294",objOut:"29"},{portIn:"link",portOut:"childs",objIn:"306",objOut:"29"},{portIn:"link",portOut:"childs",objIn:"86",objOut:"29"}]},{name:"Opfened",value:false}]},{objName:"Ops.Sidebar.Slider_v3",id:"30",uiAttribs:{},portsIn:[{name:"link"},{name:"Text",value:'Slider "First Last" and "Cut-Play" "-0.95 | -0.70" and <0 "Newly toggled"'},{name:"Min",value:-1},{name:"Max",value:1},{name:"Step",value:1e-5},{name:"Suffix",value:""},{name:"Grey Out",value:false},{name:"Visible",value:true},{name:"Input"},{name:"Set Default",value:0},{name:"Reset",value:0},{name:"Default",value:.5}],portsOut:[{name:"childs"},{name:"Result",links:[{portIn:"val",portOut:"Result",objIn:"298",objOut:"30"},{portIn:"value",portOut:"Result",objIn:"297",objOut:"30"}]}]},{objName:"Ops.Math.FlipSign",id:"31",uiAttribs:{},portsIn:[{name:"Value"}],portsOut:[{name:"Result",links:[{portIn:"amount",portOut:"Result",objIn:"28",objOut:"31"},{portIn:"amount",portOut:"Result",objIn:"35",objOut:"31"}]}]},{objName:"Ops.Math.Clamp",id:"32",uiAttribs:{},portsIn:[{name:"val"},{name:"min",value:-1},{name:"max",value:0},{name:"ignore outside values",value:false}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"31",objOut:"32"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"33",uiAttribs:{},portsIn:[{name:"Render"},{name:"Base Texture"},{name:"Size index",value:0},{name:"Size",value:"Auto"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 8bit ubyte"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"34",objOut:"33"}]},{name:"texture_out",links:[{portIn:"Texture In",portOut:"texture_out",objIn:"36",objOut:"33"},{portIn:"Image",portOut:"texture_out",objIn:"37",objOut:"33"},{portIn:"Mask",portOut:"texture_out",objIn:"37",objOut:"33"},{portIn:"Texture In",portOut:"texture_out",objIn:"38",objOut:"33"}]},{name:"Aspect Ratio",value:.9026798307475318},{name:"Texture Width",value:640},{name:"Texture Height",value:709}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"34",uiAttribs:{},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount"},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"35",objOut:"34"}]}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"35",uiAttribs:{},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount"},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Ui.VizTexture",id:"36",uiAttribs:{},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out"},{name:"Info",value:"640x709 8bit linear repeat"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"37",uiAttribs:{},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"darken"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask"},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Ui.VizTexture",id:"38",uiAttribs:{},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out"},{name:"Info",value:"640x709 8bit linear repeat"}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"39",uiAttribs:{},portsIn:[{name:"Render"},{name:"Base Texture"},{name:"Size index",value:0},{name:"Size",value:"Auto"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 8bit ubyte"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"37",objOut:"39"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"27",objOut:"39"}]},{name:"Aspect Ratio",value:.9026798307475318},{name:"Texture Width",value:640},{name:"Texture Height",value:709}]},{objName:"Ops.Gl.TextureEffects.LumaKey_v2",id:"40",uiAttribs:{},portsIn:[{name:"render"},{name:"Invert",value:false},{name:"Black White",value:true},{name:"Threshold low ",value:.041},{name:"Threshold high",value:.387}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.MainLoop",id:"41",uiAttribs:{},portsIn:[{name:"FPS Limit",value:0},{name:"Reduce FPS not focussed",value:true},{name:"Reduce FPS loading",value:false},{name:"Clear",value:true},{name:"ClearAlpha",value:true},{name:"Fullscreen Button",value:false},{name:"Active",value:true},{name:"Hires Displays",value:false},{name:"Pixel Unit index",value:0},{name:"Pixel Unit",value:"Display"}],portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"11",objOut:"41"},{portIn:"render",portOut:"trigger",objIn:"313",objOut:"41"}]},{name:"width",value:640},{name:"height",value:709}]},{objName:"Ops.Sidebar.Slider_v3",id:"42",uiAttribs:{},portsIn:[{name:"link"},{name:"Text",value:"Wipe >0.2 T:5sec <0.2 ∞"},{name:"Min",value:0},{name:"Max",value:1},{name:"Step",value:1e-5},{name:"Suffix",value:""},{name:"Grey Out",value:false},{name:"Visible",value:true},{name:"Input",value:.70019},{name:"Set Default",value:0},{name:"Reset",value:0},{name:"Default",value:.5}],portsOut:[{name:"childs"},{name:"Result",links:[{portIn:"val",portOut:"Result",objIn:"49",objOut:"42"},{portIn:"Boolean",portOut:"Result",objIn:"48",objOut:"42"}]}]},{objName:"Ops.Anim.AnimNumber",id:"43",uiAttribs:{},portsIn:[{name:"exe"},{name:"Value"},{name:"duration",value:5},{name:"easing index",value:0},{name:"easing",value:"linear"}],portsOut:[{name:"Next",value:0},{name:"result",value:.70019},{name:"Finished",links:[{portIn:"Trigger",portOut:"Finished",objIn:"52",objOut:"43"}]}]},{objName:"Ops.Sequence",id:"44",uiAttribs:{},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"exe",portOut:"trigger 0",objIn:"43",objOut:"44"}]},{name:"trigger 1",links:[{portIn:"Trigger in",portOut:"trigger 1",objIn:"275",objOut:"44"}]},{name:"trigger 2",value:0},{name:"trigger 3",links:[{portIn:"Execute",portOut:"trigger 3",objIn:"276",objOut:"44"}]},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Ui.VizGraph",id:"45",uiAttribs:{},portsIn:[{name:"Number 1"},{name:"Number 2",value:0},{name:"Number 3",value:0},{name:"Number 4",value:0},{name:"Number 5",value:0},{name:"Number 6",value:0},{name:"Number 7",value:0},{name:"Number 8",value:0},{name:"Reset",value:0}],portsOut:[]},{objName:"Ops.Value.NumberSwitchBoolean",id:"46",uiAttribs:{},portsIn:[{name:"Boolean"},{name:"Value false",value:.2},{name:"Value true"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"43",objOut:"46"}]}]},{objName:"Ops.Math.Compare.GreaterThan",id:"47",uiAttribs:{},portsIn:[{name:"number1"},{name:"number2",value:.21}],portsOut:[{name:"result",links:[{portIn:"Boolean",portOut:"result",objIn:"46",objOut:"47"}]}]},{objName:"Ops.Value.NumberSwitchBoolean",id:"48",uiAttribs:{},portsIn:[{name:"Boolean"},{name:"Value false",value:0},{name:"Value true",value:.2}],portsOut:[{name:"Result",links:[{portIn:"Play",portOut:"Result",objIn:"50",objOut:"48"}]}]},{objName:"Ops.Math.Clamp",id:"49",uiAttribs:{},portsIn:[{name:"val"},{name:"min",value:.20000001},{name:"max",value:1},{name:"ignore outside values",value:false}],portsOut:[{name:"result",links:[{portIn:"Value true",portOut:"result",objIn:"46",objOut:"49"},{portIn:"number1",portOut:"result",objIn:"47",objOut:"49"}]}]},{objName:"Ops.Anim.Timer_v2",id:"50",uiAttribs:{},portsIn:[{name:"Speed",value:1},{name:"Play"},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"number",portOut:"Time",objIn:"53",objOut:"50"},{portIn:"Input",portOut:"Time",objIn:"30",objOut:"50"},{portIn:"number1",portOut:"Time",objIn:"61",objOut:"50"}]}]},{objName:"Ops.Value.GateNumber",id:"51",uiAttribs:{},portsIn:[{name:"Value In",value:0},{name:"Pass Through"}],portsOut:[{name:"Value Out",links:[{portIn:"Play",portOut:"Value Out",objIn:"50",objOut:"51"}]}]},{objName:"Ops.Trigger.IsTriggered",id:"52",uiAttribs:{},portsIn:[{name:"Trigger"}],portsOut:[{name:"Next",links:[{portIn:"Reset",portOut:"Next",objIn:"50",objOut:"52"}]},{name:"Was Triggered",links:[{portIn:"Pass Through",portOut:"Was Triggered",objIn:"51",objOut:"52"}]}]},{objName:"Ops.Math.Exp",id:"53",uiAttribs:{},portsIn:[{name:"number"}],portsOut:[{name:"result",links:[{portIn:"Number 1",portOut:"result",objIn:"45",objOut:"53"}]}]},{objName:"Ops.Trigger.TimedSequence",id:"54",uiAttribs:{},portsIn:[{name:"exe"},{name:"current"},{name:"overwriteTime"},{name:"ignoreInSubPatch",value:false}],portsOut:[{name:"triggerAlways",links:[{portIn:"render",portOut:"triggerAlways",objIn:"27",objOut:"54"}]},{name:"Names"},{name:"currentKeyTime",value:0},{name:"Current",links:[{portIn:"Value",portOut:"Current",objIn:"79",objOut:"54"}]},{name:"trigger 0",value:0},{name:"trigger 1",links:[{portIn:"render",portOut:"trigger 1",objIn:"305",objOut:"54"}]},{name:"trigger 2",links:[{portIn:"render",portOut:"trigger 2",objIn:"293",objOut:"54"}]},{name:"trigger 3",links:[{portIn:"render",portOut:"trigger 3",objIn:"77",objOut:"54"}]},{name:"trigger 4",links:[{portIn:"render",portOut:"trigger 4",objIn:"57",objOut:"54"}]},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0},{name:"trigger 16",value:0},{name:"trigger 17",value:0},{name:"trigger 18",value:0},{name:"trigger 19",value:0},{name:"trigger 20",value:0},{name:"trigger 21",value:0},{name:"trigger 22",value:0},{name:"trigger 23",value:0},{name:"trigger 24",value:0},{name:"trigger 25",value:0},{name:"trigger 26",value:0},{name:"trigger 27",value:0},{name:"trigger 28",value:0},{name:"trigger 29",value:0},{name:"trigger 30",value:0},{name:"trigger 31",value:0}]},{objName:"Ops.Sequence",id:"55",uiAttribs:{},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"58",objOut:"55"}]},{name:"trigger 1",links:[{portIn:"Render",portOut:"trigger 1",objIn:"56",objOut:"55"}]},{name:"trigger 2",links:[{portIn:"Update",portOut:"trigger 2",objIn:"69",objOut:"55"}]},{name:"trigger 3",links:[{portIn:"Render",portOut:"trigger 3",objIn:"76",objOut:"55"}]},{name:"trigger 4",links:[{portIn:"exec",portOut:"trigger 4",objIn:"80",objOut:"55"}]},{name:"trigger 5",links:[{portIn:"Render",portOut:"trigger 5",objIn:"292",objOut:"55"}]},{name:"trigger 6",links:[{portIn:"Render",portOut:"trigger 6",objIn:"304",objOut:"55"}]},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"56",uiAttribs:{},portsIn:[{name:"Render"},{name:"Base Texture"},{name:"Size index",value:0},{name:"Size",value:"Auto"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 8bit ubyte"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",value:0},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"57",objOut:"56"}]},{name:"Aspect Ratio",value:.9026798307475318},{name:"Texture Width",value:640},{name:"Texture Height",value:709}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"57",uiAttribs:{},portsIn:[{name:"render"},{name:"Scale index",value:1},{name:"Scale",value:"Fit"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Render2Texture",id:"58",uiAttribs:{},portsIn:[{name:"render"},{name:"use viewport size",value:true},{name:"texture width",value:640},{name:"texture height",value:709},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:true},{name:"Clear",value:true}],portsOut:[{name:"trigger",value:0},{name:"texture",links:[{portIn:"Texture In",portOut:"texture",objIn:"59",objOut:"58"}]},{name:"textureDepth"}]},{objName:"Ops.Ui.VizTexture",id:"59",uiAttribs:{},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out"},{name:"Info",value:"640x709 8bit linear repeat"}]},{objName:"Ops.Boolean.ToggleBoolValue",id:"60",uiAttribs:{},portsIn:[{name:"in bool"}],portsOut:[{name:"out bool",links:[{portIn:"overwriteTime",portOut:"out bool",objIn:"54",objOut:"60"}]}]},{objName:"Ops.Math.Compare.GreaterOrEquals",id:"61",uiAttribs:{},portsIn:[{name:"number1"},{name:"number2",value:.001}],portsOut:[{name:"result",links:[{portIn:"in bool",portOut:"result",objIn:"60",objOut:"61"}]}]},{objName:"Ops.Sidebar.Toggle_v3",id:"62",uiAttribs:{},portsIn:[{name:"link"},{name:"Text",value:"Toggle"},{name:"Input",value:true},{name:"Set Default",value:0},{name:"Default",value:true},{name:"Grey Out",value:false},{name:"Visible",value:true}],portsOut:[{name:"childs"},{name:"Value",links:[{portIn:"Boolean",portOut:"Value",objIn:"63",objOut:"62"}]}]},{objName:"Ops.Value.NumberSwitchBoolean",id:"63",uiAttribs:{},portsIn:[{name:"Boolean"},{name:"Value false",value:0},{name:"Value true",value:4}],portsOut:[{name:"Result",links:[{portIn:"number1",portOut:"Result",objIn:"68",objOut:"63"},{portIn:"Index 4",portOut:"Result",objIn:"69",objOut:"63"},{portIn:"Value In",portOut:"Result",objIn:"64",objOut:"63"}]}]},{objName:"Ops.Value.GateNumber",id:"64",uiAttribs:{},portsIn:[{name:"Value In"},{name:"Pass Through"}],portsOut:[{name:"Value Out",links:[{portIn:"Index",portOut:"Value Out",objIn:"65",objOut:"64"},{portIn:"Value",portOut:"Value Out",objIn:"65",objOut:"64"}]}]},{objName:"Ops.Value.RouteNumber",id:"65",uiAttribs:{},portsIn:[{name:"Index"},{name:"Value"},{name:"Default Value",value:1.21},{name:"Set inactive to default",value:false}],portsOut:[{name:"Index 0 Value",value:0},{name:"Index 1 Value",links:[{portIn:"SearchValue",portOut:"Index 1 Value",objIn:"70",objOut:"65"}]},{name:"Index 2 Value",links:[{portIn:"SearchValue",portOut:"Index 2 Value",objIn:"70",objOut:"65"}]},{name:"Index 3 Value",links:[{portIn:"SearchValue",portOut:"Index 3 Value",objIn:"70",objOut:"65"}]},{name:"Index 4 Value",links:[{portIn:"SearchValue",portOut:"Index 4 Value",objIn:"70",objOut:"65"}]},{name:"Index 5 Value",value:1.21},{name:"Index 6 Value",value:1.21},{name:"Index 7 Value",value:1.21},{name:"Index 8 Value",value:1.21},{name:"Index 9 Value",value:1.21}]},{objName:"Ops.Sidebar.Toggle_v3",id:"66",uiAttribs:{},portsIn:[{name:"link"},{name:"Text",value:"Toggle"},{name:"Input",value:true},{name:"Set Default",value:0},{name:"Default",value:true},{name:"Grey Out",value:false},{name:"Visible",value:true}],portsOut:[{name:"childs"},{name:"Value",links:[{portIn:"Boolean",portOut:"Value",objIn:"67",objOut:"66"}]}]},{objName:"Ops.Value.NumberSwitchBoolean",id:"67",uiAttribs:{},portsIn:[{name:"Boolean"},{name:"Value false",value:0},{name:"Value true",value:3}],portsOut:[{name:"Result",links:[{portIn:"number1",portOut:"Result",objIn:"68",objOut:"67"},{portIn:"Index 3",portOut:"Result",objIn:"69",objOut:"67"},{portIn:"Value In",portOut:"Result",objIn:"64",objOut:"67"}]}]},{objName:"Ops.Math.Compare.LessThan",id:"68",uiAttribs:{},portsIn:[{name:"number1"},{name:"number2",value:1}],portsOut:[{name:"result",links:[{portIn:"in bool",portOut:"result",objIn:"71",objOut:"68"}]}]},{objName:"Ops.Array.ArrayFromNumbers",id:"69",uiAttribs:{},portsIn:[{name:"Update"},{name:"Limit",value:30},{name:"Slider",value:false},{name:"Index 0",value:0},{name:"Index 1"},{name:"Index 2"},{name:"Index 3"},{name:"Index 4"},{name:"Index 5",value:0},{name:"Index 6",value:0},{name:"Index 7",value:0},{name:"Index 8",value:0},{name:"Index 9",value:0},{name:"Index 10",value:0},{name:"Index 11",value:0},{name:"Index 12",value:0},{name:"Index 13",value:0},{name:"Index 14",value:0},{name:"Index 15",value:0},{name:"Index 16",value:0},{name:"Index 17",value:0},{name:"Index 18",value:0},{name:"Index 19",value:0},{name:"Index 20",value:0},{name:"Index 21",value:0},{name:"Index 22",value:0},{name:"Index 23",value:0},{name:"Index 24",value:0},{name:"Index 25",value:0},{name:"Index 26",value:0},{name:"Index 27",value:0},{name:"Index 28",value:0},{name:"Index 29",value:0}],portsOut:[{name:"Next",value:0},{name:"Array",links:[{portIn:"Array",portOut:"Array",objIn:"70",objOut:"69"},{portIn:"Array",portOut:"Array",objIn:"72",objOut:"69"}]}]},{objName:"Ops.Array.ArrayContains_v2",id:"70",uiAttribs:{},portsIn:[{name:"Array"},{name:"SearchValue"}],portsOut:[{name:"Found",value:true},{name:"Index",links:[{portIn:"Number",portOut:"Index",objIn:"73",objOut:"70"}]}]},{objName:"Ops.Boolean.ToggleBoolValue",id:"71",uiAttribs:{},portsIn:[{name:"in bool"}],portsOut:[{name:"out bool",links:[{portIn:"Pass Through",portOut:"out bool",objIn:"64",objOut:"71"}]}]},{objName:"Ops.Json.ArrayGetNumberByPath",id:"72",uiAttribs:{},portsIn:[{name:"Array"},{name:"Path"}],portsOut:[{name:"Output",links:[{portIn:"current",portOut:"Output",objIn:"54",objOut:"72"}]},{name:"Found",value:true}]},{objName:"Ops.String.NumberToString_v2",id:"73",uiAttribs:{},portsIn:[{name:"Number"}],portsOut:[{name:"Result",links:[{portIn:"Path",portOut:"Result",objIn:"72",objOut:"73"}]}]},{objName:"Ops.Math.SmoothStep_v2",id:"74",uiAttribs:{},portsIn:[{name:"number",value:0},{name:"min",value:0},{name:"max",value:1}],portsOut:[{name:"result",value:0}]},{objName:"Ops.Ui.VizTexture",id:"75",uiAttribs:{},portsIn:[{name:"Texture In",value:0},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out"},{name:"Info",value:"unknown"}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"76",uiAttribs:{},portsIn:[{name:"Render"},{name:"Base Texture"},{name:"Size index",value:0},{name:"Size",value:"Auto"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 8bit ubyte"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",value:0},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"77",objOut:"76"}]},{name:"Aspect Ratio",value:.9026798307475318},{name:"Texture Width",value:640},{name:"Texture Height",value:709}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"77",uiAttribs:{},portsIn:[{name:"render"},{name:"Scale index",value:1},{name:"Scale",value:"Fit"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Textures.SwitchTextures_v2",id:"78",uiAttribs:{},portsIn:[{name:"exec"},{name:"num"},{name:"Default Texture Transparent",value:true},{name:"texture0",value:0},{name:"texture1"},{name:"texture2"},{name:"texture3"},{name:"texture4"},{name:"texture5",value:0},{name:"texture6",value:0},{name:"texture7",value:0},{name:"texture8",value:0},{name:"texture9",value:0},{name:"texture10",value:0},{name:"texture11",value:0},{name:"texture12",value:0},{name:"texture13",value:0},{name:"texture14",value:0},{name:"texture15",value:0}],portsOut:[{name:"Next",value:0},{name:"texture",links:[{portIn:"Image",portOut:"texture",objIn:"34",objOut:"78"}]}]},{objName:"Ops.Value.PreviousValueStore",id:"79",uiAttribs:{},portsIn:[{name:"Value"}],portsOut:[{name:"Current Value",links:[{portIn:"num",portOut:"Current Value",objIn:"78",objOut:"79"}]},{name:"Previous Value",links:[{portIn:"num",portOut:"Previous Value",objIn:"80",objOut:"79"}]}]},{objName:"Ops.Gl.Textures.SwitchTextures_v2",id:"80",uiAttribs:{},portsIn:[{name:"exec"},{name:"num"},{name:"Default Texture Transparent",value:true},{name:"texture0",value:0},{name:"texture1"},{name:"texture2"},{name:"texture3"},{name:"texture4"},{name:"texture5",value:0},{name:"texture6",value:0},{name:"texture7",value:0},{name:"texture8",value:0},{name:"texture9",value:0},{name:"texture10",value:0},{name:"texture11",value:0},{name:"texture12",value:0},{name:"texture13",value:0},{name:"texture14",value:0},{name:"texture15",value:0}],portsOut:[{name:"Next",links:[{portIn:"exec",portOut:"Next",objIn:"78",objOut:"80"}]},{name:"texture",links:[{portIn:"Image",portOut:"texture",objIn:"35",objOut:"80"}]}]},{objName:"Ops.Ui.Area",id:"81",uiAttribs:{},portsIn:[{name:"Title",value:""}],portsOut:[]},{objName:"Ops.Ui.Area",id:"82",uiAttribs:{},portsIn:[{name:"Title",value:""}],portsOut:[]},{objName:"Ops.Ui.Area",id:"83",uiAttribs:{},portsIn:[{name:"Title",value:""}],portsOut:[]},{objName:"Ops.Ui.Area",id:"84",uiAttribs:{},portsIn:[{name:"Title",value:""}],portsOut:[]},{objName:"Ops.Sidebar.XYPad",id:"85",uiAttribs:{},portsIn:[{name:"Link"},{name:"Text",value:"XY Pad"},{name:"Range index",value:0},{name:"Range",value:"0-1"},{name:"Input X"},{name:"Input Y"},{name:"Flip X",value:false},{name:"Flip Y",value:false},{name:"Set Default",value:0},{name:"Default X",value:.5},{name:"Default Y",value:.5},{name:"Visible",value:true}],portsOut:[{name:"Children",links:[{portIn:"link",portOut:"Children",objIn:"88",objOut:"85"}]},{name:"X",value:.6666666666666666},{name:"Y",value:.6666666666666666}]},{objName:"Ops.Sidebar.Incrementor_v2",id:"86",uiAttribs:{},portsIn:[{name:"link"},{name:"Label",value:"Incrementor"},{name:"min",value:0},{name:"max",value:2},{name:"stepsize",value:1},{name:"Default",value:0},{name:"Values",value:0},{name:"Set Default",value:0}],portsOut:[{name:"childs",links:[{portIn:"Link",portOut:"childs",objIn:"85",objOut:"86"}]},{name:"value",links:[{portIn:"number1",portOut:"value",objIn:"286",objOut:"86"},{portIn:"Number",portOut:"value",objIn:"279",objOut:"86"}]}]},{objName:"Ops.Ui.Area",id:"87",uiAttribs:{},portsIn:[{name:"Title",value:""}],portsOut:[]},{objName:"Ops.Sidebar.Incrementor_v2",id:"88",uiAttribs:{},portsIn:[{name:"link"},{name:"Label",value:"YIncrementor"},{name:"min",value:0},{name:"max",value:2},{name:"stepsize",value:1},{name:"Default",value:0},{name:"Values",value:0},{name:"Set Default",value:0}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"296",objOut:"88"}]},{name:"value",links:[{portIn:"number1",portOut:"value",objIn:"285",objOut:"88"},{portIn:"Number",portOut:"value",objIn:"280",objOut:"88"}]}]},{objName:"Ops.Math.Log",id:"89",uiAttribs:{},portsIn:[{name:"number",value:0}],portsOut:[{name:"result",value:null}]},{objName:"Ops.Ui.VizGraph",id:"90",uiAttribs:{},portsIn:[{name:"Number 1",value:0},{name:"Number 2",value:0},{name:"Number 3",value:0},{name:"Number 4",value:0},{name:"Number 5",value:0},{name:"Number 6",value:0},{name:"Number 7",value:0},{name:"Number 8",value:0},{name:"Reset",value:0}],portsOut:[]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"91",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat sphere(vec2 uv, vec2 c, float r) {\n\tuv -= c;\n\tuv /= r;\n\treturn 2.0*r*sqrt(max(0.0, 1.0-dot(uv, uv)));\n}\nfloat beehive_dist(vec2 p){\n\tvec2 s = vec2(1.0, 1.73205080757);\n    p = abs(p);\n    return max(dot(p, s*.5), p.x);\n}\n\nvec4 beehive_center(vec2 p) {\n\tvec2 s = vec2(1.0, 1.73205080757);\n    vec4 hC = floor(vec4(p, p - vec2(.5, 1))/vec4(s,s)) + .5;\n    vec4 h = vec4(p - hC.xy*s, p - (hC.zw + .5)*s);\n    return dot(h.xy, h.xy)<dot(h.zw, h.zw) ? vec4(h.xy, hC.xy) : vec4(h.zw, hC.zw + 9.73);\n}\nvec3 blend_normal(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1 + (1.0-opacity)*c2;\n}\n\nvec3 blend_dissolve(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\tif (rand(uv) < opacity) {\n\t\treturn c1;\n\t} else {\n\t\treturn c2;\n\t}\n}\n\nvec3 blend_multiply(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1*c2 + (1.0-opacity)*c2;\n}\n\nvec3 blend_screen(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*(1.0-(1.0-c1)*(1.0-c2)) + (1.0-opacity)*c2;\n}\n\nfloat blend_overlay_f(float c1, float c2) {\n\treturn (c1 < 0.5) ? (2.0*c1*c2) : (1.0-2.0*(1.0-c1)*(1.0-c2));\n}\n\nvec3 blend_overlay(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_overlay_f(c1.x, c2.x), blend_overlay_f(c1.y, c2.y), blend_overlay_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_hard_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*0.5*(c1*c2+blend_overlay(uv, c1, c2, 1.0)) + (1.0-opacity)*c2;\n}\n\nfloat blend_soft_light_f(float c1, float c2) {\n\treturn (c2 < 0.5) ? (2.0*c1*c2+c1*c1*(1.0-2.0*c2)) : 2.0*c1*(1.0-c2)+sqrt(c1)*(2.0*c2-1.0);\n}\n\nvec3 blend_soft_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_soft_light_f(c1.x, c2.x), blend_soft_light_f(c1.y, c2.y), blend_soft_light_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_burn_f(float c1, float c2) {\n\treturn (c1==0.0)?c1:max((1.0-((1.0-c2)/c1)),0.0);\n}\n\nvec3 blend_burn(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_burn_f(c1.x, c2.x), blend_burn_f(c1.y, c2.y), blend_burn_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_dodge_f(float c1, float c2) {\n\treturn (c1==1.0)?c1:min(c2/(1.0-c1),1.0);\n}\n\nvec3 blend_dodge(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_dodge_f(c1.x, c2.x), blend_dodge_f(c1.y, c2.y), blend_dodge_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_lighten(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*max(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_darken(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*min(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_difference(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*clamp(c2-c1, vec3(0.0), vec3(1.0)) + (1.0-opacity)*c2;\n}\nconst float p_o490056_gradient_0_pos = 0.000000000;\nconst float p_o490056_gradient_0_r = 1.000000000;\nconst float p_o490056_gradient_0_g = 0.000000000;\nconst float p_o490056_gradient_0_b = 0.000000000;\nconst float p_o490056_gradient_0_a = 1.000000000;\nconst float p_o490056_gradient_1_pos = 0.254545000;\nconst float p_o490056_gradient_1_r = 1.000000000;\nconst float p_o490056_gradient_1_g = 0.968750000;\nconst float p_o490056_gradient_1_b = 0.000000000;\nconst float p_o490056_gradient_1_a = 1.000000000;\nconst float p_o490056_gradient_2_pos = 0.527273000;\nconst float p_o490056_gradient_2_r = 0.000000000;\nconst float p_o490056_gradient_2_g = 1.000000000;\nconst float p_o490056_gradient_2_b = 0.125000000;\nconst float p_o490056_gradient_2_a = 1.000000000;\nconst float p_o490056_gradient_3_pos = 0.772727000;\nconst float p_o490056_gradient_3_r = 0.000000000;\nconst float p_o490056_gradient_3_g = 0.062500000;\nconst float p_o490056_gradient_3_b = 1.000000000;\nconst float p_o490056_gradient_3_a = 1.000000000;\nconst float p_o490056_gradient_4_pos = 1.000000000;\nconst float p_o490056_gradient_4_r = 0.843750000;\nconst float p_o490056_gradient_4_g = 0.000000000;\nconst float p_o490056_gradient_4_b = 1.000000000;\nconst float p_o490056_gradient_4_a = 1.000000000;\nvec4 o490056_gradient_gradient_fct(float x) {\n  if (x < p_o490056_gradient_0_pos) {\n    return vec4(p_o490056_gradient_0_r,p_o490056_gradient_0_g,p_o490056_gradient_0_b,p_o490056_gradient_0_a);\n  } else if (x < p_o490056_gradient_1_pos) {\n    return mix(vec4(p_o490056_gradient_0_r,p_o490056_gradient_0_g,p_o490056_gradient_0_b,p_o490056_gradient_0_a), vec4(p_o490056_gradient_1_r,p_o490056_gradient_1_g,p_o490056_gradient_1_b,p_o490056_gradient_1_a), ((x-p_o490056_gradient_0_pos)/(p_o490056_gradient_1_pos-p_o490056_gradient_0_pos)));\n  } else if (x < p_o490056_gradient_2_pos) {\n    return mix(vec4(p_o490056_gradient_1_r,p_o490056_gradient_1_g,p_o490056_gradient_1_b,p_o490056_gradient_1_a), vec4(p_o490056_gradient_2_r,p_o490056_gradient_2_g,p_o490056_gradient_2_b,p_o490056_gradient_2_a), ((x-p_o490056_gradient_1_pos)/(p_o490056_gradient_2_pos-p_o490056_gradient_1_pos)));\n  } else if (x < p_o490056_gradient_3_pos) {\n    return mix(vec4(p_o490056_gradient_2_r,p_o490056_gradient_2_g,p_o490056_gradient_2_b,p_o490056_gradient_2_a), vec4(p_o490056_gradient_3_r,p_o490056_gradient_3_g,p_o490056_gradient_3_b,p_o490056_gradient_3_a), ((x-p_o490056_gradient_2_pos)/(p_o490056_gradient_3_pos-p_o490056_gradient_2_pos)));\n  } else if (x < p_o490056_gradient_4_pos) {\n    return mix(vec4(p_o490056_gradient_3_r,p_o490056_gradient_3_g,p_o490056_gradient_3_b,p_o490056_gradient_3_a), vec4(p_o490056_gradient_4_r,p_o490056_gradient_4_g,p_o490056_gradient_4_b,p_o490056_gradient_4_a), ((x-p_o490056_gradient_3_pos)/(p_o490056_gradient_4_pos-p_o490056_gradient_3_pos)));\n  }\n  return vec4(p_o490056_gradient_4_r,p_o490056_gradient_4_g,p_o490056_gradient_4_b,p_o490056_gradient_4_a);\n}\nconst float p_o370343_cx = 0.500000000;\nconst float p_o370343_cy = 0.500000000;\nconst float p_o370343_r = 0.030000000;\nconst float p_o15985_cx = 0.500000000;\nconst float p_o15985_cy = 0.500000000;\nconst float p_o15985_r = 0.520000000;\nconst float seed_o20146 = 0.000000000;\nconst float p_o20146_sx = 4.000000000;\nconst float p_o20146_sy = 4.000000000;\nvec3 o448778_input_in(vec2 uv, float _seed_variation_) {\nfloat o370343_0_1_f = sphere((uv), vec2(p_o370343_cx, p_o370343_cy), p_o370343_r);\nfloat o15985_0_1_f = sphere((uv), vec2(p_o15985_cx, p_o15985_cy), p_o15985_r);\nvec2 o20146_0_uv = (uv)*vec2(p_o20146_sx, p_o20146_sy*1.73205080757);\nvec4 o20146_0_center = beehive_center(o20146_0_uv);float o20146_0_1_f = 1.0-2.0*beehive_dist(o20146_0_center.xy);\nvec4 o26946_0_s1 = vec4(((uv)).x, 1.0, 1.0, 1.0);\nvec4 o26946_0_s2 = vec4(vec3(o15985_0_1_f), 1.0);\nfloat o26946_0_a = (abs(iTime*0.4)*sin(iTime))*o20146_0_1_f;\nvec4 o26946_0_2_rgba = vec4(blend_screen((uv), o26946_0_s1.rgb, o26946_0_s2.rgb, o26946_0_a*o26946_0_s1.a), min(1.0, o26946_0_s2.a+o26946_0_a*o26946_0_s1.a));\nvec4 o369032_0_s1 = vec4(vec3(o370343_0_1_f), 1.0);\nvec4 o369032_0_s2 = o26946_0_2_rgba;\nfloat o369032_0_a = (abs(iTime*0.4)*sin(iTime))*1.0;\nvec4 o369032_0_2_rgba = vec4(blend_screen((uv), o369032_0_s1.rgb, o369032_0_s2.rgb, o369032_0_a*o369032_0_s1.a), min(1.0, o369032_0_s2.a+o369032_0_a*o369032_0_s1.a));\n\nreturn ((o369032_0_2_rgba).rgb);\n}\nfloat o448778_fct(vec2 uv, float _seed_variation_) {\n\tvec2 e = vec2(1.0/64.000000000, 0.0);\n\tvec3 rv = 4.0*o448778_input_in(uv, _seed_variation_);\n\trv -= o448778_input_in(uv+e.xy, _seed_variation_);\n\trv -= o448778_input_in(uv-e.xy, _seed_variation_);\n\trv -= o448778_input_in(uv+e.yx, _seed_variation_);\n\trv -= o448778_input_in(uv-e.yx, _seed_variation_);\n\trv = abs(rv);\n\treturn max(rv.x, max(rv.y ,rv.z))*64.000000000;\n}\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o448778_0_1_f = clamp(o448778_fct((UV), _seed_variation_), 0.0, 1.0);\nfloat o370343_0_1_f = sphere((UV), vec2(p_o370343_cx, p_o370343_cy), p_o370343_r);\nfloat o15985_0_1_f = sphere((UV), vec2(p_o15985_cx, p_o15985_cy), p_o15985_r);\nvec2 o20146_0_uv = (UV)*vec2(p_o20146_sx, p_o20146_sy*1.73205080757);\nvec4 o20146_0_center = beehive_center(o20146_0_uv);float o20146_0_1_f = 1.0-2.0*beehive_dist(o20146_0_center.xy);\nvec4 o26946_0_s1 = vec4(((UV)).x, 1.0, 1.0, 1.0);\nvec4 o26946_0_s2 = vec4(vec3(o15985_0_1_f), 1.0);\nfloat o26946_0_a = (abs(iTime*0.4)*sin(iTime))*o20146_0_1_f;\nvec4 o26946_0_2_rgba = vec4(blend_screen((UV), o26946_0_s1.rgb, o26946_0_s2.rgb, o26946_0_a*o26946_0_s1.a), min(1.0, o26946_0_s2.a+o26946_0_a*o26946_0_s1.a));\nvec4 o369032_0_s1 = vec4(vec3(o370343_0_1_f), 1.0);\nvec4 o369032_0_s2 = o26946_0_2_rgba;\nfloat o369032_0_a = (abs(iTime*0.4)*sin(iTime))*1.0;\nvec4 o369032_0_2_rgba = vec4(blend_screen((UV), o369032_0_s1.rgb, o369032_0_s2.rgb, o369032_0_a*o369032_0_s1.a), min(1.0, o369032_0_s2.a+o369032_0_a*o369032_0_s1.a));\nvec4 o452611_0_s1 = vec4(vec3(o448778_0_1_f), 1.0);\nvec4 o452611_0_s2 = o369032_0_2_rgba;\nfloat o452611_0_a = (round(iTime*0.9)*sin(iTime*0.2))*1.0;\nvec4 o452611_0_2_rgba = vec4(blend_multiply((UV), o452611_0_s1.rgb, o452611_0_s2.rgb, o452611_0_a*o452611_0_s1.a), min(1.0, o452611_0_s2.a+o452611_0_a*o452611_0_s1.a));\nvec4 o490056_0_1_rgba = o490056_gradient_gradient_fct((dot((o452611_0_2_rgba).rgb, vec3(1.0))/3.0));\ngl_FragColor = o490056_0_1_rgba;\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"92",objOut:"91"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"92",objOut:"91"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"92",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"mirrored repeat"},{name:"Floating Point",value:true},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"100",objOut:"92"}]},{name:"Texture",links:[{portIn:"Texture In",portOut:"Texture",objIn:"95",objOut:"92"}]},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Anim.Timer_v2",id:"93",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Speed",value:2.19},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"iTime",portOut:"Time",objIn:"91",objOut:"93"},{portIn:"time",portOut:"Time",objIn:"101",objOut:"93"}]}]},{objName:"Ops.Sequence",id:"94",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"91",objOut:"94"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Ui.VizTexture",id:"95",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"97",objOut:"95"}]},{name:"Info",value:"unknown"}]},{objName:"Ops.Gl.Render2Texture",id:"96",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render",value:null},{name:"use viewport size",value:true},{name:"texture width",value:640},{name:"texture height",value:320},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:true},{name:"Clear",value:true}],portsOut:[{name:"trigger",value:0},{name:"texture"},{name:"textureDepth"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"97",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"125",objOut:"97"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v2",id:"98",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"94",objOut:"98"},{portIn:"render",portOut:"Next",objIn:"97",objOut:"98"},{portIn:"Render",portOut:"Next",objIn:"127",objOut:"98"},{portIn:"exe",portOut:"Next",objIn:"185",objOut:"98"}]},{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"126",objOut:"98"}]},{name:"Aspect Ratio",value:.9026798307475318}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"99",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Meshes.Rectangle_v2",id:"100",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"width",value:1},{name:"height",value:1},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"num columns",value:1},{name:"num rows",value:1},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Active",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.TextureEffects.Wobble",id:"101",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"time"},{name:"SpeedX",value:4},{name:"SpeedY",value:8},{name:"RepeatX",value:57.62},{name:"RepeatY",value:11},{name:"Multiply",value:.01},{name:"Mask",value:0}],portsOut:[{name:"Trigger",value:0}]},{objName:"Ops.Trigger.TimedSequence",id:"102",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"current"},{name:"overwriteTime",value:false},{name:"ignoreInSubPatch",value:false}],portsOut:[{name:"triggerAlways",links:[{portIn:"Render",portOut:"triggerAlways",objIn:"109",objOut:"102"},{portIn:"Render",portOut:"triggerAlways",objIn:"119",objOut:"102"},{portIn:"Render",portOut:"triggerAlways",objIn:"139",objOut:"102"},{portIn:"Render",portOut:"triggerAlways",objIn:"163",objOut:"102"},{portIn:"Render",portOut:"triggerAlways",objIn:"98",objOut:"102"}]},{name:"Names"},{name:"currentKeyTime",value:0},{name:"Current",value:4},{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"99",objOut:"102"}]},{name:"trigger 1",links:[{portIn:"render",portOut:"trigger 1",objIn:"112",objOut:"102"}]},{name:"trigger 2",links:[{portIn:"render",portOut:"trigger 2",objIn:"122",objOut:"102"}]},{name:"trigger 3",links:[{portIn:"render",portOut:"trigger 3",objIn:"142",objOut:"102"}]},{name:"trigger 4",links:[{portIn:"render",portOut:"trigger 4",objIn:"145",objOut:"102"}]},{name:"trigger 5",links:[{portIn:"render",portOut:"trigger 5",objIn:"143",objOut:"102"}]},{name:"trigger 6",links:[{portIn:"render",portOut:"trigger 6",objIn:"196",objOut:"102"}]},{name:"trigger 7",links:[{portIn:"render",portOut:"trigger 7",objIn:"209",objOut:"102"}]},{name:"trigger 8",links:[{portIn:"render",portOut:"trigger 8",objIn:"227",objOut:"102"}]},{name:"trigger 9",links:[{portIn:"render",portOut:"trigger 9",objIn:"239",objOut:"102"}]},{name:"trigger 10",links:[{portIn:"render",portOut:"trigger 10",objIn:"254",objOut:"102"}]},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0},{name:"trigger 16",value:0},{name:"trigger 17",value:0},{name:"trigger 18",value:0},{name:"trigger 19",value:0},{name:"trigger 20",value:0},{name:"trigger 21",value:0},{name:"trigger 22",value:0},{name:"trigger 23",value:0},{name:"trigger 24",value:0},{name:"trigger 25",value:0},{name:"trigger 26",value:0},{name:"trigger 27",value:0},{name:"trigger 28",value:0},{name:"trigger 29",value:0},{name:"trigger 30",value:0},{name:"trigger 31",value:0}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"103",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat sphere(vec2 uv, vec2 c, float r) {\n\tuv -= c;\n\tuv /= r;\n\treturn 2.0*r*sqrt(max(0.0, 1.0-dot(uv, uv)));\n}\nfloat beehive_dist(vec2 p){\n\tvec2 s = vec2(1.0, 1.73205080757);\n    p = abs(p);\n    return max(dot(p, s*.5), p.x);\n}\n\nvec4 beehive_center(vec2 p) {\n\tvec2 s = vec2(1.0, 1.73205080757);\n    vec4 hC = floor(vec4(p, p - vec2(.5, 1))/vec4(s,s)) + .5;\n    vec4 h = vec4(p - hC.xy*s, p - (hC.zw + .5)*s);\n    return dot(h.xy, h.xy)<dot(h.zw, h.zw) ? vec4(h.xy, hC.xy) : vec4(h.zw, hC.zw + 9.73);\n}\nvec3 blend_normal(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1 + (1.0-opacity)*c2;\n}\n\nvec3 blend_dissolve(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\tif (rand(uv) < opacity) {\n\t\treturn c1;\n\t} else {\n\t\treturn c2;\n\t}\n}\n\nvec3 blend_multiply(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1*c2 + (1.0-opacity)*c2;\n}\n\nvec3 blend_screen(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*(1.0-(1.0-c1)*(1.0-c2)) + (1.0-opacity)*c2;\n}\n\nfloat blend_overlay_f(float c1, float c2) {\n\treturn (c1 < 0.5) ? (2.0*c1*c2) : (1.0-2.0*(1.0-c1)*(1.0-c2));\n}\n\nvec3 blend_overlay(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_overlay_f(c1.x, c2.x), blend_overlay_f(c1.y, c2.y), blend_overlay_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_hard_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*0.5*(c1*c2+blend_overlay(uv, c1, c2, 1.0)) + (1.0-opacity)*c2;\n}\n\nfloat blend_soft_light_f(float c1, float c2) {\n\treturn (c2 < 0.5) ? (2.0*c1*c2+c1*c1*(1.0-2.0*c2)) : 2.0*c1*(1.0-c2)+sqrt(c1)*(2.0*c2-1.0);\n}\n\nvec3 blend_soft_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_soft_light_f(c1.x, c2.x), blend_soft_light_f(c1.y, c2.y), blend_soft_light_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_burn_f(float c1, float c2) {\n\treturn (c1==0.0)?c1:max((1.0-((1.0-c2)/c1)),0.0);\n}\n\nvec3 blend_burn(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_burn_f(c1.x, c2.x), blend_burn_f(c1.y, c2.y), blend_burn_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_dodge_f(float c1, float c2) {\n\treturn (c1==1.0)?c1:min(c2/(1.0-c1),1.0);\n}\n\nvec3 blend_dodge(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_dodge_f(c1.x, c2.x), blend_dodge_f(c1.y, c2.y), blend_dodge_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_lighten(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*max(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_darken(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*min(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_difference(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*clamp(c2-c1, vec3(0.0), vec3(1.0)) + (1.0-opacity)*c2;\n}\nconst float p_o490056_gradient_0_pos = 0.000000000;\nconst float p_o490056_gradient_0_r = 1.000000000;\nconst float p_o490056_gradient_0_g = 0.000000000;\nconst float p_o490056_gradient_0_b = 0.000000000;\nconst float p_o490056_gradient_0_a = 1.000000000;\nconst float p_o490056_gradient_1_pos = 0.119755415;\nconst float p_o490056_gradient_1_r = 0.843750000;\nconst float p_o490056_gradient_1_g = 0.000000000;\nconst float p_o490056_gradient_1_b = 1.000000000;\nconst float p_o490056_gradient_1_a = 1.000000000;\nconst float p_o490056_gradient_2_pos = 0.488830844;\nconst float p_o490056_gradient_2_r = 0.000000000;\nconst float p_o490056_gradient_2_g = 0.000000000;\nconst float p_o490056_gradient_2_b = 0.000000000;\nconst float p_o490056_gradient_2_a = 1.000000000;\nconst float p_o490056_gradient_3_pos = 0.827149131;\nconst float p_o490056_gradient_3_r = 1.000000000;\nconst float p_o490056_gradient_3_g = 0.968750000;\nconst float p_o490056_gradient_3_b = 0.000000000;\nconst float p_o490056_gradient_3_a = 1.000000000;\nconst float p_o490056_gradient_4_pos = 0.980930120;\nconst float p_o490056_gradient_4_r = 0.000000000;\nconst float p_o490056_gradient_4_g = 0.062500000;\nconst float p_o490056_gradient_4_b = 1.000000000;\nconst float p_o490056_gradient_4_a = 1.000000000;\nvec4 o490056_gradient_gradient_fct(float x) {\n  if (x < p_o490056_gradient_0_pos) {\n    return vec4(p_o490056_gradient_0_r,p_o490056_gradient_0_g,p_o490056_gradient_0_b,p_o490056_gradient_0_a);\n  } else if (x < p_o490056_gradient_1_pos) {\n    return mix(vec4(p_o490056_gradient_0_r,p_o490056_gradient_0_g,p_o490056_gradient_0_b,p_o490056_gradient_0_a), vec4(p_o490056_gradient_1_r,p_o490056_gradient_1_g,p_o490056_gradient_1_b,p_o490056_gradient_1_a), ((x-p_o490056_gradient_0_pos)/(p_o490056_gradient_1_pos-p_o490056_gradient_0_pos)));\n  } else if (x < p_o490056_gradient_2_pos) {\n    return mix(vec4(p_o490056_gradient_1_r,p_o490056_gradient_1_g,p_o490056_gradient_1_b,p_o490056_gradient_1_a), vec4(p_o490056_gradient_2_r,p_o490056_gradient_2_g,p_o490056_gradient_2_b,p_o490056_gradient_2_a), ((x-p_o490056_gradient_1_pos)/(p_o490056_gradient_2_pos-p_o490056_gradient_1_pos)));\n  } else if (x < p_o490056_gradient_3_pos) {\n    return mix(vec4(p_o490056_gradient_2_r,p_o490056_gradient_2_g,p_o490056_gradient_2_b,p_o490056_gradient_2_a), vec4(p_o490056_gradient_3_r,p_o490056_gradient_3_g,p_o490056_gradient_3_b,p_o490056_gradient_3_a), ((x-p_o490056_gradient_2_pos)/(p_o490056_gradient_3_pos-p_o490056_gradient_2_pos)));\n  } else if (x < p_o490056_gradient_4_pos) {\n    return mix(vec4(p_o490056_gradient_3_r,p_o490056_gradient_3_g,p_o490056_gradient_3_b,p_o490056_gradient_3_a), vec4(p_o490056_gradient_4_r,p_o490056_gradient_4_g,p_o490056_gradient_4_b,p_o490056_gradient_4_a), ((x-p_o490056_gradient_3_pos)/(p_o490056_gradient_4_pos-p_o490056_gradient_3_pos)));\n  }\n  return vec4(p_o490056_gradient_4_r,p_o490056_gradient_4_g,p_o490056_gradient_4_b,p_o490056_gradient_4_a);\n}\nconst float p_o370343_cx = 0.500000000;\nconst float p_o370343_cy = 0.500000000;\nconst float p_o370343_r = 0.030000000;\nconst float p_o15985_cx = 0.500000000;\nconst float p_o15985_cy = 0.500000000;\nconst float p_o15985_r = 0.520000000;\nconst float seed_o20146 = 0.000000000;\nvec3 o448778_input_in(vec2 uv, float _seed_variation_) {\nfloat o370343_0_1_f = sphere((uv), vec2(p_o370343_cx, p_o370343_cy), p_o370343_r);\nfloat o15985_0_1_f = sphere((uv), vec2(p_o15985_cx, p_o15985_cy), p_o15985_r);\nvec2 o20146_0_uv = (uv)*vec2((sin(iTime*0.7)), (sin(iTime*0.7))*1.73205080757);\nvec4 o20146_0_center = beehive_center(o20146_0_uv);float o20146_0_1_f = 1.0-2.0*beehive_dist(o20146_0_center.xy);\nvec4 o26946_0_s1 = vec4(((uv)).x, 1.0, 1.0, 1.0);\nvec4 o26946_0_s2 = vec4(vec3(o15985_0_1_f), 1.0);\nfloat o26946_0_a = (abs(iTime*0.4)*sin(iTime))*o20146_0_1_f;\nvec4 o26946_0_2_rgba = vec4(blend_overlay((uv), o26946_0_s1.rgb, o26946_0_s2.rgb, o26946_0_a*o26946_0_s1.a), min(1.0, o26946_0_s2.a+o26946_0_a*o26946_0_s1.a));\nvec4 o369032_0_s1 = vec4(vec3(o370343_0_1_f), 1.0);\nvec4 o369032_0_s2 = o26946_0_2_rgba;\nfloat o369032_0_a = (abs(iTime*0.4)*sin(iTime))*1.0;\nvec4 o369032_0_2_rgba = vec4(blend_burn((uv), o369032_0_s1.rgb, o369032_0_s2.rgb, o369032_0_a*o369032_0_s1.a), min(1.0, o369032_0_s2.a+o369032_0_a*o369032_0_s1.a));\n\nreturn ((o369032_0_2_rgba).rgb);\n}\nfloat o448778_fct(vec2 uv, float _seed_variation_) {\n\tvec2 e = vec2(1.0/64.000000000, 0.0);\n\tvec3 rv = 4.0*o448778_input_in(uv, _seed_variation_);\n\trv -= o448778_input_in(uv+e.xy, _seed_variation_);\n\trv -= o448778_input_in(uv-e.xy, _seed_variation_);\n\trv -= o448778_input_in(uv+e.yx, _seed_variation_);\n\trv -= o448778_input_in(uv-e.yx, _seed_variation_);\n\trv = abs(rv);\n\treturn max(rv.x, max(rv.y ,rv.z))*64.000000000;\n}\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o448778_0_1_f = clamp(o448778_fct((UV), _seed_variation_), 0.0, 1.0);\nfloat o370343_0_1_f = sphere((UV), vec2(p_o370343_cx, p_o370343_cy), p_o370343_r);\nfloat o15985_0_1_f = sphere((UV), vec2(p_o15985_cx, p_o15985_cy), p_o15985_r);\nvec2 o20146_0_uv = (UV)*vec2((sin(iTime*0.7)), (sin(iTime*0.7))*1.73205080757);\nvec4 o20146_0_center = beehive_center(o20146_0_uv);float o20146_0_1_f = 1.0-2.0*beehive_dist(o20146_0_center.xy);\nvec4 o26946_0_s1 = vec4(((UV)).x, 1.0, 1.0, 1.0);\nvec4 o26946_0_s2 = vec4(vec3(o15985_0_1_f), 1.0);\nfloat o26946_0_a = (abs(iTime*0.4)*sin(iTime))*o20146_0_1_f;\nvec4 o26946_0_2_rgba = vec4(blend_overlay((UV), o26946_0_s1.rgb, o26946_0_s2.rgb, o26946_0_a*o26946_0_s1.a), min(1.0, o26946_0_s2.a+o26946_0_a*o26946_0_s1.a));\nvec4 o369032_0_s1 = vec4(vec3(o370343_0_1_f), 1.0);\nvec4 o369032_0_s2 = o26946_0_2_rgba;\nfloat o369032_0_a = (abs(iTime*0.4)*sin(iTime))*1.0;\nvec4 o369032_0_2_rgba = vec4(blend_burn((UV), o369032_0_s1.rgb, o369032_0_s2.rgb, o369032_0_a*o369032_0_s1.a), min(1.0, o369032_0_s2.a+o369032_0_a*o369032_0_s1.a));\nvec4 o452611_0_s1 = vec4(vec3(o448778_0_1_f), 1.0);\nvec4 o452611_0_s2 = o369032_0_2_rgba;\nfloat o452611_0_a = (round(iTime*0.9)*sin(iTime*0.2))*1.0;\nvec4 o452611_0_2_rgba = vec4(blend_hard_light((UV), o452611_0_s1.rgb, o452611_0_s2.rgb, o452611_0_a*o452611_0_s1.a), min(1.0, o452611_0_s2.a+o452611_0_a*o452611_0_s1.a));\nvec4 o490056_0_1_rgba = o490056_gradient_gradient_fct((dot((o452611_0_2_rgba).rgb, vec3(1.0))/3.0));\ngl_FragColor = o490056_0_1_rgba;\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"104",objOut:"103"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"104",objOut:"103"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"104",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"mirrored repeat"},{name:"Floating Point",value:true},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"110",objOut:"104"}]},{name:"Texture",links:[{portIn:"Texture In",portOut:"Texture",objIn:"107",objOut:"104"}]},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Anim.Timer_v2",id:"105",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Speed",value:.69},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"iTime",portOut:"Time",objIn:"103",objOut:"105"},{portIn:"time",portOut:"Time",objIn:"111",objOut:"105"}]}]},{objName:"Ops.Sequence",id:"106",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"103",objOut:"106"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Ui.VizTexture",id:"107",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"108",objOut:"107"}]},{name:"Info",value:"unknown"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"108",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"111",objOut:"108"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v2",id:"109",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"108",objOut:"109"},{portIn:"exe",portOut:"Next",objIn:"106",objOut:"109"},{portIn:"exe",portOut:"Next",objIn:"182",objOut:"109"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"112",objOut:"109"}]},{name:"Aspect Ratio",value:1.3333333333333333}]},{objName:"Ops.Gl.Meshes.Rectangle_v2",id:"110",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"width",value:1},{name:"height",value:1},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"num columns",value:1},{name:"num rows",value:1},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Active",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.TextureEffects.Wobble",id:"111",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"time"},{name:"SpeedX",value:4},{name:"SpeedY",value:8},{name:"RepeatX",value:57.62},{name:"RepeatY",value:11},{name:"Multiply",value:.01},{name:"Mask",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"180",objOut:"111"}]}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"112",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"113",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat perlin(vec2 uv, vec2 size, int iterations, float persistence, float seed) {\n\tvec2 seed2 = rand2(vec2(seed, 1.0-seed));\n    float rv = 0.0;\n    float coef = 1.0;\n    float acc = 0.0;\n    for (int i = 0; i < iterations; ++i) {\n    \tvec2 step = vec2(1.0)/size;\n\t\tvec2 xy = floor(uv*size);\n        float f0 = rand(seed2+mod(xy, size));\n        float f1 = rand(seed2+mod(xy+vec2(1.0, 0.0), size));\n        float f2 = rand(seed2+mod(xy+vec2(0.0, 1.0), size));\n        float f3 = rand(seed2+mod(xy+vec2(1.0, 1.0), size));\n        vec2 mixval = smoothstep(0.0, 1.0, fract(uv*size));\n        rv += coef * mix(mix(f0, f1, mixval.x), mix(f2, f3, mixval.x), mixval.y);\n        acc += coef;\n        size *= 2.0;\n        coef *= persistence;\n    }\n    \n    return rv / acc;\n}\nvec2 transform(vec2 uv, vec2 translate, float rotate, vec2 scale, bool repeat) {\n \tvec2 rv;\n\tuv -= translate;\n\tuv -= vec2(0.5);\n\trv.x = cos(rotate)*uv.x + sin(rotate)*uv.y;\n\trv.y = -sin(rotate)*uv.x + cos(rotate)*uv.y;\n\trv /= scale;\n\trv += vec2(0.5);\n    if (repeat) {\n\t\treturn fract(rv);\n\t} else {\n\t\treturn clamp(rv, vec2(0.0), vec2(1.0));\n\t}\t\n}vec3 blend_normal(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1 + (1.0-opacity)*c2;\n}\n\nvec3 blend_dissolve(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\tif (rand(uv) < opacity) {\n\t\treturn c1;\n\t} else {\n\t\treturn c2;\n\t}\n}\n\nvec3 blend_multiply(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1*c2 + (1.0-opacity)*c2;\n}\n\nvec3 blend_screen(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*(1.0-(1.0-c1)*(1.0-c2)) + (1.0-opacity)*c2;\n}\n\nfloat blend_overlay_f(float c1, float c2) {\n\treturn (c1 < 0.5) ? (2.0*c1*c2) : (1.0-2.0*(1.0-c1)*(1.0-c2));\n}\n\nvec3 blend_overlay(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_overlay_f(c1.x, c2.x), blend_overlay_f(c1.y, c2.y), blend_overlay_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_hard_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*0.5*(c1*c2+blend_overlay(uv, c1, c2, 1.0)) + (1.0-opacity)*c2;\n}\n\nfloat blend_soft_light_f(float c1, float c2) {\n\treturn (c2 < 0.5) ? (2.0*c1*c2+c1*c1*(1.0-2.0*c2)) : 2.0*c1*(1.0-c2)+sqrt(c1)*(2.0*c2-1.0);\n}\n\nvec3 blend_soft_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_soft_light_f(c1.x, c2.x), blend_soft_light_f(c1.y, c2.y), blend_soft_light_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_burn_f(float c1, float c2) {\n\treturn (c1==0.0)?c1:max((1.0-((1.0-c2)/c1)),0.0);\n}\n\nvec3 blend_burn(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_burn_f(c1.x, c2.x), blend_burn_f(c1.y, c2.y), blend_burn_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_dodge_f(float c1, float c2) {\n\treturn (c1==1.0)?c1:min(c2/(1.0-c1),1.0);\n}\n\nvec3 blend_dodge(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_dodge_f(c1.x, c2.x), blend_dodge_f(c1.y, c2.y), blend_dodge_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_lighten(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*max(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_darken(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*min(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_difference(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*clamp(c2-c1, vec3(0.0), vec3(1.0)) + (1.0-opacity)*c2;\n}\nconst float p_o710689_gradient_0_pos = 0.000000000;\nconst float p_o710689_gradient_0_r = 1.000000000;\nconst float p_o710689_gradient_0_g = 0.000000000;\nconst float p_o710689_gradient_0_b = 0.000000000;\nconst float p_o710689_gradient_0_a = 1.000000000;\nconst float p_o710689_gradient_1_pos = 0.105021078;\nconst float p_o710689_gradient_1_r = 0.785156250;\nconst float p_o710689_gradient_1_g = 0.000000000;\nconst float p_o710689_gradient_1_b = 0.000000000;\nconst float p_o710689_gradient_1_a = 1.000000000;\nconst float p_o710689_gradient_2_pos = 0.494770119;\nconst float p_o710689_gradient_2_r = 0.000000000;\nconst float p_o710689_gradient_2_g = 1.000000000;\nconst float p_o710689_gradient_2_b = 0.125000000;\nconst float p_o710689_gradient_2_a = 1.000000000;\nconst float p_o710689_gradient_3_pos = 0.895845170;\nconst float p_o710689_gradient_3_r = 0.031250000;\nconst float p_o710689_gradient_3_g = 0.000000000;\nconst float p_o710689_gradient_3_b = 1.000000000;\nconst float p_o710689_gradient_3_a = 1.000000000;\nconst float p_o710689_gradient_4_pos = 1.000000000;\nconst float p_o710689_gradient_4_r = 0.000000000;\nconst float p_o710689_gradient_4_g = 0.062500000;\nconst float p_o710689_gradient_4_b = 1.000000000;\nconst float p_o710689_gradient_4_a = 1.000000000;\nvec4 o710689_gradient_gradient_fct(float x) {\n  if (x < p_o710689_gradient_0_pos) {\n    return vec4(p_o710689_gradient_0_r,p_o710689_gradient_0_g,p_o710689_gradient_0_b,p_o710689_gradient_0_a);\n  } else if (x < p_o710689_gradient_1_pos) {\n    return mix(vec4(p_o710689_gradient_0_r,p_o710689_gradient_0_g,p_o710689_gradient_0_b,p_o710689_gradient_0_a), vec4(p_o710689_gradient_1_r,p_o710689_gradient_1_g,p_o710689_gradient_1_b,p_o710689_gradient_1_a), 0.5-0.5*cos(3.14159265359*(x-p_o710689_gradient_0_pos)/(p_o710689_gradient_1_pos-p_o710689_gradient_0_pos)));\n  } else if (x < p_o710689_gradient_2_pos) {\n    return mix(vec4(p_o710689_gradient_1_r,p_o710689_gradient_1_g,p_o710689_gradient_1_b,p_o710689_gradient_1_a), vec4(p_o710689_gradient_2_r,p_o710689_gradient_2_g,p_o710689_gradient_2_b,p_o710689_gradient_2_a), 0.5-0.5*cos(3.14159265359*(x-p_o710689_gradient_1_pos)/(p_o710689_gradient_2_pos-p_o710689_gradient_1_pos)));\n  } else if (x < p_o710689_gradient_3_pos) {\n    return mix(vec4(p_o710689_gradient_2_r,p_o710689_gradient_2_g,p_o710689_gradient_2_b,p_o710689_gradient_2_a), vec4(p_o710689_gradient_3_r,p_o710689_gradient_3_g,p_o710689_gradient_3_b,p_o710689_gradient_3_a), 0.5-0.5*cos(3.14159265359*(x-p_o710689_gradient_2_pos)/(p_o710689_gradient_3_pos-p_o710689_gradient_2_pos)));\n  } else if (x < p_o710689_gradient_4_pos) {\n    return mix(vec4(p_o710689_gradient_3_r,p_o710689_gradient_3_g,p_o710689_gradient_3_b,p_o710689_gradient_3_a), vec4(p_o710689_gradient_4_r,p_o710689_gradient_4_g,p_o710689_gradient_4_b,p_o710689_gradient_4_a), 0.5-0.5*cos(3.14159265359*(x-p_o710689_gradient_3_pos)/(p_o710689_gradient_4_pos-p_o710689_gradient_3_pos)));\n  }\n  return vec4(p_o710689_gradient_4_r,p_o710689_gradient_4_g,p_o710689_gradient_4_b,p_o710689_gradient_4_a);\n}\nconst float p_o755667_translate_y = 1.000000000;\nconst float p_o800540_translate_x = 1.000000000;\nconst float p_o800540_translate_y = 0.370000000;\nconst float p_o800540_rotate = 0.000000000;\nconst float p_o800540_scale_x = 1.000000000;\nconst float p_o800540_scale_y = 1.000000000;\nconst float seed_o800541 = 1093.000000000;\nconst float p_o800541_scale_x = 4.000000000;\nconst float p_o800541_scale_y = 4.000000000;\nconst float p_o800541_iterations = 2.000000000;\nconst float p_o800541_persistence = 0.100000000;\nconst float p_o695213_curve_0_x = 0.000000000;\nconst float p_o695213_curve_0_y = 1.000000000;\nconst float p_o695213_curve_0_ls = 0.000000000;\nconst float p_o695213_curve_0_rs = -1.000000000;\nconst float p_o695213_curve_1_x = 1.000000000;\nconst float p_o695213_curve_1_y = 0.000000000;\nconst float p_o695213_curve_1_ls = -1.000000000;\nconst float p_o695213_curve_1_rs = 0.000000000;\nfloat o695213_curve_curve_fct(float x) {\n{\nfloat dx = x - p_o695213_curve_0_x;\nfloat d = p_o695213_curve_1_x - p_o695213_curve_0_x;\nfloat t = dx/d;\nfloat omt = (1.0 - t);\nfloat omt2 = omt * omt;\nfloat omt3 = omt2 * omt;\nfloat t2 = t * t;\nfloat t3 = t2 * t;\nd /= 3.0;\nfloat y1 = p_o695213_curve_0_y;\nfloat yac = p_o695213_curve_0_y + d*p_o695213_curve_0_rs;\nfloat ybc = p_o695213_curve_1_y - d*p_o695213_curve_1_ls;\nfloat y2 = p_o695213_curve_1_y;\nreturn y1*omt3 + yac*omt2*t*3.0 + ybc*omt*t2*3.0 + y2*t3;\n}\n}\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o800541_0_1_f = perlin(((UV)-vec2((round(iTime*0.2*0.8)*sin(iTime*0.1*0.8)), p_o755667_translate_y)), vec2(p_o800541_scale_x, p_o800541_scale_y), int(p_o800541_iterations), p_o800541_persistence, (seed_o800541+_seed_variation_));\nfloat o800541_0_3_f = perlin((transform(((UV)-vec2((round(iTime*0.2*0.8)*sin(iTime*0.1*0.8)), p_o755667_translate_y)), vec2(p_o800540_translate_x*(2.0*o800541_0_1_f-1.0), p_o800540_translate_y*(2.0*o800541_0_1_f-1.0)), p_o800540_rotate*0.01745329251*(2.0*1.0-1.0), vec2(p_o800540_scale_x*(2.0*1.0-1.0), p_o800540_scale_y*(2.0*1.0-1.0)), true)), vec2(p_o800541_scale_x, p_o800541_scale_y), int(p_o800541_iterations), p_o800541_persistence, (seed_o800541+_seed_variation_));\nvec4 o800540_0_1_rgba = vec4(vec3(o800541_0_3_f), 1.0);\nvec4 o755667_0_1_rgba = o800540_0_1_rgba;\nfloat o695213_0_1_f = o695213_curve_curve_fct((dot((o755667_0_1_rgba).rgb, vec3(1.0))/3.0));\nvec4 o690393_0_s1 = o755667_0_1_rgba;\nvec4 o690393_0_s2 = vec4(1.0, ((UV)).y, 1.0, 1.0);\nfloat o690393_0_a = (abs(iTime*0.2)*sin(iTime*0.2))*o695213_0_1_f;\nvec4 o690393_0_2_rgba = vec4(blend_lighten((UV), o690393_0_s1.rgb, o690393_0_s2.rgb, o690393_0_a*o690393_0_s1.a), min(1.0, o690393_0_s2.a+o690393_0_a*o690393_0_s1.a));\nvec4 o710689_0_1_rgba = o710689_gradient_gradient_fct((dot((o690393_0_2_rgba).rgb, vec3(1.0))/3.0));\ngl_FragColor = o710689_0_1_rgba;\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"114",objOut:"113"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"114",objOut:"113"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"114",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"mirrored repeat"},{name:"Floating Point",value:true},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"120",objOut:"114"}]},{name:"Texture",links:[{portIn:"Texture In",portOut:"Texture",objIn:"117",objOut:"114"}]},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Anim.Timer_v2",id:"115",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Speed",value:3.39},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"iTime",portOut:"Time",objIn:"113",objOut:"115"},{portIn:"time",portOut:"Time",objIn:"121",objOut:"115"}]}]},{objName:"Ops.Sequence",id:"116",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"113",objOut:"116"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Ui.VizTexture",id:"117",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"118",objOut:"117"}]},{name:"Info",value:"unknown"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"118",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"121",objOut:"118"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v2",id:"119",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"118",objOut:"119"},{portIn:"exe",portOut:"Next",objIn:"116",objOut:"119"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"122",objOut:"119"}]},{name:"Aspect Ratio",value:1.3333333333333333}]},{objName:"Ops.Gl.Meshes.Rectangle_v2",id:"120",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"width",value:1},{name:"height",value:1},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"num columns",value:1},{name:"num rows",value:1},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Active",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.TextureEffects.Wobble",id:"121",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"time"},{name:"SpeedX",value:4},{name:"SpeedY",value:8},{name:"RepeatX",value:57.62},{name:"RepeatY",value:11},{name:"Multiply",value:.01},{name:"Mask",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"179",objOut:"121"}]}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"122",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Trigger.GateTrigger",id:"123",uiAttribs:{},portsIn:[{name:"Execute"},{name:"Pass Through"}],portsOut:[{name:"Trigger out",links:[{portIn:"in0 Ops.Trigger.GateTrigger Trigger out",portOut:"Trigger out",objIn:"302",objOut:"123"}]}]},{objName:"Ops.Boolean.ToggleBool",id:"124",uiAttribs:{},portsIn:[{name:"trigger"},{name:"reset",value:0},{name:"Default",value:false}],portsOut:[{name:"result",links:[{portIn:"Pass Through",portOut:"result",objIn:"123",objOut:"124"},{portIn:"Input",portOut:"result",objIn:"296",objOut:"124"}]}]},{objName:"Ops.Gl.TextureEffects.Gradient",id:"125",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"difference"},{name:"Amount",value:1},{name:"Width",value:1},{name:"Type index",value:0},{name:"Type",value:"X"},{name:"Pos"},{name:"Smoothstep",value:true},{name:"r",value:1},{name:"g",value:0},{name:"b",value:0},{name:"r2",value:0},{name:"g2",value:0},{name:"b2",value:0},{name:"r3",value:0},{name:"g3",value:.20000000000000018},{name:"b3",value:1},{name:"Randomize",value:0}],portsOut:[{name:"Next",links:[{portIn:"Render",portOut:"Next",objIn:"101",objOut:"125"}]}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"126",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"129",objOut:"126"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v2",id:"127",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"126",objOut:"127"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"99",objOut:"127"}]},{name:"Aspect Ratio",value:1.3333333333333333}]},{objName:"Ops.Gl.TextureEffects.Wobble",id:"128",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"time",value:0},{name:"SpeedX",value:4},{name:"SpeedY",value:8},{name:"RepeatX",value:57.62},{name:"RepeatY",value:11},{name:"Multiply",value:.01},{name:"Mask",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"exe 7",portOut:"Trigger",objIn:"271",objOut:"128"}]}]},{objName:"Ops.Gl.TextureEffects.Gradient",id:"129",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"hardlight"},{name:"Amount",value:1},{name:"Width",value:1},{name:"Type index",value:0},{name:"Type",value:"Radial"},{name:"Pos",value:.293},{name:"Smoothstep",value:true},{name:"r",value:1},{name:"g",value:0},{name:"b",value:0},{name:"r2",value:0},{name:"g2",value:0},{name:"b2",value:0},{name:"r3",value:0},{name:"g3",value:0},{name:"b3",value:1},{name:"Randomize",value:0}],portsOut:[{name:"Next",links:[{portIn:"Render",portOut:"Next",objIn:"128",objOut:"129"}]}]},{objName:"Ops.Devices.Keyboard.KeyPressLearn",id:"130",uiAttribs:{},portsIn:[{name:"key code",value:17},{name:"canvas only",value:true},{name:"Mod Key index",value:0},{name:"Mod Key",value:"none"},{name:"Enabled",value:true},{name:"Prevent Default",value:false},{name:"learn",value:0}],portsOut:[{name:"on press",links:[{portIn:"Set",portOut:"on press",objIn:"131",objOut:"130"},{portIn:"trigger",portOut:"on press",objIn:"124",objOut:"130"}]},{name:"on release",links:[{portIn:"Trigger",portOut:"on release",objIn:"155",objOut:"130"}]},{name:"Pressed",value:0},{name:"Key",value:"Control"}]},{objName:"Ops.Trigger.SetNumberOnTrigger",id:"131",uiAttribs:{},portsIn:[{name:"Set"},{name:"Number",value:0}],portsOut:[{name:"Next",value:0},{name:"Out Value",value:0}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"132",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat sphere(vec2 uv, vec2 c, float r) {\n\tuv -= c;\n\tuv /= r;\n\treturn 2.0*r*sqrt(max(0.0, 1.0-dot(uv, uv)));\n}\nconst float p_o254341_R = 0.210000000;\nconst float p_o254341_r = 0.270000000;\nvec2 o256395_input_sdf(vec3 p, float _seed_variation_) {\nvec2 o254341_0_q = vec2(length((p).zx)-p_o254341_R,(p).y);\nfloat o254341_0_1_sdf3d = length(o254341_0_q)-p_o254341_r;\n\nreturn vec2(o254341_0_1_sdf3d, 0.0);\n}\nvec2 raymarch_o256395(vec2 uv, float _seed_variation_) {\n\tvec3 ro = vec3(uv-vec2(0.5), 1.0);\n\tvec3 rd = vec3(0.0, 0.0, -1.0);\n\tfloat dO = 0.0;\n\tfloat c = 0.0;\n    for (int i=0; i < 100; i++) {\n    \tvec3 p = ro + rd*dO;\n        vec2 dS = o256395_input_sdf(p, _seed_variation_);\n        dO += dS.x;\n\n        if (dO >= 1.0) {\n\t\t\tbreak;\n\t\t} else if (dS.x < 0.0001) {\n\t\t\tc = dS.y;\n\t\t\tbreak;\n\t\t}\n    }\n    \n    return vec2(dO, c);\n}\n\nvec3 normal_o256395(vec3 p, float _seed_variation_) {\n\tif (p.z <= 0.0) {\n\t\treturn vec3(0.0, 0.0, 1.0);\n\t}\n\n\tfloat d = o256395_input_sdf(p, _seed_variation_).x;\n    float e = .001;\n    \n    vec3 n = d - vec3(\n        o256395_input_sdf(p-vec3(e, 0.0, 0.0), _seed_variation_).x,\n        o256395_input_sdf(p-vec3(0.0, e, 0.0), _seed_variation_).x,\n        o256395_input_sdf(p-vec3(0.0, 0.0, e), _seed_variation_).x);\n    \n    return vec3(-1.0, -1.0, -1.0)*normalize(n);\n}\n\nconst float p_o207924_d = 0.810000000;\nconst float p_o57201_cx = 0.500000000;\nconst float p_o57201_cy = 0.500000000;\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nvec2 o256395_0_d = raymarch_o256395((UV), _seed_variation_);\nvec3 o256395_1_1_rgb = vec3(0.5)+0.5*normal_o256395(vec3((UV)-vec2(0.5), 1.0-o256395_0_d.x), _seed_variation_);\nfloat o57201_0_1_f = sphere(((vec4(o256395_1_1_rgb, 0.0)).xy+vec2(0.5)), vec2(p_o57201_cx, p_o57201_cy), (sin(iTime*0.9)*sin(iTime*0.5)));\nvec3 o241986_0_1_tex3d = vec3(o57201_0_1_f);\nvec3 o207924_0_1_tex3d = mix(o241986_0_1_tex3d, vec3(0.5), clamp(0.0/max(p_o207924_d, 0.0001), 0.0, 1.0));\nvec3 o245261_0_1_rgb = o207924_0_1_tex3d;\ngl_FragColor = vec4(o245261_0_1_rgb, 1.0);\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"133",objOut:"132"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"133",objOut:"132"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"133",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"mirrored repeat"},{name:"Floating Point",value:true},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"146",objOut:"133"}]},{name:"Texture",links:[{portIn:"Texture In",portOut:"Texture",objIn:"136",objOut:"133"}]},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Anim.Timer_v2",id:"134",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Speed",value:1},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"iTime",portOut:"Time",objIn:"132",objOut:"134"},{portIn:"time",portOut:"Time",objIn:"141",objOut:"134"},{portIn:"time",portOut:"Time",objIn:"149",objOut:"134"},{portIn:"Rotate",portOut:"Time",objIn:"150",objOut:"134"}]}]},{objName:"Ops.Sequence",id:"135",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"132",objOut:"135"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Ui.VizTexture",id:"136",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"138",objOut:"136"}]},{name:"Info",value:"unknown"}]},{objName:"Ops.Gl.Render2Texture",id:"137",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render",value:null},{name:"use viewport size",value:true},{name:"texture width",value:640},{name:"texture height",value:320},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:true},{name:"Clear",value:true}],portsOut:[{name:"trigger",value:0},{name:"texture"},{name:"textureDepth"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"138",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"151",objOut:"138"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v2",id:"139",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"138",objOut:"139"},{portIn:"exe",portOut:"Next",objIn:"135",objOut:"139"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"142",objOut:"139"}]},{name:"Aspect Ratio",value:.9026798307475318}]},{objName:"Ops.Gl.Meshes.Rectangle_v2",id:"140",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"width",value:1},{name:"height",value:1},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"num columns",value:1},{name:"num rows",value:1},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Active",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.TextureEffects.Wobble",id:"141",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"time"},{name:"SpeedX",value:4},{name:"SpeedY",value:8},{name:"RepeatX",value:57.62},{name:"RepeatY",value:11},{name:"Multiply",value:.01},{name:"Mask",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"Render",portOut:"Trigger",objIn:"149",objOut:"141"}]}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"142",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"143",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"144",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render",value:null},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture",value:0}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"145",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.TextureEffects.ColorMap",id:"146",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Gradient"},{name:"Method index",value:0},{name:"Method",value:"Luminance"},{name:"Min",value:.258},{name:"Max",value:1},{name:"Position",value:1}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"140",objOut:"146"}]}]},{objName:"Ops.Gl.GradientTexture",id:"147",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":1,"g":0,"b":0},{"pos":0.25,"r":1,"g":0,"b":0},{"pos":0.386,"r":0.7604346180181212,"g":0.5489903204869321,"b":0.8147596590458878},{"pos":0.432,"r":0,"g":0.11999999999999966,"b":1},{"pos":1,"r":0,"g":0.11999999999999966,"b":1}]}'},{name:"Direction index",value:0},{name:"Direction",value:"X"},{name:"Smoothstep",value:false},{name:"Step",value:true},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:256},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Gradient Array",value:0},{name:"Randomize Colors",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Gradient",portOut:"Texture",objIn:"146",objOut:"147"}]},{name:"Colors"},{name:"Colors Pos"}]},{objName:"Ops.Gl.TextureEffects.Mirror",id:"148",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"axis index",value:0},{name:"axis",value:"X"},{name:"width",value:5.32},{name:"offset",value:0},{name:"flip",value:true}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"153",objOut:"148"}]}]},{objName:"Ops.Gl.TextureEffects.Wobble",id:"149",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"time"},{name:"SpeedX",value:4},{name:"SpeedY",value:8},{name:"RepeatX",value:.06},{name:"RepeatY",value:.11},{name:"Multiply",value:6.71},{name:"Mask",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"148",objOut:"149"}]}]},{objName:"Ops.Gl.TextureEffects.Waveform_v2",id:"150",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:.555},{name:"Waveform index",value:0},{name:"Waveform",value:"Square"},{name:"Amplitude",value:.5},{name:"Frequency",value:2.05},{name:"Line Width",value:0},{name:"Line Glow",value:.089},{name:"invert color",value:false},{name:"Solid fill",value:false},{name:"Offset X",value:0},{name:"Offset Y",value:.478},{name:"Rotate"},{name:"r",value:1},{name:"g",value:1},{name:"b",value:1}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"146",objOut:"150"},{portIn:"exe 10",portOut:"trigger",objIn:"271",objOut:"150"}]}]},{objName:"Ops.Gl.TextureEffects.ColorMap",id:"151",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"multiply invert"},{name:"Amount",value:1},{name:"Gradient"},{name:"Method index",value:0},{name:"Method",value:"Luminance"},{name:"Min",value:.478},{name:"Max",value:1},{name:"Position",value:.383}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"141",objOut:"151"}]}]},{objName:"Ops.Gl.GradientTexture",id:"152",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":1,"g":0,"b":0},{"pos":0.392,"r":1,"g":0,"b":0},{"pos":0.588,"r":0.08000000000000008,"g":0,"b":1},{"pos":1,"r":0.08000000000000008,"g":0,"b":1}]}'},{name:"Direction index",value:0},{name:"Direction",value:"X"},{name:"Smoothstep",value:true},{name:"Step",value:true},{name:"Flip",value:true},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:256},{name:"filter index",value:1},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"mirrored repeat"},{name:"Gradient Array",value:0},{name:"Randomize Colors",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Gradient",portOut:"Texture",objIn:"151",objOut:"152"}]},{name:"Colors"},{name:"Colors Pos"}]},{objName:"Ops.Gl.TextureEffects.Twirl_v3",id:"153",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"exclusion"},{name:"Amount"},{name:"Twist amount",value:200},{name:"Radius",value:.5},{name:"Center X",value:.5},{name:"Center Y",value:.5}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"150",objOut:"153"}]}]},{objName:"Ops.Anim.Timer_v2",id:"154",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Speed",value:2.92},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"Amount",portOut:"Time",objIn:"153",objOut:"154"}]}]},{objName:"Ops.Trigger.TriggerSend",id:"155",uiAttribs:{},portsIn:[{name:"Trigger"},{name:"Named Trigger",value:"TimerStart"}],portsOut:[]},{objName:"Ops.Trigger.TriggerReceive",id:"156",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Named Trigger",value:"TimerStart"}],portsOut:[{name:"Triggered",links:[{portIn:"Reset",portOut:"Triggered",objIn:"154",objOut:"156"}]}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"157",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat sphere(vec2 uv, vec2 c, float r) {\n\tuv -= c;\n\tuv /= r;\n\treturn 2.0*r*sqrt(max(0.0, 1.0-dot(uv, uv)));\n}\nfloat box(vec2 uv, vec3 center, vec3 rad, vec3 rot) {\n\tvec3 ro = vec3(uv, 1.0)-center;\n\tvec3 rd = vec3(0.0000001, 0.0000001, -1.0);\n\tmat3 r = mat3(vec3(1, 0, 0), vec3(0, cos(rot.x), -sin(rot.x)), vec3(0, sin(rot.x), cos(rot.x)));\n\tr *= mat3(vec3(cos(rot.y), 0, -sin(rot.y)), vec3(0, 1, 0), vec3(sin(rot.y), 0, cos(rot.y)));\n\tr *= mat3(vec3(cos(rot.z), -sin(rot.z), 0), vec3(sin(rot.z), cos(rot.z), 0), vec3(0, 0, 1));\n\tro = r * ro;\n\trd = r * rd;\n    vec3 m = 1.0/rd;\n    vec3 n = m*ro;\n    vec3 k = abs(m)*rad;\n    vec3 t1 = -n - k;\n    vec3 t2 = -n + k;\n\n    float tN = max(max(t1.x, t1.y), t1.z);\n    float tF = min(min(t2.x, t2.y), t2.z);\n    if(tN>tF || tF<0.0) return 1.0;\n    return tN;\n}vec3 blend_normal(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1 + (1.0-opacity)*c2;\n}\n\nvec3 blend_dissolve(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\tif (rand(uv) < opacity) {\n\t\treturn c1;\n\t} else {\n\t\treturn c2;\n\t}\n}\n\nvec3 blend_multiply(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1*c2 + (1.0-opacity)*c2;\n}\n\nvec3 blend_screen(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*(1.0-(1.0-c1)*(1.0-c2)) + (1.0-opacity)*c2;\n}\n\nfloat blend_overlay_f(float c1, float c2) {\n\treturn (c1 < 0.5) ? (2.0*c1*c2) : (1.0-2.0*(1.0-c1)*(1.0-c2));\n}\n\nvec3 blend_overlay(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_overlay_f(c1.x, c2.x), blend_overlay_f(c1.y, c2.y), blend_overlay_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_hard_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*0.5*(c1*c2+blend_overlay(uv, c1, c2, 1.0)) + (1.0-opacity)*c2;\n}\n\nfloat blend_soft_light_f(float c1, float c2) {\n\treturn (c2 < 0.5) ? (2.0*c1*c2+c1*c1*(1.0-2.0*c2)) : 2.0*c1*(1.0-c2)+sqrt(c1)*(2.0*c2-1.0);\n}\n\nvec3 blend_soft_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_soft_light_f(c1.x, c2.x), blend_soft_light_f(c1.y, c2.y), blend_soft_light_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_burn_f(float c1, float c2) {\n\treturn (c1==0.0)?c1:max((1.0-((1.0-c2)/c1)),0.0);\n}\n\nvec3 blend_burn(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_burn_f(c1.x, c2.x), blend_burn_f(c1.y, c2.y), blend_burn_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_dodge_f(float c1, float c2) {\n\treturn (c1==1.0)?c1:min(c2/(1.0-c1),1.0);\n}\n\nvec3 blend_dodge(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_dodge_f(c1.x, c2.x), blend_dodge_f(c1.y, c2.y), blend_dodge_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_lighten(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*max(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_darken(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*min(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_difference(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*clamp(c2-c1, vec3(0.0), vec3(1.0)) + (1.0-opacity)*c2;\n}\nconst float p_o419741_gradient_0_pos = 0.000000000;\nconst float p_o419741_gradient_0_r = 1.000000000;\nconst float p_o419741_gradient_0_g = 0.000000000;\nconst float p_o419741_gradient_0_b = 0.000000000;\nconst float p_o419741_gradient_0_a = 1.000000000;\nconst float p_o419741_gradient_1_pos = 0.436363186;\nconst float p_o419741_gradient_1_r = 1.000000000;\nconst float p_o419741_gradient_1_g = 0.968750000;\nconst float p_o419741_gradient_1_b = 0.000000000;\nconst float p_o419741_gradient_1_a = 1.000000000;\nconst float p_o419741_gradient_2_pos = 0.527273005;\nconst float p_o419741_gradient_2_r = 0.000000000;\nconst float p_o419741_gradient_2_g = 1.000000000;\nconst float p_o419741_gradient_2_b = 0.125000000;\nconst float p_o419741_gradient_2_a = 1.000000000;\nconst float p_o419741_gradient_3_pos = 0.627272727;\nconst float p_o419741_gradient_3_r = 0.843750000;\nconst float p_o419741_gradient_3_g = 0.000000000;\nconst float p_o419741_gradient_3_b = 1.000000000;\nconst float p_o419741_gradient_3_a = 1.000000000;\nconst float p_o419741_gradient_4_pos = 1.000000000;\nconst float p_o419741_gradient_4_r = 0.000000000;\nconst float p_o419741_gradient_4_g = 0.062500000;\nconst float p_o419741_gradient_4_b = 1.000000000;\nconst float p_o419741_gradient_4_a = 1.000000000;\nvec4 o419741_gradient_gradient_fct(float x) {\n  if (x < p_o419741_gradient_0_pos) {\n    return vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a);\n  } else if (x < p_o419741_gradient_1_pos) {\n    return mix(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)), mix(vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a), vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), (x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos)), 1.0-0.5*(x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos));\n  } else if (x < p_o419741_gradient_2_pos) {\n    return 0.5*(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)) + mix(mix(vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a), vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), (x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos)), mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)), 0.5-0.5*cos(3.14159265359*(x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos))));\n  } else if (x < p_o419741_gradient_3_pos) {\n    return 0.5*(mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)) + mix(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)), mix(vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a), (x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos)), 0.5-0.5*cos(3.14159265359*(x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos))));\n  } else if (x < p_o419741_gradient_4_pos) {\n    return mix(mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)), mix(vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a), (x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos)), 0.5+0.5*(x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos));\n  }\n  return vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a);\n}\nconst float p_o398645_amount = 11.490000000;\nconst float p_o254341_r = 0.500000000;\nvec2 o256395_input_sdf(vec3 p, float _seed_variation_) {\nvec2 o254341_0_q = vec2(length((p).xy)-(sin(iTime*0.2)),(p).z);\nfloat o254341_0_1_sdf3d = length(o254341_0_q)-p_o254341_r;\n\nreturn vec2(o254341_0_1_sdf3d, 0.0);\n}\nvec2 raymarch_o256395(vec2 uv, float _seed_variation_) {\n\tvec3 ro = vec3(uv-vec2(0.5), 1.0);\n\tvec3 rd = vec3(0.0, 0.0, -1.0);\n\tfloat dO = 0.0;\n\tfloat c = 0.0;\n    for (int i=0; i < 100; i++) {\n    \tvec3 p = ro + rd*dO;\n        vec2 dS = o256395_input_sdf(p, _seed_variation_);\n        dO += dS.x;\n\n        if (dO >= 1.0) {\n\t\t\tbreak;\n\t\t} else if (dS.x < 0.0001) {\n\t\t\tc = dS.y;\n\t\t\tbreak;\n\t\t}\n    }\n    \n    return vec2(dO, c);\n}\n\nvec3 normal_o256395(vec3 p, float _seed_variation_) {\n\tif (p.z <= 0.0) {\n\t\treturn vec3(0.0, 0.0, 1.0);\n\t}\n\n\tfloat d = o256395_input_sdf(p, _seed_variation_).x;\n    float e = .001;\n    \n    vec3 n = d - vec3(\n        o256395_input_sdf(p-vec3(e, 0.0, 0.0), _seed_variation_).x,\n        o256395_input_sdf(p-vec3(0.0, e, 0.0), _seed_variation_).x,\n        o256395_input_sdf(p-vec3(0.0, 0.0, e), _seed_variation_).x);\n    \n    return vec3(-1.0, -1.0, -1.0)*normalize(n);\n}\n\nconst float p_o207924_d = 0.270000000;\nconst float p_o57201_cx = 0.500000000;\nconst float p_o57201_cy = 0.500000000;\nconst float p_o479214_gradient_0_pos = 0.236363636;\nconst float p_o479214_gradient_0_r = 0.000000000;\nconst float p_o479214_gradient_0_g = 0.062500000;\nconst float p_o479214_gradient_0_b = 1.000000000;\nconst float p_o479214_gradient_0_a = 1.000000000;\nconst float p_o479214_gradient_1_pos = 0.590909368;\nconst float p_o479214_gradient_1_r = 0.000000000;\nconst float p_o479214_gradient_1_g = 1.000000000;\nconst float p_o479214_gradient_1_b = 0.125000000;\nconst float p_o479214_gradient_1_a = 1.000000000;\nconst float p_o479214_gradient_2_pos = 0.800000000;\nconst float p_o479214_gradient_2_r = 1.000000000;\nconst float p_o479214_gradient_2_g = 0.000000000;\nconst float p_o479214_gradient_2_b = 0.000000000;\nconst float p_o479214_gradient_2_a = 1.000000000;\nconst float p_o479214_gradient_3_pos = 0.836363636;\nconst float p_o479214_gradient_3_r = 0.843750000;\nconst float p_o479214_gradient_3_g = 0.000000000;\nconst float p_o479214_gradient_3_b = 1.000000000;\nconst float p_o479214_gradient_3_a = 1.000000000;\nconst float p_o479214_gradient_4_pos = 1.000000000;\nconst float p_o479214_gradient_4_r = 1.000000000;\nconst float p_o479214_gradient_4_g = 0.968750000;\nconst float p_o479214_gradient_4_b = 0.000000000;\nconst float p_o479214_gradient_4_a = 1.000000000;\nvec4 o479214_gradient_gradient_fct(float x) {\n  if (x < p_o479214_gradient_0_pos) {\n    return vec4(p_o479214_gradient_0_r,p_o479214_gradient_0_g,p_o479214_gradient_0_b,p_o479214_gradient_0_a);\n  } else if (x < p_o479214_gradient_1_pos) {\n    return mix(vec4(p_o479214_gradient_0_r,p_o479214_gradient_0_g,p_o479214_gradient_0_b,p_o479214_gradient_0_a), vec4(p_o479214_gradient_1_r,p_o479214_gradient_1_g,p_o479214_gradient_1_b,p_o479214_gradient_1_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_0_pos)/(p_o479214_gradient_1_pos-p_o479214_gradient_0_pos)));\n  } else if (x < p_o479214_gradient_2_pos) {\n    return mix(vec4(p_o479214_gradient_1_r,p_o479214_gradient_1_g,p_o479214_gradient_1_b,p_o479214_gradient_1_a), vec4(p_o479214_gradient_2_r,p_o479214_gradient_2_g,p_o479214_gradient_2_b,p_o479214_gradient_2_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_1_pos)/(p_o479214_gradient_2_pos-p_o479214_gradient_1_pos)));\n  } else if (x < p_o479214_gradient_3_pos) {\n    return mix(vec4(p_o479214_gradient_2_r,p_o479214_gradient_2_g,p_o479214_gradient_2_b,p_o479214_gradient_2_a), vec4(p_o479214_gradient_3_r,p_o479214_gradient_3_g,p_o479214_gradient_3_b,p_o479214_gradient_3_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_2_pos)/(p_o479214_gradient_3_pos-p_o479214_gradient_2_pos)));\n  } else if (x < p_o479214_gradient_4_pos) {\n    return mix(vec4(p_o479214_gradient_3_r,p_o479214_gradient_3_g,p_o479214_gradient_3_b,p_o479214_gradient_3_a), vec4(p_o479214_gradient_4_r,p_o479214_gradient_4_g,p_o479214_gradient_4_b,p_o479214_gradient_4_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_3_pos)/(p_o479214_gradient_4_pos-p_o479214_gradient_3_pos)));\n  }\n  return vec4(p_o479214_gradient_4_r,p_o479214_gradient_4_g,p_o479214_gradient_4_b,p_o479214_gradient_4_a);\n}\nconst float p_o520101_radius = 0.480000000;\nconst float p_o520101_repeat = 6.000000000;\nconst float p_o270325_cx = 0.500000000;\nconst float p_o270325_cy = 0.500000000;\nconst float p_o270325_cz = 0.500000000;\nconst float p_o270325_sx = 0.250000000;\nconst float p_o270325_sy = 0.250000000;\nconst float p_o270325_sz = 0.250000000;\nconst float p_o270325_rx = 0.000000000;\nconst float p_o270325_ry = 0.000000000;\nconst float p_o270325_rz = 0.000000000;\nconst float p_o457554_repeat = 1.000000000;\nconst float p_o457554_gradient_0_pos = 0.000000000;\nconst float p_o457554_gradient_0_r = 0.000000000;\nconst float p_o457554_gradient_0_g = 0.000000000;\nconst float p_o457554_gradient_0_b = 0.000000000;\nconst float p_o457554_gradient_0_a = 1.000000000;\nconst float p_o457554_gradient_1_pos = 0.178294574;\nconst float p_o457554_gradient_1_r = 1.000000000;\nconst float p_o457554_gradient_1_g = 1.000000000;\nconst float p_o457554_gradient_1_b = 1.000000000;\nconst float p_o457554_gradient_1_a = 1.000000000;\nvec4 o457554_gradient_gradient_fct(float x) {\n  if (x < p_o457554_gradient_0_pos) {\n    return vec4(p_o457554_gradient_0_r,p_o457554_gradient_0_g,p_o457554_gradient_0_b,p_o457554_gradient_0_a);\n  } else if (x < p_o457554_gradient_1_pos) {\n    return mix(vec4(p_o457554_gradient_0_r,p_o457554_gradient_0_g,p_o457554_gradient_0_b,p_o457554_gradient_0_a), vec4(p_o457554_gradient_1_r,p_o457554_gradient_1_g,p_o457554_gradient_1_b,p_o457554_gradient_1_a), ((x-p_o457554_gradient_0_pos)/(p_o457554_gradient_1_pos-p_o457554_gradient_0_pos)));\n  }\n  return vec4(p_o457554_gradient_1_r,p_o457554_gradient_1_g,p_o457554_gradient_1_b,p_o457554_gradient_1_a);\n}\n\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nvec2 o256395_0_d = raymarch_o256395((UV), _seed_variation_);\nvec3 o256395_1_1_rgb = vec3(0.5)+0.5*normal_o256395(vec3((UV)-vec2(0.5), 1.0-o256395_0_d.x), _seed_variation_);\nfloat o57201_0_1_f = sphere(((vec4(o256395_1_1_rgb, 0.0)).xy+vec2(0.5)), vec2(p_o57201_cx, p_o57201_cy), (sin(iTime*0.9)*sin(iTime*0.9)));\nvec3 o241986_0_1_tex3d = vec3(o57201_0_1_f);\nvec2 o254341_0_q = vec2(length(((vec4(o256395_1_1_rgb, 0.0)).xyz).xy)-(sin(iTime*0.2)),((vec4(o256395_1_1_rgb, 0.0)).xyz).z);\nfloat o254341_0_1_sdf3d = length(o254341_0_q)-p_o254341_r;\nvec3 o207924_0_1_tex3d = mix(o241986_0_1_tex3d, vec3(0.5), clamp(o254341_0_1_sdf3d/max(p_o207924_d, 0.0001), 0.0, 1.0));\nvec3 o245261_0_1_rgb = o207924_0_1_tex3d;\nfloat o270325_0_1_f = 1.0-box((vec2(fract(p_o520101_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o520101_radius*length((UV)-vec2(0.5))))), vec3(p_o270325_cx, p_o270325_cy, p_o270325_cz), vec3(p_o270325_sx, p_o270325_sy, p_o270325_sz), 0.01745329251*vec3(p_o270325_rx, p_o270325_ry, p_o270325_rz));\nvec4 o520101_0_1_rgba = vec4(vec3(o270325_0_1_f), 1.0);\nvec4 o479214_0_1_rgba = o479214_gradient_gradient_fct((dot((o520101_0_1_rgba).rgb, vec3(1.0))/3.0));\nvec4 o457554_0_1_rgba = o457554_gradient_gradient_fct(fract(p_o457554_repeat*1.41421356237*length(fract((UV))-vec2(0.5, 0.5))));\nvec4 o398645_0_s1 = vec4(o245261_0_1_rgb, 1.0);\nvec4 o398645_0_s2 = o479214_0_1_rgba;\nfloat o398645_0_a = p_o398645_amount*(dot((o457554_0_1_rgba).rgb, vec3(1.0))/3.0);\nvec4 o398645_0_1_rgba = vec4(blend_soft_light((UV), o398645_0_s1.rgb, o398645_0_s2.rgb, o398645_0_a*o398645_0_s1.a), min(1.0, o398645_0_s2.a+o398645_0_a*o398645_0_s1.a));\nvec4 o419741_0_1_rgba = o419741_gradient_gradient_fct((dot((o398645_0_1_rgba).rgb, vec3(1.0))/3.0));\ngl_FragColor = o419741_0_1_rgba;\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"158",objOut:"157"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"158",objOut:"157"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"158",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"mirrored repeat"},{name:"Floating Point",value:true},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"164",objOut:"158"}]},{name:"Texture",links:[{portIn:"Texture In",portOut:"Texture",objIn:"161",objOut:"158"}]},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Anim.Timer_v2",id:"159",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Speed",value:2.14},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"iTime",portOut:"Time",objIn:"157",objOut:"159"},{portIn:"time",portOut:"Time",objIn:"165",objOut:"159"}]}]},{objName:"Ops.Sequence",id:"160",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"157",objOut:"160"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",links:[{portIn:"Render",portOut:"trigger 15",objIn:"172",objOut:"160"}]}]},{objName:"Ops.Ui.VizTexture",id:"161",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"162",objOut:"161"}]},{name:"Info",value:"unknown"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"162",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"165",objOut:"162"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v2",id:"163",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"162",objOut:"163"},{portIn:"exe",portOut:"Next",objIn:"160",objOut:"163"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"145",objOut:"163"}]},{name:"Aspect Ratio",value:.9026798307475318}]},{objName:"Ops.Gl.Meshes.Rectangle_v2",id:"164",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"width",value:1},{name:"height",value:1},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"num columns",value:1},{name:"num rows",value:1},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Active",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.TextureEffects.Wobble",id:"165",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"time"},{name:"SpeedX",value:4},{name:"SpeedY",value:8},{name:"RepeatX",value:57.62},{name:"RepeatY",value:11},{name:"Multiply",value:.01},{name:"Mask",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"exe 11",portOut:"Trigger",objIn:"271",objOut:"165"}]}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"166",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat box(vec2 uv, vec3 center, vec3 rad, vec3 rot) {\n\tvec3 ro = vec3(uv, 1.0)-center;\n\tvec3 rd = vec3(0.0000001, 0.0000001, -1.0);\n\tmat3 r = mat3(vec3(1, 0, 0), vec3(0, cos(rot.x), -sin(rot.x)), vec3(0, sin(rot.x), cos(rot.x)));\n\tr *= mat3(vec3(cos(rot.y), 0, -sin(rot.y)), vec3(0, 1, 0), vec3(sin(rot.y), 0, cos(rot.y)));\n\tr *= mat3(vec3(cos(rot.z), -sin(rot.z), 0), vec3(sin(rot.z), cos(rot.z), 0), vec3(0, 0, 1));\n\tro = r * ro;\n\trd = r * rd;\n    vec3 m = 1.0/rd;\n    vec3 n = m*ro;\n    vec3 k = abs(m)*rad;\n    vec3 t1 = -n - k;\n    vec3 t2 = -n + k;\n\n    float tN = max(max(t1.x, t1.y), t1.z);\n    float tF = min(min(t2.x, t2.y), t2.z);\n    if(tN>tF || tF<0.0) return 1.0;\n    return tN;\n}float sphere(vec2 uv, vec2 c, float r) {\n\tuv -= c;\n\tuv /= r;\n\treturn 2.0*r*sqrt(max(0.0, 1.0-dot(uv, uv)));\n}\nvec3 blend_normal(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1 + (1.0-opacity)*c2;\n}\n\nvec3 blend_dissolve(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\tif (rand(uv) < opacity) {\n\t\treturn c1;\n\t} else {\n\t\treturn c2;\n\t}\n}\n\nvec3 blend_multiply(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1*c2 + (1.0-opacity)*c2;\n}\n\nvec3 blend_screen(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*(1.0-(1.0-c1)*(1.0-c2)) + (1.0-opacity)*c2;\n}\n\nfloat blend_overlay_f(float c1, float c2) {\n\treturn (c1 < 0.5) ? (2.0*c1*c2) : (1.0-2.0*(1.0-c1)*(1.0-c2));\n}\n\nvec3 blend_overlay(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_overlay_f(c1.x, c2.x), blend_overlay_f(c1.y, c2.y), blend_overlay_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_hard_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*0.5*(c1*c2+blend_overlay(uv, c1, c2, 1.0)) + (1.0-opacity)*c2;\n}\n\nfloat blend_soft_light_f(float c1, float c2) {\n\treturn (c2 < 0.5) ? (2.0*c1*c2+c1*c1*(1.0-2.0*c2)) : 2.0*c1*(1.0-c2)+sqrt(c1)*(2.0*c2-1.0);\n}\n\nvec3 blend_soft_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_soft_light_f(c1.x, c2.x), blend_soft_light_f(c1.y, c2.y), blend_soft_light_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_burn_f(float c1, float c2) {\n\treturn (c1==0.0)?c1:max((1.0-((1.0-c2)/c1)),0.0);\n}\n\nvec3 blend_burn(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_burn_f(c1.x, c2.x), blend_burn_f(c1.y, c2.y), blend_burn_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_dodge_f(float c1, float c2) {\n\treturn (c1==1.0)?c1:min(c2/(1.0-c1),1.0);\n}\n\nvec3 blend_dodge(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_dodge_f(c1.x, c2.x), blend_dodge_f(c1.y, c2.y), blend_dodge_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_lighten(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*max(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_darken(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*min(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_difference(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*clamp(c2-c1, vec3(0.0), vec3(1.0)) + (1.0-opacity)*c2;\n}\nconst float p_o419741_gradient_0_pos = 0.000000000;\nconst float p_o419741_gradient_0_r = 1.000000000;\nconst float p_o419741_gradient_0_g = 0.000000000;\nconst float p_o419741_gradient_0_b = 0.000000000;\nconst float p_o419741_gradient_0_a = 1.000000000;\nconst float p_o419741_gradient_1_pos = 0.144273793;\nconst float p_o419741_gradient_1_r = 1.000000000;\nconst float p_o419741_gradient_1_g = 0.968750000;\nconst float p_o419741_gradient_1_b = 0.000000000;\nconst float p_o419741_gradient_1_a = 1.000000000;\nconst float p_o419741_gradient_2_pos = 0.274273404;\nconst float p_o419741_gradient_2_r = 1.000000000;\nconst float p_o419741_gradient_2_g = 0.000000000;\nconst float p_o419741_gradient_2_b = 0.000000000;\nconst float p_o419741_gradient_2_a = 1.000000000;\nconst float p_o419741_gradient_3_pos = 0.414273349;\nconst float p_o419741_gradient_3_r = 0.843750000;\nconst float p_o419741_gradient_3_g = 0.000000000;\nconst float p_o419741_gradient_3_b = 1.000000000;\nconst float p_o419741_gradient_3_a = 1.000000000;\nconst float p_o419741_gradient_4_pos = 0.854273571;\nconst float p_o419741_gradient_4_r = 0.000000000;\nconst float p_o419741_gradient_4_g = 0.062500000;\nconst float p_o419741_gradient_4_b = 1.000000000;\nconst float p_o419741_gradient_4_a = 1.000000000;\nvec4 o419741_gradient_gradient_fct(float x) {\n  if (x < p_o419741_gradient_0_pos) {\n    return vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a);\n  } else if (x < p_o419741_gradient_1_pos) {\n    return mix(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)), mix(vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a), vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), (x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos)), 1.0-0.5*(x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos));\n  } else if (x < p_o419741_gradient_2_pos) {\n    return 0.5*(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)) + mix(mix(vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a), vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), (x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos)), mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)), 0.5-0.5*cos(3.14159265359*(x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos))));\n  } else if (x < p_o419741_gradient_3_pos) {\n    return 0.5*(mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)) + mix(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)), mix(vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a), (x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos)), 0.5-0.5*cos(3.14159265359*(x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos))));\n  } else if (x < p_o419741_gradient_4_pos) {\n    return mix(mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)), mix(vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a), (x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos)), 0.5+0.5*(x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos));\n  }\n  return vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a);\n}\nconst float p_o398645_amount = 2.200000000;\nconst float p_o479214_gradient_0_pos = 0.025183105;\nconst float p_o479214_gradient_0_r = 1.000000000;\nconst float p_o479214_gradient_0_g = 0.000000000;\nconst float p_o479214_gradient_0_b = 0.000000000;\nconst float p_o479214_gradient_0_a = 1.000000000;\nconst float p_o479214_gradient_1_pos = 0.435182884;\nconst float p_o479214_gradient_1_r = 1.000000000;\nconst float p_o479214_gradient_1_g = 0.968750000;\nconst float p_o479214_gradient_1_b = 0.000000000;\nconst float p_o479214_gradient_1_a = 1.000000000;\nconst float p_o479214_gradient_2_pos = 0.590909368;\nconst float p_o479214_gradient_2_r = 0.000000000;\nconst float p_o479214_gradient_2_g = 1.000000000;\nconst float p_o479214_gradient_2_b = 0.125000000;\nconst float p_o479214_gradient_2_a = 1.000000000;\nconst float p_o479214_gradient_3_pos = 0.915182218;\nconst float p_o479214_gradient_3_r = 0.000000000;\nconst float p_o479214_gradient_3_g = 0.062500000;\nconst float p_o479214_gradient_3_b = 1.000000000;\nconst float p_o479214_gradient_3_a = 1.000000000;\nvec4 o479214_gradient_gradient_fct(float x) {\n  if (x < p_o479214_gradient_0_pos) {\n    return vec4(p_o479214_gradient_0_r,p_o479214_gradient_0_g,p_o479214_gradient_0_b,p_o479214_gradient_0_a);\n  } else if (x < p_o479214_gradient_1_pos) {\n    return mix(vec4(p_o479214_gradient_0_r,p_o479214_gradient_0_g,p_o479214_gradient_0_b,p_o479214_gradient_0_a), vec4(p_o479214_gradient_1_r,p_o479214_gradient_1_g,p_o479214_gradient_1_b,p_o479214_gradient_1_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_0_pos)/(p_o479214_gradient_1_pos-p_o479214_gradient_0_pos)));\n  } else if (x < p_o479214_gradient_2_pos) {\n    return mix(vec4(p_o479214_gradient_1_r,p_o479214_gradient_1_g,p_o479214_gradient_1_b,p_o479214_gradient_1_a), vec4(p_o479214_gradient_2_r,p_o479214_gradient_2_g,p_o479214_gradient_2_b,p_o479214_gradient_2_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_1_pos)/(p_o479214_gradient_2_pos-p_o479214_gradient_1_pos)));\n  } else if (x < p_o479214_gradient_3_pos) {\n    return mix(vec4(p_o479214_gradient_2_r,p_o479214_gradient_2_g,p_o479214_gradient_2_b,p_o479214_gradient_2_a), vec4(p_o479214_gradient_3_r,p_o479214_gradient_3_g,p_o479214_gradient_3_b,p_o479214_gradient_3_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_2_pos)/(p_o479214_gradient_3_pos-p_o479214_gradient_2_pos)));\n  }\n  return vec4(p_o479214_gradient_3_r,p_o479214_gradient_3_g,p_o479214_gradient_3_b,p_o479214_gradient_3_a);\n}\nconst float p_o520101_repeat = 6.000000000;\nconst float p_o270325_cx = 0.500000000;\nconst float p_o270325_cy = 0.500000000;\nconst float p_o270325_cz = 0.500000000;\nconst float p_o270325_sx = 0.250000000;\nconst float p_o270325_sy = 0.250000000;\nconst float p_o270325_sz = 0.250000000;\nconst float p_o270325_ry = 2.000000000;\nconst float p_o207924_d = 0.710000000;\nconst float p_o553530_radius = 0.320000000;\nconst float p_o553530_repeat = 5.000000000;\nconst float p_o57201_cx = 0.500000000;\nconst float p_o57201_cy = 0.710000000;\nconst float p_o254341_r = 0.500000000;\n\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o270325_0_1_f = 1.0-box((vec2(fract(p_o520101_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/(cos(iTime*0.001))*length((UV)-vec2(0.5))))), vec3(p_o270325_cx, p_o270325_cy, p_o270325_cz), vec3(p_o270325_sx, p_o270325_sy, p_o270325_sz), 0.01745329251*vec3((sin(iTime*0.9)*sin(iTime*0.9)), p_o270325_ry, (sin(iTime*0.9)*sin(iTime*0.9)*abs(iTime))));\nvec4 o520101_0_1_rgba = vec4(vec3(o270325_0_1_f), 1.0);\nvec4 o479214_0_1_rgba = o479214_gradient_gradient_fct((dot((o520101_0_1_rgba).rgb, vec3(1.0))/3.0));\nfloat o57201_0_1_f = sphere((vec2(fract(p_o553530_repeat*atan(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5)).y-0.5, ((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o553530_radius*length(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5))-vec2(0.5))))), vec2(p_o57201_cx, p_o57201_cy), (sin(iTime*0.2)*sin(iTime*0.9)));\nvec4 o553530_0_1_rgba = vec4(vec3(o57201_0_1_f), 1.0);\nvec3 o241986_0_1_tex3d = ((o553530_0_1_rgba).rgb);\nvec2 o254341_0_q = vec2(length(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xyz).xy)-(sin(iTime*0.2)),((vec4(((o479214_0_1_rgba).rgb), 0.0)).xyz).z);\nfloat o254341_0_1_sdf3d = length(o254341_0_q)-p_o254341_r;\nvec3 o207924_0_1_tex3d = mix(o241986_0_1_tex3d, vec3(0.5), clamp(o254341_0_1_sdf3d/max(p_o207924_d, 0.0001), 0.0, 1.0));\nvec3 o245261_0_1_rgb = o207924_0_1_tex3d;\nvec3 o241986_0_3_tex3d = ((o553530_0_1_rgba).rgb);\nvec3 o818931_0_1_rgb = o241986_0_3_tex3d;\nfloat o57201_0_3_f = sphere((vec2(fract(p_o553530_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o553530_radius*length((UV)-vec2(0.5))))), vec2(p_o57201_cx, p_o57201_cy), (sin(iTime*0.2)*sin(iTime*0.9)));\nvec4 o553530_0_3_rgba = vec4(vec3(o57201_0_3_f), 1.0);\nvec4 o398645_0_s1 = vec4(o245261_0_1_rgb, 1.0);\nvec4 o398645_0_s2 = vec4(o818931_0_1_rgb, 1.0);\nfloat o398645_0_a = p_o398645_amount*(dot((o553530_0_3_rgba).rgb, vec3(1.0))/3.0);\nvec4 o398645_0_1_rgba = vec4(blend_hard_light((UV), o398645_0_s1.rgb, o398645_0_s2.rgb, o398645_0_a*o398645_0_s1.a), min(1.0, o398645_0_s2.a+o398645_0_a*o398645_0_s1.a));\nvec4 o419741_0_1_rgba = o419741_gradient_gradient_fct((dot((o398645_0_1_rgba).rgb, vec3(1.0))/3.0));\ngl_FragColor = o419741_0_1_rgba;\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"167",objOut:"166"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"167",objOut:"166"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"167",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"mirrored repeat"},{name:"Floating Point",value:true},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"173",objOut:"167"}]},{name:"Texture",links:[{portIn:"Texture In",portOut:"Texture",objIn:"170",objOut:"167"}]},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Anim.Timer_v2",id:"168",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Speed",value:.91},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"iTime",portOut:"Time",objIn:"166",objOut:"168"},{portIn:"time",portOut:"Time",objIn:"174",objOut:"168"}]}]},{objName:"Ops.Sequence",id:"169",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"166",objOut:"169"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",links:[{portIn:"Render",portOut:"trigger 15",objIn:"192",objOut:"169"}]}]},{objName:"Ops.Ui.VizTexture",id:"170",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"171",objOut:"170"}]},{name:"Info",value:"unknown"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"171",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"176",objOut:"171"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v2",id:"172",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"171",objOut:"172"},{portIn:"exe",portOut:"Next",objIn:"169",objOut:"172"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"143",objOut:"172"}]},{name:"Aspect Ratio",value:.9026798307475318}]},{objName:"Ops.Gl.Meshes.Rectangle_v2",id:"173",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"width",value:1},{name:"height",value:1},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"num columns",value:1},{name:"num rows",value:1},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Active",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.TextureEffects.Wobble",id:"174",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"time"},{name:"SpeedX",value:4},{name:"SpeedY",value:8},{name:"RepeatX",value:10.94},{name:"RepeatY",value:7.17},{name:"Multiply",value:.08},{name:"Mask",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"exe 12",portOut:"Trigger",objIn:"271",objOut:"174"}]}]},{objName:"Ops.Gl.GradientTexture",id:"175",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":8.881784197001252e-16,"g":0,"b":1},{"pos":0.25,"r":8.881784197001252e-16,"g":0,"b":1},{"pos":0.75,"r":1,"g":0,"b":0},{"pos":1,"r":1,"g":0,"b":0}]}'},{name:"Direction index",value:0},{name:"Direction",value:"X"},{name:"Smoothstep",value:false},{name:"Step",value:false},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:256},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Gradient Array",value:0},{name:"Randomize Colors",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Gradient",portOut:"Texture",objIn:"176",objOut:"175"}]},{name:"Colors"},{name:"Colors Pos"}]},{objName:"Ops.Gl.TextureEffects.ColorMap",id:"176",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Gradient"},{name:"Method index",value:0},{name:"Method",value:"Luminance"},{name:"Min",value:0},{name:"Max",value:1},{name:"Position",value:.5}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"174",objOut:"176"}]}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"177",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render",value:0},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat box(vec2 uv, vec3 center, vec3 rad, vec3 rot) {\n\tvec3 ro = vec3(uv, 1.0)-center;\n\tvec3 rd = vec3(0.0000001, 0.0000001, -1.0);\n\tmat3 r = mat3(vec3(1, 0, 0), vec3(0, cos(rot.x), -sin(rot.x)), vec3(0, sin(rot.x), cos(rot.x)));\n\tr *= mat3(vec3(cos(rot.y), 0, -sin(rot.y)), vec3(0, 1, 0), vec3(sin(rot.y), 0, cos(rot.y)));\n\tr *= mat3(vec3(cos(rot.z), -sin(rot.z), 0), vec3(sin(rot.z), cos(rot.z), 0), vec3(0, 0, 1));\n\tro = r * ro;\n\trd = r * rd;\n    vec3 m = 1.0/rd;\n    vec3 n = m*ro;\n    vec3 k = abs(m)*rad;\n    vec3 t1 = -n - k;\n    vec3 t2 = -n + k;\n\n    float tN = max(max(t1.x, t1.y), t1.z);\n    float tF = min(min(t2.x, t2.y), t2.z);\n    if(tN>tF || tF<0.0) return 1.0;\n    return tN;\n}float sphere(vec2 uv, vec2 c, float r) {\n\tuv -= c;\n\tuv /= r;\n\treturn 2.0*r*sqrt(max(0.0, 1.0-dot(uv, uv)));\n}\nvec3 blend_normal(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1 + (1.0-opacity)*c2;\n}\n\nvec3 blend_dissolve(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\tif (rand(uv) < opacity) {\n\t\treturn c1;\n\t} else {\n\t\treturn c2;\n\t}\n}\n\nvec3 blend_multiply(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1*c2 + (1.0-opacity)*c2;\n}\n\nvec3 blend_screen(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*(1.0-(1.0-c1)*(1.0-c2)) + (1.0-opacity)*c2;\n}\n\nfloat blend_overlay_f(float c1, float c2) {\n\treturn (c1 < 0.5) ? (2.0*c1*c2) : (1.0-2.0*(1.0-c1)*(1.0-c2));\n}\n\nvec3 blend_overlay(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_overlay_f(c1.x, c2.x), blend_overlay_f(c1.y, c2.y), blend_overlay_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_hard_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*0.5*(c1*c2+blend_overlay(uv, c1, c2, 1.0)) + (1.0-opacity)*c2;\n}\n\nfloat blend_soft_light_f(float c1, float c2) {\n\treturn (c2 < 0.5) ? (2.0*c1*c2+c1*c1*(1.0-2.0*c2)) : 2.0*c1*(1.0-c2)+sqrt(c1)*(2.0*c2-1.0);\n}\n\nvec3 blend_soft_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_soft_light_f(c1.x, c2.x), blend_soft_light_f(c1.y, c2.y), blend_soft_light_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_burn_f(float c1, float c2) {\n\treturn (c1==0.0)?c1:max((1.0-((1.0-c2)/c1)),0.0);\n}\n\nvec3 blend_burn(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_burn_f(c1.x, c2.x), blend_burn_f(c1.y, c2.y), blend_burn_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_dodge_f(float c1, float c2) {\n\treturn (c1==1.0)?c1:min(c2/(1.0-c1),1.0);\n}\n\nvec3 blend_dodge(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_dodge_f(c1.x, c2.x), blend_dodge_f(c1.y, c2.y), blend_dodge_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_lighten(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*max(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_darken(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*min(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_difference(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*clamp(c2-c1, vec3(0.0), vec3(1.0)) + (1.0-opacity)*c2;\n}\nconst float p_o419741_gradient_0_pos = 0.000000000;\nconst float p_o419741_gradient_0_r = 1.000000000;\nconst float p_o419741_gradient_0_g = 0.000000000;\nconst float p_o419741_gradient_0_b = 0.000000000;\nconst float p_o419741_gradient_0_a = 1.000000000;\nconst float p_o419741_gradient_1_pos = 0.144273793;\nconst float p_o419741_gradient_1_r = 1.000000000;\nconst float p_o419741_gradient_1_g = 0.968750000;\nconst float p_o419741_gradient_1_b = 0.000000000;\nconst float p_o419741_gradient_1_a = 1.000000000;\nconst float p_o419741_gradient_2_pos = 0.274273404;\nconst float p_o419741_gradient_2_r = 1.000000000;\nconst float p_o419741_gradient_2_g = 0.000000000;\nconst float p_o419741_gradient_2_b = 0.000000000;\nconst float p_o419741_gradient_2_a = 1.000000000;\nconst float p_o419741_gradient_3_pos = 0.414273349;\nconst float p_o419741_gradient_3_r = 0.843750000;\nconst float p_o419741_gradient_3_g = 0.000000000;\nconst float p_o419741_gradient_3_b = 1.000000000;\nconst float p_o419741_gradient_3_a = 1.000000000;\nconst float p_o419741_gradient_4_pos = 0.854273571;\nconst float p_o419741_gradient_4_r = 0.000000000;\nconst float p_o419741_gradient_4_g = 0.062500000;\nconst float p_o419741_gradient_4_b = 1.000000000;\nconst float p_o419741_gradient_4_a = 1.000000000;\nvec4 o419741_gradient_gradient_fct(float x) {\n  if (x < p_o419741_gradient_0_pos) {\n    return vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a);\n  } else if (x < p_o419741_gradient_1_pos) {\n    return mix(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)), mix(vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a), vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), (x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos)), 1.0-0.5*(x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos));\n  } else if (x < p_o419741_gradient_2_pos) {\n    return 0.5*(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)) + mix(mix(vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a), vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), (x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos)), mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)), 0.5-0.5*cos(3.14159265359*(x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos))));\n  } else if (x < p_o419741_gradient_3_pos) {\n    return 0.5*(mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)) + mix(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)), mix(vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a), (x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos)), 0.5-0.5*cos(3.14159265359*(x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos))));\n  } else if (x < p_o419741_gradient_4_pos) {\n    return mix(mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)), mix(vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a), (x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos)), 0.5+0.5*(x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos));\n  }\n  return vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a);\n}\nconst float p_o398645_amount = 11.760000000;\nconst float p_o479214_gradient_0_pos = 0.025183105;\nconst float p_o479214_gradient_0_r = 1.000000000;\nconst float p_o479214_gradient_0_g = 0.000000000;\nconst float p_o479214_gradient_0_b = 0.000000000;\nconst float p_o479214_gradient_0_a = 1.000000000;\nconst float p_o479214_gradient_1_pos = 0.435182884;\nconst float p_o479214_gradient_1_r = 1.000000000;\nconst float p_o479214_gradient_1_g = 0.968750000;\nconst float p_o479214_gradient_1_b = 0.000000000;\nconst float p_o479214_gradient_1_a = 1.000000000;\nconst float p_o479214_gradient_2_pos = 0.590909368;\nconst float p_o479214_gradient_2_r = 0.000000000;\nconst float p_o479214_gradient_2_g = 1.000000000;\nconst float p_o479214_gradient_2_b = 0.125000000;\nconst float p_o479214_gradient_2_a = 1.000000000;\nconst float p_o479214_gradient_3_pos = 0.915182218;\nconst float p_o479214_gradient_3_r = 0.000000000;\nconst float p_o479214_gradient_3_g = 0.062500000;\nconst float p_o479214_gradient_3_b = 1.000000000;\nconst float p_o479214_gradient_3_a = 1.000000000;\nvec4 o479214_gradient_gradient_fct(float x) {\n  if (x < p_o479214_gradient_0_pos) {\n    return vec4(p_o479214_gradient_0_r,p_o479214_gradient_0_g,p_o479214_gradient_0_b,p_o479214_gradient_0_a);\n  } else if (x < p_o479214_gradient_1_pos) {\n    return mix(vec4(p_o479214_gradient_0_r,p_o479214_gradient_0_g,p_o479214_gradient_0_b,p_o479214_gradient_0_a), vec4(p_o479214_gradient_1_r,p_o479214_gradient_1_g,p_o479214_gradient_1_b,p_o479214_gradient_1_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_0_pos)/(p_o479214_gradient_1_pos-p_o479214_gradient_0_pos)));\n  } else if (x < p_o479214_gradient_2_pos) {\n    return mix(vec4(p_o479214_gradient_1_r,p_o479214_gradient_1_g,p_o479214_gradient_1_b,p_o479214_gradient_1_a), vec4(p_o479214_gradient_2_r,p_o479214_gradient_2_g,p_o479214_gradient_2_b,p_o479214_gradient_2_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_1_pos)/(p_o479214_gradient_2_pos-p_o479214_gradient_1_pos)));\n  } else if (x < p_o479214_gradient_3_pos) {\n    return mix(vec4(p_o479214_gradient_2_r,p_o479214_gradient_2_g,p_o479214_gradient_2_b,p_o479214_gradient_2_a), vec4(p_o479214_gradient_3_r,p_o479214_gradient_3_g,p_o479214_gradient_3_b,p_o479214_gradient_3_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_2_pos)/(p_o479214_gradient_3_pos-p_o479214_gradient_2_pos)));\n  }\n  return vec4(p_o479214_gradient_3_r,p_o479214_gradient_3_g,p_o479214_gradient_3_b,p_o479214_gradient_3_a);\n}\nconst float p_o520101_repeat = 6.000000000;\nconst float p_o270325_cx = 0.500000000;\nconst float p_o270325_cy = 0.500000000;\nconst float p_o270325_cz = 0.500000000;\nconst float p_o270325_sx = 0.250000000;\nconst float p_o270325_sy = 0.250000000;\nconst float p_o270325_sz = 0.250000000;\nconst float p_o270325_ry = 2.000000000;\nconst float p_o207924_d = 0.710000000;\nconst float p_o553530_radius = 0.320000000;\nconst float p_o553530_repeat = 5.000000000;\nconst float p_o57201_cx = 0.500000000;\nconst float p_o57201_cy = 0.710000000;\nconst float p_o254341_r = 0.500000000;\n\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o270325_0_1_f = 1.0-box((vec2(fract(p_o520101_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/(cos(iTime*0.001))*length((UV)-vec2(0.5))))), vec3(p_o270325_cx, p_o270325_cy, p_o270325_cz), vec3(p_o270325_sx, p_o270325_sy, p_o270325_sz), 0.01745329251*vec3((sin(iTime*0.9)*sin(iTime*0.9)), p_o270325_ry, (sin(iTime*0.9)*sin(iTime*0.9)*abs(iTime))));\nvec4 o520101_0_1_rgba = vec4(vec3(o270325_0_1_f), 1.0);\nvec4 o479214_0_1_rgba = o479214_gradient_gradient_fct((dot((o520101_0_1_rgba).rgb, vec3(1.0))/3.0));\nfloat o57201_0_1_f = sphere((vec2(fract(p_o553530_repeat*atan(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5)).y-0.5, ((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o553530_radius*length(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5))-vec2(0.5))))), vec2(p_o57201_cx, p_o57201_cy), (sin(iTime*0.2)*sin(iTime*0.9)));\nvec4 o553530_0_1_rgba = vec4(vec3(o57201_0_1_f), 1.0);\nvec3 o241986_0_1_tex3d = ((o553530_0_1_rgba).rgb);\nvec2 o254341_0_q = vec2(length(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xyz).xy)-(sin(iTime*0.2)),((vec4(((o479214_0_1_rgba).rgb), 0.0)).xyz).z);\nfloat o254341_0_1_sdf3d = length(o254341_0_q)-p_o254341_r;\nvec3 o207924_0_1_tex3d = mix(o241986_0_1_tex3d, vec3(0.5), clamp(o254341_0_1_sdf3d/max(p_o207924_d, 0.0001), 0.0, 1.0));\nvec3 o245261_0_1_rgb = o207924_0_1_tex3d;\nvec3 o241986_0_3_tex3d = ((o553530_0_1_rgba).rgb);\nvec3 o818931_0_1_rgb = o241986_0_3_tex3d;\nfloat o57201_0_3_f = sphere((vec2(fract(p_o553530_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o553530_radius*length((UV)-vec2(0.5))))), vec2(p_o57201_cx, p_o57201_cy), (sin(iTime*0.2)*sin(iTime*0.9)));\nvec4 o553530_0_3_rgba = vec4(vec3(o57201_0_3_f), 1.0);\nvec4 o398645_0_s1 = vec4(o245261_0_1_rgb, 1.0);\nvec4 o398645_0_s2 = vec4(o818931_0_1_rgb, 1.0);\nfloat o398645_0_a = p_o398645_amount*(dot((o553530_0_3_rgba).rgb, vec3(1.0))/3.0);\nvec4 o398645_0_1_rgba = vec4(blend_soft_light((UV), o398645_0_s1.rgb, o398645_0_s2.rgb, o398645_0_a*o398645_0_s1.a), min(1.0, o398645_0_s2.a+o398645_0_a*o398645_0_s1.a));\nvec4 o419741_0_1_rgba = o419741_gradient_gradient_fct((dot((o398645_0_1_rgba).rgb, vec3(1.0))/3.0));\ngl_FragColor = o419741_0_1_rgba;\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime",value:0}],portsOut:[{name:"trigger",value:0},{name:"Shader"},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.TextureEffects.RepeatTexture",id:"178",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"lighten"},{name:"Amount",value:1},{name:"x",value:6.42},{name:"y",value:7.26},{name:"Multiply",value:0}],portsOut:[{name:"trigger",links:[{portIn:"exe 9",portOut:"trigger",objIn:"271",objOut:"178"}]}]},{objName:"Ops.Gl.TextureEffects.PolarCoords",id:"179",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Radius Inner",value:.343},{name:"Radius Outer",value:.582},{name:"Crop",value:true}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"178",objOut:"179"}]}]},{objName:"Ops.Gl.TextureEffects.Mirror",id:"180",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"axis index",value:0},{name:"axis",value:"X"},{name:"width",value:.42},{name:"offset"},{name:"flip",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"181",objOut:"180"}]}]},{objName:"Ops.Gl.TextureEffects.Mirror",id:"181",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"axis index",value:0},{name:"axis",value:"Y"},{name:"width",value:-.87},{name:"offset",value:-.54},{name:"flip",value:false}],portsOut:[{name:"trigger",links:[{portIn:"exe 8",portOut:"trigger",objIn:"271",objOut:"181"}]}]},{objName:"Ops.Anim.SineAnim",id:"182",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"Mode index",value:0},{name:"Mode",value:"Sine"},{name:"phase",value:1.33},{name:"frequency",value:.36},{name:"amplitude",value:1.45}],portsOut:[{name:"Trigger out",value:0},{name:"result",links:[{portIn:"number",portOut:"result",objIn:"183",objOut:"182"}]}]},{objName:"Ops.Math.Abs",id:"183",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"number"}],portsOut:[{name:"result",links:[{portIn:"value",portOut:"result",objIn:"184",objOut:"183"}]}]},{objName:"Ops.Math.Sine",id:"184",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"value"},{name:"phase",value:.48},{name:"frequency",value:1},{name:"amplitude",value:-.85},{name:"asine",value:false}],portsOut:[{name:"result",links:[{portIn:"offset",portOut:"result",objIn:"180",objOut:"184"}]}]},{objName:"Ops.Anim.SineAnim",id:"185",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"Mode index",value:0},{name:"Mode",value:"Sine"},{name:"phase",value:0},{name:"frequency",value:1},{name:"amplitude",value:1}],portsOut:[{name:"Trigger out",value:0},{name:"result",links:[{portIn:"Pos",portOut:"result",objIn:"125",objOut:"185"}]}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"186",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat shape_circle(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float distance = length(uv);\n    return clamp((1.0-distance/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_polygon(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y)+3.14159265359;\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(0.5+angle/slice)*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(angle*sides/6.28318530718-0.5+2.0*step(fract(angle*sides/6.28318530718), 0.5))*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_curved_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = 2.0*(atan(uv.x, uv.y)+3.14159265359);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-cos(floor(0.5+0.5*angle/slice)*2.0*slice-angle)*length(uv)/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_rays(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = 0.5*max(edge, 1.0e-8)*size;\n\tfloat slice = 6.28318530718/sides;\n    float angle = mod(atan(uv.x, uv.y)+3.14159265359, slice)/slice;\n    return clamp(min((size-angle)/edge, angle/edge), 0.0, 1.0);\n}\n\nvec2 rotate(vec2 uv, vec2 center, float rotate) {\n \tvec2 rv;\n\tuv -= center;\n\trv.x = cos(rotate)*uv.x + sin(rotate)*uv.y;\n\trv.y = -sin(rotate)*uv.x + cos(rotate)*uv.y;\n\trv += center;\n    return rv;\t\n}const float p_o13743_cx = 0.000000000;\nconst float p_o13743_cy = 0.000000000;\nconst float p_o13728_gradient_0_pos = 0.000000000;\nconst float p_o13728_gradient_0_r = 1.000000000;\nconst float p_o13728_gradient_0_g = 0.000000000;\nconst float p_o13728_gradient_0_b = 0.000000000;\nconst float p_o13728_gradient_0_a = 1.000000000;\nconst float p_o13728_gradient_1_pos = 0.399003000;\nconst float p_o13728_gradient_1_r = 0.035911001;\nconst float p_o13728_gradient_1_g = 0.145328000;\nconst float p_o13728_gradient_1_b = 0.574576974;\nconst float p_o13728_gradient_1_a = 1.000000000;\nconst float p_o13728_gradient_2_pos = 0.662365000;\nconst float p_o13728_gradient_2_r = 0.098465003;\nconst float p_o13728_gradient_2_g = 0.185066000;\nconst float p_o13728_gradient_2_b = 0.933593988;\nconst float p_o13728_gradient_2_a = 1.000000000;\nconst float p_o13728_gradient_3_pos = 1.000000000;\nconst float p_o13728_gradient_3_r = 0.000000000;\nconst float p_o13728_gradient_3_g = 0.062500000;\nconst float p_o13728_gradient_3_b = 1.000000000;\nconst float p_o13728_gradient_3_a = 1.000000000;\nvec4 o13728_gradient_gradient_fct(float x) {\n  if (x < p_o13728_gradient_0_pos) {\n    return vec4(p_o13728_gradient_0_r,p_o13728_gradient_0_g,p_o13728_gradient_0_b,p_o13728_gradient_0_a);\n  } else if (x < p_o13728_gradient_1_pos) {\n    return mix(vec4(p_o13728_gradient_0_r,p_o13728_gradient_0_g,p_o13728_gradient_0_b,p_o13728_gradient_0_a), vec4(p_o13728_gradient_1_r,p_o13728_gradient_1_g,p_o13728_gradient_1_b,p_o13728_gradient_1_a), ((x-p_o13728_gradient_0_pos)/(p_o13728_gradient_1_pos-p_o13728_gradient_0_pos)));\n  } else if (x < p_o13728_gradient_2_pos) {\n    return mix(vec4(p_o13728_gradient_1_r,p_o13728_gradient_1_g,p_o13728_gradient_1_b,p_o13728_gradient_1_a), vec4(p_o13728_gradient_2_r,p_o13728_gradient_2_g,p_o13728_gradient_2_b,p_o13728_gradient_2_a), ((x-p_o13728_gradient_1_pos)/(p_o13728_gradient_2_pos-p_o13728_gradient_1_pos)));\n  } else if (x < p_o13728_gradient_3_pos) {\n    return mix(vec4(p_o13728_gradient_2_r,p_o13728_gradient_2_g,p_o13728_gradient_2_b,p_o13728_gradient_2_a), vec4(p_o13728_gradient_3_r,p_o13728_gradient_3_g,p_o13728_gradient_3_b,p_o13728_gradient_3_a), ((x-p_o13728_gradient_2_pos)/(p_o13728_gradient_3_pos-p_o13728_gradient_2_pos)));\n  }\n  return vec4(p_o13728_gradient_3_r,p_o13728_gradient_3_g,p_o13728_gradient_3_b,p_o13728_gradient_3_a);\n}\nconst float p_o13689_radius = 1.000000000;\nconst float p_o13689_repeat = 1.000000000;\nconst float p_o13688_radius = 1.000000000;\nconst float p_o13688_repeat = 1.000000000;\nconst float p_o13687_radius = 1.500000000;\nconst float p_o13687_repeat = 1.000000000;\nconst float p_o13690_cx = 0.700000000;\nconst float p_o13686_sides = 5.000000000;\nconst float p_o13686_radius = 0.640000000;\nconst float p_o13686_edge = 0.500000000;\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o13686_0_1_f = shape_polygon((rotate((vec2(fract(p_o13687_repeat*atan((vec2(fract(p_o13688_repeat*atan((vec2(fract(p_o13689_repeat*atan((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o13689_radius*length((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o13689_repeat*atan((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o13689_radius*length((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o13688_radius*length((vec2(fract(p_o13689_repeat*atan((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o13689_radius*length((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5))))).y-0.5, (vec2(fract(p_o13688_repeat*atan((vec2(fract(p_o13689_repeat*atan((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o13689_radius*length((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o13689_repeat*atan((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o13689_radius*length((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o13688_radius*length((vec2(fract(p_o13689_repeat*atan((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o13689_radius*length((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o13687_radius*length((vec2(fract(p_o13688_repeat*atan((vec2(fract(p_o13689_repeat*atan((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o13689_radius*length((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o13689_repeat*atan((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o13689_radius*length((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o13688_radius*length((vec2(fract(p_o13689_repeat*atan((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o13689_radius*length((rotate((UV), vec2(0.5+p_o13743_cx, 0.5+p_o13743_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5)))))-vec2(0.5))))), vec2(0.5+p_o13690_cx, 0.5+(sin(iTime * 0.009) * (iTime * 0.0005))), (sin(iTime * 0.05) * (iTime))*0.01745329251)), p_o13686_sides, p_o13686_radius*1.0, p_o13686_edge*1.0);\nvec4 o13690_0_1_rgba = vec4(vec3(o13686_0_1_f), 1.0);\nvec4 o13687_0_1_rgba = o13690_0_1_rgba;\nvec4 o13688_0_1_rgba = o13687_0_1_rgba;\nvec4 o13689_0_1_rgba = o13688_0_1_rgba;\nvec4 o13728_0_1_rgba = o13728_gradient_gradient_fct((dot((o13689_0_1_rgba).rgb, vec3(1.0))/3.0));\nvec4 o13743_0_1_rgba = o13728_0_1_rgba;\ngl_FragColor = o13743_0_1_rgba;\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1.02},{name:"iResolution Y",value:.95},{name:"iResolution Z",value:1.29},{name:"iTime"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"187",objOut:"186"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"187",objOut:"186"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"187",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"mirrored repeat"},{name:"Floating Point",value:true},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"193",objOut:"187"}]},{name:"Texture",links:[{portIn:"Texture In",portOut:"Texture",objIn:"190",objOut:"187"}]},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Anim.Timer_v2",id:"188",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Speed",value:2.47},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"iTime",portOut:"Time",objIn:"186",objOut:"188"}]}]},{objName:"Ops.Sequence",id:"189",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"186",objOut:"189"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",links:[{portIn:"Render",portOut:"trigger 15",objIn:"204",objOut:"189"}]}]},{objName:"Ops.Ui.VizTexture",id:"190",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"191",objOut:"190"}]},{name:"Info",value:"unknown"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"191",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"197",objOut:"191"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v2",id:"192",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"191",objOut:"192"},{portIn:"exe",portOut:"Next",objIn:"189",objOut:"192"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"196",objOut:"192"}]},{name:"Aspect Ratio",value:.9026798307475318}]},{objName:"Ops.Gl.Meshes.Rectangle_v2",id:"193",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"width",value:1},{name:"height",value:1},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"num columns",value:1},{name:"num rows",value:1},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Active",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.TextureEffects.Wobble",id:"194",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"time",value:0},{name:"SpeedX",value:4},{name:"SpeedY",value:8},{name:"RepeatX",value:11.36},{name:"RepeatY",value:9.14},{name:"Multiply",value:.05},{name:"Mask"}],portsOut:[{name:"Trigger",links:[{portIn:"exe 13",portOut:"Trigger",objIn:"271",objOut:"194"}]}]},{objName:"Ops.Gl.GradientTexture",id:"195",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":1,"g":0,"b":0},{"pos":0.308,"r":1,"g":0,"b":0},{"pos":0.708,"r":8.881784197001252e-16,"g":0,"b":1},{"pos":1,"r":8.881784197001252e-16,"g":0,"b":1}]}'},{name:"Direction index",value:0},{name:"Direction",value:"X"},{name:"Smoothstep",value:false},{name:"Step",value:false},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:256},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Gradient Array",value:0},{name:"Randomize Colors",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Mask",portOut:"Texture",objIn:"197",objOut:"195"},{portIn:"Mask",portOut:"Texture",objIn:"194",objOut:"195"}]},{name:"Colors"},{name:"Colors Pos"}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"196",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.TextureEffects.ChromaticAberration",id:"197",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"add"},{name:"Amount",value:.716},{name:"Pixel",value:5.01},{name:"Lens Distort",value:.762},{name:"Smooth",value:false},{name:"Mask"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"194",objOut:"197"}]}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"198",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat shape_circle(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float distance = length(uv);\n    return clamp((1.0-distance/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_polygon(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y)+3.14159265359;\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(0.5+angle/slice)*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(angle*sides/6.28318530718-0.5+2.0*step(fract(angle*sides/6.28318530718), 0.5))*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_curved_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = 2.0*(atan(uv.x, uv.y)+3.14159265359);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-cos(floor(0.5+0.5*angle/slice)*2.0*slice-angle)*length(uv)/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_rays(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = 0.5*max(edge, 1.0e-8)*size;\n\tfloat slice = 6.28318530718/sides;\n    float angle = mod(atan(uv.x, uv.y)+3.14159265359, slice)/slice;\n    return clamp(min((size-angle)/edge, angle/edge), 0.0, 1.0);\n}\n\nvec2 rotate(vec2 uv, vec2 center, float rotate) {\n \tvec2 rv;\n\tuv -= center;\n\trv.x = cos(rotate)*uv.x + sin(rotate)*uv.y;\n\trv.y = -sin(rotate)*uv.x + cos(rotate)*uv.y;\n\trv += center;\n    return rv;\t\n}vec3 blend_normal(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1 + (1.0-opacity)*c2;\n}\n\nvec3 blend_dissolve(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\tif (rand(uv) < opacity) {\n\t\treturn c1;\n\t} else {\n\t\treturn c2;\n\t}\n}\n\nvec3 blend_multiply(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1*c2 + (1.0-opacity)*c2;\n}\n\nvec3 blend_screen(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*(1.0-(1.0-c1)*(1.0-c2)) + (1.0-opacity)*c2;\n}\n\nfloat blend_overlay_f(float c1, float c2) {\n\treturn (c1 < 0.5) ? (2.0*c1*c2) : (1.0-2.0*(1.0-c1)*(1.0-c2));\n}\n\nvec3 blend_overlay(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_overlay_f(c1.x, c2.x), blend_overlay_f(c1.y, c2.y), blend_overlay_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_hard_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*0.5*(c1*c2+blend_overlay(uv, c1, c2, 1.0)) + (1.0-opacity)*c2;\n}\n\nfloat blend_soft_light_f(float c1, float c2) {\n\treturn (c2 < 0.5) ? (2.0*c1*c2+c1*c1*(1.0-2.0*c2)) : 2.0*c1*(1.0-c2)+sqrt(c1)*(2.0*c2-1.0);\n}\n\nvec3 blend_soft_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_soft_light_f(c1.x, c2.x), blend_soft_light_f(c1.y, c2.y), blend_soft_light_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_burn_f(float c1, float c2) {\n\treturn (c1==0.0)?c1:max((1.0-((1.0-c2)/c1)),0.0);\n}\n\nvec3 blend_burn(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_burn_f(c1.x, c2.x), blend_burn_f(c1.y, c2.y), blend_burn_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_dodge_f(float c1, float c2) {\n\treturn (c1==1.0)?c1:min(c2/(1.0-c1),1.0);\n}\n\nvec3 blend_dodge(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_dodge_f(c1.x, c2.x), blend_dodge_f(c1.y, c2.y), blend_dodge_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_lighten(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*max(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_darken(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*min(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_difference(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*clamp(c2-c1, vec3(0.0), vec3(1.0)) + (1.0-opacity)*c2;\n}\nconst float p_o689653_gradient_0_pos = 0.000000000;\nconst float p_o689653_gradient_0_r = 1.000000000;\nconst float p_o689653_gradient_0_g = 0.000000000;\nconst float p_o689653_gradient_0_b = 0.000000000;\nconst float p_o689653_gradient_0_a = 1.000000000;\nconst float p_o689653_gradient_1_pos = 0.163563954;\nconst float p_o689653_gradient_1_r = 0.000000000;\nconst float p_o689653_gradient_1_g = 1.000000000;\nconst float p_o689653_gradient_1_b = 0.125000000;\nconst float p_o689653_gradient_1_a = 1.000000000;\nconst float p_o689653_gradient_2_pos = 0.340910756;\nconst float p_o689653_gradient_2_r = 0.000000000;\nconst float p_o689653_gradient_2_g = 0.062500000;\nconst float p_o689653_gradient_2_b = 1.000000000;\nconst float p_o689653_gradient_2_a = 1.000000000;\nvec4 o689653_gradient_gradient_fct(float x) {\n  if (x < p_o689653_gradient_0_pos) {\n    return vec4(p_o689653_gradient_0_r,p_o689653_gradient_0_g,p_o689653_gradient_0_b,p_o689653_gradient_0_a);\n  } else if (x < p_o689653_gradient_1_pos) {\n    return mix(vec4(p_o689653_gradient_0_r,p_o689653_gradient_0_g,p_o689653_gradient_0_b,p_o689653_gradient_0_a), vec4(p_o689653_gradient_1_r,p_o689653_gradient_1_g,p_o689653_gradient_1_b,p_o689653_gradient_1_a), 0.5-0.5*cos(3.14159265359*(x-p_o689653_gradient_0_pos)/(p_o689653_gradient_1_pos-p_o689653_gradient_0_pos)));\n  } else if (x < p_o689653_gradient_2_pos) {\n    return mix(vec4(p_o689653_gradient_1_r,p_o689653_gradient_1_g,p_o689653_gradient_1_b,p_o689653_gradient_1_a), vec4(p_o689653_gradient_2_r,p_o689653_gradient_2_g,p_o689653_gradient_2_b,p_o689653_gradient_2_a), 0.5-0.5*cos(3.14159265359*(x-p_o689653_gradient_1_pos)/(p_o689653_gradient_2_pos-p_o689653_gradient_1_pos)));\n  }\n  return vec4(p_o689653_gradient_2_r,p_o689653_gradient_2_g,p_o689653_gradient_2_b,p_o689653_gradient_2_a);\n}\nconst float p_o85415_amount = 14.780000000;\nconst float p_o370586_cx = 0.000000000;\nconst float p_o370586_cy = 0.000000000;\nconst float p_o265706_gradient_0_pos = 0.000000000;\nconst float p_o265706_gradient_0_r = 1.000000000;\nconst float p_o265706_gradient_0_g = 0.000000000;\nconst float p_o265706_gradient_0_b = 0.000000000;\nconst float p_o265706_gradient_0_a = 1.000000000;\nconst float p_o265706_gradient_1_pos = 0.399003462;\nconst float p_o265706_gradient_1_r = 0.035911076;\nconst float p_o265706_gradient_1_g = 0.145327628;\nconst float p_o265706_gradient_1_b = 0.574577212;\nconst float p_o265706_gradient_1_a = 1.000000000;\nconst float p_o265706_gradient_2_pos = 0.662364613;\nconst float p_o265706_gradient_2_r = 0.098464966;\nconst float p_o265706_gradient_2_g = 0.185065985;\nconst float p_o265706_gradient_2_b = 0.933593750;\nconst float p_o265706_gradient_2_a = 1.000000000;\nconst float p_o265706_gradient_3_pos = 1.000000000;\nconst float p_o265706_gradient_3_r = 0.000000000;\nconst float p_o265706_gradient_3_g = 0.062500000;\nconst float p_o265706_gradient_3_b = 1.000000000;\nconst float p_o265706_gradient_3_a = 1.000000000;\nvec4 o265706_gradient_gradient_fct(float x) {\n  if (x < p_o265706_gradient_0_pos) {\n    return vec4(p_o265706_gradient_0_r,p_o265706_gradient_0_g,p_o265706_gradient_0_b,p_o265706_gradient_0_a);\n  } else if (x < p_o265706_gradient_1_pos) {\n    return mix(vec4(p_o265706_gradient_0_r,p_o265706_gradient_0_g,p_o265706_gradient_0_b,p_o265706_gradient_0_a), vec4(p_o265706_gradient_1_r,p_o265706_gradient_1_g,p_o265706_gradient_1_b,p_o265706_gradient_1_a), ((x-p_o265706_gradient_0_pos)/(p_o265706_gradient_1_pos-p_o265706_gradient_0_pos)));\n  } else if (x < p_o265706_gradient_2_pos) {\n    return mix(vec4(p_o265706_gradient_1_r,p_o265706_gradient_1_g,p_o265706_gradient_1_b,p_o265706_gradient_1_a), vec4(p_o265706_gradient_2_r,p_o265706_gradient_2_g,p_o265706_gradient_2_b,p_o265706_gradient_2_a), ((x-p_o265706_gradient_1_pos)/(p_o265706_gradient_2_pos-p_o265706_gradient_1_pos)));\n  } else if (x < p_o265706_gradient_3_pos) {\n    return mix(vec4(p_o265706_gradient_2_r,p_o265706_gradient_2_g,p_o265706_gradient_2_b,p_o265706_gradient_2_a), vec4(p_o265706_gradient_3_r,p_o265706_gradient_3_g,p_o265706_gradient_3_b,p_o265706_gradient_3_a), ((x-p_o265706_gradient_2_pos)/(p_o265706_gradient_3_pos-p_o265706_gradient_2_pos)));\n  }\n  return vec4(p_o265706_gradient_3_r,p_o265706_gradient_3_g,p_o265706_gradient_3_b,p_o265706_gradient_3_a);\n}\nconst float p_o27497_radius = 1.000000000;\nconst float p_o27497_repeat = 7.000000000;\nconst float p_o22106_radius = 1.000000000;\nconst float p_o22106_repeat = 1.000000000;\nconst float p_o15531_radius = 1.500000000;\nconst float p_o15531_repeat = 1.000000000;\nconst float p_o35637_cx = 0.000000000;\nconst float p_o9383_sides = 5.000000000;\nconst float p_o9383_radius = 0.640000000;\nconst float p_o9383_edge = 0.500000000;\nvec3 o559231_input_in(vec2 uv, float _seed_variation_) {\nfloat o9383_0_1_f = shape_polygon((rotate((vec2(fract(p_o15531_repeat*atan((vec2(fract(p_o22106_repeat*atan((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o22106_radius*length((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5))))).y-0.5, (vec2(fract(p_o22106_repeat*atan((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o22106_radius*length((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o15531_radius*length((vec2(fract(p_o22106_repeat*atan((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o22106_radius*length((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5)))))-vec2(0.5))))), vec2(0.5+p_o35637_cx, 0.5+(sin(iTime * 0.009) * (iTime * 0.0008))), (sin(iTime * 0.05) * (iTime))*0.01745329251)), p_o9383_sides, p_o9383_radius*1.0, p_o9383_edge*1.0);\nvec4 o35637_0_1_rgba = vec4(vec3(o9383_0_1_f), 1.0);\nvec4 o15531_0_1_rgba = o35637_0_1_rgba;\nvec4 o22106_0_1_rgba = o15531_0_1_rgba;\nvec4 o27497_0_1_rgba = o22106_0_1_rgba;\nvec4 o265706_0_1_rgba = o265706_gradient_gradient_fct((dot((o27497_0_1_rgba).rgb, vec3(1.0))/3.0));\nvec4 o370586_0_1_rgba = o265706_0_1_rgba;\n\nreturn ((o370586_0_1_rgba).rgb);\n}\nfloat o559231_fct(vec2 uv, float _seed_variation_) {\n\tvec2 e = vec2(1.0/512.000000000, -1.0/512.000000000);\n\tvec3 rv = 4.0*o559231_input_in(uv, _seed_variation_);\n\trv -= o559231_input_in(uv+e.xy, _seed_variation_);\n\trv -= o559231_input_in(uv-e.xy, _seed_variation_);\n\trv -= o559231_input_in(uv+e.xx, _seed_variation_);\n\trv -= o559231_input_in(uv-e.xx, _seed_variation_);\n\trv = abs(rv);\n\treturn max(rv.x, max(rv.y ,rv.z))*512.000000000;\n}const float p_o180891_gradient_0_pos = 0.000000000;\nconst float p_o180891_gradient_0_r = 0.988281250;\nconst float p_o180891_gradient_0_g = 0.000000000;\nconst float p_o180891_gradient_0_b = 0.000000000;\nconst float p_o180891_gradient_0_a = 1.000000000;\nconst float p_o180891_gradient_1_pos = 1.000000000;\nconst float p_o180891_gradient_1_r = 1.000000000;\nconst float p_o180891_gradient_1_g = 0.171875000;\nconst float p_o180891_gradient_1_b = 0.909423828;\nconst float p_o180891_gradient_1_a = 1.000000000;\nvec4 o180891_gradient_gradient_fct(float x) {\n  if (x < p_o180891_gradient_0_pos) {\n    return vec4(p_o180891_gradient_0_r,p_o180891_gradient_0_g,p_o180891_gradient_0_b,p_o180891_gradient_0_a);\n  } else if (x < p_o180891_gradient_1_pos) {\n    return mix(vec4(p_o180891_gradient_0_r,p_o180891_gradient_0_g,p_o180891_gradient_0_b,p_o180891_gradient_0_a), vec4(p_o180891_gradient_1_r,p_o180891_gradient_1_g,p_o180891_gradient_1_b,p_o180891_gradient_1_a), 0.5-0.5*cos(3.14159265359*(x-p_o180891_gradient_0_pos)/(p_o180891_gradient_1_pos-p_o180891_gradient_0_pos)));\n  }\n  return vec4(p_o180891_gradient_1_r,p_o180891_gradient_1_g,p_o180891_gradient_1_b,p_o180891_gradient_1_a);\n}\nvec2 o116913_input_sdf(vec3 p, float _seed_variation_) {\nfloat o111232_0_1_sdf3d = length((p))-(sin(iTime * 0.3));\n\nreturn vec2(o111232_0_1_sdf3d, 0.0);\n}\nvec2 raymarch_o116913(vec2 uv, float _seed_variation_) {\n\tvec3 ro = vec3(uv-vec2(0.5), 1.0);\n\tvec3 rd = vec3(0.0, 0.0, -1.0);\n\tfloat dO = 0.0;\n\tfloat c = 0.0;\n    for (int i=0; i < 100; i++) {\n    \tvec3 p = ro + rd*dO;\n        vec2 dS = o116913_input_sdf(p, _seed_variation_);\n        dO += dS.x;\n\n        if (dO >= 1.0) {\n\t\t\tbreak;\n\t\t} else if (dS.x < 0.0001) {\n\t\t\tc = dS.y;\n\t\t\tbreak;\n\t\t}\n    }\n    \n    return vec2(dO, c);\n}\n\nvec3 normal_o116913(vec3 p, float _seed_variation_) {\n\tif (p.z <= 0.0) {\n\t\treturn vec3(0.0, 0.0, 1.0);\n\t}\n\n\tfloat d = o116913_input_sdf(p, _seed_variation_).x;\n    float e = .001;\n    \n    vec3 n = d - vec3(\n        o116913_input_sdf(p-vec3(e, 0.0, 0.0), _seed_variation_).x,\n        o116913_input_sdf(p-vec3(0.0, e, 0.0), _seed_variation_).x,\n        o116913_input_sdf(p-vec3(0.0, 0.0, e), _seed_variation_).x);\n    \n    return vec3(-1.0, -1.0, -1.0)*normalize(n);\n}\n\nconst float p_o164084_w = 0.300000000;\nvec4 o164084_input_in(vec2 uv, float _seed_variation_) {\nvec2 o116913_0_d = raymarch_o116913((uv), _seed_variation_);\nfloat o116913_0_1_f = 1.0-o116913_0_d.x;\n\nreturn vec4(vec3(o116913_0_1_f), 1.0);\n}\nvec4 make_tileable_o164084(vec2 uv, float w, float _seed_variation_) {\n\tvec4 a = o164084_input_in(uv, _seed_variation_);\n\tvec4 b = o164084_input_in(fract(uv+vec2(0.5)), _seed_variation_);\n\tfloat coef_ab = sin(1.57079632679*clamp((length(uv-vec2(0.5))-0.5+w)/w, 0.0, 1.0));\n\tvec4 c = o164084_input_in(fract(uv+vec2(0.25)), _seed_variation_);\n\tfloat coef_abc = sin(1.57079632679*clamp((min(min(length(uv-vec2(0.0, 0.5)), length(uv-vec2(0.5, 0.0))), min(length(uv-vec2(1.0, 0.5)), length(uv-vec2(0.5, 1.0))))-w)/w, 0.0, 1.0));\n\treturn mix(c, mix(a, b, coef_ab), coef_abc);\n}\n\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o559231_0_1_f = clamp(o559231_fct((UV), _seed_variation_), 0.0, 1.0);\nvec2 o116913_0_d = raymarch_o116913((UV), _seed_variation_);\nvec3 o116913_1_1_rgb = vec3(0.5)+0.5*normal_o116913(vec3((UV)-vec2(0.5), 1.0-o116913_0_d.x), _seed_variation_);\nvec4 o180891_0_1_rgba = o180891_gradient_gradient_fct((dot(o116913_1_1_rgb, vec3(1.0))/3.0));\nvec4 o164084_0_1_rgba = make_tileable_o164084((UV), 0.5*p_o164084_w, _seed_variation_);\nvec4 o85415_0_s1 = vec4(vec3(o559231_0_1_f), 1.0);\nvec4 o85415_0_s2 = o180891_0_1_rgba;\nfloat o85415_0_a = p_o85415_amount*(dot((o164084_0_1_rgba).rgb, vec3(1.0))/3.0);\nvec4 o85415_0_1_rgba = vec4(blend_multiply((UV), o85415_0_s1.rgb, o85415_0_s2.rgb, o85415_0_a*o85415_0_s1.a), min(1.0, o85415_0_s2.a+o85415_0_a*o85415_0_s1.a));\nvec4 o689653_0_1_rgba = o689653_gradient_gradient_fct((dot((o85415_0_1_rgba).rgb, vec3(1.0))/3.0));\ngl_FragColor = o689653_0_1_rgba;\n}\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"199",objOut:"198"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"199",objOut:"198"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"199",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"mirrored repeat"},{name:"Floating Point",value:true},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"205",objOut:"199"}]},{name:"Texture",links:[{portIn:"Texture In",portOut:"Texture",objIn:"202",objOut:"199"}]},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Anim.Timer_v2",id:"200",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Speed",value:.72},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"iTime",portOut:"Time",objIn:"198",objOut:"200"}]}]},{objName:"Ops.Sequence",id:"201",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"198",objOut:"201"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",links:[{portIn:"Render",portOut:"trigger 15",objIn:"220",objOut:"201"}]}]},{objName:"Ops.Ui.VizTexture",id:"202",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"203",objOut:"202"}]},{name:"Info",value:"unknown"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"203",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"208",objOut:"203"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v2",id:"204",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"203",objOut:"204"},{portIn:"exe",portOut:"Next",objIn:"201",objOut:"204"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"209",objOut:"204"}]},{name:"Aspect Ratio",value:.9026798307475318}]},{objName:"Ops.Gl.Meshes.Rectangle_v2",id:"205",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"width",value:1},{name:"height",value:1},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"num columns",value:1},{name:"num rows",value:1},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Active",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.GradientTexture",id:"206",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":8.881784197001252e-16,"g":0,"b":1},{"pos":0.02,"r":8.881784197001252e-16,"g":0,"b":1},{"pos":0.21,"r":1,"g":0,"b":0},{"pos":0.488,"r":0.7520159698207888,"g":0.2980955505283348,"b":0.7255181847110971},{"pos":1,"r":0.7520159698207888,"g":0.2980955505283348,"b":0.7255181847110971}]}'},{name:"Direction index",value:0},{name:"Direction",value:"X"},{name:"Smoothstep",value:false},{name:"Step",value:false},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:256},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Gradient Array",value:0},{name:"Randomize Colors",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Mask",portOut:"Texture",objIn:"208",objOut:"206"}]},{name:"Colors"},{name:"Colors Pos"}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"207",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render",value:0},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat box(vec2 uv, vec3 center, vec3 rad, vec3 rot) {\n\tvec3 ro = vec3(uv, 1.0)-center;\n\tvec3 rd = vec3(0.0000001, 0.0000001, -1.0);\n\tmat3 r = mat3(vec3(1, 0, 0), vec3(0, cos(rot.x), -sin(rot.x)), vec3(0, sin(rot.x), cos(rot.x)));\n\tr *= mat3(vec3(cos(rot.y), 0, -sin(rot.y)), vec3(0, 1, 0), vec3(sin(rot.y), 0, cos(rot.y)));\n\tr *= mat3(vec3(cos(rot.z), -sin(rot.z), 0), vec3(sin(rot.z), cos(rot.z), 0), vec3(0, 0, 1));\n\tro = r * ro;\n\trd = r * rd;\n    vec3 m = 1.0/rd;\n    vec3 n = m*ro;\n    vec3 k = abs(m)*rad;\n    vec3 t1 = -n - k;\n    vec3 t2 = -n + k;\n\n    float tN = max(max(t1.x, t1.y), t1.z);\n    float tF = min(min(t2.x, t2.y), t2.z);\n    if(tN>tF || tF<0.0) return 1.0;\n    return tN;\n}float sphere(vec2 uv, vec2 c, float r) {\n\tuv -= c;\n\tuv /= r;\n\treturn 2.0*r*sqrt(max(0.0, 1.0-dot(uv, uv)));\n}\nvec3 blend_normal(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1 + (1.0-opacity)*c2;\n}\n\nvec3 blend_dissolve(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\tif (rand(uv) < opacity) {\n\t\treturn c1;\n\t} else {\n\t\treturn c2;\n\t}\n}\n\nvec3 blend_multiply(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1*c2 + (1.0-opacity)*c2;\n}\n\nvec3 blend_screen(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*(1.0-(1.0-c1)*(1.0-c2)) + (1.0-opacity)*c2;\n}\n\nfloat blend_overlay_f(float c1, float c2) {\n\treturn (c1 < 0.5) ? (2.0*c1*c2) : (1.0-2.0*(1.0-c1)*(1.0-c2));\n}\n\nvec3 blend_overlay(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_overlay_f(c1.x, c2.x), blend_overlay_f(c1.y, c2.y), blend_overlay_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_hard_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*0.5*(c1*c2+blend_overlay(uv, c1, c2, 1.0)) + (1.0-opacity)*c2;\n}\n\nfloat blend_soft_light_f(float c1, float c2) {\n\treturn (c2 < 0.5) ? (2.0*c1*c2+c1*c1*(1.0-2.0*c2)) : 2.0*c1*(1.0-c2)+sqrt(c1)*(2.0*c2-1.0);\n}\n\nvec3 blend_soft_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_soft_light_f(c1.x, c2.x), blend_soft_light_f(c1.y, c2.y), blend_soft_light_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_burn_f(float c1, float c2) {\n\treturn (c1==0.0)?c1:max((1.0-((1.0-c2)/c1)),0.0);\n}\n\nvec3 blend_burn(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_burn_f(c1.x, c2.x), blend_burn_f(c1.y, c2.y), blend_burn_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_dodge_f(float c1, float c2) {\n\treturn (c1==1.0)?c1:min(c2/(1.0-c1),1.0);\n}\n\nvec3 blend_dodge(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_dodge_f(c1.x, c2.x), blend_dodge_f(c1.y, c2.y), blend_dodge_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_lighten(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*max(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_darken(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*min(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_difference(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*clamp(c2-c1, vec3(0.0), vec3(1.0)) + (1.0-opacity)*c2;\n}\nconst float p_o419741_gradient_0_pos = 0.000000000;\nconst float p_o419741_gradient_0_r = 1.000000000;\nconst float p_o419741_gradient_0_g = 0.000000000;\nconst float p_o419741_gradient_0_b = 0.000000000;\nconst float p_o419741_gradient_0_a = 1.000000000;\nconst float p_o419741_gradient_1_pos = 0.144273793;\nconst float p_o419741_gradient_1_r = 1.000000000;\nconst float p_o419741_gradient_1_g = 0.968750000;\nconst float p_o419741_gradient_1_b = 0.000000000;\nconst float p_o419741_gradient_1_a = 1.000000000;\nconst float p_o419741_gradient_2_pos = 0.274273404;\nconst float p_o419741_gradient_2_r = 1.000000000;\nconst float p_o419741_gradient_2_g = 0.000000000;\nconst float p_o419741_gradient_2_b = 0.000000000;\nconst float p_o419741_gradient_2_a = 1.000000000;\nconst float p_o419741_gradient_3_pos = 0.414273349;\nconst float p_o419741_gradient_3_r = 0.843750000;\nconst float p_o419741_gradient_3_g = 0.000000000;\nconst float p_o419741_gradient_3_b = 1.000000000;\nconst float p_o419741_gradient_3_a = 1.000000000;\nconst float p_o419741_gradient_4_pos = 0.854273571;\nconst float p_o419741_gradient_4_r = 0.000000000;\nconst float p_o419741_gradient_4_g = 0.062500000;\nconst float p_o419741_gradient_4_b = 1.000000000;\nconst float p_o419741_gradient_4_a = 1.000000000;\nvec4 o419741_gradient_gradient_fct(float x) {\n  if (x < p_o419741_gradient_0_pos) {\n    return vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a);\n  } else if (x < p_o419741_gradient_1_pos) {\n    return mix(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)), mix(vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a), vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), (x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos)), 1.0-0.5*(x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos));\n  } else if (x < p_o419741_gradient_2_pos) {\n    return 0.5*(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)) + mix(mix(vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a), vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), (x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos)), mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)), 0.5-0.5*cos(3.14159265359*(x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos))));\n  } else if (x < p_o419741_gradient_3_pos) {\n    return 0.5*(mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)) + mix(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)), mix(vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a), (x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos)), 0.5-0.5*cos(3.14159265359*(x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos))));\n  } else if (x < p_o419741_gradient_4_pos) {\n    return mix(mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)), mix(vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a), (x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos)), 0.5+0.5*(x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos));\n  }\n  return vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a);\n}\nconst float p_o398645_amount = 11.760000000;\nconst float p_o479214_gradient_0_pos = 0.025183105;\nconst float p_o479214_gradient_0_r = 1.000000000;\nconst float p_o479214_gradient_0_g = 0.000000000;\nconst float p_o479214_gradient_0_b = 0.000000000;\nconst float p_o479214_gradient_0_a = 1.000000000;\nconst float p_o479214_gradient_1_pos = 0.435182884;\nconst float p_o479214_gradient_1_r = 1.000000000;\nconst float p_o479214_gradient_1_g = 0.968750000;\nconst float p_o479214_gradient_1_b = 0.000000000;\nconst float p_o479214_gradient_1_a = 1.000000000;\nconst float p_o479214_gradient_2_pos = 0.590909368;\nconst float p_o479214_gradient_2_r = 0.000000000;\nconst float p_o479214_gradient_2_g = 1.000000000;\nconst float p_o479214_gradient_2_b = 0.125000000;\nconst float p_o479214_gradient_2_a = 1.000000000;\nconst float p_o479214_gradient_3_pos = 0.915182218;\nconst float p_o479214_gradient_3_r = 0.000000000;\nconst float p_o479214_gradient_3_g = 0.062500000;\nconst float p_o479214_gradient_3_b = 1.000000000;\nconst float p_o479214_gradient_3_a = 1.000000000;\nvec4 o479214_gradient_gradient_fct(float x) {\n  if (x < p_o479214_gradient_0_pos) {\n    return vec4(p_o479214_gradient_0_r,p_o479214_gradient_0_g,p_o479214_gradient_0_b,p_o479214_gradient_0_a);\n  } else if (x < p_o479214_gradient_1_pos) {\n    return mix(vec4(p_o479214_gradient_0_r,p_o479214_gradient_0_g,p_o479214_gradient_0_b,p_o479214_gradient_0_a), vec4(p_o479214_gradient_1_r,p_o479214_gradient_1_g,p_o479214_gradient_1_b,p_o479214_gradient_1_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_0_pos)/(p_o479214_gradient_1_pos-p_o479214_gradient_0_pos)));\n  } else if (x < p_o479214_gradient_2_pos) {\n    return mix(vec4(p_o479214_gradient_1_r,p_o479214_gradient_1_g,p_o479214_gradient_1_b,p_o479214_gradient_1_a), vec4(p_o479214_gradient_2_r,p_o479214_gradient_2_g,p_o479214_gradient_2_b,p_o479214_gradient_2_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_1_pos)/(p_o479214_gradient_2_pos-p_o479214_gradient_1_pos)));\n  } else if (x < p_o479214_gradient_3_pos) {\n    return mix(vec4(p_o479214_gradient_2_r,p_o479214_gradient_2_g,p_o479214_gradient_2_b,p_o479214_gradient_2_a), vec4(p_o479214_gradient_3_r,p_o479214_gradient_3_g,p_o479214_gradient_3_b,p_o479214_gradient_3_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_2_pos)/(p_o479214_gradient_3_pos-p_o479214_gradient_2_pos)));\n  }\n  return vec4(p_o479214_gradient_3_r,p_o479214_gradient_3_g,p_o479214_gradient_3_b,p_o479214_gradient_3_a);\n}\nconst float p_o520101_repeat = 6.000000000;\nconst float p_o270325_cx = 0.500000000;\nconst float p_o270325_cy = 0.500000000;\nconst float p_o270325_cz = 0.500000000;\nconst float p_o270325_sx = 0.250000000;\nconst float p_o270325_sy = 0.250000000;\nconst float p_o270325_sz = 0.250000000;\nconst float p_o270325_ry = 2.000000000;\nconst float p_o207924_d = 0.710000000;\nconst float p_o553530_radius = 0.320000000;\nconst float p_o553530_repeat = 5.000000000;\nconst float p_o57201_cx = 0.500000000;\nconst float p_o57201_cy = 0.710000000;\nconst float p_o254341_r = 0.500000000;\n\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o270325_0_1_f = 1.0-box((vec2(fract(p_o520101_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/(cos(iTime*0.001))*length((UV)-vec2(0.5))))), vec3(p_o270325_cx, p_o270325_cy, p_o270325_cz), vec3(p_o270325_sx, p_o270325_sy, p_o270325_sz), 0.01745329251*vec3((sin(iTime*0.9)*sin(iTime*0.9)), p_o270325_ry, (sin(iTime*0.9)*sin(iTime*0.9)*abs(iTime))));\nvec4 o520101_0_1_rgba = vec4(vec3(o270325_0_1_f), 1.0);\nvec4 o479214_0_1_rgba = o479214_gradient_gradient_fct((dot((o520101_0_1_rgba).rgb, vec3(1.0))/3.0));\nfloat o57201_0_1_f = sphere((vec2(fract(p_o553530_repeat*atan(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5)).y-0.5, ((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o553530_radius*length(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5))-vec2(0.5))))), vec2(p_o57201_cx, p_o57201_cy), (sin(iTime*0.2)*sin(iTime*0.9)));\nvec4 o553530_0_1_rgba = vec4(vec3(o57201_0_1_f), 1.0);\nvec3 o241986_0_1_tex3d = ((o553530_0_1_rgba).rgb);\nvec2 o254341_0_q = vec2(length(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xyz).xy)-(sin(iTime*0.2)),((vec4(((o479214_0_1_rgba).rgb), 0.0)).xyz).z);\nfloat o254341_0_1_sdf3d = length(o254341_0_q)-p_o254341_r;\nvec3 o207924_0_1_tex3d = mix(o241986_0_1_tex3d, vec3(0.5), clamp(o254341_0_1_sdf3d/max(p_o207924_d, 0.0001), 0.0, 1.0));\nvec3 o245261_0_1_rgb = o207924_0_1_tex3d;\nvec3 o241986_0_3_tex3d = ((o553530_0_1_rgba).rgb);\nvec3 o818931_0_1_rgb = o241986_0_3_tex3d;\nfloat o57201_0_3_f = sphere((vec2(fract(p_o553530_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o553530_radius*length((UV)-vec2(0.5))))), vec2(p_o57201_cx, p_o57201_cy), (sin(iTime*0.2)*sin(iTime*0.9)));\nvec4 o553530_0_3_rgba = vec4(vec3(o57201_0_3_f), 1.0);\nvec4 o398645_0_s1 = vec4(o245261_0_1_rgb, 1.0);\nvec4 o398645_0_s2 = vec4(o818931_0_1_rgb, 1.0);\nfloat o398645_0_a = p_o398645_amount*(dot((o553530_0_3_rgba).rgb, vec3(1.0))/3.0);\nvec4 o398645_0_1_rgba = vec4(blend_soft_light((UV), o398645_0_s1.rgb, o398645_0_s2.rgb, o398645_0_a*o398645_0_s1.a), min(1.0, o398645_0_s2.a+o398645_0_a*o398645_0_s1.a));\nvec4 o419741_0_1_rgba = o419741_gradient_gradient_fct((dot((o398645_0_1_rgba).rgb, vec3(1.0))/3.0));\ngl_FragColor = o419741_0_1_rgba;\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime",value:0}],portsOut:[{name:"trigger",value:0},{name:"Shader"},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.TextureEffects.ChromaticAberration",id:"208",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"add"},{name:"Amount",value:.716},{name:"Pixel",value:5.01},{name:"Lens Distort",value:.762},{name:"Smooth",value:false},{name:"Mask"}],portsOut:[{name:"trigger",links:[{portIn:"exe 14",portOut:"trigger",objIn:"271",objOut:"208"}]}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"209",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"210",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render",value:0},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat shape_circle(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float distance = length(uv);\n    return clamp((1.0-distance/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_polygon(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y)+3.14159265359;\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(0.5+angle/slice)*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(angle*sides/6.28318530718-0.5+2.0*step(fract(angle*sides/6.28318530718), 0.5))*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_curved_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = 2.0*(atan(uv.x, uv.y)+3.14159265359);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-cos(floor(0.5+0.5*angle/slice)*2.0*slice-angle)*length(uv)/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_rays(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = 0.5*max(edge, 1.0e-8)*size;\n\tfloat slice = 6.28318530718/sides;\n    float angle = mod(atan(uv.x, uv.y)+3.14159265359, slice)/slice;\n    return clamp(min((size-angle)/edge, angle/edge), 0.0, 1.0);\n}\n\nvec2 rotate(vec2 uv, vec2 center, float rotate) {\n \tvec2 rv;\n\tuv -= center;\n\trv.x = cos(rotate)*uv.x + sin(rotate)*uv.y;\n\trv.y = -sin(rotate)*uv.x + cos(rotate)*uv.y;\n\trv += center;\n    return rv;\t\n}const float p_o370586_cx = 0.000000000;\nconst float p_o370586_cy = 0.000000000;\nconst float p_o265706_gradient_0_pos = 0.000000000;\nconst float p_o265706_gradient_0_r = 1.000000000;\nconst float p_o265706_gradient_0_g = 0.000000000;\nconst float p_o265706_gradient_0_b = 0.000000000;\nconst float p_o265706_gradient_0_a = 1.000000000;\nconst float p_o265706_gradient_1_pos = 0.399003462;\nconst float p_o265706_gradient_1_r = 0.035911076;\nconst float p_o265706_gradient_1_g = 0.145327628;\nconst float p_o265706_gradient_1_b = 0.574577212;\nconst float p_o265706_gradient_1_a = 1.000000000;\nconst float p_o265706_gradient_2_pos = 0.662364613;\nconst float p_o265706_gradient_2_r = 0.098464966;\nconst float p_o265706_gradient_2_g = 0.185065985;\nconst float p_o265706_gradient_2_b = 0.933593750;\nconst float p_o265706_gradient_2_a = 1.000000000;\nconst float p_o265706_gradient_3_pos = 1.000000000;\nconst float p_o265706_gradient_3_r = 0.000000000;\nconst float p_o265706_gradient_3_g = 0.062500000;\nconst float p_o265706_gradient_3_b = 1.000000000;\nconst float p_o265706_gradient_3_a = 1.000000000;\nvec4 o265706_gradient_gradient_fct(float x) {\n  if (x < p_o265706_gradient_0_pos) {\n    return vec4(p_o265706_gradient_0_r,p_o265706_gradient_0_g,p_o265706_gradient_0_b,p_o265706_gradient_0_a);\n  } else if (x < p_o265706_gradient_1_pos) {\n    return mix(vec4(p_o265706_gradient_0_r,p_o265706_gradient_0_g,p_o265706_gradient_0_b,p_o265706_gradient_0_a), vec4(p_o265706_gradient_1_r,p_o265706_gradient_1_g,p_o265706_gradient_1_b,p_o265706_gradient_1_a), ((x-p_o265706_gradient_0_pos)/(p_o265706_gradient_1_pos-p_o265706_gradient_0_pos)));\n  } else if (x < p_o265706_gradient_2_pos) {\n    return mix(vec4(p_o265706_gradient_1_r,p_o265706_gradient_1_g,p_o265706_gradient_1_b,p_o265706_gradient_1_a), vec4(p_o265706_gradient_2_r,p_o265706_gradient_2_g,p_o265706_gradient_2_b,p_o265706_gradient_2_a), ((x-p_o265706_gradient_1_pos)/(p_o265706_gradient_2_pos-p_o265706_gradient_1_pos)));\n  } else if (x < p_o265706_gradient_3_pos) {\n    return mix(vec4(p_o265706_gradient_2_r,p_o265706_gradient_2_g,p_o265706_gradient_2_b,p_o265706_gradient_2_a), vec4(p_o265706_gradient_3_r,p_o265706_gradient_3_g,p_o265706_gradient_3_b,p_o265706_gradient_3_a), ((x-p_o265706_gradient_2_pos)/(p_o265706_gradient_3_pos-p_o265706_gradient_2_pos)));\n  }\n  return vec4(p_o265706_gradient_3_r,p_o265706_gradient_3_g,p_o265706_gradient_3_b,p_o265706_gradient_3_a);\n}\nconst float p_o27497_radius = 1.000000000;\nconst float p_o27497_repeat = 7.000000000;\nconst float p_o22106_radius = 1.000000000;\nconst float p_o22106_repeat = 1.000000000;\nconst float p_o15531_radius = 1.500000000;\nconst float p_o15531_repeat = 1.000000000;\nconst float p_o35637_cx = 0.000000000;\nconst float p_o9383_sides = 5.000000000;\nconst float p_o9383_radius = 0.640000000;\nconst float p_o9383_edge = 0.500000000;\nvec3 o559231_input_in(vec2 uv, float _seed_variation_) {\nfloat o9383_0_1_f = shape_polygon((rotate((vec2(fract(p_o15531_repeat*atan((vec2(fract(p_o22106_repeat*atan((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o22106_radius*length((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5))))).y-0.5, (vec2(fract(p_o22106_repeat*atan((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o22106_radius*length((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o15531_radius*length((vec2(fract(p_o22106_repeat*atan((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o22106_radius*length((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5)))))-vec2(0.5))))), vec2(0.5+p_o35637_cx, 0.5+(sin(iTime * 0.009) * (iTime * 0.0005))), (sin(iTime * 0.05) * (iTime))*0.01745329251)), p_o9383_sides, p_o9383_radius*1.0, p_o9383_edge*1.0);\nvec4 o35637_0_1_rgba = vec4(vec3(o9383_0_1_f), 1.0);\nvec4 o15531_0_1_rgba = o35637_0_1_rgba;\nvec4 o22106_0_1_rgba = o15531_0_1_rgba;\nvec4 o27497_0_1_rgba = o22106_0_1_rgba;\nvec4 o265706_0_1_rgba = o265706_gradient_gradient_fct((dot((o27497_0_1_rgba).rgb, vec3(1.0))/3.0));\nvec4 o370586_0_1_rgba = o265706_0_1_rgba;\n\nreturn ((o370586_0_1_rgba).rgb);\n}\nfloat o559231_fct(vec2 uv, float _seed_variation_) {\n\tvec2 e = vec2(1.0/512.000000000, -1.0/512.000000000);\n\tvec3 rv = 4.0*o559231_input_in(uv, _seed_variation_);\n\trv -= o559231_input_in(uv+e.xy, _seed_variation_);\n\trv -= o559231_input_in(uv-e.xy, _seed_variation_);\n\trv -= o559231_input_in(uv+e.xx, _seed_variation_);\n\trv -= o559231_input_in(uv-e.xx, _seed_variation_);\n\trv = abs(rv);\n\treturn max(rv.x, max(rv.y ,rv.z))*512.000000000;\n}\n\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o559231_0_1_f = clamp(o559231_fct((UV), _seed_variation_), 0.0, 1.0);\ngl_FragColor = vec4(vec3(o559231_0_1_f), 1.0);\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime",value:0}],portsOut:[{name:"trigger",value:0},{name:"Shader"},{name:"Has Errors",value:false}]},{objName:"Ops.Trigger.TriggerReceive",id:"211",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Named Trigger",value:"TimerStart"}],portsOut:[{name:"Triggered",links:[{portIn:"Reset",portOut:"Triggered",objIn:"188",objOut:"211"}]}]},{objName:"Ops.Trigger.TriggerReceive",id:"212",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Named Trigger",value:"TimerStart"}],portsOut:[{name:"Triggered",links:[{portIn:"Reset",portOut:"Triggered",objIn:"200",objOut:"212"}]}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"213",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat sdArc(vec2 p, float a1, float a2, float ra, float rb) {\n\tfloat amid = 0.5*(a1+a2)+1.6+3.14*step(a1, a2);\n\tfloat alength = 0.5*(a1-a2)-1.6+3.14*step(a1, a2);\n\tvec2 sca = vec2(cos(amid), sin(amid));\n\tvec2 scb = vec2(cos(alength), sin(alength));\n    p *= mat2(vec2(sca.x,sca.y),vec2(-sca.y,sca.x));\n    p.x = abs(p.x);\n    float k = (scb.y*p.x>scb.x*p.y) ? dot(p.xy,scb) : length(p.xy);\n    return sqrt( dot(p,p) + ra*ra - 2.0*ra*k ) - rb;\n}\nvec2 sdLine(vec2 p, vec2 a, vec2 b) {\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp(dot(pa,ba)/dot(ba,ba), 0.0, 1.0);\n    return vec2(length(pa-ba*h), h);\n}\nconst float p_o119967_gradient_0_pos = 0.209090909;\nconst float p_o119967_gradient_0_r = 1.000000000;\nconst float p_o119967_gradient_0_g = 0.000000000;\nconst float p_o119967_gradient_0_b = 0.000000000;\nconst float p_o119967_gradient_0_a = 1.000000000;\nconst float p_o119967_gradient_1_pos = 0.827272727;\nconst float p_o119967_gradient_1_r = 0.000000000;\nconst float p_o119967_gradient_1_g = 0.062500000;\nconst float p_o119967_gradient_1_b = 1.000000000;\nconst float p_o119967_gradient_1_a = 1.000000000;\nvec4 o119967_gradient_gradient_fct(float x) {\n  if (x < p_o119967_gradient_0_pos) {\n    return vec4(p_o119967_gradient_0_r,p_o119967_gradient_0_g,p_o119967_gradient_0_b,p_o119967_gradient_0_a);\n  } else if (x < p_o119967_gradient_1_pos) {\n    return mix(vec4(p_o119967_gradient_0_r,p_o119967_gradient_0_g,p_o119967_gradient_0_b,p_o119967_gradient_0_a), vec4(p_o119967_gradient_1_r,p_o119967_gradient_1_g,p_o119967_gradient_1_b,p_o119967_gradient_1_a), 0.5-0.5*cos(3.14159265359*(x-p_o119967_gradient_0_pos)/(p_o119967_gradient_1_pos-p_o119967_gradient_0_pos)));\n  }\n  return vec4(p_o119967_gradient_1_r,p_o119967_gradient_1_g,p_o119967_gradient_1_b,p_o119967_gradient_1_a);\n}\nconst float p_o47866_radius = 0.980000019;\nconst float p_o36150_d = 0.390000000;\nconst float p_o14099_a1 = 30.000000000;\nconst float p_o14099_a2 = 150.000000000;\nconst float p_o14099_r1 = 0.300000000;\nconst float p_o14099_r2 = 0.100000000;\nconst float p_o20177_ax = -0.300000000;\nconst float p_o20177_ay = -0.300000000;\nconst float p_o20177_bx = 0.270000000;\nconst float p_o20177_by = 0.300000000;\nconst float p_o20177_r = 0.050000000;\nvec2 o44908_input_sdf(vec3 p, float _seed_variation_) {\nvec2 o36150_0_q = vec2(length((p).xy)-p_o36150_d+0.5, (p).z+0.5);\nfloat o14099_0_1_sdf2d = sdArc((o36150_0_q)-vec2(0.5), mod(p_o14099_a1, 360.0)*0.01745329251, mod(p_o14099_a2, 360.0)*0.01745329251, p_o14099_r1, p_o14099_r2);\nvec2 o20177_0_sdl = sdLine((o36150_0_q), vec2(p_o20177_ax+0.5, p_o20177_ay+0.5), vec2(p_o20177_bx+0.5, p_o20177_by+0.5));float o20177_0_1_sdf2d = o20177_0_sdl.x-p_o20177_r*1.0;\nfloat o8300_0_1_sdf2d = mix(o14099_0_1_sdf2d, o20177_0_1_sdf2d, (cos(iTime) * 5.6 * 3.1426));\nfloat o36150_0_1_sdf3d = o8300_0_1_sdf2d;\n\nreturn vec2(o36150_0_1_sdf3d, 0.0);\n}\nvec2 raymarch_o44908(vec2 uv, float _seed_variation_) {\n\tvec3 ro = vec3(uv-vec2(0.5), 1.0);\n\tvec3 rd = vec3(0.0, 0.0, -1.0);\n\tfloat dO = 0.0;\n\tfloat c = 0.0;\n    for (int i=0; i < 100; i++) {\n    \tvec3 p = ro + rd*dO;\n        vec2 dS = o44908_input_sdf(p, _seed_variation_);\n        dO += dS.x;\n\n        if (dO >= 1.0) {\n\t\t\tbreak;\n\t\t} else if (dS.x < 0.0001) {\n\t\t\tc = dS.y;\n\t\t\tbreak;\n\t\t}\n    }\n    \n    return vec2(dO, c);\n}\n\nvec3 normal_o44908(vec3 p, float _seed_variation_) {\n\tif (p.z <= 0.0) {\n\t\treturn vec3(0.0, 0.0, 1.0);\n\t}\n\n\tfloat d = o44908_input_sdf(p, _seed_variation_).x;\n    float e = .001;\n    \n    vec3 n = d - vec3(\n        o44908_input_sdf(p-vec3(e, 0.0, 0.0), _seed_variation_).x,\n        o44908_input_sdf(p-vec3(0.0, e, 0.0), _seed_variation_).x,\n        o44908_input_sdf(p-vec3(0.0, 0.0, e), _seed_variation_).x);\n    \n    return vec3(-1.0, -1.0, -1.0)*normalize(n);\n}\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nvec2 o44908_0_d = raymarch_o44908((vec2(fract((tan(iTime))*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o47866_radius*length((UV)-vec2(0.5))))), _seed_variation_);\nvec3 o44908_1_1_rgb = vec3(0.5)+0.5*normal_o44908(vec3((vec2(fract((tan(iTime))*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o47866_radius*length((UV)-vec2(0.5)))))-vec2(0.5), 1.0-o44908_0_d.x), _seed_variation_);\nvec4 o47866_0_1_rgba = vec4(o44908_1_1_rgb, 1.0);\nvec4 o119967_0_1_rgba = o119967_gradient_gradient_fct((dot((o47866_0_1_rgba).rgb, vec3(1.0))/3.0));\ngl_FragColor = o119967_0_1_rgba;\n}\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"214",objOut:"213"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"214",objOut:"213"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"214",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"mirrored repeat"},{name:"Floating Point",value:true},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",value:0},{name:"Texture",links:[{portIn:"Texture In",portOut:"Texture",objIn:"217",objOut:"214"}]},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Anim.Timer_v2",id:"215",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Speed",value:.72},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"iTime",portOut:"Time",objIn:"213",objOut:"215"}]}]},{objName:"Ops.Sequence",id:"216",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"213",objOut:"216"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",links:[{portIn:"Render",portOut:"trigger 15",objIn:"237",objOut:"216"}]}]},{objName:"Ops.Ui.VizTexture",id:"217",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"219",objOut:"217"}]},{name:"Info",value:"unknown"}]},{objName:"Ops.Gl.Render2Texture",id:"218",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render",value:null},{name:"use viewport size",value:true},{name:"texture width",value:640},{name:"texture height",value:320},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:true},{name:"Clear",value:true}],portsOut:[{name:"trigger",value:0},{name:"texture"},{name:"textureDepth"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"219",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"226",objOut:"219"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v2",id:"220",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"219",objOut:"220"},{portIn:"exe",portOut:"Next",objIn:"216",objOut:"220"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"227",objOut:"220"}]},{name:"Aspect Ratio",value:.9026798307475318}]},{objName:"Ops.Gl.Meshes.Rectangle_v2",id:"221",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render",value:null},{name:"width",value:1},{name:"height",value:1},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"num columns",value:1},{name:"num rows",value:1},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Active",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.TextureEffects.Wobble",id:"222",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render",value:null},{name:"time",value:0},{name:"SpeedX",value:4},{name:"SpeedY",value:8},{name:"RepeatX",value:10.94},{name:"RepeatY",value:7.17},{name:"Multiply",value:.08},{name:"Mask",value:0}],portsOut:[{name:"Trigger",value:0}]},{objName:"Ops.Gl.GradientTexture",id:"223",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":8.881784197001252e-16,"g":0,"b":1},{"pos":0.02,"r":8.881784197001252e-16,"g":0,"b":1},{"pos":0.21,"r":1,"g":0,"b":0},{"pos":0.488,"r":0.7520159698207888,"g":0.2980955505283348,"b":0.7255181847110971},{"pos":1,"r":0.7520159698207888,"g":0.2980955505283348,"b":0.7255181847110971}]}'},{name:"Direction index",value:0},{name:"Direction",value:"X"},{name:"Smoothstep",value:false},{name:"Step",value:false},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:256},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Gradient Array",value:0},{name:"Randomize Colors",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Mask",portOut:"Texture",objIn:"226",objOut:"223"}]},{name:"Colors"},{name:"Colors Pos"}]},{objName:"Ops.Gl.TextureEffects.ColorMap",id:"224",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render",value:null},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"lighten"},{name:"Amount",value:1},{name:"Gradient",value:0},{name:"Method index",value:0},{name:"Method",value:"Luminance"},{name:"Min",value:0},{name:"Max",value:1},{name:"Position",value:.5}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"225",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render",value:0},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat box(vec2 uv, vec3 center, vec3 rad, vec3 rot) {\n\tvec3 ro = vec3(uv, 1.0)-center;\n\tvec3 rd = vec3(0.0000001, 0.0000001, -1.0);\n\tmat3 r = mat3(vec3(1, 0, 0), vec3(0, cos(rot.x), -sin(rot.x)), vec3(0, sin(rot.x), cos(rot.x)));\n\tr *= mat3(vec3(cos(rot.y), 0, -sin(rot.y)), vec3(0, 1, 0), vec3(sin(rot.y), 0, cos(rot.y)));\n\tr *= mat3(vec3(cos(rot.z), -sin(rot.z), 0), vec3(sin(rot.z), cos(rot.z), 0), vec3(0, 0, 1));\n\tro = r * ro;\n\trd = r * rd;\n    vec3 m = 1.0/rd;\n    vec3 n = m*ro;\n    vec3 k = abs(m)*rad;\n    vec3 t1 = -n - k;\n    vec3 t2 = -n + k;\n\n    float tN = max(max(t1.x, t1.y), t1.z);\n    float tF = min(min(t2.x, t2.y), t2.z);\n    if(tN>tF || tF<0.0) return 1.0;\n    return tN;\n}float sphere(vec2 uv, vec2 c, float r) {\n\tuv -= c;\n\tuv /= r;\n\treturn 2.0*r*sqrt(max(0.0, 1.0-dot(uv, uv)));\n}\nvec3 blend_normal(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1 + (1.0-opacity)*c2;\n}\n\nvec3 blend_dissolve(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\tif (rand(uv) < opacity) {\n\t\treturn c1;\n\t} else {\n\t\treturn c2;\n\t}\n}\n\nvec3 blend_multiply(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1*c2 + (1.0-opacity)*c2;\n}\n\nvec3 blend_screen(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*(1.0-(1.0-c1)*(1.0-c2)) + (1.0-opacity)*c2;\n}\n\nfloat blend_overlay_f(float c1, float c2) {\n\treturn (c1 < 0.5) ? (2.0*c1*c2) : (1.0-2.0*(1.0-c1)*(1.0-c2));\n}\n\nvec3 blend_overlay(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_overlay_f(c1.x, c2.x), blend_overlay_f(c1.y, c2.y), blend_overlay_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_hard_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*0.5*(c1*c2+blend_overlay(uv, c1, c2, 1.0)) + (1.0-opacity)*c2;\n}\n\nfloat blend_soft_light_f(float c1, float c2) {\n\treturn (c2 < 0.5) ? (2.0*c1*c2+c1*c1*(1.0-2.0*c2)) : 2.0*c1*(1.0-c2)+sqrt(c1)*(2.0*c2-1.0);\n}\n\nvec3 blend_soft_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_soft_light_f(c1.x, c2.x), blend_soft_light_f(c1.y, c2.y), blend_soft_light_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_burn_f(float c1, float c2) {\n\treturn (c1==0.0)?c1:max((1.0-((1.0-c2)/c1)),0.0);\n}\n\nvec3 blend_burn(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_burn_f(c1.x, c2.x), blend_burn_f(c1.y, c2.y), blend_burn_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_dodge_f(float c1, float c2) {\n\treturn (c1==1.0)?c1:min(c2/(1.0-c1),1.0);\n}\n\nvec3 blend_dodge(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_dodge_f(c1.x, c2.x), blend_dodge_f(c1.y, c2.y), blend_dodge_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_lighten(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*max(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_darken(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*min(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_difference(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*clamp(c2-c1, vec3(0.0), vec3(1.0)) + (1.0-opacity)*c2;\n}\nconst float p_o419741_gradient_0_pos = 0.000000000;\nconst float p_o419741_gradient_0_r = 1.000000000;\nconst float p_o419741_gradient_0_g = 0.000000000;\nconst float p_o419741_gradient_0_b = 0.000000000;\nconst float p_o419741_gradient_0_a = 1.000000000;\nconst float p_o419741_gradient_1_pos = 0.144273793;\nconst float p_o419741_gradient_1_r = 1.000000000;\nconst float p_o419741_gradient_1_g = 0.968750000;\nconst float p_o419741_gradient_1_b = 0.000000000;\nconst float p_o419741_gradient_1_a = 1.000000000;\nconst float p_o419741_gradient_2_pos = 0.274273404;\nconst float p_o419741_gradient_2_r = 1.000000000;\nconst float p_o419741_gradient_2_g = 0.000000000;\nconst float p_o419741_gradient_2_b = 0.000000000;\nconst float p_o419741_gradient_2_a = 1.000000000;\nconst float p_o419741_gradient_3_pos = 0.414273349;\nconst float p_o419741_gradient_3_r = 0.843750000;\nconst float p_o419741_gradient_3_g = 0.000000000;\nconst float p_o419741_gradient_3_b = 1.000000000;\nconst float p_o419741_gradient_3_a = 1.000000000;\nconst float p_o419741_gradient_4_pos = 0.854273571;\nconst float p_o419741_gradient_4_r = 0.000000000;\nconst float p_o419741_gradient_4_g = 0.062500000;\nconst float p_o419741_gradient_4_b = 1.000000000;\nconst float p_o419741_gradient_4_a = 1.000000000;\nvec4 o419741_gradient_gradient_fct(float x) {\n  if (x < p_o419741_gradient_0_pos) {\n    return vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a);\n  } else if (x < p_o419741_gradient_1_pos) {\n    return mix(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)), mix(vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a), vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), (x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos)), 1.0-0.5*(x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos));\n  } else if (x < p_o419741_gradient_2_pos) {\n    return 0.5*(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)) + mix(mix(vec4(p_o419741_gradient_0_r,p_o419741_gradient_0_g,p_o419741_gradient_0_b,p_o419741_gradient_0_a), vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), (x-p_o419741_gradient_0_pos)/(p_o419741_gradient_1_pos-p_o419741_gradient_0_pos)), mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)), 0.5-0.5*cos(3.14159265359*(x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos))));\n  } else if (x < p_o419741_gradient_3_pos) {\n    return 0.5*(mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)) + mix(mix(vec4(p_o419741_gradient_1_r,p_o419741_gradient_1_g,p_o419741_gradient_1_b,p_o419741_gradient_1_a), vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), (x-p_o419741_gradient_1_pos)/(p_o419741_gradient_2_pos-p_o419741_gradient_1_pos)), mix(vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a), (x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos)), 0.5-0.5*cos(3.14159265359*(x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos))));\n  } else if (x < p_o419741_gradient_4_pos) {\n    return mix(mix(vec4(p_o419741_gradient_2_r,p_o419741_gradient_2_g,p_o419741_gradient_2_b,p_o419741_gradient_2_a), vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), (x-p_o419741_gradient_2_pos)/(p_o419741_gradient_3_pos-p_o419741_gradient_2_pos)), mix(vec4(p_o419741_gradient_3_r,p_o419741_gradient_3_g,p_o419741_gradient_3_b,p_o419741_gradient_3_a), vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a), (x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos)), 0.5+0.5*(x-p_o419741_gradient_3_pos)/(p_o419741_gradient_4_pos-p_o419741_gradient_3_pos));\n  }\n  return vec4(p_o419741_gradient_4_r,p_o419741_gradient_4_g,p_o419741_gradient_4_b,p_o419741_gradient_4_a);\n}\nconst float p_o398645_amount = 11.760000000;\nconst float p_o479214_gradient_0_pos = 0.025183105;\nconst float p_o479214_gradient_0_r = 1.000000000;\nconst float p_o479214_gradient_0_g = 0.000000000;\nconst float p_o479214_gradient_0_b = 0.000000000;\nconst float p_o479214_gradient_0_a = 1.000000000;\nconst float p_o479214_gradient_1_pos = 0.435182884;\nconst float p_o479214_gradient_1_r = 1.000000000;\nconst float p_o479214_gradient_1_g = 0.968750000;\nconst float p_o479214_gradient_1_b = 0.000000000;\nconst float p_o479214_gradient_1_a = 1.000000000;\nconst float p_o479214_gradient_2_pos = 0.590909368;\nconst float p_o479214_gradient_2_r = 0.000000000;\nconst float p_o479214_gradient_2_g = 1.000000000;\nconst float p_o479214_gradient_2_b = 0.125000000;\nconst float p_o479214_gradient_2_a = 1.000000000;\nconst float p_o479214_gradient_3_pos = 0.915182218;\nconst float p_o479214_gradient_3_r = 0.000000000;\nconst float p_o479214_gradient_3_g = 0.062500000;\nconst float p_o479214_gradient_3_b = 1.000000000;\nconst float p_o479214_gradient_3_a = 1.000000000;\nvec4 o479214_gradient_gradient_fct(float x) {\n  if (x < p_o479214_gradient_0_pos) {\n    return vec4(p_o479214_gradient_0_r,p_o479214_gradient_0_g,p_o479214_gradient_0_b,p_o479214_gradient_0_a);\n  } else if (x < p_o479214_gradient_1_pos) {\n    return mix(vec4(p_o479214_gradient_0_r,p_o479214_gradient_0_g,p_o479214_gradient_0_b,p_o479214_gradient_0_a), vec4(p_o479214_gradient_1_r,p_o479214_gradient_1_g,p_o479214_gradient_1_b,p_o479214_gradient_1_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_0_pos)/(p_o479214_gradient_1_pos-p_o479214_gradient_0_pos)));\n  } else if (x < p_o479214_gradient_2_pos) {\n    return mix(vec4(p_o479214_gradient_1_r,p_o479214_gradient_1_g,p_o479214_gradient_1_b,p_o479214_gradient_1_a), vec4(p_o479214_gradient_2_r,p_o479214_gradient_2_g,p_o479214_gradient_2_b,p_o479214_gradient_2_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_1_pos)/(p_o479214_gradient_2_pos-p_o479214_gradient_1_pos)));\n  } else if (x < p_o479214_gradient_3_pos) {\n    return mix(vec4(p_o479214_gradient_2_r,p_o479214_gradient_2_g,p_o479214_gradient_2_b,p_o479214_gradient_2_a), vec4(p_o479214_gradient_3_r,p_o479214_gradient_3_g,p_o479214_gradient_3_b,p_o479214_gradient_3_a), 0.5-0.5*cos(3.14159265359*(x-p_o479214_gradient_2_pos)/(p_o479214_gradient_3_pos-p_o479214_gradient_2_pos)));\n  }\n  return vec4(p_o479214_gradient_3_r,p_o479214_gradient_3_g,p_o479214_gradient_3_b,p_o479214_gradient_3_a);\n}\nconst float p_o520101_repeat = 6.000000000;\nconst float p_o270325_cx = 0.500000000;\nconst float p_o270325_cy = 0.500000000;\nconst float p_o270325_cz = 0.500000000;\nconst float p_o270325_sx = 0.250000000;\nconst float p_o270325_sy = 0.250000000;\nconst float p_o270325_sz = 0.250000000;\nconst float p_o270325_ry = 2.000000000;\nconst float p_o207924_d = 0.710000000;\nconst float p_o553530_radius = 0.320000000;\nconst float p_o553530_repeat = 5.000000000;\nconst float p_o57201_cx = 0.500000000;\nconst float p_o57201_cy = 0.710000000;\nconst float p_o254341_r = 0.500000000;\n\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o270325_0_1_f = 1.0-box((vec2(fract(p_o520101_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/(cos(iTime*0.001))*length((UV)-vec2(0.5))))), vec3(p_o270325_cx, p_o270325_cy, p_o270325_cz), vec3(p_o270325_sx, p_o270325_sy, p_o270325_sz), 0.01745329251*vec3((sin(iTime*0.9)*sin(iTime*0.9)), p_o270325_ry, (sin(iTime*0.9)*sin(iTime*0.9)*abs(iTime))));\nvec4 o520101_0_1_rgba = vec4(vec3(o270325_0_1_f), 1.0);\nvec4 o479214_0_1_rgba = o479214_gradient_gradient_fct((dot((o520101_0_1_rgba).rgb, vec3(1.0))/3.0));\nfloat o57201_0_1_f = sphere((vec2(fract(p_o553530_repeat*atan(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5)).y-0.5, ((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o553530_radius*length(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xy+vec2(0.5))-vec2(0.5))))), vec2(p_o57201_cx, p_o57201_cy), (sin(iTime*0.2)*sin(iTime*0.9)));\nvec4 o553530_0_1_rgba = vec4(vec3(o57201_0_1_f), 1.0);\nvec3 o241986_0_1_tex3d = ((o553530_0_1_rgba).rgb);\nvec2 o254341_0_q = vec2(length(((vec4(((o479214_0_1_rgba).rgb), 0.0)).xyz).xy)-(sin(iTime*0.2)),((vec4(((o479214_0_1_rgba).rgb), 0.0)).xyz).z);\nfloat o254341_0_1_sdf3d = length(o254341_0_q)-p_o254341_r;\nvec3 o207924_0_1_tex3d = mix(o241986_0_1_tex3d, vec3(0.5), clamp(o254341_0_1_sdf3d/max(p_o207924_d, 0.0001), 0.0, 1.0));\nvec3 o245261_0_1_rgb = o207924_0_1_tex3d;\nvec3 o241986_0_3_tex3d = ((o553530_0_1_rgba).rgb);\nvec3 o818931_0_1_rgb = o241986_0_3_tex3d;\nfloat o57201_0_3_f = sphere((vec2(fract(p_o553530_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o553530_radius*length((UV)-vec2(0.5))))), vec2(p_o57201_cx, p_o57201_cy), (sin(iTime*0.2)*sin(iTime*0.9)));\nvec4 o553530_0_3_rgba = vec4(vec3(o57201_0_3_f), 1.0);\nvec4 o398645_0_s1 = vec4(o245261_0_1_rgb, 1.0);\nvec4 o398645_0_s2 = vec4(o818931_0_1_rgb, 1.0);\nfloat o398645_0_a = p_o398645_amount*(dot((o553530_0_3_rgba).rgb, vec3(1.0))/3.0);\nvec4 o398645_0_1_rgba = vec4(blend_soft_light((UV), o398645_0_s1.rgb, o398645_0_s2.rgb, o398645_0_a*o398645_0_s1.a), min(1.0, o398645_0_s2.a+o398645_0_a*o398645_0_s1.a));\nvec4 o419741_0_1_rgba = o419741_gradient_gradient_fct((dot((o398645_0_1_rgba).rgb, vec3(1.0))/3.0));\ngl_FragColor = o419741_0_1_rgba;\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime",value:0}],portsOut:[{name:"trigger",value:0},{name:"Shader"},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.TextureEffects.ChromaticAberration",id:"226",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"add"},{name:"Amount",value:.716},{name:"Pixel",value:5.01},{name:"Lens Distort",value:.762},{name:"Smooth",value:false},{name:"Mask"}],portsOut:[{name:"trigger",links:[{portIn:"in0 Ops.Gl.TextureEffects.FastBlur trigger",portOut:"trigger",objIn:"270",objOut:"226"}]}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"227",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"228",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render",value:0},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n//---\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat shape_circle(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float distance = length(uv);\n    return clamp((1.0-distance/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_polygon(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y)+3.14159265359;\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(0.5+angle/slice)*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(angle*sides/6.28318530718-0.5+2.0*step(fract(angle*sides/6.28318530718), 0.5))*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_curved_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = 2.0*(atan(uv.x, uv.y)+3.14159265359);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-cos(floor(0.5+0.5*angle/slice)*2.0*slice-angle)*length(uv)/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_rays(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = 0.5*max(edge, 1.0e-8)*size;\n\tfloat slice = 6.28318530718/sides;\n    float angle = mod(atan(uv.x, uv.y)+3.14159265359, slice)/slice;\n    return clamp(min((size-angle)/edge, angle/edge), 0.0, 1.0);\n}\n\nvec2 rotate(vec2 uv, vec2 center, float rotate) {\n \tvec2 rv;\n\tuv -= center;\n\trv.x = cos(rotate)*uv.x + sin(rotate)*uv.y;\n\trv.y = -sin(rotate)*uv.x + cos(rotate)*uv.y;\n\trv += center;\n    return rv;\t\n}const float p_o370586_cx = 0.000000000;\nconst float p_o370586_cy = 0.000000000;\nconst float p_o265706_gradient_0_pos = 0.000000000;\nconst float p_o265706_gradient_0_r = 1.000000000;\nconst float p_o265706_gradient_0_g = 0.000000000;\nconst float p_o265706_gradient_0_b = 0.000000000;\nconst float p_o265706_gradient_0_a = 1.000000000;\nconst float p_o265706_gradient_1_pos = 0.399003462;\nconst float p_o265706_gradient_1_r = 0.035911076;\nconst float p_o265706_gradient_1_g = 0.145327628;\nconst float p_o265706_gradient_1_b = 0.574577212;\nconst float p_o265706_gradient_1_a = 1.000000000;\nconst float p_o265706_gradient_2_pos = 0.662364613;\nconst float p_o265706_gradient_2_r = 0.098464966;\nconst float p_o265706_gradient_2_g = 0.185065985;\nconst float p_o265706_gradient_2_b = 0.933593750;\nconst float p_o265706_gradient_2_a = 1.000000000;\nconst float p_o265706_gradient_3_pos = 1.000000000;\nconst float p_o265706_gradient_3_r = 0.000000000;\nconst float p_o265706_gradient_3_g = 0.062500000;\nconst float p_o265706_gradient_3_b = 1.000000000;\nconst float p_o265706_gradient_3_a = 1.000000000;\nvec4 o265706_gradient_gradient_fct(float x) {\n  if (x < p_o265706_gradient_0_pos) {\n    return vec4(p_o265706_gradient_0_r,p_o265706_gradient_0_g,p_o265706_gradient_0_b,p_o265706_gradient_0_a);\n  } else if (x < p_o265706_gradient_1_pos) {\n    return mix(vec4(p_o265706_gradient_0_r,p_o265706_gradient_0_g,p_o265706_gradient_0_b,p_o265706_gradient_0_a), vec4(p_o265706_gradient_1_r,p_o265706_gradient_1_g,p_o265706_gradient_1_b,p_o265706_gradient_1_a), ((x-p_o265706_gradient_0_pos)/(p_o265706_gradient_1_pos-p_o265706_gradient_0_pos)));\n  } else if (x < p_o265706_gradient_2_pos) {\n    return mix(vec4(p_o265706_gradient_1_r,p_o265706_gradient_1_g,p_o265706_gradient_1_b,p_o265706_gradient_1_a), vec4(p_o265706_gradient_2_r,p_o265706_gradient_2_g,p_o265706_gradient_2_b,p_o265706_gradient_2_a), ((x-p_o265706_gradient_1_pos)/(p_o265706_gradient_2_pos-p_o265706_gradient_1_pos)));\n  } else if (x < p_o265706_gradient_3_pos) {\n    return mix(vec4(p_o265706_gradient_2_r,p_o265706_gradient_2_g,p_o265706_gradient_2_b,p_o265706_gradient_2_a), vec4(p_o265706_gradient_3_r,p_o265706_gradient_3_g,p_o265706_gradient_3_b,p_o265706_gradient_3_a), ((x-p_o265706_gradient_2_pos)/(p_o265706_gradient_3_pos-p_o265706_gradient_2_pos)));\n  }\n  return vec4(p_o265706_gradient_3_r,p_o265706_gradient_3_g,p_o265706_gradient_3_b,p_o265706_gradient_3_a);\n}\nconst float p_o27497_radius = 1.000000000;\nconst float p_o27497_repeat = 7.000000000;\nconst float p_o22106_radius = 1.000000000;\nconst float p_o22106_repeat = 1.000000000;\nconst float p_o15531_radius = 1.500000000;\nconst float p_o15531_repeat = 1.000000000;\nconst float p_o35637_cx = 0.000000000;\nconst float p_o9383_sides = 5.000000000;\nconst float p_o9383_radius = 0.640000000;\nconst float p_o9383_edge = 0.500000000;\nvec3 o559231_input_in(vec2 uv, float _seed_variation_) {\nfloat o9383_0_1_f = shape_polygon((rotate((vec2(fract(p_o15531_repeat*atan((vec2(fract(p_o22106_repeat*atan((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o22106_radius*length((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5))))).y-0.5, (vec2(fract(p_o22106_repeat*atan((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o22106_radius*length((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o15531_radius*length((vec2(fract(p_o22106_repeat*atan((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).y-0.5, (vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5))))).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o22106_radius*length((vec2(fract(p_o27497_repeat*atan((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).y-0.5, (rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o27497_radius*length((rotate((uv), vec2(0.5+p_o370586_cx, 0.5+p_o370586_cy), (abs(iTime))*0.01745329251))-vec2(0.5)))))-vec2(0.5)))))-vec2(0.5))))), vec2(0.5+p_o35637_cx, 0.5+(sin(iTime * 0.009) * (iTime * 0.0005))), (sin(iTime * 0.05) * (iTime))*0.01745329251)), p_o9383_sides, p_o9383_radius*1.0, p_o9383_edge*1.0);\nvec4 o35637_0_1_rgba = vec4(vec3(o9383_0_1_f), 1.0);\nvec4 o15531_0_1_rgba = o35637_0_1_rgba;\nvec4 o22106_0_1_rgba = o15531_0_1_rgba;\nvec4 o27497_0_1_rgba = o22106_0_1_rgba;\nvec4 o265706_0_1_rgba = o265706_gradient_gradient_fct((dot((o27497_0_1_rgba).rgb, vec3(1.0))/3.0));\nvec4 o370586_0_1_rgba = o265706_0_1_rgba;\n\nreturn ((o370586_0_1_rgba).rgb);\n}\nfloat o559231_fct(vec2 uv, float _seed_variation_) {\n\tvec2 e = vec2(1.0/512.000000000, -1.0/512.000000000);\n\tvec3 rv = 4.0*o559231_input_in(uv, _seed_variation_);\n\trv -= o559231_input_in(uv+e.xy, _seed_variation_);\n\trv -= o559231_input_in(uv-e.xy, _seed_variation_);\n\trv -= o559231_input_in(uv+e.xx, _seed_variation_);\n\trv -= o559231_input_in(uv-e.xx, _seed_variation_);\n\trv = abs(rv);\n\treturn max(rv.x, max(rv.y ,rv.z))*512.000000000;\n}\n\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o559231_0_1_f = clamp(o559231_fct((UV), _seed_variation_), 0.0, 1.0);\ngl_FragColor = vec4(vec3(o559231_0_1_f), 1.0);\n}\n\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime",value:0}],portsOut:[{name:"trigger",value:0},{name:"Shader"},{name:"Has Errors",value:false}]},{objName:"Ops.Trigger.TriggerReceive",id:"229",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Named Trigger",value:"TimerStart"}],portsOut:[{name:"Triggered",links:[{portIn:"Reset",portOut:"Triggered",objIn:"215",objOut:"229"}]}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"230",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render",value:null},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture",value:0}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"231",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n\n\nfloat dot2(vec2 x) {\n\treturn dot(x, x);\n}\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat wave_constant(float x) {\n\treturn 1.0;\n}\n\nfloat wave_sine(float x) {\n\treturn 0.5-0.5*cos(3.14159265359*2.0*x);\n}\n\nfloat wave_triangle(float x) {\n\tx = fract(x);\n\treturn min(2.0*x, 2.0-2.0*x);\n}\n\nfloat wave_sawtooth(float x) {\n\treturn fract(x);\n}\n\nfloat wave_square(float x) {\n\treturn (fract(x) < 0.5) ? 0.0 : 1.0;\n}\n\nfloat wave_bounce(float x) {\n\tx = 2.0*(fract(x)-0.5);\n\treturn sqrt(1.0-x*x);\n}\n\nfloat mix_mul(float x, float y) {\n\treturn x*y;\n}\n\nfloat mix_add(float x, float y) {\n\treturn min(x+y, 1.0);\n}\n\nfloat mix_max(float x, float y) {\n\treturn max(x, y);\n}\n\nfloat mix_min(float x, float y) {\n\treturn min(x, y);\n}\n\nfloat mix_xor(float x, float y) {\n\treturn min(x+y, 2.0-x-y);\n}\n\nfloat mix_pow(float x, float y) {\n\treturn pow(x, y);\n}vec4 brick(vec2 uv, vec2 bmin, vec2 bmax, float mortar, float round, float bevel) {\n\tfloat color;\n\tvec2 size = bmax - bmin;\n\tfloat min_size = min(size.x, size.y);\n\tmortar *= min_size;\n\tbevel *= min_size;\n\tround *= min_size;\n\tvec2 center = 0.5*(bmin+bmax);\n    vec2 d = abs(uv-center)-0.5*(size)+vec2(round+mortar);\n    color = length(max(d,vec2(0))) + min(max(d.x,d.y),0.0)-round;\n\tcolor = clamp(-color/bevel, 0.0, 1.0);\n\tvec2 tiled_brick_pos = mod(bmin, vec2(1.0, 1.0));\n\treturn vec4(color, center, tiled_brick_pos.x+7.0*tiled_brick_pos.y);\n}\n\nvec3 brick_random_color(vec2 bmin, vec2 bmax, float seed) {\n\tvec2 center = 0.5*(bmin + bmax);\n\treturn rand3(fract(center + vec2(seed)));\n}\n\nvec3 brick_uv(vec2 uv, vec2 bmin, vec2 bmax, float seed) {\n\tvec2 center = 0.5*(bmin + bmax);\n\tvec2 size = bmax - bmin;\n\tfloat max_size = max(size.x, size.y);\n\treturn vec3(0.5+(uv-center)/max_size, rand(fract(center)+vec2(seed)));\n}\n\nvec3 brick_corner_uv(vec2 uv, vec2 bmin, vec2 bmax, float mortar, float corner, float seed) {\n\tvec2 center = 0.5*(bmin + bmax);\n\tvec2 size = bmax - bmin;\n\tfloat max_size = max(size.x, size.y);\n\tfloat min_size = min(size.x, size.y);\n\tmortar *= min_size;\n\tcorner *= min_size;\n\treturn vec3(clamp((0.5*size-vec2(mortar)-abs(uv-center))/corner, vec2(0.0), vec2(1.0)), rand(fract(center)+vec2(seed)+ceil(vec2(uv-center))));\n}\n\nvec4 bricks_rb(vec2 uv, vec2 count, float repeat, float offset) {\n\tcount *= repeat;\n\tfloat x_offset = offset*step(0.5, fract(uv.y*count.y*0.5));\n\tvec2 bmin = floor(vec2(uv.x*count.x-x_offset, uv.y*count.y));\n\tbmin.x += x_offset;\n\tbmin /= count;\n\treturn vec4(bmin, bmin+vec2(1.0)/count);\n}\n\nvec4 bricks_rb2(vec2 uv, vec2 count, float repeat, float offset) {\n\tcount *= repeat;\n\tfloat x_offset = offset*step(0.5, fract(uv.y*count.y*0.5));\n\tcount.x = count.x*(1.0+step(0.5, fract(uv.y*count.y*0.5)));\n\tvec2 bmin = floor(vec2(uv.x*count.x-x_offset, uv.y*count.y));\n\tbmin.x += x_offset;\n\tbmin /= count;\n\treturn vec4(bmin, bmin+vec2(1.0)/count);\n}\n\nvec4 bricks_hb(vec2 uv, vec2 count, float repeat, float offset) {\n\tfloat pc = count.x+count.y;\n\tfloat c = pc*repeat;\n\tvec2 corner = floor(uv*c);\n\tfloat cdiff = mod(corner.x-corner.y, pc);\n\tif (cdiff < count.x) {\n\t\treturn vec4((corner-vec2(cdiff, 0.0))/c, (corner-vec2(cdiff, 0.0)+vec2(count.x, 1.0))/c);\n\t} else {\n\t\treturn vec4((corner-vec2(0.0, pc-cdiff-1.0))/c, (corner-vec2(0.0, pc-cdiff-1.0)+vec2(1.0, count.y))/c);\n\t}\n}\n\nvec4 bricks_bw(vec2 uv, vec2 count, float repeat, float offset) {\n\tvec2 c = 2.0*count*repeat;\n\tfloat mc = max(c.x, c.y);\n\tvec2 corner1 = floor(uv*c);\n\tvec2 corner2 = count*floor(repeat*2.0*uv);\n\tfloat cdiff = mod(dot(floor(repeat*2.0*uv), vec2(1.0)), 2.0);\n\tvec2 corner;\n\tvec2 size;\n\tif (cdiff == 0.0) {\n\t\tcorner = vec2(corner1.x, corner2.y);\n\t\tsize = vec2(1.0, count.y);\n\t} else {\n\t\tcorner = vec2(corner2.x, corner1.y);\n\t\tsize = vec2(count.x, 1.0);\n\t}\n\treturn vec4(corner/c, (corner+size)/c);\n}\n\nvec4 bricks_sb(vec2 uv, vec2 count, float repeat, float offset) {\n\tvec2 c = (count+vec2(1.0))*repeat;\n\tfloat mc = max(c.x, c.y);\n\tvec2 corner1 = floor(uv*c);\n\tvec2 corner2 = (count+vec2(1.0))*floor(repeat*uv);\n\tvec2 rcorner = corner1 - corner2;\n\tvec2 corner;\n\tvec2 size;\n\tif (rcorner.x == 0.0 && rcorner.y < count.y) {\n\t\tcorner = corner2;\n\t\tsize = vec2(1.0, count.y);\n\t} else if (rcorner.y == 0.0) {\n\t\tcorner = corner2+vec2(1.0, 0.0);\n\t\tsize = vec2(count.x, 1.0);\n\t} else if (rcorner.x == count.x) {\n\t\tcorner = corner2+vec2(count.x, 1.0);\n\t\tsize = vec2(1.0, count.y);\n\t} else if (rcorner.y == count.y) {\n\t\tcorner = corner2+vec2(0.0, count.y);\n\t\tsize = vec2(count.x, 1.0);\n\t} else {\n\t\tcorner = corner2+vec2(1.0);\n\t\tsize = vec2(count.x-1.0, count.y-1.0);\n\t}\n\treturn vec4(corner/c, (corner+size)/c);\n}vec2 transform(vec2 uv, vec2 translate, float rotate, vec2 scale, bool repeat) {\n \tvec2 rv;\n\tuv -= translate;\n\tuv -= vec2(0.5);\n\trv.x = cos(rotate)*uv.x + sin(rotate)*uv.y;\n\trv.y = -sin(rotate)*uv.x + cos(rotate)*uv.y;\n\trv /= scale;\n\trv += vec2(0.5);\n    if (repeat) {\n\t\treturn fract(rv);\n\t} else {\n\t\treturn clamp(rv, vec2(0.0), vec2(1.0));\n\t}\t\n}vec3 blend_normal(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1 + (1.0-opacity)*c2;\n}\n\nvec3 blend_dissolve(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\tif (rand(uv) < opacity) {\n\t\treturn c1;\n\t} else {\n\t\treturn c2;\n\t}\n}\n\nvec3 blend_multiply(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1*c2 + (1.0-opacity)*c2;\n}\n\nvec3 blend_screen(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*(1.0-(1.0-c1)*(1.0-c2)) + (1.0-opacity)*c2;\n}\n\nfloat blend_overlay_f(float c1, float c2) {\n\treturn (c1 < 0.5) ? (2.0*c1*c2) : (1.0-2.0*(1.0-c1)*(1.0-c2));\n}\n\nvec3 blend_overlay(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_overlay_f(c1.x, c2.x), blend_overlay_f(c1.y, c2.y), blend_overlay_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_hard_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*0.5*(c1*c2+blend_overlay(uv, c1, c2, 1.0)) + (1.0-opacity)*c2;\n}\n\nfloat blend_soft_light_f(float c1, float c2) {\n\treturn (c2 < 0.5) ? (2.0*c1*c2+c1*c1*(1.0-2.0*c2)) : 2.0*c1*(1.0-c2)+sqrt(c1)*(2.0*c2-1.0);\n}\n\nvec3 blend_soft_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_soft_light_f(c1.x, c2.x), blend_soft_light_f(c1.y, c2.y), blend_soft_light_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_burn_f(float c1, float c2) {\n\treturn (c1==0.0)?c1:max((1.0-((1.0-c2)/c1)),0.0);\n}\n\nvec3 blend_burn(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_burn_f(c1.x, c2.x), blend_burn_f(c1.y, c2.y), blend_burn_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_dodge_f(float c1, float c2) {\n\treturn (c1==1.0)?c1:min(c2/(1.0-c1),1.0);\n}\n\nvec3 blend_dodge(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_dodge_f(c1.x, c2.x), blend_dodge_f(c1.y, c2.y), blend_dodge_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_lighten(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*max(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_darken(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*min(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_difference(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*clamp(c2-c1, vec3(0.0), vec3(1.0)) + (1.0-opacity)*c2;\n}\nfloat sphere(vec2 uv, vec2 c, float r) {\n\tuv -= c;\n\tuv /= r;\n\treturn 2.0*r*sqrt(max(0.0, 1.0-dot(uv, uv)));\n}\nvec2 sdLine(vec2 p, vec2 a, vec2 b) {\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp(dot(pa,ba)/dot(ba,ba), 0.0, 1.0);\n    return vec2(length(pa-ba*h), h);\n}\nfloat smin(float d1, float d2, float k) {\n    float h = clamp( 0.5 + 0.5*(d2-d1)/k, 0.0, 1.0 );\n    return mix( d2, d1, h ) - k*h*(1.0-h);\n}\n\nfloat smax(float d1, float d2, float k) {\n\tfloat h = clamp( 0.5 - 0.5*(d2-d1)/k, 0.0, 1.0 );\n\treturn mix( d2, d1, h ) + k*h*(1.0-h); \n}float rand31(vec3 p) {\n\treturn fract(sin(dot(p,vec3(127.1,311.7, 74.7)))*43758.5453123);\n}\nvec3 rand33(vec3 p){\n\tp = vec3( dot(p,vec3(127.1,311.7, 74.7)),\n\t\t\t  dot(p,vec3(269.5,183.3,246.1)),\n\t\t\t  dot(p,vec3(113.5,271.9,124.6)));\n\n\treturn -1.0 + 2.0*fract(sin(p)*43758.5453123);\n}\n\nfloat tex3d_fbm_value(vec3 coord, vec3 size, float seed) {\n\tvec3 o = floor(coord)+rand3(vec2(seed, 1.0-seed))+size;\n\tvec3 f = fract(coord);\n\tfloat p000 = rand31(mod(o, size));\n\tfloat p001 = rand31(mod(o + vec3(0.0, 0.0, 1.0), size));\n\tfloat p010 = rand31(mod(o + vec3(0.0, 1.0, 0.0), size));\n\tfloat p011 = rand31(mod(o + vec3(0.0, 1.0, 1.0), size));\n\tfloat p100 = rand31(mod(o + vec3(1.0, 0.0, 0.0), size));\n\tfloat p101 = rand31(mod(o + vec3(1.0, 0.0, 1.0), size));\n\tfloat p110 = rand31(mod(o + vec3(1.0, 1.0, 0.0), size));\n\tfloat p111 = rand31(mod(o + vec3(1.0, 1.0, 1.0), size));\n\tvec3 t = f * f * (3.0 - 2.0 * f);\n\treturn mix(mix(mix(p000, p100, t.x), mix(p010, p110, t.x), t.y), mix(mix(p001, p101, t.x), mix(p011, p111, t.x), t.y), t.z);\n}\n\nfloat tex3d_fbm_value_nowrap(vec3 coord, vec3 size, float seed) {\n\tvec3 o = floor(coord)+rand3(vec2(seed, 1.0-seed))+size;\n\tvec3 f = fract(coord);\n\tfloat p000 = rand31(o);\n\tfloat p001 = rand31(o + vec3(0.0, 0.0, 1.0));\n\tfloat p010 = rand31(o + vec3(0.0, 1.0, 0.0));\n\tfloat p011 = rand31(o + vec3(0.0, 1.0, 1.0));\n\tfloat p100 = rand31(o + vec3(1.0, 0.0, 0.0));\n\tfloat p101 = rand31(o + vec3(1.0, 0.0, 1.0));\n\tfloat p110 = rand31(o + vec3(1.0, 1.0, 0.0));\n\tfloat p111 = rand31(o + vec3(1.0, 1.0, 1.0));\n\tvec3 t = f * f * (3.0 - 2.0 * f);\n\treturn mix(mix(mix(p000, p100, t.x), mix(p010, p110, t.x), t.y), mix(mix(p001, p101, t.x), mix(p011, p111, t.x), t.y), t.z);\n}\n\nfloat tex3d_fbm_perlin(vec3 coord, vec3 size, float seed) {\n\tvec3 o = floor(coord)+rand3(vec2(seed, 1.0-seed))+size;\n\tvec3 f = fract(coord);\n\tvec3 v000 = normalize(rand33(mod(o, size))-vec3(0.5));\n\tvec3 v001 = normalize(rand33(mod(o + vec3(0.0, 0.0, 1.0), size))-vec3(0.5));\n\tvec3 v010 = normalize(rand33(mod(o + vec3(0.0, 1.0, 0.0), size))-vec3(0.5));\n\tvec3 v011 = normalize(rand33(mod(o + vec3(0.0, 1.0, 1.0), size))-vec3(0.5));\n\tvec3 v100 = normalize(rand33(mod(o + vec3(1.0, 0.0, 0.0), size))-vec3(0.5));\n\tvec3 v101 = normalize(rand33(mod(o + vec3(1.0, 0.0, 1.0), size))-vec3(0.5));\n\tvec3 v110 = normalize(rand33(mod(o + vec3(1.0, 1.0, 0.0), size))-vec3(0.5));\n\tvec3 v111 = normalize(rand33(mod(o + vec3(1.0, 1.0, 1.0), size))-vec3(0.5));\n\tfloat p000 = dot(v000, f);\n\tfloat p001 = dot(v001, f - vec3(0.0, 0.0, 1.0));\n\tfloat p010 = dot(v010, f - vec3(0.0, 1.0, 0.0));\n\tfloat p011 = dot(v011, f - vec3(0.0, 1.0, 1.0));\n\tfloat p100 = dot(v100, f - vec3(1.0, 0.0, 0.0));\n\tfloat p101 = dot(v101, f - vec3(1.0, 0.0, 1.0));\n\tfloat p110 = dot(v110, f - vec3(1.0, 1.0, 0.0));\n\tfloat p111 = dot(v111, f - vec3(1.0, 1.0, 1.0));\n\tvec3 t = f * f * (3.0 - 2.0 * f);\n\treturn 0.5 + mix(mix(mix(p000, p100, t.x), mix(p010, p110, t.x), t.y), mix(mix(p001, p101, t.x), mix(p011, p111, t.x), t.y), t.z);\n}\n\nfloat tex3d_fbm_perlin_nowrap(vec3 coord, vec3 size, float seed) {\n\tvec3 o = floor(coord)+rand3(vec2(seed, 1.0-seed))+size;\n\tvec3 f = fract(coord);\n\tvec3 v000 = normalize(rand33(o)-vec3(0.5));\n\tvec3 v001 = normalize(rand33(o + vec3(0.0, 0.0, 1.0))-vec3(0.5));\n\tvec3 v010 = normalize(rand33(o + vec3(0.0, 1.0, 0.0))-vec3(0.5));\n\tvec3 v011 = normalize(rand33(o + vec3(0.0, 1.0, 1.0))-vec3(0.5));\n\tvec3 v100 = normalize(rand33(o + vec3(1.0, 0.0, 0.0))-vec3(0.5));\n\tvec3 v101 = normalize(rand33(o + vec3(1.0, 0.0, 1.0))-vec3(0.5));\n\tvec3 v110 = normalize(rand33(o + vec3(1.0, 1.0, 0.0))-vec3(0.5));\n\tvec3 v111 = normalize(rand33(o + vec3(1.0, 1.0, 1.0))-vec3(0.5));\n\tfloat p000 = dot(v000, f);\n\tfloat p001 = dot(v001, f - vec3(0.0, 0.0, 1.0));\n\tfloat p010 = dot(v010, f - vec3(0.0, 1.0, 0.0));\n\tfloat p011 = dot(v011, f - vec3(0.0, 1.0, 1.0));\n\tfloat p100 = dot(v100, f - vec3(1.0, 0.0, 0.0));\n\tfloat p101 = dot(v101, f - vec3(1.0, 0.0, 1.0));\n\tfloat p110 = dot(v110, f - vec3(1.0, 1.0, 0.0));\n\tfloat p111 = dot(v111, f - vec3(1.0, 1.0, 1.0));\n\tvec3 t = f * f * (3.0 - 2.0 * f);\n\treturn 0.5 + mix(mix(mix(p000, p100, t.x), mix(p010, p110, t.x), t.y), mix(mix(p001, p101, t.x), mix(p011, p111, t.x), t.y), t.z);\n}\n\nfloat tex3d_fbm_cellular(vec3 coord, vec3 size, float seed) {\n\tvec3 o = floor(coord)+rand3(vec2(seed, 1.0-seed))+size;\n\tvec3 f = fract(coord);\n\tfloat min_dist = 3.0;\n\tfor (float x = -1.0; x <= 1.0; x++) {\n\t\tfor (float y = -1.0; y <= 1.0; y++) {\n\t\t\tfor (float z = -1.0; z <= 1.0; z++) {\n\t\t\t\tvec3 node = 0.4*rand33(mod(o + vec3(x, y, z), size)) + vec3(x, y, z);\n\t\t\t\tfloat dist = sqrt((f - node).x * (f - node).x + (f - node).y * (f - node).y + (f - node).z * (f - node).z);\n\t\t\t\tmin_dist = min(min_dist, dist);\n\t\t\t}\n\t\t}\n\t}\n\treturn min_dist;\n}\n\nfloat tex3d_fbm_cellular_nowrap(vec3 coord, vec3 size, float seed) {\n\tvec3 o = floor(coord)+rand3(vec2(seed, 1.0-seed))+size;\n\tvec3 f = fract(coord);\n\tfloat min_dist = 3.0;\n\tfor (float x = -1.0; x <= 1.0; x++) {\n\t\tfor (float y = -1.0; y <= 1.0; y++) {\n\t\t\tfor (float z = -1.0; z <= 1.0; z++) {\n\t\t\t\tvec3 node = 0.4*rand33(o + vec3(x, y, z)) + vec3(x, y, z);\n\t\t\t\tfloat dist = sqrt((f - node).x * (f - node).x + (f - node).y * (f - node).y + (f - node).z * (f - node).z);\n\t\t\t\tmin_dist = min(min_dist, dist);\n\t\t\t}\n\t\t}\n\t}\n\treturn min_dist;\n}\n// https://iquilezles.org/www/articles/fbmsdf/fbmsdf.htm\nfloat fbm_sph( ivec3 i, vec3 f, ivec3 c, float seed )\n{\n\t// Line below randomizes the positions of each sphere, this can cause a bit of artifacting,\n\t// but also makes for a much more natural effect. Disabled for now.\n\t//f += rand3( vec2(i.xy + c.xy) - vec2( float(i.z + c.z) ) ) - vec3(0.5);\n\t// random radius at grid vertex i+c\n\tfloat rad = 0.5*rand31(vec3(i+c) + vec3(seed));\n\t// distance to sphere at grid vertex i+c\n\treturn length(f-vec3(c)) - rad; \n}\n\nfloat sdBase( vec3 p, float seed )\n{\n   ivec3 i = ivec3(floor(p));\n    vec3 f =       fract(p);\n   // distance to the 8 corners spheres\n   return min(min(min(fbm_sph(i,f,ivec3(0,0,0), seed),\n                      fbm_sph(i,f,ivec3(0,0,1), seed)),\n                  min(fbm_sph(i,f,ivec3(0,1,0), seed),\n                      fbm_sph(i,f,ivec3(0,1,1), seed))),\n              min(min(fbm_sph(i,f,ivec3(1,0,0), seed),\n                      fbm_sph(i,f,ivec3(1,0,1), seed)),\n                  min(fbm_sph(i,f,ivec3(1,1,0), seed),\n                      fbm_sph(i,f,ivec3(1,1,1), seed))));\n}\n\nfloat sdFbm( vec3 p, float d, int iterations, float smoothness, float seed, float scaling, int mode)\n{\n\tfloat s = 1.0;\n\tfor( int i=0; i<iterations; i++ )\n\t{\n\t\t// evaluate new octave\n\t\tfloat n = s*sdBase(p, seed);\n\t\t\n\t\tif(mode == 0) {\n\t\t\t// add\n\t\t\tn = smax(n,d - scaling * s,smoothness * s);\n\t\t\td = smin(n,d             ,smoothness * s);\n\t\t} else {\n\t\t\t// subtract\n\t\t\td = smax(d - scaling * s, -n, smoothness * s );\n\t\t}\n\t\t\n\t\t// prepare next octave\n\t\tp = mat3(vec3(0.02, 1.60, 1.20),\n\t\t\t\tvec3(-1.60, 0.72,-0.96),\n\t\t\t\tvec3(-1.20,-0.96, 1.28))*p;\n\t\ts = 0.5*s;\n\t}\n\treturn d;\n}vec2 sdf3d_smooth_union(vec2 d1, vec2 d2, float k) {\n    float h = clamp(0.5+0.5*(d2.x-d1.x)/k, 0.0, 1.0);\n    return vec2(mix(d2.x, d1.x, h)-k*h*(1.0-h), mix(d2.y, d1.y, step(d1.x, d2.x)));\n}\n\nvec2 sdf3d_smooth_subtraction(vec2 d1, vec2 d2, float k ) {\n    float h = clamp(0.5-0.5*(d2.x+d1.x)/k, 0.0, 1.0);\n    return vec2(mix(d2.x, -d1.x, h )+k*h*(1.0-h), d2.y);\n}\n\nvec2 sdf3d_smooth_intersection(vec2 d1, vec2 d2, float k ) {\n    float h = clamp(0.5-0.5*(d2.x-d1.x)/k, 0.0, 1.0);\n    return vec2(mix(d2.x, d1.x, h)+k*h*(1.0-h), mix(d1.y, d2.y, step(d1.x, d2.x)));\n}\nvec2 rotate(vec2 uv, vec2 center, float rotate) {\n \tvec2 rv;\n\tuv -= center;\n\trv.x = cos(rotate)*uv.x + sin(rotate)*uv.y;\n\trv.y = -sin(rotate)*uv.x + cos(rotate)*uv.y;\n\trv += center;\n    return rv;\t\n}vec2 sdf3dc_union(vec2 a, vec2 b) {\n\treturn vec2(min(a.x, b.x), mix(b.y, a.y, step(a.x, b.x)));\n}\nvec2 sdf3dc_sub(vec2 a, vec2 b) {\n\treturn vec2(max(-a.x, b.x), a.y);\n}\nvec2 sdf3dc_inter(vec2 a, vec2 b) {\n\treturn vec2(max(a.x, b.x), mix(a.y, b.y, step(a.x, b.x)));\n}\nconst float p_o208638_amount = 0.800000000;\nconst float p_o202919_radius = 1.000000000;\nconst float p_o202919_repeat = 3.000000000;\nconst float p_o200479_amount = 1.000000000;\nconst float p_o200480_x_scale = 4.000000000;\nconst float p_o200480_y_scale = 4.000000000;\nfloat o200480_fct(vec2 uv, float _seed_variation_) {\n\treturn mix_mul(wave_sine(p_o200480_x_scale*uv.x), wave_constant(p_o200480_y_scale*uv.y));\n}const float p_o200460_translate_x = 0.975000000;\nconst float p_o200460_translate_y = 0.000000000;\nconst float p_o200460_rotate = 30.125000000;\nconst float p_o200460_scale_x = 0.500000000;\nconst float p_o200460_scale_y = 1.000000000;\nconst float seed_o200474 = -61325.000000000;\nconst float p_o200474_repeat = 1.000000000;\nconst float p_o200474_rows = 1.000000000;\nconst float p_o200474_columns = 4.000000000;\nconst float p_o200474_row_offset = 0.500000000;\nconst float p_o200474_mortar = 0.100000000;\nconst float p_o200474_bevel = 0.100000000;\nconst float p_o200474_round = 0.000000000;\nconst float p_o200474_corner = 0.000000000;\nconst float p_o200461_gradient_0_pos = 0.000000000;\nconst float p_o200461_gradient_0_r = 0.437500000;\nconst float p_o200461_gradient_0_g = 0.437500000;\nconst float p_o200461_gradient_0_b = 0.437500000;\nconst float p_o200461_gradient_0_a = 1.000000000;\nconst float p_o200461_gradient_1_pos = 1.000000000;\nconst float p_o200461_gradient_1_r = 1.000000000;\nconst float p_o200461_gradient_1_g = 1.000000000;\nconst float p_o200461_gradient_1_b = 1.000000000;\nconst float p_o200461_gradient_1_a = 1.000000000;\nvec4 o200461_gradient_gradient_fct(float x) {\n  if (x < p_o200461_gradient_0_pos) {\n    return vec4(p_o200461_gradient_0_r,p_o200461_gradient_0_g,p_o200461_gradient_0_b,p_o200461_gradient_0_a);\n  } else if (x < p_o200461_gradient_1_pos) {\n    return mix(vec4(p_o200461_gradient_0_r,p_o200461_gradient_0_g,p_o200461_gradient_0_b,p_o200461_gradient_0_a), vec4(p_o200461_gradient_1_r,p_o200461_gradient_1_g,p_o200461_gradient_1_b,p_o200461_gradient_1_a), ((x-p_o200461_gradient_0_pos)/(p_o200461_gradient_1_pos-p_o200461_gradient_0_pos)));\n  }\n  return vec4(p_o200461_gradient_1_r,p_o200461_gradient_1_g,p_o200461_gradient_1_b,p_o200461_gradient_1_a);\n}\nconst float p_o200475_x_scale = 4.000000000;\nconst float p_o200475_y_scale = 4.000000000;\nfloat o200475_fct(vec2 uv, float _seed_variation_) {\n\treturn mix_mul(wave_sine(p_o200475_x_scale*uv.x), wave_constant(p_o200475_y_scale*uv.y));\n}const float seed_o9593 = 0.000000000;\nconst float p_o9593_iterations = 8.000000000;\nconst float p_o9593_scaling = 0.300000000;\nconst float p_o7952_d = 0.670000000;\nconst float p_o484473_ax = 0.152238786;\nconst float p_o484473_ay = -0.244776070;\nconst float p_o484473_bx = 0.199999988;\nconst float p_o484473_by = 0.197014928;\nconst float p_o484473_r = 0.250000000;\nconst float p_o78207_cx = 0.370000000;\nconst float p_o78207_cy = 0.420000000;\nconst float p_o78207_r = 0.870000000;\nconst float seed_o46634 = 0.721985400;\nconst float p_o46634_v1 = 0.100000000;\nconst float p_o46634_v2 = 0.100000000;\nconst float p_o46634_v3 = 0.200000000;\nconst float p_o46634_v4 = 0.300000000;\nconst float p_o46634_v5 = 0.400000000;\nconst float p_o36911_x = 0.200000000;\nconst float p_o36911_y = 0.020000000;\nconst float p_o36911_z = -0.130000000;\nconst float p_o11735_x = 0.000000000;\nconst float p_o11735_y = 0.130000000;\nconst float p_o11735_z = 0.070000000;\nconst float p_o14203_k = 0.750000000;\nconst float p_o17347_a = 47.000000000;\nconst float p_o16591_R = -0.610000000;\nvec2 o46634_input_in(vec3 p, float _seed_variation_) {\nfloat o17347_0_1_sdf3d = dot(vec2(cos(p_o17347_a*0.01745329251),sin(p_o17347_a*0.01745329251)),vec2(length((((p)-clamp((p), -abs(vec3(p_o36911_x, p_o36911_y, p_o36911_z)), abs(vec3(p_o36911_x, p_o36911_y, p_o36911_z))))-vec3(p_o11735_x, p_o11735_y, p_o11735_z)).xz),(((p)-clamp((p), -abs(vec3(p_o36911_x, p_o36911_y, p_o36911_z)), abs(vec3(p_o36911_x, p_o36911_y, p_o36911_z))))-vec3(p_o11735_x, p_o11735_y, p_o11735_z)).y));\nvec2 o16591_0_q = vec2(length((((p)-clamp((p), -abs(vec3(p_o36911_x, p_o36911_y, p_o36911_z)), abs(vec3(p_o36911_x, p_o36911_y, p_o36911_z))))-vec3(p_o11735_x, p_o11735_y, p_o11735_z)).xy)-p_o16591_R,(((p)-clamp((p), -abs(vec3(p_o36911_x, p_o36911_y, p_o36911_z)), abs(vec3(p_o36911_x, p_o36911_y, p_o36911_z))))-vec3(p_o11735_x, p_o11735_y, p_o11735_z)).z);\nfloat o16591_0_1_sdf3d = length(o16591_0_q)-(cos(iTime));\nvec2 o14203_0_1_sdf3dc = sdf3d_smooth_union(vec2(o17347_0_1_sdf3d, 0.0), vec2(o16591_0_1_sdf3d, 0.0), p_o14203_k);\nvec2 o11735_0_1_sdf3dc = o14203_0_1_sdf3dc;\nvec2 o36911_0_1_sdf3dc = o11735_0_1_sdf3dc;\n\nreturn o36911_0_1_sdf3dc;\n}\nvec2 o124264_input_sdf(vec3 p, float _seed_variation_) {\nvec2 o7952_0_q = vec2(length((p).xy)-p_o7952_d+0.5, (p).z+0.5);\nvec2 o484473_0_sdl = sdLine((o7952_0_q), vec2(p_o484473_ax+0.5, p_o484473_ay+0.5), vec2(p_o484473_bx+0.5, p_o484473_by+0.5));float o78207_0_1_f = sphere((vec2(o484473_0_sdl.y, 0.5)), vec2(p_o78207_cx, p_o78207_cy), p_o78207_r);\nfloat o484473_0_1_sdf2d = o484473_0_sdl.x-p_o484473_r*o78207_0_1_f;\nfloat o7952_0_1_sdf3d = o484473_0_1_sdf2d;\nfloat o9593_0_1_sdf3d = sdFbm((p), o7952_0_1_sdf3d, int(p_o9593_iterations), (sin(iTime) + 1.2), (seed_o9593+_seed_variation_), p_o9593_scaling, 0);\nvec2 o46634_2_1_sdf3dc = o46634_input_in((p), (seed_o46634+_seed_variation_)+p_o46634_v3);\nvec2 o86520_0_1_sdf3dc = sdf3dc_sub(vec2(o9593_0_1_sdf3d, 0.0), o46634_2_1_sdf3dc);\n\nreturn o86520_0_1_sdf3dc;\n}\nvec2 raymarch_o124264(vec2 uv, float _seed_variation_) {\n\tvec3 ro = vec3(uv-vec2(0.5), 1.0);\n\tvec3 rd = vec3(0.0, 0.0, -1.0);\n\tfloat dO = 0.0;\n\tfloat c = 0.0;\n    for (int i=0; i < 100; i++) {\n    \tvec3 p = ro + rd*dO;\n        vec2 dS = o124264_input_sdf(p, _seed_variation_);\n        dO += dS.x;\n\n        if (dO >= 1.0) {\n\t\t\tbreak;\n\t\t} else if (dS.x < 0.0001) {\n\t\t\tc = dS.y;\n\t\t\tbreak;\n\t\t}\n    }\n    \n    return vec2(dO, c);\n}\n\nvec3 normal_o124264(vec3 p, float _seed_variation_) {\n\tif (p.z <= 0.0) {\n\t\treturn vec3(0.0, 0.0, -1.0);\n\t}\n\n\tfloat d = o124264_input_sdf(p, _seed_variation_).x;\n    float e = .001;\n    \n    vec3 n = d - vec3(\n        o124264_input_sdf(p-vec3(e, 0.0, 0.0), _seed_variation_).x,\n        o124264_input_sdf(p-vec3(0.0, e, 0.0), _seed_variation_).x,\n        o124264_input_sdf(p-vec3(0.0, 0.0, e), _seed_variation_).x);\n    \n    return vec3(-1.0, -1.0, -1.0)*normalize(n);\n}\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o200480_0_1_f = o200480_fct((vec2(fract(p_o202919_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o202919_radius*length((UV)-vec2(0.5))))), _seed_variation_);\nvec4 o200474_0_rect = bricks_rb((vec2(fract(p_o202919_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o202919_radius*length((UV)-vec2(0.5))))), vec2(p_o200474_columns, p_o200474_rows), p_o200474_repeat, p_o200474_row_offset);\nvec4 o200474_0 = brick((vec2(fract(p_o202919_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o202919_radius*length((UV)-vec2(0.5))))), o200474_0_rect.xy, o200474_0_rect.zw, p_o200474_mortar*1.0, p_o200474_round*1.0, max(0.001, p_o200474_bevel*1.0));\nvec3 o200474_1_2_rgb = brick_random_color(o200474_0_rect.xy, o200474_0_rect.zw, float((seed_o200474+_seed_variation_)));\nfloat o200475_0_1_f = o200475_fct((transform((vec2(fract(p_o202919_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o202919_radius*length((UV)-vec2(0.5))))), vec2(p_o200460_translate_x*(2.0*(dot(o200474_1_2_rgb, vec3(1.0))/3.0)-1.0), p_o200460_translate_y*(2.0*1.0-1.0)), p_o200460_rotate*0.01745329251*(2.0*1.0-1.0), vec2(p_o200460_scale_x*(2.0*1.0-1.0), p_o200460_scale_y*(2.0*1.0-1.0)), true)), _seed_variation_);\nvec4 o200461_0_1_rgba = o200461_gradient_gradient_fct(o200475_0_1_f);\nvec4 o200460_0_1_rgba = o200461_0_1_rgba;\nvec4 o200479_0_s1 = vec4(vec3(o200480_0_1_f), 1.0);\nvec4 o200479_0_s2 = o200460_0_1_rgba;\nfloat o200479_0_a = p_o200479_amount*1.0;\nvec4 o200479_0_2_rgba = vec4(blend_multiply((vec2(fract(p_o202919_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o202919_radius*length((UV)-vec2(0.5))))), o200479_0_s1.rgb, o200479_0_s2.rgb, o200479_0_a*o200479_0_s1.a), min(1.0, o200479_0_s2.a+o200479_0_a*o200479_0_s1.a));\nvec4 o202919_0_1_rgba = o200479_0_2_rgba;\nvec2 o124264_0_d = raymarch_o124264((UV), _seed_variation_);\nvec3 o124264_1_1_rgb = vec3(0.5)+0.5*normal_o124264(vec3((UV)-vec2(0.5), 1.0-o124264_0_d.x), _seed_variation_);\nfloat o124264_0_2_f = clamp(1.0-o124264_0_d.x, 0.0, 1.0);\nvec4 o208638_0_s1 = o202919_0_1_rgba;\nvec4 o208638_0_s2 = vec4(o124264_1_1_rgb, 1.0);\nfloat o208638_0_a = p_o208638_amount*o124264_0_2_f;\nvec4 o208638_0_1_rgba = vec4(blend_difference((UV), o208638_0_s1.rgb, o208638_0_s2.rgb, o208638_0_a*o208638_0_s1.a), min(1.0, o208638_0_s2.a+o208638_0_a*o208638_0_s1.a));\ngl_FragColor = o208638_0_1_rgba;\n}\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"232",objOut:"231"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"232",objOut:"231"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"232",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"mirrored repeat"},{name:"Floating Point",value:true},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",value:0},{name:"Texture",links:[{portIn:"Texture In",portOut:"Texture",objIn:"235",objOut:"232"}]},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Anim.Timer_v2",id:"233",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Speed",value:.72},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"iTime",portOut:"Time",objIn:"231",objOut:"233"},{portIn:"Time",portOut:"Time",objIn:"242",objOut:"233"}]}]},{objName:"Ops.Sequence",id:"234",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"231",objOut:"234"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",links:[{portIn:"Render",portOut:"trigger 15",objIn:"252",objOut:"234"}]}]},{objName:"Ops.Ui.VizTexture",id:"235",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"236",objOut:"235"}]},{name:"Info",value:"unknown"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"236",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"241",objOut:"236"},{portIn:"render",portOut:"trigger",objIn:"243",objOut:"236"},{portIn:"render",portOut:"trigger",objIn:"244",objOut:"236"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v2",id:"237",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"234",objOut:"237"},{portIn:"render",portOut:"Next",objIn:"236",objOut:"237"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"239",objOut:"237"}]},{name:"Aspect Ratio",value:.9026798307475318}]},{objName:"Ops.Gl.GradientTexture",id:"238",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":8.881784197001252e-16,"g":0,"b":1},{"pos":0.208,"r":8.881784197001252e-16,"g":0,"b":1},{"pos":0.976,"r":1,"g":0,"b":0},{"pos":1,"r":1,"g":0,"b":0}]}'},{name:"Direction index",value:0},{name:"Direction",value:"Radial"},{name:"Smoothstep",value:false},{name:"Step",value:false},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:512},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Gradient Array",value:0},{name:"Randomize Colors",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Gradient",portOut:"Texture",objIn:"241",objOut:"238"},{portIn:"Gradient",portOut:"Texture",objIn:"245",objOut:"238"}]},{name:"Colors"},{name:"Colors Pos"}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"239",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Trigger.TriggerReceive",id:"240",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Named Trigger",value:"TimerStart"}],portsOut:[{name:"Triggered",links:[{portIn:"Reset",portOut:"Triggered",objIn:"233",objOut:"240"}]}]},{objName:"Ops.Gl.TextureEffects.ColorMap",id:"241",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"multiply invert"},{name:"Amount",value:1},{name:"Gradient"},{name:"Method index",value:0},{name:"Method",value:"Luminance"},{name:"Min",value:0},{name:"Max",value:.436},{name:"Position",value:1}],portsOut:[{name:"trigger",links:[{portIn:"in0 Ops.Gl.TextureEffects.FastBlur trigger",portOut:"trigger",objIn:"270",objOut:"241"}]}]},{objName:"Ops.Gl.TextureEffects.Plasma",id:"242",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"color dodge"},{name:"Amount",value:1},{name:"Width",value:19.39},{name:"Height",value:25.1},{name:"Mul",value:5.78},{name:"offset X",value:-.13},{name:"offset Y",value:2.96},{name:"Time"},{name:"Greyscale",value:true}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"245",objOut:"242"}]}]},{objName:"Ops.Gl.TextureEffects.ScaleTexture",id:"243",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Multiplier",value:0},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"color dodge"},{name:"Amount",value:1},{name:"Scale X",value:1},{name:"Scale Y",value:.49},{name:"offset X",value:0},{name:"offset Y",value:0},{name:"center X",value:.567},{name:"center Y",value:0}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"242",objOut:"243"}]}]},{objName:"Ops.Gl.TextureEffects.FastBlur",id:"244",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"amount",value:.28},{name:"Clamp",value:false},{name:"Mask Invert",value:false},{name:"Mask",value:0},{name:"direction index",value:0},{name:"direction",value:"both"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.TextureEffects.ColorMap",id:"245",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Gradient"},{name:"Method index",value:0},{name:"Method",value:"Luminance"},{name:"Min",value:0},{name:"Max",value:.822},{name:"Position",value:.489}],portsOut:[{name:"trigger",links:[{portIn:"in0 Ops.Gl.TextureEffects.FastBlur trigger",portOut:"trigger",objIn:"270",objOut:"245"}]}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"246",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI sampler2D iChannel0;\nUNI vec3 iResolution;\nUNI float iTime;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n\nfloat dot2(vec2 x) {\n\treturn dot(x, x);\n}\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat wave_constant(float x) {\n\treturn 1.0;\n}\n\nfloat wave_sine(float x) {\n\treturn 0.5-0.5*cos(3.14159265359*2.0*x);\n}\n\nfloat wave_triangle(float x) {\n\tx = fract(x);\n\treturn min(2.0*x, 2.0-2.0*x);\n}\n\nfloat wave_sawtooth(float x) {\n\treturn fract(x);\n}\n\nfloat wave_square(float x) {\n\treturn (fract(x) < 0.5) ? 0.0 : 1.0;\n}\n\nfloat wave_bounce(float x) {\n\tx = 2.0*(fract(x)-0.5);\n\treturn sqrt(1.0-x*x);\n}\n\nfloat mix_mul(float x, float y) {\n\treturn x*y;\n}\n\nfloat mix_add(float x, float y) {\n\treturn min(x+y, 1.0);\n}\n\nfloat mix_max(float x, float y) {\n\treturn max(x, y);\n}\n\nfloat mix_min(float x, float y) {\n\treturn min(x, y);\n}\n\nfloat mix_xor(float x, float y) {\n\treturn min(x+y, 2.0-x-y);\n}\n\nfloat mix_pow(float x, float y) {\n\treturn pow(x, y);\n}vec4 brick(vec2 uv, vec2 bmin, vec2 bmax, float mortar, float round, float bevel, float brick_height) {\n\tfloat color;\n\tvec2 size = bmax - bmin;\n\tfloat min_size = min(size.x, size.y);\n\n\tmortar *= brick_height;\n\tbevel *= brick_height;\n\tround *= brick_height;\n\n\tvec2 center = 0.5*(bmin+bmax);\n    vec2 d = abs(uv-center)-0.5*(size)+vec2(round+mortar);\n    color = length(max(d,vec2(0))) + min(max(d.x,d.y),0.0)-round;\n\tcolor = clamp(-color/bevel, 0.0, 1.0);\n\tvec2 tiled_brick_pos = mod(bmin, vec2(1.0, 1.0));\n\treturn vec4(color, center, tiled_brick_pos.x+7.0*tiled_brick_pos.y);\n}\n\nvec4 brick_corner_bb(vec2 uv, vec2 bmin, vec2 bmax, float mortar, float corner, float brick_height) {\n\tvec2 center = 0.5*(bmin + bmax);\n\tvec2 size = bmax - bmin;\n\tfloat max_size = max(size.x, size.y);\n\tfloat min_size = min(size.x, size.y);\n\n\tmortar *= brick_height;\n\tcorner *= brick_height;\n\t\n\tvec2 corner1 = vec2(bmin + mortar);\n\tvec2 corner2 = vec2(bmax.x - mortar - corner, bmin.y + mortar);\n\tvec2 corner3 = vec2(bmin.x + mortar, bmax.y - mortar - corner);\n\tvec2 corner4 = vec2(bmax - mortar - corner);\n\tvec2 top = uv.x < center.x ? corner1 : corner2;\n\tvec2 bottom = uv.x < center.x ? corner3 : corner4;\n\tvec2 positions = uv.y < center.y ? top : bottom;\n\treturn vec4(round(fract(positions)*4096.0)/4096.0, corner, corner);\n}\n\nvec4 bricks_rb(vec2 uv, vec2 count, float offset) {\n\tfloat x_offset = offset*step(0.5, fract(uv.y*count.y*0.5));\n\tvec2 bmin = floor(vec2(uv.x*count.x-x_offset, uv.y*count.y));\n\tbmin.x += x_offset;\n\tbmin /= count;\n\treturn vec4(bmin, bmin+vec2(1.0)/count);\n}\n\nvec4 bricks_rb2(vec2 uv, vec2 count, float offset) {\n\tfloat x_offset = offset*step(0.5, fract(uv.y*count.y*0.5));\n\tcount.x = count.x*(1.0+step(0.5, fract(uv.y*count.y*0.5)));\n\tvec2 bmin = floor(vec2(uv.x*count.x-x_offset, uv.y*count.y));\n\tbmin.x += x_offset;\n\tbmin /= count;\n\treturn vec4(bmin, bmin+vec2(1.0)/count);\n}\n\nvec4 bricks_rb3(vec2 uv, vec2 count, float offset) {\n\tvec4 bb = bricks_rb(uv, count, offset);\n\t\n\tif ( (uv.x - bb.x) / (bb.z - bb.x) < 1.0/3.0) {\n\t\tbb.z = bb.x + (bb.z - bb.x) / 3.0;\n\t} else {\n\t\tbb.x = bb.x + (bb.z - bb.x) / 3.0;\n\t}\n\treturn bb;\n}\n\nvec4 bricks_hb(vec2 uv, vec2 count, float offset) {\n\tfloat pc = count.x+count.y;\n\tfloat c = pc;\n\tvec2 corner = floor(uv*c);\n\tfloat cdiff = mod(corner.x-corner.y, pc);\n\tif (cdiff < count.x) {\n\t\treturn vec4((corner-vec2(cdiff, 0.0))/c, (corner-vec2(cdiff, 0.0)+vec2(count.x, 1.0))/c);\n\t} else {\n\t\treturn vec4((corner-vec2(0.0, pc-cdiff-1.0))/c, (corner-vec2(0.0, pc-cdiff-1.0)+vec2(1.0, count.y))/c);\n\t}\n}\n\nvec4 bricks_bw(vec2 uv, vec2 count, float offset) {\n\tvec2 c = 2.0*count;\n\tfloat mc = max(c.x, c.y);\n\tvec2 corner1 = floor(uv*c);\n\tvec2 corner2 = count*floor(2.0*uv);\n\tfloat cdiff = mod(dot(floor(2.0*uv), vec2(1.0)), 2.0);\n\tvec2 corner;\n\tvec2 size;\n\tif (cdiff == 0.0) {\n\t\tcorner = vec2(corner1.x, corner2.y);\n\t\tsize = vec2(1.0, count.y);\n\t} else {\n\t\tcorner = vec2(corner2.x, corner1.y);\n\t\tsize = vec2(count.x, 1.0);\n\t}\n\treturn vec4(corner/c, (corner+size)/c);\n}\n\nvec4 bricks_sb(vec2 uv, vec2 count, float offset) {\n\tvec2 c = (count+vec2(1.0));\n\tfloat mc = max(c.x, c.y);\n\tvec2 corner1 = floor(uv*c);\n\tvec2 corner2 = (count+vec2(1.0))*floor(uv);\n\tvec2 rcorner = corner1 - corner2;\n\tvec2 corner;\n\tvec2 size;\n\tif (rcorner.x == 0.0 && rcorner.y < count.y) {\n\t\tcorner = corner2;\n\t\tsize = vec2(1.0, count.y);\n\t} else if (rcorner.y == 0.0) {\n\t\tcorner = corner2+vec2(1.0, 0.0);\n\t\tsize = vec2(count.x, 1.0);\n\t} else if (rcorner.x == count.x) {\n\t\tcorner = corner2+vec2(count.x, 1.0);\n\t\tsize = vec2(1.0, count.y);\n\t} else if (rcorner.y == count.y) {\n\t\tcorner = corner2+vec2(0.0, count.y);\n\t\tsize = vec2(count.x, 1.0);\n\t} else {\n\t\tcorner = corner2+vec2(1.0);\n\t\tsize = vec2(count.x-1.0, count.y-1.0);\n\t}\n\treturn vec4(corner/c, (corner+size)/c);\n}float shape_circle(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float distance = length(uv);\n    return clamp((1.0-distance/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_polygon(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y)+3.14159265359;\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(0.5+angle/slice)*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(angle*sides/6.28318530718-0.5+2.0*step(fract(angle*sides/6.28318530718), 0.5))*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_curved_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = 2.0*(atan(uv.x, uv.y)+3.14159265359);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-cos(floor(0.5+0.5*angle/slice)*2.0*slice-angle)*length(uv)/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_rays(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = 0.5*max(edge, 1.0e-8)*size;\n\tfloat slice = 6.28318530718/sides;\n    float angle = mod(atan(uv.x, uv.y)+3.14159265359, slice)/slice;\n    return clamp(min((size-angle)/edge, angle/edge), 0.0, 1.0);\n}\n\nvec2 sdLine(vec2 p, vec2 a, vec2 b) {\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp(dot(pa,ba)/dot(ba,ba), 0.0, 1.0);\n    return vec2(length(pa-ba*h), h);\n}\nvec3 blend_normal(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1 + (1.0-opacity)*c2;\n}\n\nvec3 blend_dissolve(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\tif (rand(uv) < opacity) {\n\t\treturn c1;\n\t} else {\n\t\treturn c2;\n\t}\n}\n\nvec3 blend_multiply(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*c1*c2 + (1.0-opacity)*c2;\n}\n\nvec3 blend_screen(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*(1.0-(1.0-c1)*(1.0-c2)) + (1.0-opacity)*c2;\n}\n\nfloat blend_overlay_f(float c1, float c2) {\n\treturn (c1 < 0.5) ? (2.0*c1*c2) : (1.0-2.0*(1.0-c1)*(1.0-c2));\n}\n\nvec3 blend_overlay(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_overlay_f(c1.x, c2.x), blend_overlay_f(c1.y, c2.y), blend_overlay_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_hard_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*0.5*(c1*c2+blend_overlay(uv, c1, c2, 1.0)) + (1.0-opacity)*c2;\n}\n\nfloat blend_soft_light_f(float c1, float c2) {\n\treturn (c2 < 0.5) ? (2.0*c1*c2+c1*c1*(1.0-2.0*c2)) : 2.0*c1*(1.0-c2)+sqrt(c1)*(2.0*c2-1.0);\n}\n\nvec3 blend_soft_light(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_soft_light_f(c1.x, c2.x), blend_soft_light_f(c1.y, c2.y), blend_soft_light_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_burn_f(float c1, float c2) {\n\treturn (c1==0.0)?c1:max((1.0-((1.0-c2)/c1)),0.0);\n}\n\nvec3 blend_burn(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_burn_f(c1.x, c2.x), blend_burn_f(c1.y, c2.y), blend_burn_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nfloat blend_dodge_f(float c1, float c2) {\n\treturn (c1==1.0)?c1:min(c2/(1.0-c1),1.0);\n}\n\nvec3 blend_dodge(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*vec3(blend_dodge_f(c1.x, c2.x), blend_dodge_f(c1.y, c2.y), blend_dodge_f(c1.z, c2.z)) + (1.0-opacity)*c2;\n}\n\nvec3 blend_lighten(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*max(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_darken(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*min(c1, c2) + (1.0-opacity)*c2;\n}\n\nvec3 blend_difference(vec2 uv, vec3 c1, vec3 c2, float opacity) {\n\treturn opacity*clamp(c2-c1, vec3(0.0), vec3(1.0)) + (1.0-opacity)*c2;\n}\nconst float p_o380864_amount = 0.890000000;\nconst float p_o273771_radius = 0.990000000;\nconst float p_o273771_repeat = 6.000000000;\nconst float p_o188690_gradient_0_pos = 0.000000000;\nconst float p_o188690_gradient_0_r = 1.000000000;\nconst float p_o188690_gradient_0_g = 0.000000000;\nconst float p_o188690_gradient_0_b = 0.000000000;\nconst float p_o188690_gradient_0_a = 1.000000000;\nconst float p_o188690_gradient_1_pos = 0.527273005;\nconst float p_o188690_gradient_1_r = 0.000000000;\nconst float p_o188690_gradient_1_g = 1.000000000;\nconst float p_o188690_gradient_1_b = 0.125000000;\nconst float p_o188690_gradient_1_a = 1.000000000;\nconst float p_o188690_gradient_2_pos = 0.772726995;\nconst float p_o188690_gradient_2_r = 0.000000000;\nconst float p_o188690_gradient_2_g = 0.062500000;\nconst float p_o188690_gradient_2_b = 1.000000000;\nconst float p_o188690_gradient_2_a = 1.000000000;\nvec4 o188690_gradient_gradient_fct(float x) {\n  if (x < p_o188690_gradient_0_pos) {\n    return vec4(p_o188690_gradient_0_r,p_o188690_gradient_0_g,p_o188690_gradient_0_b,p_o188690_gradient_0_a);\n  } else if (x < p_o188690_gradient_1_pos) {\n    return mix(vec4(p_o188690_gradient_0_r,p_o188690_gradient_0_g,p_o188690_gradient_0_b,p_o188690_gradient_0_a), vec4(p_o188690_gradient_1_r,p_o188690_gradient_1_g,p_o188690_gradient_1_b,p_o188690_gradient_1_a), 0.5-0.5*cos(3.14159265359*(x-p_o188690_gradient_0_pos)/(p_o188690_gradient_1_pos-p_o188690_gradient_0_pos)));\n  } else if (x < p_o188690_gradient_2_pos) {\n    return mix(vec4(p_o188690_gradient_1_r,p_o188690_gradient_1_g,p_o188690_gradient_1_b,p_o188690_gradient_1_a), vec4(p_o188690_gradient_2_r,p_o188690_gradient_2_g,p_o188690_gradient_2_b,p_o188690_gradient_2_a), 0.5-0.5*cos(3.14159265359*(x-p_o188690_gradient_1_pos)/(p_o188690_gradient_2_pos-p_o188690_gradient_1_pos)));\n  }\n  return vec4(p_o188690_gradient_2_r,p_o188690_gradient_2_g,p_o188690_gradient_2_b,p_o188690_gradient_2_a);\n}\nconst float p_o226039_bevel = 0.080000000;\nconst float p_o226039_base = 0.170000000;\nconst float p_o263115_s = 1.100000000;\nconst float p_o214466_ax = 0.280000000;\nconst float p_o214466_by = 0.160000000;\nconst float p_o214466_r = 0.600000000;\nconst float p_o132339_x_scale = 0.210000000;\nconst float p_o132339_y_scale = 0.200000000;\nfloat o132339_fct(vec2 uv, float _seed_variation_) {\n\treturn mix_xor(wave_sine(p_o132339_x_scale*uv.x), wave_sawtooth(p_o132339_y_scale*uv.y));\n}const float p_o80009_d = 0.300000000;\nconst float p_o12323_sides = 6.000000000;\nconst float p_o12323_radius = 0.760000000;\nconst float p_o12323_edge = 0.100000000;\nconst float p_o24363_amplitude = 0.910000000;\nconst float p_o24363_frequency = 6.000000000;\nconst float p_o7873_rows = 28.000000000;\nconst float p_o7873_columns = 1.000000000;\nconst float p_o7873_row_offset = 0.040000000;\nconst float p_o7873_mortar = 0.220000000;\nconst float p_o7873_bevel = 0.280000000;\nconst float p_o7873_round = 0.180000000;\nconst float p_o7873_corner = 0.310000000;\nconst float p_o154128_x = -0.010000000;\nconst float p_o154128_z = -0.030000000;\nconst float p_o50538_l = 0.640000000;\nconst float p_o50538_r = 0.510000000;\n\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nvec2 o214466_0_sdl = sdLine((((vec2(fract(p_o273771_repeat*atan((UV).y-0.5, (UV).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o273771_radius*length((UV)-vec2(0.5)))))-vec2(0.5))/p_o263115_s+vec2(0.5)), vec2(p_o214466_ax+0.5, (sin(iTime*.3))+0.5), vec2((sin(iTime  *.3))+0.5, p_o214466_by+0.5));float o132339_0_1_f = o132339_fct((vec2(o214466_0_sdl.y, 0.5)), _seed_variation_);\nfloat o24363_0_1_f = 1.0-abs(2.0*(((vec4(vec3(o132339_0_1_f), 0.0)).xy+vec2(0.5)).y-0.5)-p_o24363_amplitude*sin((p_o24363_frequency*((vec4(vec3(o132339_0_1_f), 0.0)).xy+vec2(0.5)).x+(cos(iTime)))*6.28318530718));\nvec4 o7873_0_rect = bricks_hb(((vec4(vec3(o132339_0_1_f), 0.0)).xy+vec2(0.5)), vec2(p_o7873_columns, p_o7873_rows), p_o7873_row_offset);\nvec4 o7873_0 = brick(((vec4(vec3(o132339_0_1_f), 0.0)).xy+vec2(0.5)), o7873_0_rect.xy, o7873_0_rect.zw, p_o7873_mortar*o24363_0_1_f, p_o7873_round*1.0, max(0.001, p_o7873_bevel*1.0), 1.0 / p_o7873_rows);float o7873_0_2_f = o7873_0.x;\nfloat o12323_0_1_f = shape_polygon(((vec4(vec3(o132339_0_1_f), 0.0)).xy+vec2(0.5)), p_o12323_sides, p_o12323_radius*o24363_0_1_f, p_o12323_edge*o7873_0_2_f);\nvec3 o85291_0_1_tex3d = vec3(o12323_0_1_f);\nvec3 o50538_0_p = (((vec4(vec3(o132339_0_1_f), 0.0)).xyz)-vec3(p_o154128_x, (sin(iTime)), p_o154128_z));\no50538_0_p.y -= clamp(o50538_0_p.y, -p_o50538_l, p_o50538_l);\nfloat o24363_0_3_f = 1.0-abs(2.0*((vec2(clamp(0.5+0.5*((((vec4(vec3(o132339_0_1_f), 0.0)).xyz)-vec3(p_o154128_x, (sin(iTime)), p_o154128_z))).y/p_o50538_l, 0.0, 1.0), 0.5)).y-0.5)-p_o24363_amplitude*sin((p_o24363_frequency*(vec2(clamp(0.5+0.5*((((vec4(vec3(o132339_0_1_f), 0.0)).xyz)-vec3(p_o154128_x, (sin(iTime)), p_o154128_z))).y/p_o50538_l, 0.0, 1.0), 0.5)).x+(cos(iTime)))*6.28318530718));\nvec4 o7873_3_rect = bricks_hb((vec2(clamp(0.5+0.5*((((vec4(vec3(o132339_0_1_f), 0.0)).xyz)-vec3(p_o154128_x, (sin(iTime)), p_o154128_z))).y/p_o50538_l, 0.0, 1.0), 0.5)), vec2(p_o7873_columns, p_o7873_rows), p_o7873_row_offset);\nvec4 o7873_3 = brick((vec2(clamp(0.5+0.5*((((vec4(vec3(o132339_0_1_f), 0.0)).xyz)-vec3(p_o154128_x, (sin(iTime)), p_o154128_z))).y/p_o50538_l, 0.0, 1.0), 0.5)), o7873_3_rect.xy, o7873_3_rect.zw, p_o7873_mortar*o24363_0_3_f, p_o7873_round*1.0, max(0.001, p_o7873_bevel*1.0), 1.0 / p_o7873_rows);float o7873_0_5_f = o7873_3.x;\nfloat o50538_0_1_sdf3d = length(o50538_0_p)-p_o50538_r*o7873_0_5_f;\nvec2 o154128_0_1_sdf3dc = vec2(o50538_0_1_sdf3d, 0.0);\nvec3 o80009_0_1_tex3d = mix(o85291_0_1_tex3d, vec3(0.5), clamp((o154128_0_1_sdf3dc).x/max(p_o80009_d, 0.0001), 0.0, 1.0));\nvec3 o96275_0_1_rgb = o80009_0_1_tex3d;\nfloat o214466_0_1_sdf2d = o214466_0_sdl.x-p_o214466_r*(dot(o96275_0_1_rgb, vec3(1.0))/3.0);\nfloat o263115_0_1_sdf2d = o214466_0_1_sdf2d*p_o263115_s;\nfloat o226039_0_1_f = clamp(p_o226039_base-o263115_0_1_sdf2d/max(p_o226039_bevel, 0.00001), 0.0, 1.0);\nvec4 o188690_0_1_rgba = o188690_gradient_gradient_fct(o226039_0_1_f);\nvec4 o273771_0_1_rgba = o188690_0_1_rgba;\nfloat o132339_0_3_f = o132339_fct((UV), _seed_variation_);\nfloat o24363_0_5_f = 1.0-abs(2.0*(((vec4(vec3(o132339_0_3_f), 0.0)).xy+vec2(0.5)).y-0.5)-p_o24363_amplitude*sin((p_o24363_frequency*((vec4(vec3(o132339_0_3_f), 0.0)).xy+vec2(0.5)).x+(cos(iTime)))*6.28318530718));\nvec4 o7873_6_rect = bricks_hb(((vec4(vec3(o132339_0_3_f), 0.0)).xy+vec2(0.5)), vec2(p_o7873_columns, p_o7873_rows), p_o7873_row_offset);\nvec4 o7873_6 = brick(((vec4(vec3(o132339_0_3_f), 0.0)).xy+vec2(0.5)), o7873_6_rect.xy, o7873_6_rect.zw, p_o7873_mortar*o24363_0_5_f, p_o7873_round*1.0, max(0.001, p_o7873_bevel*1.0), 1.0 / p_o7873_rows);float o7873_0_8_f = o7873_6.x;\nfloat o12323_0_3_f = shape_polygon(((vec4(vec3(o132339_0_3_f), 0.0)).xy+vec2(0.5)), p_o12323_sides, p_o12323_radius*o24363_0_5_f, p_o12323_edge*o7873_0_8_f);\nvec3 o85291_0_3_tex3d = vec3(o12323_0_3_f);\nvec3 o50538_2_p = (((vec4(vec3(o132339_0_3_f), 0.0)).xyz)-vec3(p_o154128_x, (sin(iTime)), p_o154128_z));\no50538_2_p.y -= clamp(o50538_2_p.y, -p_o50538_l, p_o50538_l);\nfloat o24363_0_7_f = 1.0-abs(2.0*((vec2(clamp(0.5+0.5*((((vec4(vec3(o132339_0_3_f), 0.0)).xyz)-vec3(p_o154128_x, (sin(iTime)), p_o154128_z))).y/p_o50538_l, 0.0, 1.0), 0.5)).y-0.5)-p_o24363_amplitude*sin((p_o24363_frequency*(vec2(clamp(0.5+0.5*((((vec4(vec3(o132339_0_3_f), 0.0)).xyz)-vec3(p_o154128_x, (sin(iTime)), p_o154128_z))).y/p_o50538_l, 0.0, 1.0), 0.5)).x+(cos(iTime)))*6.28318530718));\nvec4 o7873_9_rect = bricks_hb((vec2(clamp(0.5+0.5*((((vec4(vec3(o132339_0_3_f), 0.0)).xyz)-vec3(p_o154128_x, (sin(iTime)), p_o154128_z))).y/p_o50538_l, 0.0, 1.0), 0.5)), vec2(p_o7873_columns, p_o7873_rows), p_o7873_row_offset);\nvec4 o7873_9 = brick((vec2(clamp(0.5+0.5*((((vec4(vec3(o132339_0_3_f), 0.0)).xyz)-vec3(p_o154128_x, (sin(iTime)), p_o154128_z))).y/p_o50538_l, 0.0, 1.0), 0.5)), o7873_9_rect.xy, o7873_9_rect.zw, p_o7873_mortar*o24363_0_7_f, p_o7873_round*1.0, max(0.001, p_o7873_bevel*1.0), 1.0 / p_o7873_rows);float o7873_0_11_f = o7873_9.x;\nfloat o50538_0_3_sdf3d = length(o50538_2_p)-p_o50538_r*o7873_0_11_f;\nvec2 o154128_0_3_sdf3dc = vec2(o50538_0_3_sdf3d, 0.0);\nvec3 o80009_0_4_tex3d = mix(o85291_0_3_tex3d, vec3(0.5), clamp((o154128_0_3_sdf3dc).x/max(p_o80009_d, 0.0001), 0.0, 1.0));\nvec3 o96275_0_3_rgb = o80009_0_4_tex3d;\nvec4 o380864_0_s1 = o273771_0_1_rgba;\nvec4 o380864_0_s2 = vec4(o96275_0_3_rgb, 1.0);\nfloat o380864_0_a = p_o380864_amount*1.0;\nvec4 o380864_0_2_rgba = vec4(blend_normal((UV), o380864_0_s1.rgb, o380864_0_s2.rgb, o380864_0_a*o380864_0_s1.a), min(1.0, o380864_0_s2.a+o380864_0_a*o380864_0_s1.a));\ngl_FragColor = o380864_0_2_rgba;\n}\n"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iChannel0"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1},{name:"iResolution Z",value:1.29},{name:"iTime"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"247",objOut:"246"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"247",objOut:"246"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"247",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"mirrored repeat"},{name:"Floating Point",value:true},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",value:0},{name:"Texture",links:[{portIn:"Texture In",portOut:"Texture",objIn:"250",objOut:"247"}]},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Anim.Timer_v2",id:"248",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Speed",value:1.2},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"iTime",portOut:"Time",objIn:"246",objOut:"248"}]}]},{objName:"Ops.Sequence",id:"249",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"246",objOut:"249"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Ui.VizTexture",id:"250",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"Image",portOut:"Texture Out",objIn:"251",objOut:"250"}]},{name:"Info",value:"unknown"}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"251",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"256",objOut:"251"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v2",id:"252",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Render"},{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"249",objOut:"252"},{portIn:"render",portOut:"Next",objIn:"251",objOut:"252"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"254",objOut:"252"}]},{name:"Aspect Ratio",value:.9026798307475318}]},{objName:"Ops.Gl.GradientTexture",id:"253",uiAttribs:{subPatch:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":8.881784197001252e-16,"g":0,"b":1},{"pos":0.704,"r":8.881784197001252e-16,"g":0,"b":1},{"pos":0.976,"r":1,"g":0,"b":0},{"pos":1,"r":1,"g":0,"b":0}]}'},{name:"Direction index",value:0},{name:"Direction",value:"Radial"},{name:"Smoothstep",value:true},{name:"Step",value:false},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:512},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Gradient Array",value:0},{name:"Randomize Colors",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Gradient",portOut:"Texture",objIn:"257",objOut:"253"},{portIn:"Offset",portOut:"Texture",objIn:"258",objOut:"253"}]},{name:"Colors"},{name:"Colors Pos"}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"254",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Trigger.TriggerReceive",id:"255",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Named Trigger",value:"TimerStart"}],portsOut:[{name:"Triggered",links:[{portIn:"Reset",portOut:"Triggered",objIn:"248",objOut:"255"}]}]},{objName:"Ops.Gl.TextureEffects.FastBlur",id:"256",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"render"},{name:"amount",value:.28},{name:"Clamp",value:false},{name:"Mask Invert",value:false},{name:"Mask",value:0},{name:"direction index",value:0},{name:"direction",value:"both"}],portsOut:[{name:"trigger",links:[{portIn:"in0 Ops.Gl.TextureEffects.FastBlur trigger",portOut:"trigger",objIn:"270",objOut:"256"}]}]},{objName:"Ops.Gl.TextureEffects.ColorMap",id:"257",uiAttribs:{subPatch:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Gradient"},{name:"Method index",value:0},{name:"Method",value:"Luminance"},{name:"Min",value:0},{name:"Max",value:.822},{name:"Position",value:.489}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.TextureEffects.Hue",id:"258",uiAttribs:{subPatch:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},portsIn:[{name:"render"},{name:"hue"},{name:"Mask",value:0},{name:"Offset"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.TextureEffects.EdgeDetection_v3",id:"259",uiAttribs:{subPatch:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},portsIn:[{name:"Render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"softlight"},{name:"Amount",value:1},{name:"Strength",value:4.5},{name:"Width",value:.471},{name:"Mul Color",value:.077}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"258",objOut:"259"},{portIn:"exe",portOut:"Trigger",objIn:"264",objOut:"259"}]}]},{objName:"Ops.Boolean.IfTrueThen_v2",id:"260",uiAttribs:{subPatch:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},portsIn:[{name:"exe"},{name:"boolean"}],portsOut:[{name:"then",links:[{portIn:"Render",portOut:"then",objIn:"259",objOut:"260"}]},{name:"else",value:0}]},{objName:"Ops.TimeLine.TimeLineTime",id:"261",uiAttribs:{subPatch:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},portsIn:[],portsOut:[{name:"time",links:[{portIn:"hue",portOut:"time",objIn:"258",objOut:"261"}]}]},{objName:"Ops.Trigger.TriggerReceive",id:"262",uiAttribs:{subPatch:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},portsIn:[{name:"Named Trigger",value:"StartOption"}],portsOut:[{name:"Triggered",links:[{portIn:"trigger",portOut:"Triggered",objIn:"263",objOut:"262"}]}]},{objName:"Ops.Boolean.ToggleBool",id:"263",uiAttribs:{subPatch:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},portsIn:[{name:"trigger"},{name:"reset",value:0},{name:"Default",value:false}],portsOut:[{name:"result",links:[{portIn:"boolean",portOut:"result",objIn:"260",objOut:"263"}]}]},{objName:"Ops.Boolean.IfTrueThen_v2",id:"264",uiAttribs:{subPatch:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},portsIn:[{name:"exe"},{name:"boolean"}],portsOut:[{name:"then",links:[{portIn:"render",portOut:"then",objIn:"257",objOut:"264"}]},{name:"else",value:0}]},{objName:"Ops.Boolean.ToggleBool",id:"265",uiAttribs:{subPatch:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},portsIn:[{name:"trigger"},{name:"reset",value:0},{name:"Default",value:false}],portsOut:[{name:"result",links:[{portIn:"boolean",portOut:"result",objIn:"264",objOut:"265"}]}]},{objName:"Ops.Trigger.TriggerReceive",id:"266",uiAttribs:{subPatch:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},portsIn:[{name:"Named Trigger",value:"Kanool"}],portsOut:[{name:"Triggered",links:[{portIn:"trigger",portOut:"Triggered",objIn:"265",objOut:"266"}]}]},{objName:"Ops.Ui.Area",id:"267",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Title",value:""}],portsOut:[]},{objName:"Ops.Ui.PatchInput",id:"268",uiAttribs:{subPatch:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},portsIn:[],portsOut:[{name:"create port",value:0},{name:"in0 Ops.Gl.TextureEffects.FastBlur trigger",links:[{portIn:"exe",portOut:"in0 Ops.Gl.TextureEffects.FastBlur trigger",objIn:"260",objOut:"268"}]}]},{objName:"Ops.Ui.PatchOutput",id:"269",uiAttribs:{subPatch:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},portsIn:[{name:"create port",value:0}],portsOut:[]},{objName:"Ops.Ui.SubPatch",id:"270",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"create port",value:null},{name:"dataStr",value:'{"ports":[{"name":"in0 Ops.Gl.TextureEffects.FastBlur trigger","type":1}],"portsOut":[]}'},{name:"patchId",value:"4dfed637-f4f3-4ee3-8ce3-843a627c4363"},{name:"in0 Ops.Gl.TextureEffects.FastBlur trigger"}],portsOut:[{name:"create port out",value:0}]},{objName:"Ops.Sequence",id:"271",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"exe",value:0},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7"},{name:"exe 8"},{name:"exe 9"},{name:"exe 10"},{name:"exe 11"},{name:"exe 12"},{name:"exe 13"},{name:"exe 14"}],portsOut:[{name:"trigger 0",links:[{portIn:"in0 Ops.Gl.TextureEffects.FastBlur trigger",portOut:"trigger 0",objIn:"270",objOut:"271"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Sequence",id:"272",uiAttribs:{},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"Execute",portOut:"trigger 0",objIn:"123",objOut:"272"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Gl.Render2Texture",id:"273",uiAttribs:{},portsIn:[{name:"render"},{name:"use viewport size",value:true},{name:"texture width",value:640},{name:"texture height",value:709},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:true},{name:"Clear",value:true}],portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"272",objOut:"273"}]},{name:"texture",links:[{portIn:"Texture In",portOut:"texture",objIn:"3",objOut:"273"}]},{name:"textureDepth"}]},{objName:"Ops.Value.Number",id:"274",uiAttribs:{},portsIn:[{name:"value"}],portsOut:[{name:"result",links:[{portIn:"number1",portOut:"result",objIn:"289",objOut:"274"}]}]},{objName:"Ops.Array.ArrayPack3",id:"275",uiAttribs:{},portsIn:[{name:"Trigger in"},{name:"Array 1",value:null},{name:"Array 2",value:0},{name:"Array 3",value:0}],portsOut:[{name:"Trigger out",value:0},{name:"Array out"},{name:"Num Points",value:0},{name:"Array length",value:84}]},{objName:"Ops.Array.ArraySetNumber_v2",id:"276",uiAttribs:{},portsIn:[{name:"Execute"},{name:"Array",value:0},{name:"Index",value:13},{name:"Number",value:-1}],portsOut:[{name:"Next",value:0},{name:"Result"}]},{objName:"Ops.Array.Array_v3",id:"277",uiAttribs:{},portsIn:[{name:"Array length",value:13},{name:"Mode select index",value:0},{name:"Mode select",value:"1,2,3,4"},{name:"Default Value",value:.08},{name:"Reverse",value:false}],portsOut:[{name:"Array",links:[{portIn:"array",portOut:"Array",objIn:"278",objOut:"277"}]},{name:"Array length out",value:13}]},{objName:"Ops.Array.ArrayGetNumber",id:"278",uiAttribs:{},portsIn:[{name:"array"},{name:"index",value:4}],portsOut:[{name:"value",value:4}]},{objName:"Ops.String.NumberToString_v2",id:"279",uiAttribs:{},portsIn:[{name:"Number"}],portsOut:[{name:"Result",links:[{portIn:"String A",portOut:"Result",objIn:"281",objOut:"279"}]}]},{objName:"Ops.String.NumberToString_v2",id:"280",uiAttribs:{},portsIn:[{name:"Number"}],portsOut:[{name:"Result",links:[{portIn:"String B",portOut:"Result",objIn:"281",objOut:"280"}]}]},{objName:"Ops.String.StringCompose_v3",id:"281",uiAttribs:{},portsIn:[{name:"Format",value:"$a.$b"},{name:"String A"},{name:"String B"},{name:"String C",value:2},{name:"String D",value:3},{name:"String E",value:""},{name:"String F",value:""}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"282",objOut:"281"}]}]},{objName:"Ops.Ui.VizString",id:"282",uiAttribs:{},portsIn:[{name:"String"}],portsOut:[{name:"Result",links:[{portIn:"SearchValue",portOut:"Result",objIn:"284",objOut:"282"}]}]},{objName:"Ops.String.StringContains_v2",id:"283",uiAttribs:{},portsIn:[{name:"String",value:null},{name:"SearchValue",value:null}],portsOut:[{name:"Found",value:0},{name:"Index",value:-1}]},{objName:"Ops.String.ArrayContainsString",id:"284",uiAttribs:{},portsIn:[{name:"Array"},{name:"SearchValue"}],portsOut:[{name:"Found",value:1},{name:"Index",links:[{portIn:"value",portOut:"Index",objIn:"274",objOut:"284"},{portIn:"Number",portOut:"Index",objIn:"288",objOut:"284"}]}]},{objName:"Ops.Math.Divide",id:"285",uiAttribs:{},portsIn:[{name:"number1"},{name:"number2",value:3}],portsOut:[{name:"result",links:[{portIn:"Input Y",portOut:"result",objIn:"85",objOut:"285"}]}]},{objName:"Ops.Math.Divide",id:"286",uiAttribs:{},portsIn:[{name:"number1"},{name:"number2",value:3}],portsOut:[{name:"result",links:[{portIn:"Input X",portOut:"result",objIn:"85",objOut:"286"}]}]},{objName:"Ops.Json.CsvArray",id:"287",uiAttribs:{},portsIn:[{name:"file",value:"assets/6448e2cd2d251f3835610d81_test2.csv",display:"file"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"284",objOut:"287"}]},{name:"num items",value:39}]},{objName:"Ops.Ui.VizNumberBar",id:"288",uiAttribs:{},portsIn:[{name:"Number"}],portsOut:[]},{objName:"Ops.Math.Divide",id:"289",uiAttribs:{},portsIn:[{name:"number1"},{name:"number2",value:4}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"290",objOut:"289"},{portIn:"in1 / result",portOut:"result",objIn:"302",objOut:"289"}]}]},{objName:"Ops.Ui.VizNumberBar",id:"290",uiAttribs:{},portsIn:[{name:"Number"}],portsOut:[]},{objName:"Ops.Math.Round",id:"291",uiAttribs:{},portsIn:[{name:"number",value:0},{name:"Decimal Places",value:0}],portsOut:[{name:"result",value:0}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"292",uiAttribs:{},portsIn:[{name:"Render"},{name:"Base Texture"},{name:"Size index",value:0},{name:"Size",value:"Auto"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 8bit ubyte"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",value:0},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"293",objOut:"292"}]},{name:"Aspect Ratio",value:.9026798307475318},{name:"Texture Width",value:640},{name:"Texture Height",value:709}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"293",uiAttribs:{},portsIn:[{name:"render"},{name:"Scale index",value:1},{name:"Scale",value:"Fit"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Sidebar.Toggle_v3",id:"294",uiAttribs:{},portsIn:[{name:"link"},{name:"Text",value:"Toggle"},{name:"Input",value:true},{name:"Set Default",value:0},{name:"Default",value:true},{name:"Grey Out",value:false},{name:"Visible",value:true}],portsOut:[{name:"childs"},{name:"Value",links:[{portIn:"Boolean",portOut:"Value",objIn:"295",objOut:"294"}]}]},{objName:"Ops.Value.NumberSwitchBoolean",id:"295",uiAttribs:{},portsIn:[{name:"Boolean"},{name:"Value false",value:0},{name:"Value true",value:2}],portsOut:[{name:"Result",links:[{portIn:"number1",portOut:"Result",objIn:"68",objOut:"295"},{portIn:"Value In",portOut:"Result",objIn:"64",objOut:"295"},{portIn:"Index 2",portOut:"Result",objIn:"69",objOut:"295"}]}]},{objName:"Ops.Sidebar.Toggle_v3",id:"296",uiAttribs:{},portsIn:[{name:"link"},{name:"Text",value:"Animation On"},{name:"Input"},{name:"Set Default",value:0},{name:"Default",value:true},{name:"Grey Out",value:false},{name:"Visible",value:true}],portsOut:[{name:"childs"},{name:"Value",value:true}]},{objName:"Ops.Value.Number",id:"297",uiAttribs:{},portsIn:[{name:"value"}],portsOut:[{name:"result",links:[{portIn:"amount",portOut:"result",objIn:"25",objOut:"297"},{portIn:"val",portOut:"result",objIn:"32",objOut:"297"},{portIn:"amount",portOut:"result",objIn:"34",objOut:"297"}]}]},{objName:"Ops.Math.Clamp",id:"298",uiAttribs:{},portsIn:[{name:"val"},{name:"min",value:-.95},{name:"max",value:-.7},{name:"ignore outside values",value:false}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"299",objOut:"298"}]}]},{objName:"Ops.Anim.AnimNumber",id:"299",uiAttribs:{},portsIn:[{name:"exe"},{name:"Value"},{name:"duration",value:1.05},{name:"easing index",value:0},{name:"easing",value:"linear"}],portsOut:[{name:"Next",value:0},{name:"result",value:-.91242},{name:"Finished",value:0}]},{objName:"Ops.Ui.PatchInput",id:"300",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[],portsOut:[{name:"create port",value:0},{name:"in0 Ops.Trigger.GateTrigger Trigger out",links:[{portIn:"exe",portOut:"in0 Ops.Trigger.GateTrigger Trigger out",objIn:"102",objOut:"300"}]},{name:"in1 / result",links:[{portIn:"current",portOut:"in1 / result",objIn:"102",objOut:"300"}]}]},{objName:"Ops.Ui.PatchOutput",id:"301",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"create port",value:0}],portsOut:[]},{objName:"Ops.Ui.SubPatch",id:"302",uiAttribs:{},portsIn:[{name:"create port",value:null},{name:"dataStr",value:'{"ports":[{"name":"in0 Ops.Trigger.GateTrigger Trigger out","type":1},{"name":"in1 / result","type":0}],"portsOut":[]}'},{name:"patchId",value:"e29908b3-998b-45cc-a71c-6ca76d670c22"},{name:"in0 Ops.Trigger.GateTrigger Trigger out"},{name:"in1 / result"}],portsOut:[{name:"create port out",value:0}]},{objName:"Ops.Ui.VizTexture",id:"303",uiAttribs:{},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out"},{name:"Info",value:"640x709 8bit linear repeat"}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"304",uiAttribs:{},portsIn:[{name:"Render"},{name:"Base Texture"},{name:"Size index",value:0},{name:"Size",value:"Auto"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 8bit ubyte"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",value:0},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"305",objOut:"304"}]},{name:"Aspect Ratio",value:.9026798307475318},{name:"Texture Width",value:640},{name:"Texture Height",value:709}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"305",uiAttribs:{},portsIn:[{name:"render"},{name:"Scale index",value:1},{name:"Scale",value:"Fit"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Sidebar.Toggle_v3",id:"306",uiAttribs:{},portsIn:[{name:"link"},{name:"Text",value:"Toggle"},{name:"Input",value:true},{name:"Set Default",value:0},{name:"Default",value:true},{name:"Grey Out",value:false},{name:"Visible",value:true}],portsOut:[{name:"childs"},{name:"Value",links:[{portIn:"Boolean",portOut:"Value",objIn:"307",objOut:"306"}]}]},{objName:"Ops.Value.NumberSwitchBoolean",id:"307",uiAttribs:{},portsIn:[{name:"Boolean"},{name:"Value false",value:0},{name:"Value true",value:1}],portsOut:[{name:"Result",links:[{portIn:"Index 1",portOut:"Result",objIn:"69",objOut:"307"},{portIn:"number1",portOut:"Result",objIn:"68",objOut:"307"},{portIn:"Value In",portOut:"Result",objIn:"64",objOut:"307"}]}]},{objName:"Ops.Sequence",id:"308",uiAttribs:{},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:null},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"in0 Ops.Gl.Render2Texture render",portOut:"trigger 0",objIn:"374",objOut:"308"},{portIn:"in0 Ops.Gl.Render2Texture render",portOut:"trigger 0",objIn:"391",objOut:"308"}]},{name:"trigger 1",links:[{portIn:"in0 Ops.Gl.Render2Texture render",portOut:"trigger 1",objIn:"434",objOut:"308"}]},{name:"trigger 2",value:0},{name:"trigger 3",links:[{portIn:"in0 Ops.Gl.Render2Texture render",portOut:"trigger 3",objIn:"374",objOut:"308"}]},{name:"trigger 4",links:[{portIn:"in0 Ops.Gl.Render2Texture render",portOut:"trigger 4",objIn:"391",objOut:"308"}]},{name:"trigger 5",links:[{portIn:"in0 Ops.Gl.Render2Texture render",portOut:"trigger 5",objIn:"316",objOut:"308"}]},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Ui.VizTexture",id:"309",uiAttribs:{},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out"},{name:"Info",value:"640x709 8bit linear repeat"}]},{objName:"Ops.Ui.VizTexture",id:"310",uiAttribs:{},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out"},{name:"Info",value:"640x709 8bit linear repeat"}]},{objName:"Ops.Ui.VizTexture",id:"311",uiAttribs:{},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out"},{name:"Info",value:"640x709 8bit linear repeat"}]},{objName:"Ops.Ui.VizTexture",id:"312",uiAttribs:{},portsIn:[{name:"Texture In",value:0},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out"},{name:"Info",value:"unknown"}]},{objName:"Ops.Gl.Render2Texture",id:"313",uiAttribs:{},portsIn:[{name:"render"},{name:"use viewport size",value:true},{name:"texture width",value:640},{name:"texture height",value:709},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:true},{name:"Clear",value:true}],portsOut:[{name:"trigger",value:0},{name:"texture"},{name:"textureDepth"}]},{objName:"Ops.Ui.PatchInput",id:"314",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[],portsOut:[{name:"create port",value:0},{name:"in0 Ops.Gl.Render2Texture render",links:[{portIn:"render",portOut:"in0 Ops.Gl.Render2Texture render",objIn:"371",objOut:"314"}]}]},{objName:"Ops.Ui.PatchOutput",id:"315",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"create port",value:null},{name:"out0 Ops.Gl.Render2Texture texture"}],portsOut:[]},{objName:"Ops.Ui.SubPatch",id:"316",uiAttribs:{},portsIn:[{name:"create port",value:0},{name:"dataStr",value:'{"ports":[{"name":"in0 Ops.Gl.Render2Texture render","type":1}],"portsOut":[{"name":"out0 Ops.Gl.Render2Texture texture","type":2,"objType":"texture"}]}'},{name:"patchId",value:"954b8512-0457-4320-afa2-70f8f2db5690"},{name:"in0 Ops.Gl.Render2Texture render"}],portsOut:[{name:"create port out",value:0},{name:"out0 Ops.Gl.Render2Texture texture",links:[{portIn:"Base Texture",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"292",objOut:"316"},{portIn:"Texture In",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"309",objOut:"316"},{portIn:"texture2",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"80",objOut:"316"},{portIn:"texture2",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"78",objOut:"316"}]}]},{objName:"Ops.Sequence",id:"317",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"323",objOut:"317"},{portIn:"exe",portOut:"trigger 0",objIn:"326",objOut:"317"},{portIn:"Increment",portOut:"trigger 0",objIn:"327",objOut:"317"},{portIn:"exe",portOut:"trigger 0",objIn:"332",objOut:"317"},{portIn:"render",portOut:"trigger 0",objIn:"333",objOut:"317"},{portIn:"exe",portOut:"trigger 0",objIn:"370",objOut:"317"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Gl.Matrix.Transform",id:"318",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"posX",value:1.4},{name:"posY",value:-1.87},{name:"posZ",value:1.33},{name:"scale",value:1},{name:"rotX",value:7},{name:"rotY",value:0},{name:"rotZ",value:-75.01}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"350",objOut:"318"}]}]},{objName:"Ops.Math.Abs",id:"319",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"number"}],portsOut:[{name:"result",links:[{portIn:"z",portOut:"result",objIn:"323",objOut:"319"}]}]},{objName:"Ops.Ui.VizNumber",id:"320",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Number"}],portsOut:[{name:"Result",links:[{portIn:"z",portOut:"Result",objIn:"346",objOut:"320"},{portIn:"a",portOut:"Result",objIn:"350",objOut:"320"},{portIn:"g",portOut:"Result",objIn:"350",objOut:"320"}]}]},{objName:"Ops.Math.Clamp",id:"321",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"val"},{name:"min",value:1.18},{name:"max",value:4.65},{name:"ignore outside values",value:true}],portsOut:[{name:"result",value:2.5}]},{objName:"Ops.Math.Sine",id:"322",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"value"},{name:"phase",value:2.37},{name:"frequency",value:.002},{name:"amplitude",value:3.69},{name:"asine",value:false}],portsOut:[{name:"result",links:[{portIn:"number",portOut:"result",objIn:"319",objOut:"322"},{portIn:"Number",portOut:"result",objIn:"320",objOut:"322"}]}]},{objName:"Ops.Gl.Matrix.ScaleXYZ",id:"323",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"x",value:1.81},{name:"y",value:.34},{name:"z"}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"328",objOut:"323"}]}]},{objName:"Ops.Math.Pow",id:"324",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Base"},{name:"Exponent",value:3.24}],portsOut:[{name:"Result",links:[{portIn:"rotX",portOut:"Result",objIn:"328",objOut:"324"}]}]},{objName:"Ops.Trigger.TriggerCounterLoop",id:"325",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"trigger in"},{name:"reset",value:0},{name:"Loop min",value:1.5},{name:"Loop max",value:4.8}],portsOut:[{name:"trigger out",value:0},{name:"current count",links:[{portIn:"val",portOut:"current count",objIn:"321",objOut:"325"},{portIn:"Value",portOut:"current count",objIn:"326",objOut:"325"}]}]},{objName:"Ops.Anim.AnimNumber",id:"326",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"exe"},{name:"Value"},{name:"duration",value:2.37},{name:"easing index",value:0},{name:"easing",value:"Elastic Out"}],portsOut:[{name:"Next",value:0},{name:"result",links:[{portIn:"Base",portOut:"result",objIn:"324",objOut:"326"}]},{name:"Finished",value:0}]},{objName:"Ops.Math.Incrementor",id:"327",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Increment"},{name:"Decrement",value:0},{name:"Length",value:649},{name:"Limit",value:true},{name:"Reset",value:0},{name:"Mode index",value:0},{name:"Mode",value:"Rewind"},{name:"Default",value:107}],portsOut:[{name:"Changed",value:0},{name:"Value",links:[{portIn:"value",portOut:"Value",objIn:"322",objOut:"327"},{portIn:"rotZ",portOut:"Value",objIn:"328",objOut:"327"},{portIn:"Time",portOut:"Value",objIn:"346",objOut:"327"}]},{name:"Restarted",links:[{portIn:"trigger in",portOut:"Restarted",objIn:"325",objOut:"327"}]}]},{objName:"Ops.Gl.Matrix.Transform",id:"328",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"posX",value:.74},{name:"posY",value:25.82},{name:"posZ",value:.1},{name:"scale",value:11.18},{name:"rotX"},{name:"rotY",value:-89.66},{name:"rotZ"}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"341",objOut:"328"}]}]},{objName:"Ops.Gl.ShaderEffects.AreaDiscardPixel_v2",id:"329",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"Invert",value:false},{name:"Area index",value:0},{name:"Area",value:"Sphere"},{name:"Size",value:.21},{name:"Size X",value:3.9},{name:"Size Y",value:-.13},{name:"Size Z",value:1},{name:"Repeat",value:true},{name:"Repeat Distance",value:1.86},{name:"x",value:0},{name:"y",value:0},{name:"z",value:0},{name:"WorldSpace",value:true}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"338",objOut:"329"}]}]},{objName:"Ops.Math.Abs",id:"330",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"number"}],portsOut:[{name:"result",links:[{portIn:"posY",portOut:"result",objIn:"333",objOut:"330"},{portIn:"Absolute",portOut:"result",objIn:"336",objOut:"330"}]}]},{objName:"Ops.Anim.SineAnim",id:"331",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"exe"},{name:"Mode index",value:0},{name:"Mode",value:"Sine"},{name:"phase",value:9.65},{name:"frequency",value:.57},{name:"amplitude",value:1.68}],portsOut:[{name:"Trigger out",value:0},{name:"result",links:[{portIn:"number",portOut:"result",objIn:"330",objOut:"331"},{portIn:"value false",portOut:"result",objIn:"332",objOut:"331"},{portIn:"y",portOut:"result",objIn:"338",objOut:"331"}]}]},{objName:"Ops.Anim.BoolAnim",id:"332",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"exe"},{name:"bool",value:false},{name:"easing index",value:0},{name:"easing",value:"Quint In Out"},{name:"duration",value:1.61},{name:"Direction index",value:0},{name:"Direction",value:"Both"},{name:"value false"},{name:"value true",value:4.16}],portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"331",objOut:"332"}]},{name:"value",value:-1.5114213166631767},{name:"finished",value:0},{name:"Finished Trigger",value:0}]},{objName:"Ops.Gl.Matrix.Transform",id:"333",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"posX",value:0},{name:"posY"},{name:"posZ",value:-.01},{name:"scale",value:1},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Trigger In",portOut:"trigger",objIn:"337",objOut:"333"}]}]},{objName:"Ops.Gl.MeshInstancer_v4",id:"334",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"exe"},{name:"geom"},{name:"Scale",value:.18},{name:"Limit Instances",value:true},{name:"Limit",value:5},{name:"positions",value:0},{name:"Scale Array",value:null},{name:"Rotations"},{name:"Rotation Type index",value:0},{name:"Rotation Type",value:"Euler"},{name:"Material blend mode index",value:0},{name:"Material blend mode",value:"Multiply"},{name:"Colors",value:0},{name:"TexCoords",value:0}],portsOut:[{name:"Trigger Out",value:0},{name:"Num",value:"exe"}]},{objName:"Ops.Gl.Meshes.ParametricSurface",id:"335",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"shapes index",value:0},{name:"shapes",value:"Henneberg's Surface"},{name:"render",value:0},{name:"u Segments",value:100},{name:"v Segments",value:100},{name:"Multiple of PI - u",value:false},{name:"uMin",value:-1},{name:"uMax",value:1},{name:"Displace U",value:0},{name:"Multiple of PI - v",value:true},{name:"vMin",value:-.5},{name:"vMax",value:.5},{name:"Displace V",value:0},{name:"X Function",value:"2*cos(v)*sinh(u)-0.667*cos(3*v)*sinh(3*u)"},{name:"Y Function",value:"2*sin(v)*sinh(u)+0.667*sin(3*v)*sinh(3*u)"},{name:"Z Function",value:"2*cos(2*v)*cosh(2*u)"},{name:"Scale X",value:.1},{name:"Scale Y",value:.1},{name:"Scale Z",value:.1},{name:"Draw",value:false}],portsOut:[{name:"trigger",value:0},{name:"geometry",links:[{portIn:"geom",portOut:"geometry",objIn:"334",objOut:"335"}]},{name:"Position"},{name:"Position Amount",value:30603}]},{objName:"Ops.Gl.ShaderEffects.ExplodeDividedMesh_v2",id:"336",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Render"},{name:"Distance",value:1},{name:"Size",value:2.24},{name:"Absolute"},{name:"add x",value:0},{name:"add y",value:0},{name:"add z",value:0},{name:"mul x",value:1},{name:"mul y",value:-1.01},{name:"mul z",value:1},{name:"x",value:0},{name:"y",value:0},{name:"z",value:0}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"334",objOut:"336"}]}]},{objName:"Ops.Gl.Phong.PhongMaterial_v6",id:"337",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Trigger In"},{name:"R",value:.9051690700988171},{name:"G",value:.24917355634374339},{name:"B",value:.8465644130458064},{name:"A",value:1},{name:"Enable",value:true},{name:"Albedo",value:.707},{name:"Roughness",value:.835},{name:"Active",value:false},{name:"Fresnel Intensity",value:.7},{name:"Fresnel Width",value:1},{name:"Fresnel Exponent",value:6},{name:"Fresnel R",value:1},{name:"Fresnel G",value:1},{name:"Fresnel B",value:1},{name:"Emissive Active",value:false},{name:"Color Intensity",value:.3},{name:"Emissive R",value:.8793450775989448},{name:"Emissive G",value:.029759320766855835},{name:"Emissive B",value:.05906836866061771},{name:"Shininess",value:4},{name:"Specular Amount",value:.5},{name:"Specular Model index",value:0},{name:"Specular Model",value:"Blinn"},{name:"Energy Conservation",value:false},{name:"Double Sided Material",value:false},{name:"Falloff Mode index",value:0},{name:"Falloff Mode",value:"A"},{name:"Diffuse Texture",value:0},{name:"Specular Texture",value:0},{name:"Normal Map",value:0},{name:"AO Texture",value:0},{name:"Emissive Texture",value:0},{name:"Emissive Mask",value:0},{name:"Opacity Texture",value:0},{name:"Environment Map",value:0},{name:"Env Map Mask",value:0},{name:"Colorize Texture",value:false},{name:"Diffuse Repeat X",value:1},{name:"Diffuse Repeat Y",value:1},{name:"Texture Offset X",value:0},{name:"Texture Offset Y",value:0},{name:"Specular Intensity",value:1},{name:"Normal Map Intensity",value:.5},{name:"AO Intensity",value:1},{name:"Emissive Intensity",value:1},{name:"Emissive Mask Intensity",value:1},{name:"Env Map Intensity",value:1},{name:"Env Map Blend index",value:0},{name:"Env Map Blend",value:"Add"},{name:"Env Mask Intensity",value:1},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Discard Transparent Pixels",value:false}],portsOut:[{name:"Trigger Out",links:[{portIn:"render",portOut:"Trigger Out",objIn:"329",objOut:"337"}]},{name:"Shader"}]},{objName:"Ops.Gl.ShaderEffects.AreaRotate_v2",id:"338",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"Size",value:98.28},{name:"Strength",value:9.18},{name:"Smooth",value:true},{name:"x",value:0},{name:"y"},{name:"z",value:-.19}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"336",objOut:"338"}]}]},{objName:"Ops.Gl.ShaderEffects.DeformArea",id:"339",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render",value:null},{name:"Size",value:194.74},{name:"Strength",value:197.43},{name:"Smooth",value:true},{name:"WorldSpace",value:false},{name:"x",value:.61},{name:"y",value:0},{name:"z",value:0}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Trigger.TriggerIfIncreased",id:"340",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Value"}],portsOut:[{name:"Trigger",links:[{portIn:"Reset",portOut:"Trigger",objIn:"352",objOut:"340"}]}]},{objName:"Ops.Deprecated.Gl.Matrix.CircleTransform",id:"341",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"segments",value:13},{name:"radius",value:-3.6},{name:"percent",value:1},{name:"Absolute",value:true},{name:"Flip",value:true},{name:"Rotate",value:true}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"360",objOut:"341"}]},{name:"index",value:12}]},{objName:"Ops.Math.Compare.GreaterThan",id:"342",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"number1",value:225},{name:"number2"}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"340",objOut:"342"}]}]},{objName:"Ops.Ui.VizGraph",id:"343",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Number 1"},{name:"Number 2"},{name:"Number 3",value:0},{name:"Number 4",value:0},{name:"Number 5",value:0},{name:"Number 6",value:0},{name:"Number 7",value:0},{name:"Number 8",value:0},{name:"Reset",value:0}],portsOut:[]},{objName:"Ops.Math.Floor",id:"344",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Number"}],portsOut:[{name:"Result",links:[{portIn:"Index",portOut:"Result",objIn:"364",objOut:"344"}]}]},{objName:"Ops.Gl.Matrix.Camera",id:"345",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render",value:null},{name:"projection mode index",value:0},{name:"projection mode",value:"prespective"},{name:"frustum near",value:.81},{name:"frustum far",value:4998.7},{name:"fov",value:3.21},{name:"Auto Aspect Ratio",value:true},{name:"Aspect Ratio",value:1.82},{name:"eye X",value:0},{name:"eye Y",value:0},{name:"eye Z",value:0},{name:"center X",value:.02},{name:"center Y",value:.01},{name:"center Z",value:.6},{name:"truck",value:0},{name:"boom",value:0},{name:"dolly",value:0},{name:"tilt",value:2.66},{name:"pan",value:17.38},{name:"roll",value:-17.03}],portsOut:[{name:"trigger",value:0},{name:"Aspect",value:0},{name:"Look At Array",links:[{portIn:"Scale Array",portOut:"Look At Array",objIn:"363",objOut:"345"}]}]},{objName:"Ops.Gl.ShaderEffects.VertexWobble_v2",id:"346",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"Source index",value:0},{name:"Source",value:"X * Y + Time"},{name:"amount",value:.017},{name:"Time"},{name:"Scale",value:26.53},{name:"axisX",value:true},{name:"axisY",value:true},{name:"axisZ",value:true},{name:"Range index",value:0},{name:"Range",value:"-1 to 1"},{name:"Area index",value:0},{name:"Area",value:"Axis Z"},{name:"Size",value:2.8},{name:"Falloff",value:0},{name:"x",value:0},{name:"y",value:0},{name:"z"},{name:"WorldSpace",value:true},{name:"Invert",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"351",objOut:"346"}]}]},{objName:"Ops.Ui.VizTexture",id:"347",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out"},{name:"Info",value:"640x320 8bit linear repeat"}]},{objName:"Ops.Gl.TextureEffects.Math.RgbMath",id:"348",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Render"},{name:"Operation index",value:3},{name:"Operation",value:"c-x"},{name:"R Active",value:true},{name:"G Active",value:false},{name:"B Active",value:true},{name:"A Active",value:false},{name:"r",value:.39},{name:"g",value:.31},{name:"b",value:1.38},{name:"a",value:1.74},{name:"Mask",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Execute",portOut:"trigger",objIn:"354",objOut:"348"}]}]},{objName:"Ops.Gl.Render2Texture",id:"349",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"use viewport size",value:false},{name:"texture width",value:640},{name:"texture height",value:320},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:true},{name:"Clear",value:true}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"350",objOut:"349"}]},{name:"texture",links:[{portIn:"Texture In",portOut:"texture",objIn:"347",objOut:"349"},{portIn:"AO Texture",portOut:"texture",objIn:"362",objOut:"349"}]},{name:"textureDepth"}]},{objName:"Ops.Gl.Shader.PointMaterial_v4",id:"350",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"PointSize",value:9.04},{name:"Size in Pixels",value:false},{name:"Random Size",value:0},{name:"Round",value:true},{name:"Round Antialias",value:false},{name:"Scale by Distance",value:true},{name:"r",value:.597},{name:"g"},{name:"b",value:.8200000000000001},{name:"a"},{name:"Vertex Colors",value:false},{name:"texture",value:0},{name:"Colorize Texture",value:false},{name:"Texture Mask",value:0},{name:"Mask Channel index",value:0},{name:"Mask Channel",value:"R"},{name:"Texture Colorize",value:0},{name:"Colorize Randomize",value:true},{name:"Texture Opacity",value:0},{name:"Texture Point Size",value:0},{name:"Point Size Channel index",value:0},{name:"Point Size Channel",value:"R"},{name:"Texture Point Size Mul",value:1},{name:"Map Size 0 index",value:0},{name:"Map Size 0",value:"Black"},{name:"Flip Texture",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"346",objOut:"350"}]},{name:"shader"}]},{objName:"Ops.Gl.Meshes.PointCloudFromTexture",id:"351",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"Num Points",value:1e4},{name:"Axis index",value:0},{name:"Axis",value:"XYZ"},{name:"Texture"},{name:"Point Size",value:null},{name:"Normalize",value:true},{name:"Remove Point at 0",value:false}],portsOut:[{name:"Trigger",value:0},{name:"Total Points",value:10201}]},{objName:"Ops.Anim.Timer_v2",id:"352",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Speed",value:1},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"number2",portOut:"Time",objIn:"342",objOut:"352"},{portIn:"Number",portOut:"Time",objIn:"344",objOut:"352"},{portIn:"Distance",portOut:"Time",objIn:"353",objOut:"352"}]}]},{objName:"Ops.Array.SplinePositionAtDistanceArray3",id:"353",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Calculate"},{name:"Array3x"},{name:"Distance"},{name:"Normalized",value:false}],portsOut:[{name:"Next",value:0},{name:"X",links:[{portIn:"A",portOut:"X",objIn:"368",objOut:"353"}]},{name:"Y",links:[{portIn:"B",portOut:"Y",objIn:"368",objOut:"353"}]},{name:"Z",links:[{portIn:"C",portOut:"Z",objIn:"368",objOut:"353"}]},{name:"Spline Length",value:225.35711329061215}]},{objName:"Ops.Gl.Textures.TextureToCoordinateGrid",id:"354",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Execute"},{name:"RGBE Texture"},{name:"Aspect",value:1},{name:"Threshold",value:.28}],portsOut:[{name:"Next",value:0},{name:"HDR Texture"}]},{objName:"Ops.Sequence",id:"355",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"358",objOut:"355"}]},{name:"trigger 1",links:[{portIn:"Render",portOut:"trigger 1",objIn:"356",objOut:"355"}]},{name:"trigger 2",links:[{portIn:"render",portOut:"trigger 2",objIn:"349",objOut:"355"}]},{name:"trigger 3",links:[{portIn:"render",portOut:"trigger 3",objIn:"318",objOut:"355"}]},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Gl.Meshes.GeometryToTexture_v2",id:"356",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Render"},{name:"Geometry"},{name:"Order index",value:0},{name:"Order",value:"Sequential"},{name:"Content index",value:0},{name:"Content",value:"Vertex Pos"},{name:"Size index",value:0},{name:"Size",value:"Auto"},{name:"Tex Width",value:256},{name:"filter index",value:0},{name:"filter",value:"nearest"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"}],portsOut:[{name:"Next",value:0},{name:"Total Vertices",value:10201},{name:"Texture",links:[{portIn:"Base Texture",portOut:"Texture",objIn:"357",objOut:"356"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"357",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Render"},{name:"Base Texture"},{name:"Size index",value:0},{name:"Size",value:"Auto"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 32bit float"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",links:[{portIn:"Render",portOut:"Next",objIn:"348",objOut:"357"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"351",objOut:"357"},{portIn:"RGBE Texture",portOut:"texture_out",objIn:"354",objOut:"357"}]},{name:"Aspect Ratio",value:1},{name:"Texture Width",value:101},{name:"Texture Height",value:101}]},{objName:"Ops.Gl.Meshes.ParametricSurface",id:"358",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"shapes index",value:0},{name:"shapes",value:"Spring"},{name:"render"},{name:"u Segments",value:100},{name:"v Segments",value:100},{name:"Multiple of PI - u",value:true},{name:"uMin",value:0},{name:"uMax",value:15},{name:"Displace U",value:0},{name:"Multiple of PI - v",value:true},{name:"vMin",value:0},{name:"vMax",value:2},{name:"Displace V",value:0},{name:"X Function",value:"(2 + 0.5*cos(v))*cos(u)"},{name:"Y Function",value:"(2 + 0.5*cos(v))*sin(u)"},{name:"Z Function",value:"0.5*(sin(v) + 2*u/PI)"},{name:"Scale X",value:.1},{name:"Scale Y",value:.1},{name:"Scale Z",value:.1},{name:"Draw",value:false}],portsOut:[{name:"trigger",value:0},{name:"geometry",links:[{portIn:"Geometry",portOut:"geometry",objIn:"356",objOut:"358"},{portIn:"geom",portOut:"geometry",objIn:"363",objOut:"358"}]},{name:"Position"},{name:"Position Amount",value:30603}]},{objName:"Ops.Math.Sine",id:"359",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"value"},{name:"phase",value:1.3},{name:"frequency",value:3},{name:"amplitude",value:21.17},{name:"asine",value:false}],portsOut:[{name:"result",links:[{portIn:"Number 1",portOut:"result",objIn:"343",objOut:"359"},{portIn:"phase",portOut:"result",objIn:"366",objOut:"359"}]}]},{objName:"Ops.Gl.Matrix.OrbitControls",id:"360",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"min distance",value:.05},{name:"max distance",value:99999},{name:"min rot y",value:0},{name:"max rot y",value:0},{name:"initial radius",value:.05},{name:"initial axis y",value:.5},{name:"initial axis x",value:.25},{name:"mul",value:1},{name:"Smoothness",value:1},{name:"Speed X",value:1},{name:"Speed Y",value:1},{name:"Active",value:true},{name:"Allow Panning",value:false},{name:"Allow Zooming",value:false},{name:"Allow Rotation",value:false},{name:"restricted",value:false},{name:"Reset",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Trigger In",portOut:"trigger",objIn:"362",objOut:"360"}]},{name:"radius",value:.05},{name:"Rot X",value:90},{name:"Rot Y",value:90}]},{objName:"Ops.Gl.Meshes.Cube_v2",id:"361",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Render"},{name:"Render Mesh",value:false},{name:"Width",value:.5},{name:"Length",value:.5},{name:"Height",value:.5},{name:"Center",value:true},{name:"Mapping index",value:0},{name:"Mapping",value:"Side"},{name:"Bias",value:0},{name:"Flip X",value:true},{name:"Top",value:true},{name:"Bottom",value:true},{name:"Left",value:true},{name:"Right",value:true},{name:"Front",value:true},{name:"Back",value:true}],portsOut:[{name:"Next",value:0},{name:"geometry"}]},{objName:"Ops.Gl.Phong.PhongMaterial_v6",id:"362",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Trigger In"},{name:"R",value:.23205729166666664},{name:"G",value:.44666666666666666},{name:"B",value:.3779916666666666},{name:"A",value:1},{name:"Enable",value:false},{name:"Albedo",value:.707},{name:"Roughness",value:.835},{name:"Active",value:true},{name:"Fresnel Intensity",value:.7},{name:"Fresnel Width",value:1},{name:"Fresnel Exponent",value:6},{name:"Fresnel R",value:.35229166666666667},{name:"Fresnel G",value:.5933333333333333},{name:"Fresnel B",value:.3522916666666668},{name:"Emissive Active",value:true},{name:"Color Intensity",value:.768},{name:"Emissive R",value:.3409798803071944},{name:"Emissive G",value:.38393490174798184},{name:"Emissive B",value:.498249370046403},{name:"Shininess",value:11.32},{name:"Specular Amount",value:.5},{name:"Specular Model index",value:0},{name:"Specular Model",value:"Phong"},{name:"Energy Conservation",value:false},{name:"Double Sided Material",value:false},{name:"Falloff Mode index",value:0},{name:"Falloff Mode",value:"A"},{name:"Diffuse Texture",value:0},{name:"Specular Texture",value:0},{name:"Normal Map",value:0},{name:"AO Texture"},{name:"Emissive Texture",value:0},{name:"Emissive Mask",value:0},{name:"Opacity Texture",value:0},{name:"Environment Map",value:0},{name:"Env Map Mask",value:0},{name:"Colorize Texture",value:false},{name:"Diffuse Repeat X",value:1},{name:"Diffuse Repeat Y",value:1},{name:"Texture Offset X",value:0},{name:"Texture Offset Y",value:0},{name:"Specular Intensity",value:1},{name:"Normal Map Intensity",value:.5},{name:"AO Intensity",value:1},{name:"Emissive Intensity",value:1},{name:"Emissive Mask Intensity",value:1},{name:"Env Map Intensity",value:1},{name:"Env Map Blend index",value:0},{name:"Env Map Blend",value:"Add"},{name:"Env Mask Intensity",value:1},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Discard Transparent Pixels",value:false}],portsOut:[{name:"Trigger Out",links:[{portIn:"exe",portOut:"Trigger Out",objIn:"363",objOut:"362"}]},{name:"Shader"}]},{objName:"Ops.Gl.MeshInstancer_v4",id:"363",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"exe"},{name:"geom"},{name:"Scale",value:.14},{name:"Limit Instances",value:true},{name:"Limit",value:100},{name:"positions"},{name:"Scale Array"},{name:"Rotations",value:0},{name:"Rotation Type index",value:0},{name:"Rotation Type",value:"Quaternions"},{name:"Material blend mode index",value:0},{name:"Material blend mode",value:"Normal"},{name:"Colors",value:0},{name:"TexCoords",value:0}],portsOut:[{name:"Trigger Out",value:0},{name:"Num",value:"exe"}]},{objName:"Ops.Array.Array3GetNumbers",id:"364",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Array"},{name:"Index"}],portsOut:[{name:"X",value:0},{name:"Y",value:1},{name:"Z",value:0}]},{objName:"Ops.Array.RandomNumbersArray3_v2",id:"365",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"numValues",value:15},{name:"Min",value:2},{name:"Max",value:26},{name:"random seed",value:.05},{name:"Last == First",value:true},{name:"Integer",value:true}],portsOut:[{name:"values",links:[{portIn:"Array3x",portOut:"values",objIn:"353",objOut:"365"}]},{name:"Total points",value:15},{name:"Array length",value:45}]},{objName:"Ops.Anim.SineAnim",id:"366",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"exe"},{name:"Mode index",value:0},{name:"Mode",value:"Sine"},{name:"phase"},{name:"frequency",value:.001},{name:"amplitude",value:100}],portsOut:[{name:"Trigger out",value:0},{name:"result",links:[{portIn:"Number 2",portOut:"result",objIn:"343",objOut:"366"},{portIn:"value",portOut:"result",objIn:"359",objOut:"366"}]}]},{objName:"Ops.Array.LoopArray3",id:"367",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Array in"}],portsOut:[{name:"Array out",links:[{portIn:"Rotations",portOut:"Array out",objIn:"334",objOut:"367"},{portIn:"Array",portOut:"Array out",objIn:"364",objOut:"367"},{portIn:"positions",portOut:"Array out",objIn:"363",objOut:"367"}]}]},{objName:"Ops.Array.LissajouseSpline",id:"368",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"Formula index",value:0},{name:"Formula",value:"1"},{name:"A"},{name:"B"},{name:"C"},{name:"D",value:2}],portsOut:[{name:"Result",links:[{portIn:"Array in",portOut:"Result",objIn:"367",objOut:"368"}]},{name:"Total points",value:330},{name:"Array length",value:990}]},{objName:"Ops.Gl.Render2Texture",id:"369",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"use viewport size",value:true},{name:"texture width",value:640},{name:"texture height",value:709},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:true},{name:"Clear",value:true}],portsOut:[{name:"trigger",links:[{portIn:"Trigger In",portOut:"trigger",objIn:"362",objOut:"369"}]},{name:"texture"},{name:"textureDepth"}]},{objName:"Ops.Sequence",id:"370",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"exe",portOut:"trigger 0",objIn:"366",objOut:"370"}]},{name:"trigger 1",links:[{portIn:"render",portOut:"trigger 1",objIn:"369",objOut:"370"}]},{name:"trigger 2",links:[{portIn:"Render",portOut:"trigger 2",objIn:"361",objOut:"370"}]},{name:"trigger 3",links:[{portIn:"exe",portOut:"trigger 3",objIn:"355",objOut:"370"}]},{name:"trigger 4",links:[{portIn:"Render",portOut:"trigger 4",objIn:"357",objOut:"370"}]},{name:"trigger 5",links:[{portIn:"Calculate",portOut:"trigger 5",objIn:"353",objOut:"370"}]},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Gl.Render2Texture",id:"371",uiAttribs:{subPatch:"954b8512-0457-4320-afa2-70f8f2db5690"},portsIn:[{name:"render"},{name:"use viewport size",value:true},{name:"texture width",value:640},{name:"texture height",value:709},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:true},{name:"Clear",value:true}],portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"317",objOut:"371"}]},{name:"texture",links:[{portIn:"out0 Ops.Gl.Render2Texture texture",portOut:"texture",objIn:"315",objOut:"371"}]},{name:"textureDepth"}]},{objName:"Ops.Ui.PatchInput",id:"372",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[],portsOut:[{name:"create port",value:0},{name:"in0 Ops.Gl.Render2Texture render",links:[{portIn:"render",portOut:"in0 Ops.Gl.Render2Texture render",objIn:"388",objOut:"372"}]}]},{objName:"Ops.Ui.PatchOutput",id:"373",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"create port",value:null},{name:"out0 Ops.Gl.Render2Texture texture"}],portsOut:[]},{objName:"Ops.Ui.SubPatch",id:"374",uiAttribs:{},portsIn:[{name:"create port",value:0},{name:"dataStr",value:'{"ports":[{"name":"in0 Ops.Gl.Render2Texture render","type":1}],"portsOut":[{"name":"out0 Ops.Gl.Render2Texture texture","type":2,"objType":"texture"}]}'},{name:"patchId",value:"2490b99c-8f17-4472-8f9e-57296a9291e4"},{name:"in0 Ops.Gl.Render2Texture render"}],portsOut:[{name:"create port out",value:0},{name:"out0 Ops.Gl.Render2Texture texture",links:[{portIn:"Base Texture",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"56",objOut:"374"},{portIn:"texture4",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"80",objOut:"374"},{portIn:"texture4",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"78",objOut:"374"},{portIn:"Texture In",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"310",objOut:"374"}]}]},{objName:"Ops.Gl.Meshes.Rectangle_v3",id:"375",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"render"},{name:"dorender",value:true},{name:"width",value:3.1},{name:"height",value:2},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Flip TexCoord X",value:false},{name:"Flip TexCoord Y",value:true},{name:"num columns",value:1},{name:"num rows",value:1}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"376",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI float iTime;\nUNI vec2 iResolution;\n\n/* Generated by Material Maker */\n\n/* Generated by Material Maker */\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n\n\n\nfloat dot2(vec2 x) {\n\treturn dot(x, x);\n}\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat m(vec4 a, vec4 b)\n{\n\treturn max(max(max(a.x,a.y),max(a.z,a.w)),max(max(b.x,b.y),max(b.z,b.w)));\n}\n\nvec4 fs(vec2 p,float s, float st, float sl, bool is_top)\n{\n\tsl = (1.0 - sl)/2.0; st /= 2.0;\n\tsl = clamp(sl, 0.0,1.0);\n\n\tp = 2.5*(1.0/s)*(p - 0.5)-vec2(0.0, is_top ? -0.5 : 0.5);\n\tvec2 p1 = p; vec2 p2 = p;\n\t\n\tp = abs(p)-0.5;\n\tvec4 d = vec4(min(st - abs(max(p.x, p.y) * -1.0),\n\t\tmin(-dot(p, normalize(vec2(1.0, 1.0))),\n\t\tabs(dot(p, normalize(vec2(1.0, -1.0))))) - sl));\n\n\tp1.x = abs(p1.x);\n\tp2.y = abs(p2.y);\n\n\tfloat q1 = -dot(p1,vec2(1.0,1.0));\n\tfloat q2 = -dot(p2,vec2(-1.0,1.0));\n\tfloat q3 = dot(p1,vec2(-1.0,1.0));\n\tfloat q4 = -dot(p2,vec2(1.0,1.0));\n\t\n\treturn min(d,vec4(q1,q2,q3,q4));\n}\n\nfloat ssd(vec2 p, float s, float st, float sl, float bevel, int num)\n{\n\tvec4 a = fs(p,s,st,sl,true);\n\tvec4 b = fs(p,s,st,sl,false);\n\t\n\tfloat d;\n\t\n\tvec4 x = vec4(0.0);\n\t\n\tif (num == 0) d = m(vec4(a.xyw,b.y),vec4(b.zw,x.xx));\n\tif (num == 1) d = m(vec4(a.y,b.y,x.xx),x);\n\tif (num == 2) d = m(vec4(a.xyz,b.w),vec4(b.z,x.xxx));\n\tif (num == 3) d = m(vec4(a.xyz,b.y),vec4(b.z,x.xxx));\n\tif (num == 4) d = m(vec4(a.yzw,b.y),x);\n\tif (num == 5) d = m(vec4(a.xwz,b.y),vec4(b.z,x.xxx));\n\tif (num == 6) d = m(vec4(a.xwz,b.y),vec4(b.zw,x.xx));\n\tif (num == 7) d = m(vec4(a.xy,b.y,x.x),x);\n\tif (num == 8) d = m(a,b);\n\tif (num == 9) d = m(a,vec4(b.yz,x.xx));\n\t\n\treturn clamp(d/max(bevel, 0.00001), 0.0, 1.0);\n}\n\nfloat ssd_multi(vec2 p, float s, float st, float sl, float bevel, int num, int digits, float spacing)\n{\n\tfloat v = 0.0;\n\twhile (num > 0 || digits > 0) {\n\t\tv = max(v, ssd(p, s, st, sl, bevel, num % 10));\n\t\tnum /= 10;\n\t\tp.x += (spacing+0.5)*s;\n\t\tdigits -= 1;\n\t}\n\treturn v;\n}\nvec2 rotate(vec2 uv, float rotate) {\n \tvec2 rv;\n\trv.x = cos(rotate)*uv.x + sin(rotate)*uv.y;\n\trv.y = -sin(rotate)*uv.x + cos(rotate)*uv.y;\n    return rv;\t\n}vec2 swirl_tile_false(vec2 uv, vec2 center, float radius, float angle) {\n\tvec2 v = uv-center;\n\tfloat l = length(v);\n\tif (l > radius) {\n\t\treturn uv;\n\t} else {\n\t\treturn rotate(v, angle*(1.0-l/radius)*(1.0-l/radius))+center;\n\t}\n}\n\nvec2 swirl_tile_true(vec2 uv, vec2 center, float radius, float angle) {\n\tcenter = fract(center);\n\tvec2 tile_offset = 2.0*(step(vec2(0.5), uv)-vec2(0.5));\n\tuv = swirl_tile_false(uv, center, radius, angle);\n\tuv = swirl_tile_false(uv, center+tile_offset, radius, angle);\n\tuv = swirl_tile_false(uv, center+vec2(tile_offset.x, 0.0), radius, angle);\n\treturn swirl_tile_false(uv, center+vec2(0.0, tile_offset.y), radius, angle);\n}\nvec2 scale(vec2 uv, vec2 center, vec2 scale) {\n\tuv -= center;\n\tuv /= scale;\n\tuv += center;\n    return uv;\n}const float p_o381186_cx = 0.000000000;\nconst float p_o381186_cy = 0.000000000;\nconst float p_o381186_scale_x = 0.600000024;\nconst float p_o381186_scale_y = 0.600000024;\nconst float p_o46838_cx = 0.000000000;\nconst float p_o46838_cy = 0.000000000;\nconst float p_o46838_radius = 0.500000000;\nconst float p_o19764_radius = 0.840000000;\nconst float p_o19764_repeat = 2.000000000;\nconst float p_o9152_st = 0.300000000;\nconst float p_o9152_sl = 1.000000000;\nconst float p_o9152_digits = 1.000000000;\nconst float p_o9152_bevel = 0.140000000;\nconst float p_o9152_spacing = 0.510000000;\n\n\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nfloat o9152_0_1_f = ssd_multi((vec2(fract(p_o19764_repeat*atan((swirl_tile_false((scale((UV), vec2(0.5+p_o381186_cx, 0.5+p_o381186_cy), vec2(p_o381186_scale_x, p_o381186_scale_y))), vec2(0.5+p_o46838_cx, 0.5+p_o46838_cy), p_o46838_radius, (100. *sin(iTime * 8.3))*0.01745329251)).y-0.5, (swirl_tile_false((scale((UV), vec2(0.5+p_o381186_cx, 0.5+p_o381186_cy), vec2(p_o381186_scale_x, p_o381186_scale_y))), vec2(0.5+p_o46838_cx, 0.5+p_o46838_cy), p_o46838_radius, (100. *sin(iTime * 8.3))*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o19764_radius*length((swirl_tile_false((scale((UV), vec2(0.5+p_o381186_cx, 0.5+p_o381186_cy), vec2(p_o381186_scale_x, p_o381186_scale_y))), vec2(0.5+p_o46838_cx, 0.5+p_o46838_cy), p_o46838_radius, (100. *sin(iTime * 8.3))*0.01745329251))-vec2(0.5))))), (2. *cos(iTime * 0.8) + 2.), p_o9152_st, p_o9152_sl, p_o9152_bevel*1.0, int((10. *cos(iTime * 0.4))), int(p_o9152_digits), p_o9152_spacing);\nvec4 o19764_0_1_rgba = vec4(vec3(o9152_0_1_f), 1.0);\nvec4 o46838_0_1_rgba = o19764_0_1_rgba;\nvec4 o381186_0_1_rgba = o46838_0_1_rgba;\ngl_FragColor = o381186_0_1_rgba;\n}"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iTime"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"377",objOut:"376"},{portIn:"render",portOut:"trigger",objIn:"375",objOut:"376"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"377",objOut:"376"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"377",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"repeat"},{name:"Floating Point",value:false},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",value:0},{name:"Texture",links:[{portIn:"Texture In",portOut:"Texture",objIn:"379",objOut:"377"}]},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Anim.Timer_v2",id:"378",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"Speed",value:-.54},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"val",portOut:"Time",objIn:"381",objOut:"378"}]}]},{objName:"Ops.Ui.VizTexture",id:"379",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out"},{name:"Info",value:"640x709 8bit linear repeat"}]},{objName:"Ops.Trigger.TriggerIfIncreased",id:"380",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"Value"}],portsOut:[{name:"Trigger",value:0}]},{objName:"Ops.Math.Clamp",id:"381",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"val"},{name:"min",value:-29.8},{name:"max",value:-1.8},{name:"ignore outside values",value:true}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"380",objOut:"381"},{portIn:"Value",portOut:"result",objIn:"383",objOut:"381"}]}]},{objName:"Ops.Trigger.TriggerCounterLoop",id:"382",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"trigger in"},{name:"reset",value:0},{name:"Loop min",value:-14},{name:"Loop max",value:-12.5}],portsOut:[{name:"trigger out",value:0},{name:"current count",value:-13}]},{objName:"Ops.Trigger.TriggerIfDecreased",id:"383",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"Value"}],portsOut:[{name:"Trigger",links:[{portIn:"Reset",portOut:"Trigger",objIn:"378",objOut:"383"},{portIn:"trigger in",portOut:"Trigger",objIn:"382",objOut:"383"}]}]},{objName:"Ops.Anim.InOutInAnim",id:"384",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"Update"},{name:"Duration Out",value:1.1},{name:"Easing Out index",value:0},{name:"Easing Out",value:"linear"},{name:"Value Out",value:-13},{name:"Hold duration",value:.7},{name:"Duration In",value:.02},{name:"Easing In index",value:0},{name:"Easing In",value:"absolute"},{name:"Value In",value:-11},{name:"Start"}],portsOut:[{name:"Next",value:0},{name:"Result",links:[{portIn:"iTime",portOut:"Result",objIn:"376",objOut:"384"}]},{name:"Started",value:0},{name:"Middle",value:0},{name:"finished",value:0}]},{objName:"Ops.Trigger.TriggersPerSecond",id:"385",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"exe"}],portsOut:[{name:"cps",links:[{portIn:"Value",portOut:"cps",objIn:"386",objOut:"385"}]}]},{objName:"Ops.Value.TriggerOnChangeNumber",id:"386",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"Value"}],portsOut:[{name:"Next",links:[{portIn:"Start",portOut:"Next",objIn:"384",objOut:"386"}]},{name:"Number",value:31}]},{objName:"Ops.Sequence",id:"387",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"376",objOut:"387"},{portIn:"Update",portOut:"trigger 0",objIn:"384",objOut:"387"},{portIn:"exe",portOut:"trigger 0",objIn:"385",objOut:"387"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Gl.Render2Texture",id:"388",uiAttribs:{subPatch:"2490b99c-8f17-4472-8f9e-57296a9291e4"},portsIn:[{name:"render"},{name:"use viewport size",value:true},{name:"texture width",value:640},{name:"texture height",value:709},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:true},{name:"Clear",value:true}],portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"387",objOut:"388"}]},{name:"texture",links:[{portIn:"out0 Ops.Gl.Render2Texture texture",portOut:"texture",objIn:"373",objOut:"388"}]},{name:"textureDepth"}]},{objName:"Ops.Ui.PatchInput",id:"389",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[],portsOut:[{name:"create port",value:0},{name:"in0 Ops.Gl.Render2Texture render",links:[{portIn:"render",portOut:"in0 Ops.Gl.Render2Texture render",objIn:"431",objOut:"389"}]}]},{objName:"Ops.Ui.PatchOutput",id:"390",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"create port",value:null},{name:"out0 Ops.Gl.Render2Texture texture"}],portsOut:[]},{objName:"Ops.Ui.SubPatch",id:"391",uiAttribs:{},portsIn:[{name:"create port",value:0},{name:"dataStr",value:'{"ports":[{"name":"in0 Ops.Gl.Render2Texture render","type":1}],"portsOut":[{"name":"out0 Ops.Gl.Render2Texture texture","type":2,"objType":"texture"}]}'},{name:"patchId",value:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},{name:"in0 Ops.Gl.Render2Texture render"}],portsOut:[{name:"create port out",value:0},{name:"out0 Ops.Gl.Render2Texture texture",links:[{portIn:"Base Texture",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"76",objOut:"391"},{portIn:"texture3",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"80",objOut:"391"},{portIn:"texture3",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"78",objOut:"391"},{portIn:"Texture In",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"311",objOut:"391"}]}]},{objName:"Ops.Sequence",id:"392",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"399",objOut:"392"},{portIn:"refresh",portOut:"trigger 0",objIn:"400",objOut:"392"},{portIn:"Update",portOut:"trigger 0",objIn:"405",objOut:"392"}]},{name:"trigger 1",links:[{portIn:"render",portOut:"trigger 1",objIn:"407",objOut:"392"}]},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",links:[{portIn:"render",portOut:"trigger 12",objIn:"394",objOut:"392"}]},{name:"trigger 13",value:0},{name:"trigger 14",links:[{portIn:"render",portOut:"trigger 14",objIn:"412",objOut:"392"}]},{name:"trigger 15",value:0}]},{objName:"Ops.Gl.TextureEffects.ColorMap",id:"393",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Gradient"},{name:"Method index",value:0},{name:"Method",value:"Luminance"},{name:"Min",value:0},{name:"Max",value:1},{name:"Position",value:.5}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.TextureEffects.ImageCompose",id:"394",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"use viewport size",value:true},{name:"width",value:640},{name:"height",value:709},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Background Alpha",value:1}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"395",objOut:"394"}]},{name:"texture_out",links:[{portIn:"texture",portOut:"texture_out",objIn:"412",objOut:"394"}]},{name:"Aspect Ratio",value:.9026798307475318}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v2",id:"395",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"image"},{name:"removeAlphaSrc",value:false},{name:"imageAlpha",value:0},{name:"alphaSrc index",value:0},{name:"alphaSrc",value:"alpha channel"},{name:"invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"393",objOut:"395"}]}]},{objName:"Ops.Sequence",id:"396",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"397",objOut:"396"}]},{name:"trigger 1",links:[{portIn:"render",portOut:"trigger 1",objIn:"411",objOut:"396"}]},{name:"trigger 2",links:[{portIn:"render",portOut:"trigger 2",objIn:"414",objOut:"396"}]},{name:"trigger 3",value:0},{name:"trigger 4",links:[{portIn:"render",portOut:"trigger 4",objIn:"418",objOut:"396"}]},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",links:[{portIn:"render",portOut:"trigger 7",objIn:"426",objOut:"396"}]},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Gl.Shader.BasicMaterial_v2",id:"397",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"r",value:0},{name:"g",value:1},{name:"b",value:0},{name:"a",value:1},{name:"texture",value:0},{name:"colorizeTexture",value:false},{name:"textureOpacity",value:0},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Opacity TexCoords Transform",value:false},{name:"Discard Transparent Pixels",value:false},{name:"diffuseRepeatX",value:1},{name:"diffuseRepeatY",value:1},{name:"Tex Offset X",value:0},{name:"Tex Offset Y",value:0},{name:"billboard",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"398",objOut:"397"}]},{name:"shader"}]},{objName:"Ops.Gl.Meshes.Circle",id:"398",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"radius",value:.2},{name:"innerRadius",value:.8},{name:"segments",value:30},{name:"percent",value:.783},{name:"steps",value:0},{name:"invertSteps",value:false},{name:"mapping index",value:0},{name:"mapping",value:"flat"},{name:"Spline",value:false},{name:"Draw",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Extension.ReactionDiffusion.ReactionDiffusionSystem",id:"399",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"reset",value:0},{name:"Use Viewport Size",value:false},{name:"Width",value:282},{name:"Height",value:430},{name:"speed",value:24},{name:"RD Mode index",value:0},{name:"RD Mode",value:"Coral"},{name:"feed",value:.07},{name:"kill",value:.062},{name:"delta",value:1},{name:"Ratio A",value:1},{name:"Ratio B",value:.475}],portsOut:[{name:"trigger",value:0},{name:"draw",links:[{portIn:"exe",portOut:"draw",objIn:"396",objOut:"399"}]},{name:"Texture",links:[{portIn:"image",portOut:"Texture",objIn:"395",objOut:"399"}]}]},{objName:"Ops.WebAudio.AudioAnalyzer",id:"400",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"refresh"},{name:"FFT size index",value:2},{name:"FFT size",value:"1024"},{name:"Audio In"},{name:"Data index",value:0},{name:"Data",value:"Frequency"}],portsOut:[{name:"Next",links:[{portIn:"refresh",portOut:"Next",objIn:"402",objOut:"400"}]},{name:"Audio Out"},{name:"average volume",links:[{portIn:"value",portOut:"average volume",objIn:"406",objOut:"400"}]},{name:"fft",links:[{portIn:"FFT Array",portOut:"fft",objIn:"402",objOut:"400"}]}]},{objName:"Ops.WebAudio.BiquadFilter",id:"401",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"Audio In"},{name:"type index",value:0},{name:"type",value:"bandpass"},{name:"frequency",value:3e3},{name:"detune",value:0},{name:"q",value:0},{name:"gain",value:1}],portsOut:[{name:"Audio Out",links:[{portIn:"Audio In",portOut:"Audio Out",objIn:"400",objOut:"401"}]}]},{objName:"Ops.WebAudio.FFTAreaAverage",id:"402",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"refresh"},{name:"FFT Array"},{name:"x",value:0},{name:"y",value:0},{name:"width",value:.2},{name:"height",value:.2},{name:"Create Texture",value:true}],portsOut:[{name:"texture_out"},{name:"value",value:0}]},{objName:"Ops.WebAudio.AudioBufferPlayer_v2",id:"403",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"Audio Buffer"},{name:"Start / Stop",value:true},{name:"Loop",value:true},{name:"Restart",value:null},{name:"Offset",value:0},{name:"Playback Rate",value:1},{name:"Detune",value:0}],portsOut:[{name:"Audio Out",links:[{portIn:"Audio In",portOut:"Audio Out",objIn:"401",objOut:"403"}]},{name:"Is Playing",value:true},{name:"Loading",value:false}]},{objName:"Ops.WebAudio.AudioBuffer_v2",id:"404",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"URL",value:"assets/613ba91b1d4a1267c2594baf_Hauptkonzerte_Audio_Loop.mp3",display:"file"},{name:"Create Loading Task",value:true}],portsOut:[{name:"Audio Buffer",links:[{portIn:"Audio Buffer",portOut:"Audio Buffer",objIn:"403",objOut:"404"}]},{name:"Finished Loading",value:1},{name:"Sample Rate",value:48e3},{name:"Length",value:1868160},{name:"Duration",value:38.92},{name:"Number of Channels",value:2},{name:"isLoading",value:false}]},{objName:"Ops.Anim.Smooth",id:"405",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"Update"},{name:"Separate inc/dec",value:true},{name:"Value"},{name:"Inc factor",value:1},{name:"Dec factor",value:2}],portsOut:[{name:"Next",value:0},{name:"Result",links:[{portIn:"scale",portOut:"Result",objIn:"420",objOut:"405"}]}]},{objName:"Ops.Math.MapRange",id:"406",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"value"},{name:"old min",value:0},{name:"old max",value:.3},{name:"new min",value:1},{name:"new max",value:2},{name:"Easing index",value:0},{name:"Easing",value:"Smoothstep"}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"405",objOut:"406"}]}]},{objName:"Ops.Gl.ClearColor",id:"407",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"r",value:1},{name:"g",value:1},{name:"b",value:1},{name:"a",value:1}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Meshes.Sphere_v2",id:"408",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"radius",value:.05},{name:"stacks",value:32},{name:"slices",value:32},{name:"Filloffset",value:1},{name:"Render",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.Matrix.Transform",id:"409",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"posX"},{name:"posY"},{name:"posZ",value:0},{name:"scale",value:2},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"408",objOut:"409"}]}]},{objName:"Ops.Devices.Mouse.Mouse_v2",id:"410",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"Active",value:true},{name:"relative",value:false},{name:"normalize",value:true},{name:"flip y",value:true},{name:"Area index",value:0},{name:"Area",value:"Canvas"},{name:"right click prevent default",value:true},{name:"Touch support",value:true},{name:"smooth",value:false},{name:"smoothSpeed",value:20},{name:"multiply",value:1}],portsOut:[{name:"x",links:[{portIn:"posX",portOut:"x",objIn:"409",objOut:"410"}]},{name:"y",links:[{portIn:"posY",portOut:"y",objIn:"409",objOut:"410"}]},{name:"button down",value:0},{name:"click",value:0},{name:"Button Up",value:0},{name:"click right",value:0},{name:"mouseOver",value:0},{name:"button",value:0}]},{objName:"Ops.Gl.Shader.BasicMaterial_v3",id:"411",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"r",value:.304},{name:"g",value:0},{name:"b",value:0},{name:"a",value:1},{name:"texture",value:0},{name:"colorizeTexture",value:false},{name:"Vertex Colors",value:false},{name:"textureOpacity",value:0},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Opacity TexCoords Transform",value:false},{name:"Discard Transparent Pixels",value:false},{name:"diffuseRepeatX",value:1},{name:"diffuseRepeatY",value:1},{name:"Tex Offset X",value:0},{name:"Tex Offset Y",value:0},{name:"Crop TexCoords",value:false},{name:"billboard",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"409",objOut:"411"}]},{name:"shader"}]},{objName:"Ops.Gl.Shader.BasicMaterial_v3",id:"412",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"r",value:.3211330721431622},{name:"g",value:.6812374016994915},{name:"b",value:.4309558063022263},{name:"a",value:1},{name:"texture"},{name:"colorizeTexture",value:false},{name:"Vertex Colors",value:false},{name:"textureOpacity",value:0},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Opacity TexCoords Transform",value:false},{name:"Discard Transparent Pixels",value:false},{name:"diffuseRepeatX",value:1},{name:"diffuseRepeatY",value:1},{name:"Tex Offset X",value:0},{name:"Tex Offset Y",value:0},{name:"Crop TexCoords",value:false},{name:"billboard",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"413",objOut:"412"}]},{name:"shader"}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"413",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture",value:0}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.Shader.BasicMaterial_v3",id:"414",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"r",value:.04926979200222337},{name:"g",value:0},{name:"b",value:.07138542860453989},{name:"a",value:1},{name:"texture"},{name:"colorizeTexture",value:false},{name:"Vertex Colors",value:false},{name:"textureOpacity",value:0},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Opacity TexCoords Transform",value:false},{name:"Discard Transparent Pixels",value:false},{name:"diffuseRepeatX",value:1},{name:"diffuseRepeatY",value:1},{name:"Tex Offset X",value:0},{name:"Tex Offset Y",value:0},{name:"Crop TexCoords",value:false},{name:"billboard",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"417",objOut:"414"}]},{name:"shader"}]},{objName:"Ops.Gl.Meshes.Rectangle_v2",id:"415",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"width",value:1},{name:"height",value:1},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"num columns",value:1},{name:"num rows",value:1},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Active",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.Texture_v2",id:"416",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"File",value:"assets/613ba91b1d4a1267c2594baf_Element_4@38x.png",display:"file"},{name:"Filter index",value:0},{name:"Filter",value:"mipmap"},{name:"Wrap index",value:2},{name:"Wrap",value:"repeat"},{name:"Anisotropic index",value:0},{name:"Anisotropic",value:0},{name:"Flip",value:false},{name:"Pre Multiplied Alpha",value:false},{name:"Active",value:true},{name:"Save Memory",value:true}],portsOut:[{name:"Texture",links:[{portIn:"texture",portOut:"Texture",objIn:"414",objOut:"416"}]},{name:"Width",value:578},{name:"Height",value:807},{name:"Aspect Ratio",value:.7162329615861215},{name:"Loaded",value:true},{name:"Loading",value:false}]},{objName:"Ops.Gl.Matrix.Transform",id:"417",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"posX",value:-.68},{name:"posY",value:.72},{name:"posZ",value:0},{name:"scale",value:.75},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"415",objOut:"417"}]}]},{objName:"Ops.Gl.Shader.BasicMaterial_v3",id:"418",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"r",value:0},{name:"g",value:.044},{name:"b",value:0},{name:"a",value:1},{name:"texture",value:0},{name:"colorizeTexture",value:false},{name:"Vertex Colors",value:false},{name:"textureOpacity",value:0},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Opacity TexCoords Transform",value:false},{name:"Discard Transparent Pixels",value:false},{name:"diffuseRepeatX",value:1},{name:"diffuseRepeatY",value:1},{name:"Tex Offset X",value:0},{name:"Tex Offset Y",value:0},{name:"Crop TexCoords",value:false},{name:"billboard",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"420",objOut:"418"}]},{name:"shader"}]},{objName:"Ops.Gl.Meshes.Circle",id:"419",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"radius",value:.2},{name:"innerRadius",value:0},{name:"segments",value:40},{name:"percent",value:1},{name:"steps",value:0},{name:"invertSteps",value:false},{name:"mapping index",value:0},{name:"mapping",value:"flat"},{name:"Spline",value:false},{name:"Draw",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.Matrix.Transform",id:"420",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"posX",value:0},{name:"posY",value:0},{name:"posZ",value:0},{name:"scale"},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"419",objOut:"420"}]}]},{objName:"Ops.Gl.ForceCanvasSize",id:"421",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"Trigger"},{name:"Active",value:false},{name:"Force index",value:0},{name:"Force",value:"Aspect Ratio"},{name:"Center In Parent",value:false},{name:"Scale to fit Parent",value:true},{name:"Set Width",value:300},{name:"Set Height",value:200},{name:"Aspect Ratio index",value:2},{name:"Aspect Ratio",value:"1:1"},{name:"Ratio",value:1},{name:"Fill Parent index",value:0},{name:"Fill Parent",value:"Auto"}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"392",objOut:"421"}]},{name:"Width",value:548},{name:"Height",value:548},{name:"Margin Left",value:0},{name:"Margin Top",value:0}]},{objName:"Ops.Gl.GradientTexture",id:"422",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":0,"g":0,"b":0},{"pos":0.268,"r":0,"g":0,"b":0},{"pos":0.31,"r":1,"g":1,"b":1},{"pos":1,"r":1,"g":1,"b":1}]}'},{name:"Direction index",value:0},{name:"Direction",value:"X"},{name:"Smoothstep",value:false},{name:"Step",value:false},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:256},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Gradient Array",value:0},{name:"Randomize Colors",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Image",portOut:"Texture",objIn:"424",objOut:"422"}]},{name:"Colors"},{name:"Colors Pos"}]},{objName:"Ops.Gl.TextureEffects.ImageCompose",id:"423",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"use viewport size",value:false},{name:"width",value:100},{name:"height",value:1},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Background Alpha",value:1}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"424",objOut:"423"}]},{name:"texture_out",links:[{portIn:"Gradient",portOut:"texture_out",objIn:"393",objOut:"423"}]},{name:"Aspect Ratio",value:100}]},{objName:"Ops.Gl.TextureEffects.DrawImage_v3",id:"424",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Image"},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask",value:0},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Trigger.TriggerOnce",id:"425",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"Exec"},{name:"Reset",value:0}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"423",objOut:"425"}]},{name:"Was Triggered",value:1}]},{objName:"Ops.Gl.Shader.BasicMaterial_v3",id:"426",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"r",value:.04926979200222337},{name:"g",value:0},{name:"b",value:.07138542860453989},{name:"a",value:1},{name:"texture"},{name:"colorizeTexture",value:false},{name:"Vertex Colors",value:false},{name:"textureOpacity",value:0},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Opacity TexCoords Transform",value:false},{name:"Discard Transparent Pixels",value:false},{name:"diffuseRepeatX",value:1},{name:"diffuseRepeatY",value:1},{name:"Tex Offset X",value:0},{name:"Tex Offset Y",value:0},{name:"Crop TexCoords",value:false},{name:"billboard",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"429",objOut:"426"}]},{name:"shader"}]},{objName:"Ops.Gl.Meshes.Rectangle_v2",id:"427",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"width",value:1},{name:"height",value:1},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"num columns",value:1},{name:"num rows",value:1},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Active",value:true}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.Texture_v2",id:"428",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"File",value:"assets/613ba91b1d4a1267c2594baf_Element_222x.png",display:"file"},{name:"Filter index",value:0},{name:"Filter",value:"mipmap"},{name:"Wrap index",value:2},{name:"Wrap",value:"repeat"},{name:"Anisotropic index",value:0},{name:"Anisotropic",value:0},{name:"Flip",value:false},{name:"Pre Multiplied Alpha",value:false},{name:"Active",value:true},{name:"Save Memory",value:true}],portsOut:[{name:"Texture",links:[{portIn:"texture",portOut:"Texture",objIn:"426",objOut:"428"}]},{name:"Width",value:439},{name:"Height",value:415},{name:"Aspect Ratio",value:1.0578313253012048},{name:"Loaded",value:true},{name:"Loading",value:false}]},{objName:"Ops.Gl.Matrix.Transform",id:"429",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"posX",value:.79},{name:"posY",value:-.9},{name:"posZ",value:0},{name:"scale",value:.46},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"427",objOut:"429"}]}]},{objName:"Ops.Sequence",id:"430",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"Trigger",portOut:"trigger 0",objIn:"421",objOut:"430"},{portIn:"Exec",portOut:"trigger 0",objIn:"425",objOut:"430"}]},{name:"trigger 1",value:0},{name:"trigger 2",value:0},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",value:0},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",value:0},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",value:0}]},{objName:"Ops.Gl.Render2Texture",id:"431",uiAttribs:{subPatch:"56c12324-55dc-41e0-8ed9-b8958c6eb439"},portsIn:[{name:"render"},{name:"use viewport size",value:true},{name:"texture width",value:640},{name:"texture height",value:709},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:true},{name:"Clear",value:true}],portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"430",objOut:"431"}]},{name:"texture",links:[{portIn:"out0 Ops.Gl.Render2Texture texture",portOut:"texture",objIn:"390",objOut:"431"}]},{name:"textureDepth"}]},{objName:"Ops.Ui.PatchInput",id:"432",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[],portsOut:[{name:"create port",value:0},{name:"in0 Ops.Gl.Render2Texture render",links:[{portIn:"render",portOut:"in0 Ops.Gl.Render2Texture render",objIn:"477",objOut:"432"}]}]},{objName:"Ops.Ui.PatchOutput",id:"433",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"create port",value:null},{name:"out0 Ops.Gl.Render2Texture texture"}],portsOut:[]},{objName:"Ops.Ui.SubPatch",id:"434",uiAttribs:{},portsIn:[{name:"create port",value:0},{name:"dataStr",value:'{"ports":[{"name":"in0 Ops.Gl.Render2Texture render","type":1}],"portsOut":[{"name":"out0 Ops.Gl.Render2Texture texture","type":2,"objType":"texture"}]}'},{name:"patchId",value:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},{name:"in0 Ops.Gl.Render2Texture render"}],portsOut:[{name:"create port out",value:0},{name:"out0 Ops.Gl.Render2Texture texture",links:[{portIn:"Base Texture",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"304",objOut:"434"},{portIn:"texture1",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"80",objOut:"434"},{portIn:"texture1",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"78",objOut:"434"},{portIn:"Texture In",portOut:"out0 Ops.Gl.Render2Texture texture",objIn:"303",objOut:"434"}]}]},{objName:"Ops.Gl.Meshes.Rectangle_v3",id:"435",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"dorender",value:false},{name:"width",value:3.1},{name:"height",value:2},{name:"pivot x index",value:0},{name:"pivot x",value:"center"},{name:"pivot y index",value:0},{name:"pivot y",value:"center"},{name:"axis index",value:0},{name:"axis",value:"xy"},{name:"Flip TexCoord X",value:false},{name:"Flip TexCoord Y",value:true},{name:"num columns",value:1},{name:"num rows",value:1}],portsOut:[{name:"trigger",value:0},{name:"geometry"}]},{objName:"Ops.Gl.Shader.CustomShader_v2",id:"436",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"Fragment Code",value:"UNI float iTime;\nUNI vec2 iResolution;\n\n/* Generated by Material Maker */\n\n#define SEED_VARIATION 0.0\n\n\n\n\nfloat dot2(vec2 x) {\n\treturn dot(x, x);\n}\n\nfloat rand(vec2 x) {\n    return fract(cos(mod(dot(x, vec2(13.9898, 8.141)), 3.14)) * 43758.5453);\n}\n\nvec2 rand2(vec2 x) {\n    return fract(cos(mod(vec2(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t      dot(x, vec2(3.4562, 17.398))), vec2(3.14))) * 43758.5453);\n}\n\nvec3 rand3(vec2 x) {\n    return fract(cos(mod(vec3(dot(x, vec2(13.9898, 8.141)),\n\t\t\t\t\t\t\t  dot(x, vec2(3.4562, 17.398)),\n                              dot(x, vec2(13.254, 5.867))), vec3(3.14))) * 43758.5453);\n}\n\nvec3 rgb2hsv(vec3 c) {\n\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n\tfloat d = q.x - min(q.w, q.y);\n\tfloat e = 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat param_rnd(float minimum, float maximum, float seed) {\n\treturn minimum+(maximum-minimum)*rand(vec2(seed));\n}\nfloat value_noise_2d(vec2 coord, vec2 size, float offset, float seed) {\n\tvec2 o = floor(coord)+rand2(vec2(seed, 1.0-seed))+size;\n\tvec2 f = fract(coord);\n\tfloat p00 = rand(mod(o, size));\n\tfloat p01 = rand(mod(o + vec2(0.0, 1.0), size));\n\tfloat p10 = rand(mod(o + vec2(1.0, 0.0), size));\n\tfloat p11 = rand(mod(o + vec2(1.0, 1.0), size));\n\tp00 = sin(p00 * 6.28318530718 + offset * 6.28318530718) / 2.0 + 0.5;\n\tp01 = sin(p01 * 6.28318530718 + offset * 6.28318530718) / 2.0 + 0.5;\n\tp10 = sin(p10 * 6.28318530718 + offset * 6.28318530718) / 2.0 + 0.5;\n\tp11 = sin(p11 * 6.28318530718 + offset * 6.28318530718) / 2.0 + 0.5;\n\tvec2 t =  f * f * f * (f * (f * 6.0 - 15.0) + 10.0);\n\treturn mix(mix(p00, p10, t.x), mix(p01, p11, t.x), t.y);\n}\n\nfloat fbm_2d_value(vec2 coord, vec2 size, int folds, int octaves, float persistence, float offset, float seed) {\n\tfloat normalize_factor = 0.0;\n\tfloat value = 0.0;\n\tfloat scale = 1.0;\n\tfor (int i = 0; i < octaves; i++) {\n\t\tfloat noise = value_noise_2d(coord*size, size, offset, seed);\n\t\tfor (int f = 0; f < folds; ++f) {\n\t\t\tnoise = abs(2.0*noise-1.0);\n\t\t}\n\t\tvalue += noise * scale;\n\t\tnormalize_factor += scale;\n\t\tsize *= 2.0;\n\t\tscale *= persistence;\n\t}\n\treturn value / normalize_factor;\n}\n\nfloat perlin_noise_2d(vec2 coord, vec2 size, float offset, float seed) {\n\tvec2 o = floor(coord)+rand2(vec2(seed, 1.0-seed))+size;\n\tvec2 f = fract(coord);\n\tfloat a00 = rand(mod(o, size)) * 6.28318530718 + offset * 6.28318530718;\n\tfloat a01 = rand(mod(o + vec2(0.0, 1.0), size)) * 6.28318530718 + offset * 6.28318530718;\n\tfloat a10 = rand(mod(o + vec2(1.0, 0.0), size)) * 6.28318530718 + offset * 6.28318530718;\n\tfloat a11 = rand(mod(o + vec2(1.0, 1.0), size)) * 6.28318530718 + offset * 6.28318530718;\n\tvec2 v00 = vec2(cos(a00), sin(a00));\n\tvec2 v01 = vec2(cos(a01), sin(a01));\n\tvec2 v10 = vec2(cos(a10), sin(a10));\n\tvec2 v11 = vec2(cos(a11), sin(a11));\n\tfloat p00 = dot(v00, f);\n\tfloat p01 = dot(v01, f - vec2(0.0, 1.0));\n\tfloat p10 = dot(v10, f - vec2(1.0, 0.0));\n\tfloat p11 = dot(v11, f - vec2(1.0, 1.0));\n\tvec2 t =  f * f * f * (f * (f * 6.0 - 15.0) + 10.0);\n\treturn 0.5 + mix(mix(p00, p10, t.x), mix(p01, p11, t.x), t.y);\n}\n\nfloat fbm_2d_perlin(vec2 coord, vec2 size, int folds, int octaves, float persistence, float offset, float seed) {\n\tfloat normalize_factor = 0.0;\n\tfloat value = 0.0;\n\tfloat scale = 1.0;\n\tfor (int i = 0; i < octaves; i++) {\n\t\tfloat noise = perlin_noise_2d(coord*size, size, offset, seed);\n\t\tfor (int f = 0; f < folds; ++f) {\n\t\t\tnoise = abs(2.0*noise-1.0);\n\t\t}\n\t\tvalue += noise * scale;\n\t\tnormalize_factor += scale;\n\t\tsize *= 2.0;\n\t\tscale *= persistence;\n\t}\n\treturn value / normalize_factor;\n}\n\nfloat perlinabs_noise_2d(vec2 coord, vec2 size, float offset, float seed) {\n\treturn abs(2.0*perlin_noise_2d(coord, size, offset, seed)-1.0);\n}\n\nfloat fbm_2d_perlinabs(vec2 coord, vec2 size, int folds, int octaves, float persistence, float offset, float seed) {\n\tfloat normalize_factor = 0.0;\n\tfloat value = 0.0;\n\tfloat scale = 1.0;\n\tfor (int i = 0; i < octaves; i++) {\n\t\tfloat noise = perlinabs_noise_2d(coord*size, size, offset, seed);\n\t\tfor (int f = 0; f < folds; ++f) {\n\t\t\tnoise = abs(2.0*noise-1.0);\n\t\t}\n\t\tvalue += noise * scale;\n\t\tnormalize_factor += scale;\n\t\tsize *= 2.0;\n\t\tscale *= persistence;\n\t}\n\treturn value / normalize_factor;\n}\n\nfloat fbm_2d_mod289(float x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nfloat fbm_2d_permute(float x) {\n    return fbm_2d_mod289(((x * 34.0) + 1.0) * x);\n}\n\nvec2 fbm_2d_rgrad2(vec2 p, float rot, float seed) {\n\tfloat u = fbm_2d_permute(fbm_2d_permute(p.x) + p.y) * 0.0243902439 + rot; // Rotate by shift\n\tu = fract(u) * 6.28318530718; // 2*pi\n\treturn vec2(cos(u), sin(u));\n}\n\nfloat simplex_noise_2d(vec2 coord, vec2 size, float offset, float seed) {\n\tcoord *= 2.0; // needed for it to tile\n\tcoord += rand2(vec2(seed, 1.0-seed)) + size;\n\tsize *= 2.0; // needed for it to tile\n\tcoord.y += 0.001;\n    vec2 uv = vec2(coord.x + coord.y*0.5, coord.y);\n    vec2 i0 = floor(uv);\n    vec2 f0 = fract(uv);\n    vec2 i1 = (f0.x > f0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n    vec2 p0 = vec2(i0.x - i0.y * 0.5, i0.y);\n    vec2 p1 = vec2(p0.x + i1.x - i1.y * 0.5, p0.y + i1.y);\n    vec2 p2 = vec2(p0.x + 0.5, p0.y + 1.0);\n    i1 = i0 + i1;\n    vec2 i2 = i0 + vec2(1.0, 1.0);\n    vec2 d0 = coord - p0;\n    vec2 d1 = coord - p1;\n    vec2 d2 = coord - p2;\n    vec3 xw = mod(vec3(p0.x, p1.x, p2.x), size.x);\n    vec3 yw = mod(vec3(p0.y, p1.y, p2.y), size.y);\n    vec3 iuw = xw + 0.5 * yw;\n    vec3 ivw = yw;\n    vec2 g0 = fbm_2d_rgrad2(vec2(iuw.x, ivw.x), offset, seed);\n    vec2 g1 = fbm_2d_rgrad2(vec2(iuw.y, ivw.y), offset, seed);\n    vec2 g2 = fbm_2d_rgrad2(vec2(iuw.z, ivw.z), offset, seed);\n    vec3 w = vec3(dot(g0, d0), dot(g1, d1), dot(g2, d2));\n    vec3 t = 0.8 - vec3(dot(d0, d0), dot(d1, d1), dot(d2, d2));\n    t = max(t, vec3(0.0));\n    vec3 t2 = t * t;\n    vec3 t4 = t2 * t2;\n    float n = dot(t4, w);\n    return 0.5 + 5.5 * n;\n}\n\nfloat fbm_2d_simplex(vec2 coord, vec2 size, int folds, int octaves, float persistence, float offset, float seed) {\n\tfloat normalize_factor = 0.0;\n\tfloat value = 0.0;\n\tfloat scale = 1.0;\n\tfor (int i = 0; i < octaves; i++) {\n\t\tfloat noise = simplex_noise_2d(coord*size, size, offset, seed);\n\t\tfor (int f = 0; f < folds; ++f) {\n\t\t\tnoise = abs(2.0*noise-1.0);\n\t\t}\n\t\tvalue += noise * scale;\n\t\tnormalize_factor += scale;\n\t\tsize *= 2.0;\n\t\tscale *= persistence;\n\t}\n\treturn value / normalize_factor;\n}\n\nfloat cellular_noise_2d(vec2 coord, vec2 size, float offset, float seed) {\n\tvec2 o = floor(coord)+rand2(vec2(seed, 1.0-seed))+size;\n\tvec2 f = fract(coord);\n\tfloat min_dist = 2.0;\n\tfor(float x = -1.0; x <= 1.0; x++) {\n\t\tfor(float y = -1.0; y <= 1.0; y++) {\n\t\t\tvec2 neighbor = vec2(float(x),float(y));\n\t\t\tvec2 node = rand2(mod(o + vec2(x, y), size)) + vec2(x, y);\n\t\t\tnode =  0.5 + 0.25 * sin(offset * 6.28318530718 + 6.28318530718 * node);\n\t\t\tvec2 diff = neighbor + node - f;\n\t\t\tfloat dist = length(diff);\n\t\t\tmin_dist = min(min_dist, dist);\n\t\t}\n\t}\n\treturn min_dist;\n}\n\nfloat fbm_2d_cellular(vec2 coord, vec2 size, int folds, int octaves, float persistence, float offset, float seed) {\n\tfloat normalize_factor = 0.0;\n\tfloat value = 0.0;\n\tfloat scale = 1.0;\n\tfor (int i = 0; i < octaves; i++) {\n\t\tfloat noise = cellular_noise_2d(coord*size, size, offset, seed);\n\t\tfor (int f = 0; f < folds; ++f) {\n\t\t\tnoise = abs(2.0*noise-1.0);\n\t\t}\n\t\tvalue += noise * scale;\n\t\tnormalize_factor += scale;\n\t\tsize *= 2.0;\n\t\tscale *= persistence;\n\t}\n\treturn value / normalize_factor;\n}\n\nfloat cellular2_noise_2d(vec2 coord, vec2 size, float offset, float seed) {\n\tvec2 o = floor(coord)+rand2(vec2(seed, 1.0-seed))+size;\n\tvec2 f = fract(coord);\n\tfloat min_dist1 = 2.0;\n\tfloat min_dist2 = 2.0;\n\tfor(float x = -1.0; x <= 1.0; x++) {\n\t\tfor(float y = -1.0; y <= 1.0; y++) {\n\t\t\tvec2 neighbor = vec2(float(x),float(y));\n\t\t\tvec2 node = rand2(mod(o + vec2(x, y), size)) + vec2(x, y);\n\t\t\tnode = 0.5 + 0.25 * sin(offset * 6.28318530718 + 6.28318530718*node);\n\t\t\tvec2 diff = neighbor + node - f;\n\t\t\tfloat dist = length(diff);\n\t\t\tif (min_dist1 > dist) {\n\t\t\t\tmin_dist2 = min_dist1;\n\t\t\t\tmin_dist1 = dist;\n\t\t\t} else if (min_dist2 > dist) {\n\t\t\t\tmin_dist2 = dist;\n\t\t\t}\n\t\t}\n\t}\n\treturn min_dist2-min_dist1;\n}\n\nfloat fbm_2d_cellular2(vec2 coord, vec2 size, int folds, int octaves, float persistence, float offset, float seed) {\n\tfloat normalize_factor = 0.0;\n\tfloat value = 0.0;\n\tfloat scale = 1.0;\n\tfor (int i = 0; i < octaves; i++) {\n\t\tfloat noise = cellular2_noise_2d(coord*size, size, offset, seed);\n\t\tfor (int f = 0; f < folds; ++f) {\n\t\t\tnoise = abs(2.0*noise-1.0);\n\t\t}\n\t\tvalue += noise * scale;\n\t\tnormalize_factor += scale;\n\t\tsize *= 2.0;\n\t\tscale *= persistence;\n\t}\n\treturn value / normalize_factor;\n}\n\nfloat cellular3_noise_2d(vec2 coord, vec2 size, float offset, float seed) {\n\tvec2 o = floor(coord)+rand2(vec2(seed, 1.0-seed))+size;\n\tvec2 f = fract(coord);\n\tfloat min_dist = 2.0;\n\tfor(float x = -1.0; x <= 1.0; x++) {\n\t\tfor(float y = -1.0; y <= 1.0; y++) {\n\t\t\tvec2 neighbor = vec2(float(x),float(y));\n\t\t\tvec2 node = rand2(mod(o + vec2(x, y), size)) + vec2(x, y);\n\t\t\tnode = 0.5 + 0.25 * sin(offset * 6.28318530718 + 6.28318530718*node);\n\t\t\tvec2 diff = neighbor + node - f;\n\t\t\tfloat dist = abs((diff).x) + abs((diff).y);\n\t\t\tmin_dist = min(min_dist, dist);\n\t\t}\n\t}\n\treturn min_dist;\n}\n\nfloat fbm_2d_cellular3(vec2 coord, vec2 size, int folds, int octaves, float persistence, float offset, float seed) {\n\tfloat normalize_factor = 0.0;\n\tfloat value = 0.0;\n\tfloat scale = 1.0;\n\tfor (int i = 0; i < octaves; i++) {\n\t\tfloat noise = cellular3_noise_2d(coord*size, size, offset, seed);\n\t\tfor (int f = 0; f < folds; ++f) {\n\t\t\tnoise = abs(2.0*noise-1.0);\n\t\t}\n\t\tvalue += noise * scale;\n\t\tnormalize_factor += scale;\n\t\tsize *= 2.0;\n\t\tscale *= persistence;\n\t}\n\treturn value / normalize_factor;\n}\n\nfloat cellular4_noise_2d(vec2 coord, vec2 size, float offset, float seed) {\n\tvec2 o = floor(coord)+rand2(vec2(seed, 1.0-seed))+size;\n\tvec2 f = fract(coord);\n\tfloat min_dist1 = 2.0;\n\tfloat min_dist2 = 2.0;\n\tfor(float x = -1.0; x <= 1.0; x++) {\n\t\tfor(float y = -1.0; y <= 1.0; y++) {\n\t\t\tvec2 neighbor = vec2(float(x),float(y));\n\t\t\tvec2 node = rand2(mod(o + vec2(x, y), size)) + vec2(x, y);\n\t\t\tnode = 0.5 + 0.25 * sin(offset * 6.28318530718 + 6.28318530718*node);\n\t\t\tvec2 diff = neighbor + node - f;\n\t\t\tfloat dist = abs((diff).x) + abs((diff).y);\n\t\t\tif (min_dist1 > dist) {\n\t\t\t\tmin_dist2 = min_dist1;\n\t\t\t\tmin_dist1 = dist;\n\t\t\t} else if (min_dist2 > dist) {\n\t\t\t\tmin_dist2 = dist;\n\t\t\t}\n\t\t}\n\t}\n\treturn min_dist2-min_dist1;\n}\n\nfloat fbm_2d_cellular4(vec2 coord, vec2 size, int folds, int octaves, float persistence, float offset, float seed) {\n\tfloat normalize_factor = 0.0;\n\tfloat value = 0.0;\n\tfloat scale = 1.0;\n\tfor (int i = 0; i < octaves; i++) {\n\t\tfloat noise = cellular4_noise_2d(coord*size, size, offset, seed);\n\t\tfor (int f = 0; f < folds; ++f) {\n\t\t\tnoise = abs(2.0*noise-1.0);\n\t\t}\n\t\tvalue += noise * scale;\n\t\tnormalize_factor += scale;\n\t\tsize *= 2.0;\n\t\tscale *= persistence;\n\t}\n\treturn value / normalize_factor;\n}\n\nfloat cellular5_noise_2d(vec2 coord, vec2 size, float offset, float seed) {\n\tvec2 o = floor(coord)+rand2(vec2(seed, 1.0-seed))+size;\n\tvec2 f = fract(coord);\n\tfloat min_dist = 2.0;\n\tfor(float x = -1.0; x <= 1.0; x++) {\n\t\tfor(float y = -1.0; y <= 1.0; y++) {\n\t\t\tvec2 neighbor = vec2(float(x),float(y));\n\t\t\tvec2 node = rand2(mod(o + vec2(x, y), size)) + vec2(x, y);\n\t\t\tnode = 0.5 + 0.5 * sin(offset * 6.28318530718 + 6.28318530718*node);\n\t\t\tvec2 diff = neighbor + node - f;\n\t\t\tfloat dist = max(abs((diff).x), abs((diff).y));\n\t\t\tmin_dist = min(min_dist, dist);\n\t\t}\n\t}\n\treturn min_dist;\n}\n\nfloat fbm_2d_cellular5(vec2 coord, vec2 size, int folds, int octaves, float persistence, float offset, float seed) {\n\tfloat normalize_factor = 0.0;\n\tfloat value = 0.0;\n\tfloat scale = 1.0;\n\tfor (int i = 0; i < octaves; i++) {\n\t\tfloat noise = cellular5_noise_2d(coord*size, size, offset, seed);\n\t\tfor (int f = 0; f < folds; ++f) {\n\t\t\tnoise = abs(2.0*noise-1.0);\n\t\t}\n\t\tvalue += noise * scale;\n\t\tnormalize_factor += scale;\n\t\tsize *= 2.0;\n\t\tscale *= persistence;\n\t}\n\treturn value / normalize_factor;\n}\n\nfloat cellular6_noise_2d(vec2 coord, vec2 size, float offset, float seed) {\n\tvec2 o = floor(coord)+rand2(vec2(seed, 1.0-seed))+size;\n\tvec2 f = fract(coord);\n\tfloat min_dist1 = 2.0;\n\tfloat min_dist2 = 2.0;\n\tfor(float x = -1.0; x <= 1.0; x++) {\n\t\tfor(float y = -1.0; y <= 1.0; y++) {\n\t\t\tvec2 neighbor = vec2(float(x),float(y));\n\t\t\tvec2 node = rand2(mod(o + vec2(x, y), size)) + vec2(x, y);\n\t\t\tnode = 0.5 + 0.25 * sin(offset * 6.28318530718 + 6.28318530718*node);\n\t\t\tvec2 diff = neighbor + node - f;\n\t\t\tfloat dist = max(abs((diff).x), abs((diff).y));\n\t\t\tif (min_dist1 > dist) {\n\t\t\t\tmin_dist2 = min_dist1;\n\t\t\t\tmin_dist1 = dist;\n\t\t\t} else if (min_dist2 > dist) {\n\t\t\t\tmin_dist2 = dist;\n\t\t\t}\n\t\t}\n\t}\n\treturn min_dist2-min_dist1;\n}\n\nfloat fbm_2d_cellular6(vec2 coord, vec2 size, int folds, int octaves, float persistence, float offset, float seed) {\n\tfloat normalize_factor = 0.0;\n\tfloat value = 0.0;\n\tfloat scale = 1.0;\n\tfor (int i = 0; i < octaves; i++) {\n\t\tfloat noise = cellular6_noise_2d(coord*size, size, offset, seed);\n\t\tfor (int f = 0; f < folds; ++f) {\n\t\t\tnoise = abs(2.0*noise-1.0);\n\t\t}\n\t\tvalue += noise * scale;\n\t\tnormalize_factor += scale;\n\t\tsize *= 2.0;\n\t\tscale *= persistence;\n\t}\n\treturn value / normalize_factor;\n}\n\n// MIT License Inigo Quilez - https://www.shadertoy.com/view/Xd23Dh\nfloat voronoise_noise_2d( vec2 coord, vec2 size, float offset, float seed) {\n    vec2 i = floor(coord) + rand2(vec2(seed, 1.0-seed)) + size;\n    vec2 f = fract(coord);\n    \n\tvec2 a = vec2(0.0);\n\t\n    for( int y=-2; y<=2; y++ ) {\n    \tfor( int x=-2; x<=2; x++ ) {\n        \tvec2  g = vec2( float(x), float(y) );\n\t\t\tvec3  o = rand3( mod(i + g, size) + vec2(seed) );\n\t\t\to.xy += 0.25 * sin(offset * 6.28318530718 + 6.28318530718*o.xy);\n\t\t\tvec2  d = g - f + o.xy;\n\t\t\tfloat w = pow( 1.0-smoothstep(0.0, 1.414, length(d)), 1.0 );\n\t\t\ta += vec2(o.z*w,w);\n\t\t}\n    }\n\t\n    return a.x/a.y;\n}\n\nfloat fbm_2d_voronoise(vec2 coord, vec2 size, int folds, int octaves, float persistence, float offset, float seed) {\n\tfloat normalize_factor = 0.0;\n\tfloat value = 0.0;\n\tfloat scale = 1.0;\n\tfor (int i = 0; i < octaves; i++) {\n\t\tfloat noise = voronoise_noise_2d(coord*size, size, offset, seed);\n\t\tfor (int f = 0; f < folds; ++f) {\n\t\t\tnoise = abs(2.0*noise-1.0);\n\t\t}\n\t\tvalue += noise * scale;\n\t\tnormalize_factor += scale;\n\t\tsize *= 2.0;\n\t\tscale *= persistence;\n\t}\n\treturn value / normalize_factor;\n}\nfloat shape_circle(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float distance = length(uv);\n    return clamp((1.0-distance/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_polygon(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y)+3.14159265359;\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(0.5+angle/slice)*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = atan(uv.x, uv.y);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-(cos(floor(angle*sides/6.28318530718-0.5+2.0*step(fract(angle*sides/6.28318530718), 0.5))*slice-angle)*length(uv))/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_curved_star(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = max(edge, 1.0e-8);\n    float angle = 2.0*(atan(uv.x, uv.y)+3.14159265359);\n    float slice = 6.28318530718/sides;\n    return clamp((1.0-cos(floor(0.5+0.5*angle/slice)*2.0*slice-angle)*length(uv)/size)/edge, 0.0, 1.0);\n}\n\nfloat shape_rays(vec2 uv, float sides, float size, float edge) {\n    uv = 2.0*uv-1.0;\n\tedge = 0.5*max(edge, 1.0e-8)*size;\n\tfloat slice = 6.28318530718/sides;\n    float angle = mod(atan(uv.x, uv.y)+3.14159265359, slice)/slice;\n    return clamp(min((size-angle)/edge, angle/edge), 0.0, 1.0);\n}\n\nvec2 rotate(vec2 uv, float rotate) {\n \tvec2 rv;\n\trv.x = cos(rotate)*uv.x + sin(rotate)*uv.y;\n\trv.y = -sin(rotate)*uv.x + cos(rotate)*uv.y;\n    return rv;\t\n}vec2 swirl_tile_false(vec2 uv, vec2 center, float radius, float angle) {\n\tvec2 v = uv-center;\n\tfloat l = length(v);\n\tif (l > radius) {\n\t\treturn uv;\n\t} else {\n\t\treturn rotate(v, angle*(1.0-l/radius)*(1.0-l/radius))+center;\n\t}\n}\n\nvec2 swirl_tile_true(vec2 uv, vec2 center, float radius, float angle) {\n\tcenter = fract(center);\n\tvec2 tile_offset = 2.0*(step(vec2(0.5), uv)-vec2(0.5));\n\tuv = swirl_tile_false(uv, center, radius, angle);\n\tuv = swirl_tile_false(uv, center+tile_offset, radius, angle);\n\tuv = swirl_tile_false(uv, center+vec2(tile_offset.x, 0.0), radius, angle);\n\treturn swirl_tile_false(uv, center+vec2(0.0, tile_offset.y), radius, angle);\n}\nvec2 get_from_tileset(float count, float seed, vec2 uv) {\n\treturn clamp((uv+floor(rand2(vec2(seed))*count))/count, vec2(0.0), vec2(1.0));\n}\n\nvec2 custom_uv_transform(vec2 uv, vec2 cst_scale, float rnd_rotate, float rnd_scale, vec2 seed) {\n\tseed = rand2(seed);\n\tuv -= vec2(0.5);\n\tfloat angle = (seed.x * 2.0 - 1.0) * rnd_rotate;\n\tfloat ca = cos(angle);\n\tfloat sa = sin(angle);\n\tuv = vec2(ca*uv.x+sa*uv.y, -sa*uv.x+ca*uv.y);\n\tuv *= (seed.y-0.5)*2.0*rnd_scale+1.0;\n\tuv /= cst_scale;\n\tuv += vec2(0.5);\n\treturn uv;\n}\nconst float seed_o721663 = 0.000000000;\nconst float p_o721663_tx = 4.000000000;\nconst float p_o721663_ty = 4.000000000;\nconst float p_o721663_overlap = 2.000000000;\nconst float p_o721663_scale_x = 0.500000000;\nconst float p_o721663_scale_y = 0.500000000;\nconst float p_o721663_fixed_offset = 0.000000000;\nconst float p_o721663_offset = 0.250000000;\nconst float p_o721663_rotate = 45.000000000;\nconst float p_o721663_scale = 0.200000000;\nconst float p_o721663_value = 1.000000000;\nconst float p_o609845_cx = 0.000000000;\nconst float p_o609845_cy = 0.000000000;\nconst float p_o515515_gradient_0_pos = 0.063636364;\nconst float p_o515515_gradient_0_r = 0.214620590;\nconst float p_o515515_gradient_0_g = 0.140075684;\nconst float p_o515515_gradient_0_b = 0.265625000;\nconst float p_o515515_gradient_0_a = 1.000000000;\nconst float p_o515515_gradient_1_pos = 0.363636364;\nconst float p_o515515_gradient_1_r = 1.000000000;\nconst float p_o515515_gradient_1_g = 0.968750000;\nconst float p_o515515_gradient_1_b = 0.000000000;\nconst float p_o515515_gradient_1_a = 1.000000000;\nconst float p_o515515_gradient_2_pos = 1.000000000;\nconst float p_o515515_gradient_2_r = 1.000000000;\nconst float p_o515515_gradient_2_g = 0.000000000;\nconst float p_o515515_gradient_2_b = 0.000000000;\nconst float p_o515515_gradient_2_a = 1.000000000;\nvec4 o515515_gradient_gradient_fct(float x) {\n  if (x < p_o515515_gradient_0_pos) {\n    return vec4(p_o515515_gradient_0_r,p_o515515_gradient_0_g,p_o515515_gradient_0_b,p_o515515_gradient_0_a);\n  } else if (x < p_o515515_gradient_1_pos) {\n    return mix(vec4(p_o515515_gradient_0_r,p_o515515_gradient_0_g,p_o515515_gradient_0_b,p_o515515_gradient_0_a), vec4(p_o515515_gradient_1_r,p_o515515_gradient_1_g,p_o515515_gradient_1_b,p_o515515_gradient_1_a), ((x-p_o515515_gradient_0_pos)/(p_o515515_gradient_1_pos-p_o515515_gradient_0_pos)));\n  } else if (x < p_o515515_gradient_2_pos) {\n    return mix(vec4(p_o515515_gradient_1_r,p_o515515_gradient_1_g,p_o515515_gradient_1_b,p_o515515_gradient_1_a), vec4(p_o515515_gradient_2_r,p_o515515_gradient_2_g,p_o515515_gradient_2_b,p_o515515_gradient_2_a), ((x-p_o515515_gradient_1_pos)/(p_o515515_gradient_2_pos-p_o515515_gradient_1_pos)));\n  }\n  return vec4(p_o515515_gradient_2_r,p_o515515_gradient_2_g,p_o515515_gradient_2_b,p_o515515_gradient_2_a);\n}\nconst float p_o588274_sides = 2.000000000;\nconst float p_o588274_radius = 0.546392000;\nconst float p_o588274_edge = 0.628866000;\nconst float p_o528463_radius = 1.500000000;\nconst float p_o528463_repeat = 3.000000000;\nconst float seed_o539170 = 0.000000000;\nconst float p_o539170_scale_x = 1.000000000;\nconst float p_o539170_scale_y = 2.000000000;\nconst float p_o539170_folds = 0.000000000;\nconst float p_o539170_iterations = 4.000000000;\nconst float p_o539170_persistence = 0.750000000;\nconst float p_o539170_offset = -0.100000000;\nconst float p_o513522_amplitude = 0.500000000;\nconst float p_o513522_frequency = 2.000000000;\nfloat o721663_input_in(vec2 uv, float _seed_variation_) {\nfloat o513522_0_1_f = 1.0-abs(2.0*((vec2(fract(p_o528463_repeat*atan((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)).y-0.5, (swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o528463_radius*length((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251))-vec2(0.5))))).y-0.5)-p_o513522_amplitude*sin((p_o513522_frequency*(vec2(fract(p_o528463_repeat*atan((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)).y-0.5, (swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o528463_radius*length((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251))-vec2(0.5))))).x+(iTime))*6.28318530718));\nfloat o539170_0_1_f = fbm_2d_perlin((vec2(fract(p_o528463_repeat*atan((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)).y-0.5, (swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o528463_radius*length((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251))-vec2(0.5))))), vec2(p_o539170_scale_x, p_o539170_scale_y), int(p_o539170_folds), int(p_o539170_iterations), p_o539170_persistence, o513522_0_1_f, (seed_o539170+fract(_seed_variation_)));\nvec4 o528463_0_1_rgba = vec4(vec3(o539170_0_1_f), 1.0);\nfloat o588274_0_1_f = shape_rays((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)), p_o588274_sides, p_o588274_radius*(dot((o528463_0_1_rgba).rgb, vec3(1.0))/3.0), p_o588274_edge*1.0);\nvec4 o515515_0_1_rgba = o515515_gradient_gradient_fct(o588274_0_1_f);\nvec4 o609845_0_1_rgba = o515515_0_1_rgba;\n\nreturn (dot((o609845_0_1_rgba).rgb, vec3(1.0))/3.0);\n}\nfloat o721663_input_mask(vec2 uv, float _seed_variation_) {\nfloat o513522_0_1_f = 1.0-abs(2.0*((vec2(fract(p_o528463_repeat*atan((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)).y-0.5, (swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o528463_radius*length((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251))-vec2(0.5))))).y-0.5)-p_o513522_amplitude*sin((p_o513522_frequency*(vec2(fract(p_o528463_repeat*atan((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)).y-0.5, (swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o528463_radius*length((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251))-vec2(0.5))))).x+(iTime))*6.28318530718));\nfloat o539170_0_1_f = fbm_2d_perlin((vec2(fract(p_o528463_repeat*atan((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)).y-0.5, (swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)).x-0.5)*0.15915494309), min(0.99999, 2.0/p_o528463_radius*length((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251))-vec2(0.5))))), vec2(p_o539170_scale_x, p_o539170_scale_y), int(p_o539170_folds), int(p_o539170_iterations), p_o539170_persistence, o513522_0_1_f, (seed_o539170+fract(_seed_variation_)));\nvec4 o528463_0_1_rgba = vec4(vec3(o539170_0_1_f), 1.0);\nfloat o588274_0_1_f = shape_rays((swirl_tile_false((uv), vec2(0.5+p_o609845_cx, 0.5+p_o609845_cy), (50. * sin(-iTime / (-iTime * .5))), (iTime * 10.)*0.01745329251)), p_o588274_sides, p_o588274_radius*(dot((o528463_0_1_rgba).rgb, vec3(1.0))/3.0), p_o588274_edge*1.0);\nvec4 o515515_0_1_rgba = o515515_gradient_gradient_fct(o588274_0_1_f);\nvec4 o609845_0_1_rgba = o515515_0_1_rgba;\n\nreturn (dot((o609845_0_1_rgba).rgb, vec3(1.0))/3.0);\n}\nvec4 tiler_o721663(vec2 uv, vec2 tile, int overlap, inout vec3 instance_uv, vec2 _seed, float _seed_variation_) {\n\tfloat c = 0.0;\n\tvec3 rc = vec3(0.0);\n\tvec3 rc1;\n\tfor (int dx = -overlap; dx <= overlap; ++dx) {\n\t\tfor (int dy = -overlap; dy <= overlap; ++dy) {\n\t\t\tvec2 pos = uv*tile+vec2(float(dx), float(dy)); pos = fract((floor(mod(pos, tile))+vec2(0.5))/tile)-vec2(0.5);\n\t\t\tvec2 seed = rand2(pos+_seed);\n\t\t\trc1 = rand3(seed);\n\t\t\tpos = fract(pos+vec2(p_o721663_fixed_offset/tile.x, 0.0)*floor(mod(pos.y*tile.y, 2.0))+p_o721663_offset*seed/tile);\n\t\t\tfloat mask = o721663_input_mask(fract(pos+vec2(0.5)), _seed_variation_);\n\t\t\tif (mask > 0.01) {\n\t\t\t\tvec2 pv = fract(uv - pos)-vec2(0.5);\n\t\t\t\tseed = rand2(seed);\n\t\t\t\tfloat angle = (seed.x * 2.0 - 1.0) * p_o721663_rotate * 0.01745329251;\n\t\t\t\tfloat ca = cos(angle);\n\t\t\t\tfloat sa = sin(angle);\n\t\t\t\tpv = vec2(ca*pv.x+sa*pv.y, -sa*pv.x+ca*pv.y);\n\t\t\t\tpv *= (seed.y-0.5)*2.0*p_o721663_scale+1.0;\n\t\t\t\tpv /= vec2(p_o721663_scale_x, p_o721663_scale_y);\n\t\t\t\tpv += vec2(0.5);\n\t\t\t\tseed = rand2(seed);\n\t\t\t\tvec2 clamped_pv = clamp(pv, vec2(0.0), vec2(1.0));\n\t\t\t\tif (pv.x != clamped_pv.x || pv.y != clamped_pv.y) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tvec2 full_uv = pv;\n\t\t\t\tpv = get_from_tileset( 1.0, seed.x, pv);\n\t\t\t\tfloat c1 = o721663_input_in(pv, false ? seed.x : 0.0)*mask*(1.0-p_o721663_value*seed.x);\n\t\t\t\tc = max(c, c1);\n\t\t\t\trc = mix(rc, rc1, step(c, c1));\n\t\t\t\tinstance_uv = mix(instance_uv, vec3(full_uv, seed.x), step(c, c1));\n\t\t\t}\n\t\t}\n\t}\n\treturn vec4(rc, c);\n}\n\n\n\n\n\n\nIN vec2 texCoord;\n{{MODULES_HEAD}}\nvoid main()\n{\nfloat minSize = min(iResolution.x, iResolution.y);\nfloat _seed_variation_ = SEED_VARIATION;\nvec2 UV = vec2(0.0, 1.0) + vec2(1.0, -1.0) * (texCoord-0.5*(iResolution.xy-vec2(minSize)))/minSize;\nvec3 o721663_0_instance_uv = vec3(0.0);\nvec4 o721663_0_rch = tiler_o721663((UV), vec2(p_o721663_tx, p_o721663_ty), int(p_o721663_overlap), o721663_0_instance_uv, vec2(float((seed_o721663+fract(_seed_variation_)))), _seed_variation_);float o721663_0_1_f = o721663_0_rch.a;\ngl_FragColor = vec4(vec3(o721663_0_1_f), 1.0);\n}"},{name:"Vertex Code",value:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},{name:"Use As Material",value:true},{name:"iTime"},{name:"iResolution X",value:1},{name:"iResolution Y",value:1}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"437",objOut:"436"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"437",objOut:"436"}]},{name:"Has Errors",value:false}]},{objName:"Ops.Gl.Shader.Shader2Texture",id:"437",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Render"},{name:"Shader"},{name:"Use Viewport Size",value:true},{name:"Width",value:640},{name:"Height",value:320},{name:"filter index",value:0},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"repeat"},{name:"Floating Point",value:false},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",value:0},{name:"Texture",links:[{portIn:"Texture In",portOut:"Texture",objIn:"439",objOut:"437"}]},{name:"Texture 2"},{name:"Texture 3"},{name:"Texture 4"}]},{objName:"Ops.Anim.Timer_v2",id:"438",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Speed",value:.33},{name:"Play",value:true},{name:"Reset"},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"val",portOut:"Time",objIn:"441",objOut:"438"},{portIn:"z",portOut:"Time",objIn:"449",objOut:"438"}]}]},{objName:"Ops.Ui.VizTexture",id:"439",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out",links:[{portIn:"RGBE Texture",portOut:"Texture Out",objIn:"442",objOut:"439"}]},{name:"Info",value:"640x709 8bit linear repeat"}]},{objName:"Ops.Trigger.TriggerIfIncreased",id:"440",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Value"}],portsOut:[{name:"Trigger",links:[{portIn:"Reset",portOut:"Trigger",objIn:"438",objOut:"440"}]}]},{objName:"Ops.Math.Clamp",id:"441",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"val"},{name:"min",value:.88},{name:"max",value:7},{name:"ignore outside values",value:true}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"440",objOut:"441"}]}]},{objName:"Ops.Gl.Textures.TextureToCoordinateGrid",id:"442",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Execute"},{name:"RGBE Texture"},{name:"Aspect",value:1},{name:"Threshold",value:.093}],portsOut:[{name:"Next",links:[{portIn:"Render",portOut:"Next",objIn:"444",objOut:"442"}]},{name:"HDR Texture",links:[{portIn:"Base Texture",portOut:"HDR Texture",objIn:"444",objOut:"442"}]}]},{objName:"Ops.Sequence",id:"443",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"exe"},{name:"Clean up connections",value:0},{name:"exe 0",value:0},{name:"exe 1",value:0},{name:"exe 2",value:0},{name:"exe 3",value:0},{name:"exe 4",value:0},{name:"exe 5",value:0},{name:"exe 6",value:0},{name:"exe 7",value:0},{name:"exe 8",value:0},{name:"exe 9",value:0},{name:"exe 10",value:0},{name:"exe 11",value:0},{name:"exe 12",value:0},{name:"exe 13",value:0},{name:"exe 14",value:0}],portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"436",objOut:"443"}]},{name:"trigger 1",links:[{portIn:"Execute",portOut:"trigger 1",objIn:"442",objOut:"443"}]},{name:"trigger 2",links:[{portIn:"render",portOut:"trigger 2",objIn:"471",objOut:"443"}]},{name:"trigger 3",value:0},{name:"trigger 4",value:0},{name:"trigger 5",links:[{portIn:"render",portOut:"trigger 5",objIn:"469",objOut:"443"}]},{name:"trigger 6",value:0},{name:"trigger 7",value:0},{name:"trigger 8",value:0},{name:"trigger 9",value:0},{name:"trigger 10",value:0},{name:"trigger 11",links:[{portIn:"Render",portOut:"trigger 11",objIn:"466",objOut:"443"}]},{name:"trigger 12",value:0},{name:"trigger 13",value:0},{name:"trigger 14",value:0},{name:"trigger 15",links:[{portIn:"render",portOut:"trigger 15",objIn:"465",objOut:"443"}]}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"444",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Render"},{name:"Base Texture"},{name:"Size index",value:0},{name:"Size",value:"Manual"},{name:"Width",value:200},{name:"Height",value:200},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 32bit float"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"452",objOut:"444"}]},{name:"texture_out",links:[{portIn:"Position Texture",portOut:"texture_out",objIn:"445",objOut:"444"},{portIn:"Texture",portOut:"texture_out",objIn:"447",objOut:"444"},{portIn:"Texture In",portOut:"texture_out",objIn:"451",objOut:"444"}]},{name:"Aspect Ratio",value:1},{name:"Texture Width",value:200},{name:"Texture Height",value:200}]},{objName:"Ops.Gl.Meshes.MeshInstancerFromTexture_v2",id:"445",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"exe"},{name:"Geometry"},{name:"Num Instances",value:2e5},{name:"Position Texture"},{name:"Rotation Texture",value:null},{name:"Scale Texture",value:null},{name:"Color Texture",value:null},{name:"TexCoord Texture",value:null},{name:"Color Texture Blendmode index",value:0},{name:"Color Texture Blendmode",value:"Normal"},{name:"Scale",value:.85},{name:"Multiply Pos X",value:4.03},{name:"Multiply Pos Y",value:1.88},{name:"Multiply Pos Z",value:2.63}],portsOut:[{name:"Trigger Out",value:0},{name:"Num",value:2e5}]},{objName:"Ops.Gl.Phong.PhongMaterial_v6",id:"446",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Trigger In",value:null},{name:"R",value:.9335661252249424},{name:"G",value:.182155266644222},{name:"B",value:.5889606344012455},{name:"A",value:1},{name:"Enable",value:false},{name:"Albedo",value:.707},{name:"Roughness",value:.835},{name:"Active",value:false},{name:"Fresnel Intensity",value:.7},{name:"Fresnel Width",value:1},{name:"Fresnel Exponent",value:6},{name:"Fresnel R",value:1},{name:"Fresnel G",value:1},{name:"Fresnel B",value:1},{name:"Emissive Active",value:false},{name:"Color Intensity",value:.3},{name:"Emissive R",value:.2875810337604464},{name:"Emissive G",value:.31258577371223417},{name:"Emissive B",value:.5897460379395179},{name:"Shininess",value:4},{name:"Specular Amount",value:.5},{name:"Specular Model index",value:0},{name:"Specular Model",value:"Blinn"},{name:"Energy Conservation",value:false},{name:"Double Sided Material",value:false},{name:"Falloff Mode index",value:0},{name:"Falloff Mode",value:"A"},{name:"Diffuse Texture",value:0},{name:"Specular Texture",value:0},{name:"Normal Map",value:0},{name:"AO Texture",value:0},{name:"Emissive Texture",value:0},{name:"Emissive Mask",value:0},{name:"Opacity Texture",value:0},{name:"Environment Map",value:0},{name:"Env Map Mask",value:0},{name:"Colorize Texture",value:false},{name:"Diffuse Repeat X",value:1},{name:"Diffuse Repeat Y",value:1},{name:"Texture Offset X",value:0},{name:"Texture Offset Y",value:0},{name:"Specular Intensity",value:1},{name:"Normal Map Intensity",value:.5},{name:"AO Intensity",value:1},{name:"Emissive Intensity",value:1},{name:"Emissive Mask Intensity",value:1},{name:"Env Map Intensity",value:1},{name:"Env Map Blend index",value:0},{name:"Env Map Blend",value:"Add"},{name:"Env Mask Intensity",value:1},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Discard Transparent Pixels",value:false}],portsOut:[{name:"Trigger Out",links:[{portIn:"render",portOut:"Trigger Out",objIn:"456",objOut:"446"},{portIn:"render",portOut:"Trigger Out",objIn:"458",objOut:"446"}]},{name:"Shader"}]},{objName:"Ops.Gl.Meshes.PointCloudFromTexture",id:"447",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"Num Points",value:0},{name:"Axis index",value:0},{name:"Axis",value:"XYZ"},{name:"Texture"},{name:"Point Size",value:null},{name:"Normalize",value:false},{name:"Remove Point at 0",value:false}],portsOut:[{name:"Trigger",value:0},{name:"Total Points",value:4e4}]},{objName:"Ops.Gl.Shader.PointMaterial_v4",id:"448",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"PointSize",value:3.19},{name:"Size in Pixels",value:true},{name:"Random Size",value:0},{name:"Round",value:true},{name:"Round Antialias",value:false},{name:"Scale by Distance",value:false},{name:"r",value:.19833931916172265},{name:"g",value:.9228847640322472},{name:"b",value:.513230668015372},{name:"a",value:1},{name:"Vertex Colors",value:false},{name:"texture",value:0},{name:"Colorize Texture",value:false},{name:"Texture Mask",value:0},{name:"Mask Channel index",value:0},{name:"Mask Channel",value:"R"},{name:"Texture Colorize",value:0},{name:"Colorize Randomize",value:true},{name:"Texture Opacity",value:0},{name:"Texture Point Size",value:0},{name:"Point Size Channel index",value:0},{name:"Point Size Channel",value:"R"},{name:"Texture Point Size Mul",value:1},{name:"Map Size 0 index",value:0},{name:"Map Size 0",value:"Black"},{name:"Flip Texture",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"461",objOut:"448"}]},{name:"shader"}]},{objName:"Ops.Gl.Matrix.Translate",id:"449",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"x",value:0},{name:"y",value:0},{name:"z"}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"448",objOut:"449"}]}]},{objName:"Ops.Gl.Matrix.ScaleXYZ",id:"450",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"x",value:2.43},{name:"y",value:.8},{name:"z",value:1.88}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"449",objOut:"450"}]}]},{objName:"Ops.Ui.VizTexture",id:"451",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out"},{name:"Info",value:"200x200 32bit linear repeat"}]},{objName:"Ops.Gl.TextureEffects.Plasma_v2",id:"452",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"screen"},{name:"Alpha Mask index",value:0},{name:"Alpha Mask",value:"Off"},{name:"Amount",value:.143},{name:"Width",value:20},{name:"Height",value:20},{name:"Aspect",value:true},{name:"Mul",value:.53},{name:"X",value:0},{name:"Y",value:0},{name:"Time"},{name:"Greyscale",value:false},{name:"Offset",value:0},{name:"Offset Multiply",value:1},{name:"Offset X index",value:0},{name:"Offset X",value:"None"},{name:"Offset Y index",value:0},{name:"Offset Y",value:"None"},{name:"Offset Time index",value:1},{name:"Offset Time",value:"R"},{name:"Mask",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"454",objOut:"452"}]}]},{objName:"Ops.Anim.Timer_v2",id:"453",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Speed",value:1},{name:"Play",value:true},{name:"Reset",value:0},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"Time",portOut:"Time",objIn:"452",objOut:"453"},{portIn:"time",portOut:"Time",objIn:"473",objOut:"453"}]}]},{objName:"Ops.Gl.TextureEffects.Math.RgbMath",id:"454",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Render"},{name:"Operation index",value:3},{name:"Operation",value:"c+x"},{name:"R Active",value:true},{name:"G Active",value:true},{name:"B Active",value:true},{name:"A Active",value:false},{name:"r",value:.03},{name:"g",value:.02},{name:"b",value:.02},{name:"a",value:1},{name:"Mask",value:0}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.User.olixaf.CircleTransform",id:"455",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"segments",value:2},{name:"radius",value:.64},{name:"percent",value:1},{name:"Absolute",value:true},{name:"Flip",value:false},{name:"Rotate",value:true}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"450",objOut:"455"},{portIn:"exe",portOut:"trigger",objIn:"464",objOut:"455"}]},{name:"index",value:1}]},{objName:"Ops.Gl.Meshes.Sphere_v2",id:"456",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"radius",value:.005},{name:"stacks",value:32},{name:"slices",value:32},{name:"Filloffset",value:1},{name:"Render",value:false}],portsOut:[{name:"trigger",value:0},{name:"geometry",links:[{portIn:"Geometry",portOut:"geometry",objIn:"445",objOut:"456"}]}]},{objName:"Ops.Gl.ShaderEffects.AreaRotate_v2",id:"457",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render",value:null},{name:"Size",value:8.93},{name:"Strength",value:8.31},{name:"Smooth",value:true},{name:"x",value:0},{name:"y",value:0},{name:"z",value:3.97}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.User.olixaf.CircleTransform",id:"458",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"segments",value:4},{name:"radius",value:1},{name:"percent",value:1},{name:"Absolute",value:true},{name:"Flip",value:false},{name:"Rotate",value:true}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"459",objOut:"458"}]},{name:"index",value:3}]},{objName:"Ops.Gl.Matrix.ScaleXYZ",id:"459",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"x",value:1},{name:"y",value:1},{name:"z",value:4.55}],portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"445",objOut:"459"}]}]},{objName:"Ops.Gl.ShaderEffects.TextureProjection_v2",id:"460",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"Texture",value:0},{name:"Scale",value:10},{name:"Target index",value:0},{name:"Target",value:"Pointsize"},{name:"blendMode index",value:0},{name:"blendMode",value:"multiply"},{name:"Amount",value:1},{name:"Use Texture Alpha",value:false},{name:"Pos X",value:0},{name:"Pos Y",value:0},{name:"Rot X",value:0},{name:"Rot Y",value:0},{name:"Rot Z",value:0},{name:"Mapping index",value:1},{name:"Mapping",value:"XY"},{name:"Discard",value:false},{name:"WorldSpace",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"447",objOut:"460"}]}]},{objName:"Ops.Gl.ShaderEffects.AreaTranslateFBMNoise",id:"461",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"Mode index",value:1},{name:"Mode",value:"Rotate"},{name:"Size",value:30.59},{name:"Strength",value:76.75},{name:"Smooth",value:true},{name:"x",value:0},{name:"y",value:0},{name:"z",value:6.95},{name:"Noise Scale",value:24.4},{name:"Noise X",value:0},{name:"Noise Y",value:0},{name:"Noise Z",value:0}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"463",objOut:"461"}]}]},{objName:"Ops.Anim.Timer_v2",id:"462",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Speed",value:.54},{name:"Play",value:true},{name:"Reset",value:0},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"iTime",portOut:"Time",objIn:"436",objOut:"462"}]}]},{objName:"Ops.Gl.ShaderEffects.DeformArea",id:"463",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"Size"},{name:"Strength",value:5.69},{name:"Smooth",value:true},{name:"WorldSpace",value:false},{name:"x",value:0},{name:"y",value:0},{name:"z",value:.24}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"460",objOut:"463"}]}]},{objName:"Ops.Anim.SineAnim",id:"464",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"exe"},{name:"Mode index",value:0},{name:"Mode",value:"Sine"},{name:"phase",value:0},{name:"frequency",value:1.29},{name:"amplitude",value:2.32}],portsOut:[{name:"Trigger out",value:0},{name:"result",links:[{portIn:"Size",portOut:"result",objIn:"463",objOut:"464"}]}]},{objName:"Ops.Gl.Render2Texture",id:"465",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"use viewport size",value:true},{name:"texture width",value:640},{name:"texture height",value:709},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:true},{name:"Clear",value:true}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"455",objOut:"465"}]},{name:"texture",links:[{portIn:"Base Texture",portOut:"texture",objIn:"466",objOut:"465"}]},{name:"textureDepth"}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"466",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Render"},{name:"Base Texture"},{name:"Size index",value:0},{name:"Size",value:"Auto"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 8bit ubyte"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"474",objOut:"466"}]},{name:"texture_out",links:[{portIn:"Texture In",portOut:"texture_out",objIn:"467",objOut:"466"},{portIn:"Base Texture",portOut:"texture_out",objIn:"470",objOut:"466"}]},{name:"Aspect Ratio",value:.9026798307475318},{name:"Texture Width",value:640},{name:"Texture Height",value:709}]},{objName:"Ops.Ui.VizTexture",id:"467",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Texture In"},{name:"Show Info",value:false}],portsOut:[{name:"Texture Out"},{name:"Info",value:"640x709 8bit linear repeat"}]},{objName:"Ops.Gl.TextureEffects.FastBlur_v2",id:"468",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"Passes",value:1.42},{name:"Clamp",value:true},{name:"direction index",value:0},{name:"direction",value:"horizontal"},{name:"Mask",value:0},{name:"Mask Invert",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"473",objOut:"468"}]}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"469",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"Scale index",value:1},{name:"Scale",value:"Fit"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.TextureEffects.ImageCompose_v3",id:"470",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Render"},{name:"Base Texture"},{name:"Size index",value:0},{name:"Size",value:"Auto"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Pixel Format index",value:0},{name:"Pixel Format",value:"RGBA 8bit ubyte"},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"472",objOut:"470"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"472",objOut:"470"}]},{name:"Aspect Ratio",value:.9026798307475318},{name:"Texture Width",value:640},{name:"Texture Height",value:709}]},{objName:"Ops.Gl.Render2Texture",id:"471",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"use viewport size",value:true},{name:"texture width",value:640},{name:"texture height",value:709},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:false},{name:"Clear",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"470",objOut:"471"}]},{name:"texture",links:[{portIn:"Texture",portOut:"texture",objIn:"469",objOut:"471"}]},{name:"textureDepth"}]},{objName:"Ops.Gl.Meshes.FullscreenRectangle",id:"472",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"Scale index",value:1},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false},{name:"Texture"}],portsOut:[{name:"trigger",value:0}]},{objName:"Ops.Gl.TextureEffects.Wobble_v2",id:"473",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Render"},{name:"time"},{name:"SpeedX",value:4},{name:"SpeedY",value:8},{name:"RepeatX",value:11},{name:"RepeatY",value:11},{name:"Multiply",value:.01},{name:"Amount Map",value:0},{name:"Source Amount Map index",value:0},{name:"Source Amount Map",value:"Lum"},{name:"Invert Amount Map",value:false}],portsOut:[{name:"Trigger",value:0}]},{objName:"Ops.Gl.TextureEffects.ZoomBlur_v2",id:"474",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"Strength",value:.15},{name:"X",value:0},{name:"Y",value:0},{name:"Strength Map",value:0},{name:"Source Strength Map index",value:0},{name:"Source Strength Map",value:"R"},{name:"Invert Strength Map",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"468",objOut:"474"}]}]},{objName:"Ops.Devices.Keyboard.KeyPress_v2",id:"475",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Area index",value:0},{name:"Area",value:"Canvas"},{name:"Prevent Default",value:false},{name:"Enabled",value:true}],portsOut:[{name:"On Press",value:0},{name:"Key Code",value:17},{name:"Key",value:"Control"}]},{objName:"Ops.Devices.Keyboard.KeyPressLearn",id:"476",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"key code",value:66},{name:"canvas only",value:true},{name:"Mod Key index",value:0},{name:"Mod Key",value:"none"},{name:"Enabled",value:true},{name:"Prevent Default",value:false},{name:"learn",value:0}],portsOut:[{name:"on press",links:[{portIn:"Reset",portOut:"on press",objIn:"438",objOut:"476"}]},{name:"on release",value:0},{name:"Pressed",value:0},{name:"Key",value:"B"}]},{objName:"Ops.Gl.Render2Texture",id:"477",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"render"},{name:"use viewport size",value:true},{name:"texture width",value:640},{name:"texture height",value:709},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"none"},{name:"HDR",value:false},{name:"Depth",value:true},{name:"Clear",value:true}],portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"443",objOut:"477"}]},{name:"texture",links:[{portIn:"out0 Ops.Gl.Render2Texture texture",portOut:"texture",objIn:"433",objOut:"477"}]},{name:"textureDepth"}]},{objName:"Ops.Trigger.GateTrigger",id:"478",uiAttribs:{},portsIn:[{name:"Execute"},{name:"Pass Through",value:true}],portsOut:[{name:"Trigger out",links:[{portIn:"render",portOut:"Trigger out",objIn:"4",objOut:"478"}]}]},{objName:"Ops.Trigger.TriggerReceive",id:"479",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Named Trigger",value:"TimerStart"}],portsOut:[{name:"Triggered",links:[{portIn:"Reset",portOut:"Triggered",objIn:"168",objOut:"479"}]}]},{objName:"Ops.Trigger.TriggerReceive",id:"480",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Named Trigger",value:"TimerStart"}],portsOut:[{name:"Triggered",links:[{portIn:"Reset",portOut:"Triggered",objIn:"159",objOut:"480"}]}]},{objName:"Ops.Trigger.TriggerReceive",id:"481",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Named Trigger",value:"TimerStart"}],portsOut:[{name:"Triggered",links:[{portIn:"Reset",portOut:"Triggered",objIn:"134",objOut:"481"}]}]},{objName:"Ops.Trigger.TriggerReceive",id:"482",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Named Trigger",value:"TimerStart"}],portsOut:[{name:"Triggered",links:[{portIn:"Reset",portOut:"Triggered",objIn:"115",objOut:"482"}]}]},{objName:"Ops.Trigger.TriggerReceive",id:"483",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Named Trigger",value:"TimerStart"}],portsOut:[{name:"Triggered",links:[{portIn:"Reset",portOut:"Triggered",objIn:"105",objOut:"483"}]}]},{objName:"Ops.Trigger.TriggerReceive",id:"484",uiAttribs:{subPatch:"e29908b3-998b-45cc-a71c-6ca76d670c22"},portsIn:[{name:"Named Trigger",value:"TimerStart"}],portsOut:[{name:"Triggered",links:[{portIn:"Reset",portOut:"Triggered",objIn:"93",objOut:"484"}]}]},{objName:"Ops.Trigger.GateTrigger",id:"485",uiAttribs:{subPatch:"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0"},portsIn:[{name:"Execute",value:null},{name:"Pass Through",value:false}],portsOut:[{name:"Trigger out",links:[{portIn:"render",portOut:"Trigger out",objIn:"435",objOut:"485"}]}]}],users:[],usersReadOnly:[],userOps:[],tags:[],_id:"644950481f6b773873844149",name:"copy of Tormentoise",description:"",userId:"5ef4b35539e82f6dc9d86144",created:"2023-04-26T16:24:40.270Z",cloneOf:"6448e2cd2d251f3835610d81",updated:"2023-04-27T19:48:48.701Z",log:[{_id:"644950481f6b77387384414b",key:"collabsatcreate",text:"initial list of collaborators:"}],__v:26,shortId:"hIpo_u",buildInfo:{core:{timestamp:1682341866190,created:"2023-04-24T13:11:06.190Z",git:{branch:"master",commit:"a8912bdbb85d335fb4b58c228bba4c8be8498ebd",date:"2023-04-24T13:08:49.000Z",message:"fix duplicate ids"}},ui:{timestamp:1682341878679,created:"2023-04-24T13:11:18.679Z",git:{branch:"master",commit:"92f3441db14505cdeafaf68ec0c717954f18584c",date:"2022-12-16T15:16:18.000Z",message:'do not show "automated error report" to admin users - pandrr/cables/issues/4193'}},host:"cables.gl"},opsHash:"f9b240cfbdc0f762557debcbecc55e6e47f28d85",ui:{timeLineLength:20,bookmarks:["618de12b-9964-41c3-b626-48397664d510"],viewBoxesGl:{0:{x:-1225.4458557353119,y:41.59218912093404,z:486.26150931671236},"b3fded0c-4061-445f-9b9a-dad7cd296c90":{x:895.9950267559899,y:227.5104260937835,z:401.73480843495463},"f4a2854a-1b72-4062-9e01-8928ba417e50":{x:1241.4596626392909,y:723.2233555962574,z:400.84083651504176},"a4fe7a6f-a248-4a39-9998-8a0f25f65658":{x:265.9547805539414,y:577.9514840651761,z:470.50092240936675},"f3de1024-f41e-49e4-a589-4ff3f051307c":{x:1456.611088279943,y:332.43882606620895,z:400.0232487583697},"954b8512-0457-4320-afa2-70f8f2db5690":{x:1264.2998270000094,y:159.59744876133607,z:589.4784513327527},"2490b99c-8f17-4472-8f9e-57296a9291e4":{x:538.0771811511622,y:-105.53537849309095,z:642.3396686028401},"56c12324-55dc-41e0-8ed9-b8958c6eb439":{x:358.6791674114189,y:669.8927694207996,z:462.57537965286855},"bc2f5d75-45e5-4e23-b419-75e6bb95ddd0":{x:916.6076555876336,y:505.4542446806373,z:575.242242400566},"e29908b3-998b-45cc-a71c-6ca76d670c22":{x:17439.19926101421,y:528.3361938986234,z:406.37314615581096}},renderer:{w:640,h:709,s:1}},updatedByUser:"Olixaf",deployments:{lastDeployment:{date:1682624956277,service:"download"}},exports:3,views:1,cachedUsername:"Olixaf",statsAdmin:{filenameScreenshots:["_screenshots/screenshot.png","_screenshots/screenshot_1682526943397.png","_screenshots/screenshot_1682527209025.png","_screenshots/screenshot_1682527584875.png","_screenshots/screenshot_1682528320478.png","_screenshots/screenshot_1682529504074.png","_screenshots/screenshot_1682529568708.png","_screenshots/screenshot_1682617107574.png","_screenshots/screenshot_1682620623462.png","_screenshots/screenshot_1682621682891.png","_screenshots/screenshot_1682621867465.png","_screenshots/screenshot_1682622300086.png","_screenshots/screenshot_1682622342243.png","_screenshots/screenshot_1682622917057.png","_screenshots/screenshot_1682623241462.png","_screenshots/screenshot_1682623450270.png","_screenshots/screenshot_1682623587462.png","_screenshots/screenshot_1682623738665.png","_screenshots/screenshot_1682623754440.png","_screenshots/screenshot_1682624525465.png","_screenshots/screenshot_converted.jpg","_screenshots/screenshot_converted.webp"],filenameExports:["_exports/cables_copy_of_Tormentoise1.zip","_exports/cables_copy_of_Tormentoise2.zip"],filenameAssets:[],hasOldScreenshots:false,hasOldExports:false,sizeScreenshots:1902.400390625,sizeExports:4277.291015625,sizeAssets:0}};if(!CABLES.exportedPatch){CABLES.exportedPatch=CABLES.exportedPatches["hIpo_u"]}"use strict";var CABLES=CABLES||{};CABLES.OPS=CABLES.OPS||{};var Ops=Ops||{};Ops.Gl=Ops.Gl||{};Ops.Ui=Ops.Ui||{};Ops.Anim=Ops.Anim||{};Ops.Json=Ops.Json||{};Ops.Math=Ops.Math||{};Ops.User=Ops.User||{};Ops.Array=Ops.Array||{};Ops.Value=Ops.Value||{};Ops.String=Ops.String||{};Ops.Boolean=Ops.Boolean||{};Ops.Devices=Ops.Devices||{};Ops.Sidebar=Ops.Sidebar||{};Ops.Trigger=Ops.Trigger||{};Ops.Gl.Phong=Ops.Gl.Phong||{};Ops.TimeLine=Ops.TimeLine||{};Ops.WebAudio=Ops.WebAudio||{};Ops.Extension=Ops.Extension||{};Ops.Gl.Matrix=Ops.Gl.Matrix||{};Ops.Gl.Meshes=Ops.Gl.Meshes||{};Ops.Gl.Shader=Ops.Gl.Shader||{};Ops.Deprecated=Ops.Deprecated||{};Ops.Gl.Textures=Ops.Gl.Textures||{};Ops.User.olixaf=Ops.User.olixaf||{};Ops.Math.Compare=Ops.Math.Compare||{};Ops.Deprecated.Gl=Ops.Deprecated.Gl||{};Ops.Devices.Mouse=Ops.Devices.Mouse||{};Ops.Devices.Keyboard=Ops.Devices.Keyboard||{};Ops.Gl.ShaderEffects=Ops.Gl.ShaderEffects||{};Ops.Gl.TextureEffects=Ops.Gl.TextureEffects||{};Ops.Deprecated.Gl.Matrix=Ops.Deprecated.Gl.Matrix||{};Ops.Gl.TextureEffects.Math=Ops.Gl.TextureEffects.Math||{};Ops.Extension.ReactionDiffusion=Ops.Extension.ReactionDiffusion||{};Ops.Gl.Shader.CustomShader_v2=function(){CABLES.Op.apply(this,arguments);const f=this;const e={};const t=f.inTrigger("render"),n=f.inStringEditor("Fragment Code"),a=f.inStringEditor("Vertex Code"),r=f.inValueBool("Use As Material",true),o=f.outTrigger("trigger"),i=f.outObject("Shader",null,"shader"),s=f.outBool("Has Errors");const m=f.patch.cgl;const v=[];const h=[];const b=[];f.toWorkPortsNeedToBeLinked(t);n.setUiAttribs({editorSyntax:"glsl"});a.setUiAttribs({editorSyntax:"glsl"});const x=new CGL.Shader(m,f.name);x.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]);f.setPortGroup("Source Code",[n,a]);f.setPortGroup("Options",[r]);n.set(CGL.Shader.getDefaultFragmentShader());a.set(CGL.Shader.getDefaultVertexShader());n.onChange=a.onChange=function(){if(n.isLinked()&&!n.get())return;l=true};t.onTriggered=u;let l=true;f.onLoadedValueSet=c;function c(n){A();for(let t=0;t<v.length;t++)for(let e=0;e<n.portsIn.length;e++)if(v[t]&&v[t].name==n.portsIn[e].name){v[t].set(n.portsIn[e].value);v[t].deSerializeSettings(n.portsIn[e])}}f.init=function(){A()};function u(){C();if(l)A();if(r.get())m.pushShader(x);_();o.trigger();x.popTextures();if(r.get())m.popShader()}function _(){for(let e=0;e<h.length;e++)if(h[e]&&h[e].get()&&h[e].get().tex)x.pushTexture(h[e].uniform,h[e].get().tex);else x.pushTexture(h[e],CGL.Texture.getEmptyTexture(m))}function d(){for(let e=0;e<h.length;e++)if(h[e]&&h[e].get()&&h[e].get().tex)m.setTexture(0+e+3,h[e].get().tex)}function O(t){for(let e=0;e<v.length;e++)if(v[e]&&v[e].name==t)return true;for(let e=0;e<h.length;e++)if(h[e]&&h[e].name==t)return true;return false}const p=mat4.create();const I=["modelMatrix","viewMatrix","normalMatrix","mvMatrix","projMatrix","inverseViewMatrix","camPos"];let y=0;const T=[];function g(e){const t=e.split("\n");const r=[];for(let e=0;e<t.length;e++){const n=t[e].split(";");for(let e=0;e<n.length;e++){let a=n[e].split(" ");for(let e=0;e<a.length;e++)a[e]=(a[e]+"").trim();if(a[0]==="UNI"||a[0]==="uniform"){let t=a[2];if(a.length>4)for(let e=3;e<a.length;e++)t+=a[e];a=a.filter(function(e){return e!==""});const o=a[1];let n=[t];if(t.indexOf(",")>-1)n=t.split(",");for(let e=0;e<n.length;e++){if(I.indexOf(n[e])>-1)continue;const i=n[e].trim();if(o==="float"){T.push(i);if(!O(i)){const s=f.inFloat(i,0);s.uniform=new CGL.Uniform(x,"f",i,s);v.push(s);r.push(s)}}else if(o==="int"){T.push(i);if(!O(i)){const s=f.inInt(i,0);s.uniform=new CGL.Uniform(x,"i",i,s);v.push(s);r.push(s)}}else if(o==="bool"){T.push(i);if(!O(i)){const s=f.inBool(i,false);s.uniform=new CGL.Uniform(x,"b",i,s);v.push(s);r.push(s)}}else if(o==="mat4"){T.push(i);if(!O(i)){const s=f.inArray(i,0);s.uniform=new CGL.Uniform(x,"m4",i,s);v.push(s);r.push(s);const l={name:i,num:16,port:s,uni:s.uniform,changed:false};s.onChange=function(){this.changed=true}.bind(l);b.push(l)}}else if(o==="sampler2D"||o==="samplerCube"){T.push(i);if(!O(i)){const c=f.inObject(i);let e="t";if(o==="samplerCube")e="tc";c.uniform=new CGL.Uniform(x,e,i,3+h.length);h.push(c);r.push(c);c.set(CGL.Texture.getTempTexture(m));c.on("change",(e,t)=>{if(!e)t.set(CGL.Texture.getTempTexture(m))});y++}}else if(o==="vec3"||o==="vec2"||o==="vec4"){let e=2;if(o==="vec4")e=4;if(o==="vec3")e=3;T.push(i+" X");T.push(i+" Y");if(e>2)T.push(i+" Z");if(e>3)T.push(i+" W");if(!O(i+" X")){const u=[];const l={name:i,num:e,changed:false};b.push(l);S(l);const _=f.inFloat(i+" X",0);_.onChange=function(){this.changed=true}.bind(l);v.push(_);u.push(_);l.x=_;const d=f.inFloat(i+" Y",0);d.onChange=function(){this.changed=true}.bind(l);v.push(d);u.push(d);l.y=d;if(e>2){const p=f.inFloat(i+" Z",0);p.onChange=function(){this.changed=true}.bind(l);v.push(p);u.push(p);l.z=p}if(e>3){const g=f.inFloat(i+" W",0);g.onChange=function(){this.changed=true}.bind(l);v.push(g);u.push(g);l.w=g}f.setPortGroup(i,u)}}}}}}f.setPortGroup("uniforms",r)}function A(){if(!x)return;x.bindTextures=d.bind(this);x.setSource(a.get(),n.get());if(m.glVersion==1){m.gl.getExtension("OES_standard_derivatives");x.enableExtension("GL_OES_standard_derivatives")}y=0;T.length=0;g(a.get());g(n.get());for(let t=0;t<h.length;t++)for(let e=0;e<T.length;e++)if(h[t]&&T.indexOf(h[t].name)==-1){h[t].remove();h[t]=null}for(let t=0;t<v.length;t++)for(let e=0;e<T.length;e++)if(v[t]&&T.indexOf(v[t].name)==-1){v[t].remove();v[t]=null}for(let e=0;e<b.length;e++){S(b[e]);b[e].changed=true}for(let e=0;e<v.length;e++)if(v[e]&&v[e].uniform)v[e].uniform.needsUpdate=true;x.compile();f.refreshParams();i.set(null);i.set(x);l=false;if(x.hasErrors())f.setUiError("compile","Shader has errors");else f.setUiError("compile",null);s.set(x.hasErrors())}function S(e){if(e.num==2)e.uni=new CGL.Uniform(x,"2f",e.name,[0,0]);else if(e.num==3)e.uni=new CGL.Uniform(x,"3f",e.name,[0,0,0]);else if(e.num==4)e.uni=new CGL.Uniform(x,"4f",e.name,[0,0,0,0])}function C(){for(let e=0;e<b.length;e++){const t=b[e];if(t.changed){if(t.num===2)t.uni.setValue([t.x.get(),t.y.get()]);else if(t.num===3)t.uni.setValue([t.x.get(),t.y.get(),t.z.get()]);else if(t.num===4)t.uni.setValue([t.x.get(),t.y.get(),t.z.get(),t.w.get()]);else if(t.num>4){t.uni.setValue(t.port.get())}t.changed=false}}}};Ops.Gl.Shader.CustomShader_v2.prototype=new CABLES.Op;CABLES.OPS["a165fc89-a35b-4d39-8930-7345b098bd9d"]={f:Ops.Gl.Shader.CustomShader_v2,objName:"Ops.Gl.Shader.CustomShader_v2"};Ops.Gl.Shader.Shader2Texture=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("Render"),a=e.inObject("Shader",null,"shader"),o=e.inValueBool("Use Viewport Size",true),i=e.inValueInt("Width",512),s=e.inValueInt("Height",512),l=e.inValueSelect("filter",["nearest","linear","mipmap"]),c=e.inValueSelect("wrap",["clamp to edge","repeat","mirrored repeat"],"clamp to edge"),u=e.inValueBool("Floating Point",false),_=e.inSwitch("Num Textures",["1","4"],"1"),r=e.outTrigger("Next"),d=e.outTexture("Texture"),p=e.outTexture("Texture 2"),g=e.outTexture("Texture 3"),f=e.outTexture("Texture 4");e.setPortGroup("Texture Size",[o,i,s]);e.setPortGroup("Texture settings",[l,c,u]);let m=1;const v=e.patch.cgl;const h=[0,0,0,0];const b=null;const x=[];let O=null;let I=null;i.onChange=s.onChange=u.onChange=l.onChange=_.onChange=c.onChange=N;o.onChange=M;const y=false;let T=null;const A=null;let S=true;const C=CGL.MESHES.getSimpleRect(v,"shader2texture rect");e.toWorkPortsNeedToBeLinked(a);l.set("nearest");M();function E(){if(l.get()=="mipmap"&&u.get()){e.setUiError("warning","HDR and mipmap filtering at the same time is not possible")}else{e.setUiError("warning",null)}}function M(){i.setUiAttribs({greyout:o.get()});s.setUiAttribs({greyout:o.get()});i.set(v.getViewPort()[2]);s.set(v.getViewPort()[3])}function N(){S=true;E()}function L(){if(I)I.dispose();O=null;I=null}function w(){S=false;if(T)T.delete();const e=x.length;m=parseInt(_.get());x.length=0;for(let e=0;e<m;e++)x[e]=true;if(e!=x.length){L()}T=null;let t=i.get();let n=s.get();if(o.get()){t=v.getViewPort()[2];n=v.getViewPort()[3]}let a=CGL.Texture.FILTER_NEAREST;if(l.get()=="linear")a=CGL.Texture.FILTER_LINEAR;else if(l.get()=="mipmap")a=CGL.Texture.FILTER_MIPMAP;let r=CGL.Texture.WRAP_CLAMP_TO_EDGE;if(c.get()=="repeat")r=CGL.Texture.WRAP_REPEAT;if(c.get()=="mirrored repeat")r=CGL.Texture.WRAP_MIRRORED_REPEAT;if(v.glVersion>=2){T=new CGL.Framebuffer2(v,t,n,{isFloatingPointTexture:u.get(),multisampling:false,numRenderBuffers:m,wrap:r,filter:a,depth:true,multisamplingSamples:0,clear:true})}else{T=new CGL.Framebuffer(v,i.get(),s.get(),{isFloatingPointTexture:u.get(),filter:a,wrap:r})}}n.onTriggered=function(){const e=v.getViewPort();if(!T||S)w();if(o.get()&&T&&(e[2]!=T.getTextureColor().width||e[3]!=T.getTextureColor().height))w();if(!a.get()||!a.get().setDrawBuffers)return;if(a.get()!=O){O=a.get();I=a.get().copy();I.setDrawBuffers(x)}if(!I){d.set(null);return}h[0]=e[0];h[1]=e[1];h[2]=e[2];h[3]=e[3];T.renderStart(v);v.pushPMatrix();mat4.identity(v.pMatrix);v.pushViewMatrix();mat4.identity(v.vMatrix);v.pushModelMatrix();mat4.identity(v.mMatrix);v.pushShader(a.get());if(I.bindTextures)I.bindTextures();v.pushBlend(false);C.render(a.get());v.popBlend();v.popPMatrix();v.popModelMatrix();v.popViewMatrix();T.renderEnd(v);if(m>=2){d.set(T.getTextureColorNum(0));p.set(T.getTextureColorNum(1));g.set(T.getTextureColorNum(2));f.set(T.getTextureColorNum(3))}else d.set(T.getTextureColor());v.popShader();v.gl.viewport(h[0],h[1],h[2],h[3]);r.trigger()}};Ops.Gl.Shader.Shader2Texture.prototype=new CABLES.Op;CABLES.OPS["a3debb76-7d84-4548-9e7b-24891423dcce"]={f:Ops.Gl.Shader.Shader2Texture,objName:"Ops.Gl.Shader.Shader2Texture"};Ops.Sequence=function(){CABLES.Op.apply(this,arguments);const o=this;const e={};const t=o.inTrigger("exe"),n=o.inTriggerButton("Clean up connections");const a=[],i=[],r=16;let s=null;t.onTriggered=c;n.onTriggered=u;n.setUiAttribs({hidePort:true});n.setUiAttribs({hideParam:true});for(let t=0;t<r;t++){const _=o.outTrigger("trigger "+t);i.push(_);_.onLinkChanged=l;if(t<r-1){let e=o.inTrigger("exe "+t);e.onTriggered=c;a.push(e)}}function l(){clearTimeout(s);s=setTimeout(()=>{let t=false;for(let e=0;e<i.length;e++)if(i[e].links.length>1)t=true;n.setUiAttribs({hideParam:!t});if(o.isCurrentUiOp())o.refreshParams()},60)}function c(){for(let e=0;e<i.length;e++)i[e].trigger()}function u(){let a=0;for(let n=0;n<i.length;n++){let t=[];if(i[n].links.length>1)for(let e=1;e<i[n].links.length;e++){while(i[a].links.length>0)a++;t.push(i[n].links[e]);const r=i[n].links[e].getOtherPort(i[n]);o.patch.link(o,"trigger "+a,r.parent,r.name);a++}for(let e=0;e<t.length;e++)t[e].remove()}l()}};Ops.Sequence.prototype=new CABLES.Op;CABLES.OPS["a466bc1f-06e9-4595-8849-bffb9fe22f99"]={f:Ops.Sequence,objName:"Ops.Sequence"};Ops.Ui.VizTexture=function(){CABLES.Op.apply(this,arguments);const t=this;const A={viztex_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI samplerCube cubeMap;\nUNI float width;\nUNI float height;\nUNI float type;\nUNI float time;\n\nfloat LinearizeDepth(float d,float zNear,float zFar)\n{\n    float z_n = 2.0 * d - 1.0;\n    return 2.0 * zNear / (zFar + zNear - z_n * (zFar - zNear));\n}\n\nvoid main()\n{\n    vec4 col=vec4(vec3(0.),0.0);\n\n    vec4 colTex=texture(tex,texCoord);\n\n\n\n    if(type==1.0)\n    {\n        vec4 depth=vec4(0.);\n        vec2 localST=texCoord;\n        localST.y = 1. - localST.y;\n\n        localST.t = mod(localST.t*3.,1.);\n        localST.s = mod(localST.s*4.,1.);\n\n        #ifdef WEBGL2\n            #define texCube texture\n        #endif\n        #ifdef WEBGL1\n            #define texCube textureCube\n        #endif\n\n//         //Due to the way my depth-cubeMap is rendered, objects to the -x,y,z side is projected to the positive x,y,z side\n//         //Inside where top/bottom is to be drawn?\n        if (texCoord.s*4.> 1. && texCoord.s*4.<2.)\n        {\n            //Bottom (-y) quad\n            if (texCoord.t*3. < 1.)\n            {\n                vec3 dir=vec3(localST.s*2.-1.,-1.,-localST.t*2.+1.);//Due to the (arbitrary) way I choose as up in my depth-viewmatrix, i her emultiply the latter coordinate with -1\n                depth = texCube(cubeMap, dir);\n            }\n            //top (+y) quad\n            else if (texCoord.t*3. > 2.)\n            {\n                vec3 dir=vec3(localST.s*2.-1.,1.,localST.t*2.-1.);//Get lower y texture, which is projected to the +y part of my cubeMap\n                depth = texCube(cubeMap, dir);\n            }\n            else//Front (-z) quad\n            {\n                vec3 dir=vec3(localST.s*2.-1.,-localST.t*2.+1.,1.);\n                depth = texCube(cubeMap, dir);\n            }\n        }\n//         //If not, only these ranges should be drawn\n        else if (texCoord.t*3. > 1. && texCoord.t*3. < 2.)\n        {\n            if (texCoord.x*4. < 1.)//left (-x) quad\n            {\n                vec3 dir=vec3(-1.,-localST.t*2.+1.,localST.s*2.-1.);\n                depth = texCube(cubeMap, dir);\n            }\n            else if (texCoord.x*4. < 3.)//right (+x) quad (front was done above)\n            {\n                vec3 dir=vec3(1,-localST.t*2.+1.,-localST.s*2.+1.);\n                depth = texCube(cubeMap, dir);\n            }\n            else //back (+z) quad\n            {\n                vec3 dir=vec3(-localST.s*2.+1.,-localST.t*2.+1.,-1.);\n                depth = texCube(cubeMap, dir);\n            }\n        }\n        // colTex = vec4(vec3(depth),1.);\n        colTex = vec4(depth);\n    }\n\n    if(type==2.0)\n    {\n       float near = 0.1;\n       float far = 50.;\n       float depth = LinearizeDepth(colTex.r, near, far);\n       colTex.rgb = vec3(depth);\n    }\n\n    if(colTex.r>1.0 || colTex.r<0.0)\n    {\n        float r=mod( time+colTex.r,1.0)*0.5+0.5;\n        colTex.r=r;\n    }\n    if(colTex.g>1.0 || colTex.g<0.0)\n    {\n        float r=mod( time+colTex.g,1.0)*0.5+0.5;\n        colTex.g=r;\n    }\n    if(colTex.b>1.0 || colTex.b<0.0)\n    {\n        float r=mod( time+colTex.b,1.0)*0.5+0.5;\n        colTex.b=r;\n    }\n\n\n    outColor = mix(col,colTex,colTex.a);\n}\n\n",viztex_vert:"IN vec3 vPosition;\nIN vec2 attrTexCoord;\nOUT vec2 texCoord;\nUNI mat4 projMatrix;\nUNI mat4 modelMatrix;\nUNI mat4 viewMatrix;\n\nvoid main()\n{\n    texCoord=vec2(attrTexCoord.x,1.0-attrTexCoord.y);\n    vec4 pos = vec4( vPosition, 1. );\n    mat4 mvMatrix=viewMatrix * modelMatrix;\n    gl_Position = projMatrix * mvMatrix * pos;\n}"};const S=t.inTexture("Texture In"),C=t.inBool("Show Info",false),n=t.outTexture("Texture Out"),E=t.outString("Info");t.setUiAttrib({height:150,resizable:true});const M=new CABLES.Timer;M.play();S.onChange=()=>{const e=S.get();n.set(CGL.Texture.getEmptyTexture(t.patch.cgl));n.set(e)};t.renderVizLayer=(n,a)=>{const e=S;const t=5;const r=t+1;const o=CABLES.UI.uiProfiler.start("previewlayer texture");const i=e.parent.patch.cgl;if(!this._emptyCubemap)this._emptyCubemap=CGL.Texture.getEmptyCubemapTexture(i);e.parent.patch.cgl.profileData.profileTexPreviews++;const s=e.get()||CGL.Texture.getEmptyTexture(i);if(!this._mesh){const y=new CGL.Geometry("preview op rect");y.vertices=[1,1,0,-1,1,0,1,-1,0,-1,-1,0];y.texCoords=[1,1,0,1,1,0,0,0];y.verticesIndices=[0,1,2,3,1,2];this._mesh=new CGL.Mesh(i,y)}if(!this._shader){this._shader=new CGL.Shader(i,"glpreviewtex");this._shader.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]);this._shader.setSource(A.viztex_vert,A.viztex_frag);this._shaderTexUniform=new CGL.Uniform(this._shader,"t","tex",t);this._shaderTexCubemapUniform=new CGL.Uniform(this._shader,"tc","cubeMap",r);this._shaderTexUniformW=new CGL.Uniform(this._shader,"f","width",s.width);this._shaderTexUniformH=new CGL.Uniform(this._shader,"f","height",s.height);this._shaderTypeUniform=new CGL.Uniform(this._shader,"f","type",0);this._shaderTimeUniform=new CGL.Uniform(this._shader,"f","time",0)}i.pushPMatrix();const l=[s.width,s.height];const c=e.parent.patch.cgl.canvasWidth>l[0]&&e.parent.patch.cgl.canvasHeight>l[1];if(c){mat4.ortho(i.pMatrix,0,e.parent.patch.cgl.canvasWidth,e.parent.patch.cgl.canvasHeight,0,.001,11)}else mat4.ortho(i.pMatrix,-1,1,1,-1,.001,11);const u=i.getTexture(t);const _=i.getTexture(r);let d=0;if(!s)return;if(s.cubemap)d=1;if(s.textureType==CGL.Texture.TYPE_DEPTH)d=2;if(d==0||d==2){i.setTexture(t,s.tex);i.setTexture(r,this._emptyCubemap.cubemap,i.gl.TEXTURE_CUBE_MAP)}else if(d==1){i.setTexture(r,s.cubemap,i.gl.TEXTURE_CUBE_MAP)}M.update();this._shaderTimeUniform.setValue(M.get());this._shaderTypeUniform.setValue(d);let p=[e.parent.patch.cgl.canvasWidth,e.parent.patch.cgl.canvasHeight];i.gl.clearColor(0,0,0,0);i.gl.clear(i.gl.COLOR_BUFFER_BIT|i.gl.DEPTH_BUFFER_BIT);i.pushModelMatrix();if(c){p=l;mat4.translate(i.mMatrix,i.mMatrix,[l[0]/2,l[1]/2,0]);mat4.scale(i.mMatrix,i.mMatrix,[l[0]/2,l[1]/2,0])}this._mesh.render(this._shader);i.popModelMatrix();if(d==0)i.setTexture(t,u);if(d==1)i.setTexture(r,_);i.popPMatrix();i.resetViewPort();const g=[a.width,a.height];const f=false;if(!f){if(s.width>s.height)g[1]=a.width*l[1]/l[0];else{g[1]=a.width*(l[1]/l[0]);if(g[1]>a.height){const T=a.height/g[1];g[0]*=T;g[1]*=T}}}const m=g[0]>l[0]&&g[1]>l[1];n.imageSmoothingEnabled=!c||!m;if(!n.imageSmoothingEnabled){n.fillStyle="#ffffff";n.fillRect(a.x,a.y-10,10,10);n.fillStyle="#000000";n.fillRect(a.x,a.y-10,5,5);n.fillRect(a.x+5,a.y-10+5,5,5)}let v=10*a.width/a.height;let h=a.height/10;let b=a.width/v;for(let t=0;t<v;t++)for(let e=0;e<10;e++){if((t+e)%2==0)n.fillStyle="#333333";else n.fillStyle="#393939";n.fillRect(a.x+b*t,a.y+h*e,b,h)}n.fillStyle="#222";const x=(a.width-g[0])/2;const O=(a.height-g[1])/2;n.fillRect(a.x,a.y,x,a.height);n.fillRect(a.x+g[0]+x,a.y,x,a.height);n.fillRect(a.x,a.y,a.width,O);n.fillRect(a.x,a.y+g[1]+O,a.width,O);if(l[1]==1)n.drawImage(i.canvas,0,0,p[0],p[1],a.x,a.y,a.width,a.height*5);if(l[0]==1)n.drawImage(i.canvas,0,0,p[0],p[1],a.x,a.y,a.width*5,a.height);else n.drawImage(i.canvas,0,0,p[0],p[1],a.x+(a.width-g[0])/2,a.y+(a.height-g[1])/2,g[0],g[1]);let I="unknown";if(e.get()&&e.get().getInfoOneLine)I=e.get().getInfoOneLine();if(C.get()){n.save();n.scale(a.scale,a.scale);n.font="normal 10px sourceCodePro";n.fillStyle="#000";n.fillText(I,a.x/a.scale+5+.75,(a.y+a.height)/a.scale-5+.75);n.fillStyle="#fff";n.fillText(I,a.x/a.scale+5,(a.y+a.height)/a.scale-5);n.restore()}E.set(I);i.gl.clearColor(0,0,0,0);i.gl.clear(i.gl.COLOR_BUFFER_BIT|i.gl.DEPTH_BUFFER_BIT);o.finish()}};Ops.Ui.VizTexture.prototype=new CABLES.Op;CABLES.OPS["4ea2d7b0-ca74-45db-962b-4d1965ac20c0"]={f:Ops.Ui.VizTexture,objName:"Ops.Ui.VizTexture"};Ops.Gl.TextureEffects.DrawImage_v3=function(){CABLES.Op.apply(this,arguments);const a=this;const e={drawimage_frag:"#ifdef HAS_TEXTURES\n    IN vec2 texCoord;\n    UNI sampler2D tex;\n    UNI sampler2D image;\n#endif\n\n#ifdef TEX_TRANSFORM\n    IN mat3 transform;\n#endif\n// UNI float rotate;\n\n{{CGL.BLENDMODES}}\n\n#ifdef HAS_TEXTUREALPHA\n   UNI sampler2D imageAlpha;\n#endif\n\nUNI float amount;\n\n#ifdef ASPECT_RATIO\n    UNI float aspectTex;\n    UNI float aspectPos;\n#endif\n\nvoid main()\n{\n    vec4 blendRGBA=vec4(0.0,0.0,0.0,1.0);\n\n    #ifdef HAS_TEXTURES\n        vec2 tc=texCoord;\n\n        #ifdef TEX_FLIP_X\n            tc.x=1.0-tc.x;\n        #endif\n        #ifdef TEX_FLIP_Y\n            tc.y=1.0-tc.y;\n        #endif\n\n        #ifdef ASPECT_RATIO\n            #ifdef ASPECT_AXIS_X\n                tc.y=(1.0-aspectPos)-(((1.0-aspectPos)-tc.y)*aspectTex);\n            #endif\n            #ifdef ASPECT_AXIS_Y\n                tc.x=(1.0-aspectPos)-(((1.0-aspectPos)-tc.x)/aspectTex);\n            #endif\n        #endif\n\n        #ifdef TEX_TRANSFORM\n            vec3 coordinates=vec3(tc.x, tc.y,1.0);\n            tc=(transform * coordinates ).xy;\n        #endif\n\n        blendRGBA=texture(image,tc);\n\n        vec3 blend=blendRGBA.rgb;\n        vec4 baseRGBA=texture(tex,texCoord);\n        vec3 base=baseRGBA.rgb;\n\n\n        #ifdef PREMUL\n            blend.rgb = (blend.rgb) + (base.rgb * (1.0 - blendRGBA.a));\n        #endif\n\n        vec3 colNew=_blend(base,blend);\n\n\n\n\n        #ifdef REMOVE_ALPHA_SRC\n            blendRGBA.a=1.0;\n        #endif\n\n        #ifdef HAS_TEXTUREALPHA\n            vec4 colImgAlpha=texture(imageAlpha,tc);\n            float colImgAlphaAlpha=colImgAlpha.a;\n\n            #ifdef ALPHA_FROM_LUMINANCE\n                vec3 gray = vec3(dot(vec3(0.2126,0.7152,0.0722), colImgAlpha.rgb ));\n                colImgAlphaAlpha=(gray.r+gray.g+gray.b)/3.0;\n            #endif\n\n            #ifdef ALPHA_FROM_INV_UMINANCE\n                vec3 gray = vec3(dot(vec3(0.2126,0.7152,0.0722), colImgAlpha.rgb ));\n                colImgAlphaAlpha=1.0-(gray.r+gray.g+gray.b)/3.0;\n            #endif\n\n            #ifdef INVERT_ALPHA\n                colImgAlphaAlpha=clamp(colImgAlphaAlpha,0.0,1.0);\n                colImgAlphaAlpha=1.0-colImgAlphaAlpha;\n            #endif\n\n            blendRGBA.a=colImgAlphaAlpha*blendRGBA.a;\n        #endif\n    #endif\n\n    float am=amount;\n\n    #ifdef CLIP_REPEAT\n        if(tc.y>1.0 || tc.y<0.0 || tc.x>1.0 || tc.x<0.0)\n        {\n            // colNew.rgb=vec3(0.0);\n            am=0.0;\n        }\n    #endif\n\n    #ifdef ASPECT_RATIO\n        #ifdef ASPECT_CROP\n            if(tc.y>1.0 || tc.y<0.0 || tc.x>1.0 || tc.x<0.0)\n            {\n                colNew.rgb=base.rgb;\n                am=0.0;\n            }\n\n        #endif\n    #endif\n\n\n\n    #ifndef PREMUL\n        blendRGBA.rgb=mix(colNew,base,1.0-(am*blendRGBA.a));\n        blendRGBA.a=clamp(baseRGBA.a+(blendRGBA.a*am),0.,1.);\n    #endif\n\n    #ifdef PREMUL\n        // premultiply\n        // blendRGBA.rgb = (blendRGBA.rgb) + (baseRGBA.rgb * (1.0 - blendRGBA.a));\n        blendRGBA=vec4(\n            mix(colNew.rgb,base,1.0-(am*blendRGBA.a)),\n            blendRGBA.a*am+baseRGBA.a\n            );\n    #endif\n\n    #ifdef ALPHA_MASK\n    blendRGBA.a=baseRGBA.a;\n    #endif\n\n    outColor=blendRGBA;\n}\n\n\n\n\n\n\n\n",drawimage_vert:"IN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\n\nUNI mat4 projMatrix;\nUNI mat4 mvMatrix;\n\nOUT vec2 texCoord;\n// OUT vec3 norm;\n\n#ifdef TEX_TRANSFORM\n    UNI float posX;\n    UNI float posY;\n    UNI float scaleX;\n    UNI float scaleY;\n    UNI float rotate;\n    OUT mat3 transform;\n#endif\n\nvoid main()\n{\n   texCoord=attrTexCoord;\n//   norm=attrVertNormal;\n\n   #ifdef TEX_TRANSFORM\n        vec3 coordinates=vec3(attrTexCoord.x, attrTexCoord.y,1.0);\n        float angle = radians( rotate );\n        vec2 scale= vec2(scaleX,scaleY);\n        vec2 translate= vec2(posX,posY);\n\n        transform = mat3(   scale.x * cos( angle ), scale.x * sin( angle ), 0.0,\n            - scale.y * sin( angle ), scale.y * cos( angle ), 0.0,\n            - 0.5 * scale.x * cos( angle ) + 0.5 * scale.y * sin( angle ) - 0.5 * translate.x*2.0 + 0.5,  - 0.5 * scale.x * sin( angle ) - 0.5 * scale.y * cos( angle ) - 0.5 * translate.y*2.0 + 0.5, 1.0);\n   #endif\n\n   gl_Position = projMatrix * mvMatrix * vec4(vPosition,  1.0);\n}\n"};const t=a.inTrigger("render"),n=CGL.TextureEffect.AddBlendSelect(a,"blendMode"),r=a.inValueSlider("amount",1),o=a.inTexture("Image"),i=a.inValueBool("Premultiplied",false),s=a.inValueBool("Alpha Mask",false),l=a.inValueBool("removeAlphaSrc",false),c=a.inTexture("Mask"),u=a.inValueSelect("Mask Src",["alpha channel","luminance","luminance inv"],"luminance"),_=a.inValueBool("Invert alpha channel"),d=a.inValueBool("Aspect Ratio",false),p=a.inValueSelect("Stretch Axis",["X","Y"],"X"),g=a.inValueSlider("Position",0),f=a.inValueBool("Crop",false),m=a.outTrigger("trigger");n.set("normal");const v=a.patch.cgl;const h=new CGL.Shader(v,"drawimage");c.onLinkChanged=b;a.setPortGroup("Mask",[c,u,_]);a.setPortGroup("Aspect Ratio",[d,g,f,p]);function b(){if(c.isLinked()){l.setUiAttribs({greyout:true});u.setUiAttribs({greyout:false});_.setUiAttribs({greyout:false})}else{l.setUiAttribs({greyout:false});u.setUiAttribs({greyout:true});_.setUiAttribs({greyout:true})}}a.toWorkPortsNeedToBeLinked(o);h.setSource(e.drawimage_vert,e.drawimage_frag);const x=new CGL.Uniform(h,"t","tex",0),O=new CGL.Uniform(h,"t","image",1),I=new CGL.Uniform(h,"t","imageAlpha",2),y=new CGL.Uniform(h,"f","aspectTex",1),T=new CGL.Uniform(h,"f","aspectPos",g);d.onChange=f.onChange=p.onChange=A;function A(){h.removeDefine("ASPECT_AXIS_X");h.removeDefine("ASPECT_AXIS_Y");h.removeDefine("ASPECT_CROP");g.setUiAttribs({greyout:!d.get()});f.setUiAttribs({greyout:!d.get()});p.setUiAttribs({greyout:!d.get()});if(d.get()){h.define("ASPECT_RATIO");if(f.get())h.define("ASPECT_CROP");if(p.get()=="X")h.define("ASPECT_AXIS_X");if(p.get()=="Y")h.define("ASPECT_AXIS_Y")}else{h.removeDefine("ASPECT_RATIO");if(f.get())h.define("ASPECT_CROP");if(p.get()=="X")h.define("ASPECT_AXIS_X");if(p.get()=="Y")h.define("ASPECT_AXIS_Y")}}u.set("alpha channel");const S=a.inValueBool("flip x");const C=a.inValueBool("flip y");let E=a.inValueBool("Transform");let M=a.inValueSlider("Scale X",1);let N=a.inValueSlider("Scale Y",1);let L=a.inValue("Position X",0);let w=a.inValue("Position Y",0);let P=a.inValue("Rotation",0);const D=a.inValueBool("Clip Repeat",false);const R=new CGL.Uniform(h,"f","scaleX",M);const U=new CGL.Uniform(h,"f","scaleY",N);const j=new CGL.Uniform(h,"f","posX",L);const G=new CGL.Uniform(h,"f","posY",w);const V=new CGL.Uniform(h,"f","rotate",P);E.onChange=k;function k(){h.toggleDefine("TEX_TRANSFORM",E.get());M.setUiAttribs({greyout:!E.get()});N.setUiAttribs({greyout:!E.get()});L.setUiAttribs({greyout:!E.get()});w.setUiAttribs({greyout:!E.get()});P.setUiAttribs({greyout:!E.get()})}CGL.TextureEffect.setupBlending(a,h,n,r);const B=new CGL.Uniform(h,"f","amount",r);t.onTriggered=F;D.onChange=c.onChange=i.onChange=s.onChange=_.onChange=C.onChange=S.onChange=l.onChange=u.onChange=z;k();b();A();z();function z(){h.toggleDefine("REMOVE_ALPHA_SRC",l.get());h.toggleDefine("ALPHA_MASK",s.get());h.toggleDefine("CLIP_REPEAT",D.get());h.toggleDefine("HAS_TEXTUREALPHA",c.get()&&c.get().tex);h.toggleDefine("TEX_FLIP_X",S.get());h.toggleDefine("TEX_FLIP_Y",C.get());h.toggleDefine("INVERT_ALPHA",_.get());h.toggleDefine("ALPHA_FROM_LUMINANCE",u.get()=="luminance");h.toggleDefine("ALPHA_FROM_INV_UMINANCE",u.get()=="luminance_inv");h.toggleDefine("PREMUL",i.get())}function F(){if(!CGL.TextureEffect.checkOpInEffect(a))return;const e=o.get();if(e&&e.tex&&r.get()>0){v.pushShader(h);v.currentTextureEffect.bind();const t=v.currentTextureEffect.getCurrentSourceTexture();v.setTexture(0,t.tex);if(t&&e){if(e.textureType!=t.textureType&&(e.textureType!=CGL.Texture.TYPE_FLOAT||t.textureType!=CGL.Texture.TYPE_FLOAT))a.setUiError("textypediff","Drawing 32bit texture into an 8 bit can result in data/precision loss",1);else a.setUiError("textypediff",null)}const n=1/(v.currentTextureEffect.getWidth()/v.currentTextureEffect.getHeight())*(e.width/e.height);y.setValue(n);v.setTexture(1,e.tex);if(c.get()&&c.get().tex){v.setTexture(2,c.get().tex)}v.pushBlendMode(CGL.BLEND_NONE,true);v.currentTextureEffect.finish();v.popBlendMode();v.popShader()}m.trigger()}};Ops.Gl.TextureEffects.DrawImage_v3.prototype=new CABLES.Op;CABLES.OPS["8f6b2f15-fcb0-4597-90c0-e5173f2969fe"]={f:Ops.Gl.TextureEffects.DrawImage_v3,objName:"Ops.Gl.TextureEffects.DrawImage_v3"};Ops.Gl.TextureEffects.ImageCompose_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={imgcomp_frag:"UNI float a;\nvoid main()\n{\n   outColor= vec4(0.0,0.0,0.0,a);\n}\n"};const n=e.inTrigger("Render"),a=e.inBool("Use viewport size",true),r=e.inValueInt("Width",640),o=e.inValueInt("Height",480),i=e.inSwitch("Filter",["nearest","linear","mipmap"],"linear"),s=e.inValueSelect("Wrap",["clamp to edge","repeat","mirrored repeat"],"repeat"),l=e.inValueBool("HDR"),c=e.inValueBool("Transparent",false),u=e.outTrigger("Next"),_=e.outTexture("texture_out"),d=e.outValue("Aspect Ratio");const p=e.patch.cgl;e.setPortGroup("Texture Size",[a,r,o]);e.setPortGroup("Texture Settings",[s,i,l,c]);_.set(CGL.Texture.getEmptyTexture(p,l.get()));let g=null;let f=null;let m=8,v=8;const h=[0,0,0,0];let b=true;let x=CGL.Texture.FILTER_LINEAR;let O=CGL.Texture.WRAP_CLAMP_TO_EDGE;const I=0;const y=0;s.onChange=E;i.onChange=M;n.onTriggered=e.preRender=C;M();E();S();function T(){if(g)g.delete();if(f)f.delete();if(l.get()&&i.get()=="mipmap")e.setUiError("fpmipmap","Don't use mipmap and HDR at the same time, many systems do not support this.");else e.setUiError("fpmipmap",null);g=new CGL.TextureEffect(p,{isFloatingPointTexture:l.get()});f=new CGL.Texture(p,{name:"image_compose_v2_"+e.id,isFloatingPointTexture:l.get(),filter:x,wrap:O,width:Math.ceil(r.get()),height:Math.ceil(o.get())});g.setSourceTexture(f);_.set(CGL.Texture.getEmptyTexture(p,l.get()));b=false}l.onChange=function(){b=true};function A(){if(!g)T();if(a.get()){m=p.getViewPort()[2];v=p.getViewPort()[3]}else{m=Math.ceil(r.get());v=Math.ceil(o.get())}d.set(m/v);if((m!=f.width||v!=f.height)&&(m!==0&&v!==0)){f.setSize(m,v);g.setSourceTexture(f);_.set(CGL.Texture.getEmptyTexture(p,l.get()));_.set(f)}}function S(){r.setUiAttribs({greyout:a.get()});o.setUiAttribs({greyout:a.get()})}a.onChange=function(){S()};e.preRender=function(){C()};function C(){if(!g||b)T();const e=p.getViewPort();h[0]=e[0];h[1]=e[1];h[2]=e[2];h[3]=e[3];p.pushBlend(false);A();const t=p.currentTextureEffect;p.currentTextureEffect=g;p.currentTextureEffect.width=r.get();p.currentTextureEffect.height=o.get();g.setSourceTexture(f);let n=CGL.Texture.getBlackTexture(p);if(c.get())n=CGL.Texture.getEmptyTexture(p,l.get());g.startEffect(n);u.trigger();_.set(g.getCurrentSourceTexture());g.endEffect();p.setViewPort(h[0],h[1],h[2],h[3]);p.popBlend(false);p.currentTextureEffect=t}function E(){if(s.get()=="repeat")O=CGL.Texture.WRAP_REPEAT;if(s.get()=="mirrored repeat")O=CGL.Texture.WRAP_MIRRORED_REPEAT;if(s.get()=="clamp to edge")O=CGL.Texture.WRAP_CLAMP_TO_EDGE;b=true}function M(){if(i.get()=="nearest")x=CGL.Texture.FILTER_NEAREST;if(i.get()=="linear")x=CGL.Texture.FILTER_LINEAR;if(i.get()=="mipmap")x=CGL.Texture.FILTER_MIPMAP;b=true}};Ops.Gl.TextureEffects.ImageCompose_v2.prototype=new CABLES.Op;CABLES.OPS["a5b43d4c-a9ea-4eaf-9ed0-f257d222659d"]={f:Ops.Gl.TextureEffects.ImageCompose_v2,objName:"Ops.Gl.TextureEffects.ImageCompose_v2"};Ops.Gl.Meshes.Rectangle_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("render"),a=e.outTrigger("trigger"),I=e.inValue("width",1),y=e.inValue("height",1),T=e.inSwitch("pivot x",["left","center","right"]),A=e.inSwitch("pivot y",["top","center","bottom"]),S=e.inValueInt("num columns",1),C=e.inValueInt("num rows",1),E=e.inSwitch("axis",["xy","xz"],"xy"),r=e.inValueBool("Active",true),M=e.outObject("geometry",null,"geometry");M.ignoreValueSerialize=true;const N=e.patch.cgl;E.set("xy");T.set("center");A.set("center");e.setPortGroup("Pivot",[T,A]);e.setPortGroup("Size",[I,y]);e.setPortGroup("Structure",[S,C]);e.toWorkPortsNeedToBeLinked(n);const L=new CGL.Geometry("rectangle");let w=null;let P=false;E.onChange=T.onChange=A.onChange=I.onChange=y.onChange=C.onChange=S.onChange=o;i();function o(){P=true}e.preRender=n.onTriggered=function(){if(!CGL.TextureEffect.checkOpNotInTextureEffect(e))return;if(P)i();if(r.get()&&w)w.render(N.getShader());a.trigger()};function i(){let e=I.get();let t=parseFloat(y.get());let n=0;let a=0;if(typeof e=="string")e=parseFloat(e);if(typeof t=="string")t=parseFloat(t);if(T.get()=="center")n=0;else if(T.get()=="right")n=-e/2;else if(T.get()=="left")n=+e/2;if(A.get()=="center")a=0;else if(A.get()=="top")a=-t/2;else if(A.get()=="bottom")a=+t/2;const r=[];const o=[];const i=[];const s=[];const l=[];const c=[];const u=Math.round(C.get());const _=Math.round(S.get());const d=e/_;const p=t/u;let g,f,m;m=E.get();for(f=0;f<=u;f++){for(g=0;g<=_;g++){r.push(g*d-I.get()/2+n);if(m=="xz")r.push(0);r.push(f*p-y.get()/2+a);if(m=="xy")r.push(0);o.push(g/_);o.push(1-f/u);if(m=="xz"){i.push(0,1,0);s.push(1,0,0);l.push(0,0,1)}else if(m=="xy"){i.push(0,0,1);s.push(-1,0,0);l.push(0,-1,0)}}}for(g=0;g<_;g++){for(f=0;f<u;f++){const v=g+(_+1)*f;const h=v;const b=v+1;const x=v+_+1;const O=v+1+_+1;c.push(h);c.push(x);c.push(b);c.push(b);c.push(x);c.push(O)}}L.clear();L.vertices=r;L.texCoords=o;L.verticesIndices=c;L.vertexNormals=i;L.tangents=s;L.biTangents=l;if(_*u>64e3)L.unIndex();if(!w)w=new CGL.Mesh(N,L);else w.setGeom(L);M.set(null);M.set(L);P=false}e.onDelete=function(){if(w)w.dispose()}};Ops.Gl.Meshes.Rectangle_v2.prototype=new CABLES.Op;CABLES.OPS["fc5718d6-11a5-496e-8f16-1c78b1a2824c"]={f:Ops.Gl.Meshes.Rectangle_v2,objName:"Ops.Gl.Meshes.Rectangle_v2"};Ops.Gl.GradientTexture=function(){CABLES.Op.apply(this,arguments);const n=this;const e={};const a=n.inGradient("Gradient"),E=n.inValueSelect("Direction",["X","Y","Radial"],"X"),M=n.inValueBool("Smoothstep",false),N=n.inBool("Step",false),L=n.inBool("Flip",false),w=n.inBool("sRGB",false),P=n.inBool("Oklab",false),D=n.inValueInt("Size",256),R=n.inSwitch("filter",["nearest","linear","mipmap"],"linear"),U=n.inValueSelect("wrap",["clamp to edge","repeat","mirrored repeat"],"clamp to edge"),r=n.inArray("Gradient Array"),t=n.inTriggerButton("Randomize Colors"),j=n.outTexture("Texture"),G=n.outArray("Colors",null,3),V=n.outArray("Colors Pos",null,1);const k=n.patch.cgl;U.onChange=R.onChange=N.onChange=L.onChange=w.onChange=P.onChange=D.onChange=a.onChange=M.onChange=E.onChange=r.onChange=o;a.set('{"keys" : [{"pos":0,"r":0,"g":0,"b":0},{"pos":0.25,"r":0,"g":0,"b":0},{"pos":0.75,"r":1,"g":1,"b":1},{"pos":1,"r":1,"g":1,"b":1}]}');n.onLoaded=o;t.onTriggered=()=>{const e=i();if(e){e.forEach(e=>{e.r=Math.random();e.g=Math.random();e.b=Math.random()});const t=JSON.stringify({keys:e});a.set(t)}};function B(e,t,n){let a=.4122214708*e+.5363325363*t+.0514459929*n;let r=.2119034982*e+.6806995451*t+.1073969566*n;let o=.0883024619*e+.2817188376*t+.6299787005*n;a=Math.cbrt(a);r=Math.cbrt(r);o=Math.cbrt(o);return[a*+.2104542553+r*+.793617785+o*-.0040720468,a*+1.9779984951+r*-2.428592205+o*+.4505937099,a*+.0259040371+r*+.7827717662+o*-.808675766]}function l(e,t,n){return Math.max(Math.min(e,n),t)}function z(e,t,n){let a=e+t*+.3963377774+n*+.2158037573;let r=e+t*-.1055613458+n*-.0638541728;let o=e+t*-.0894841775+n*-1.291485548;a**=3;r**=3;o**=3;let i=a*+4.0767416621+r*-3.3077115913+o*+.2309699292;let s=a*-1.2684380046+r*+2.6097574011+o*-.3413193965;var n=a*-.0041960863+r*-.7034186147+o*+1.707614701;i=l(i,0,1);s=l(s,0,1);n=l(n,0,1);return[i,s,n]}function F(e,t,n){e/=255;const a=.0031308;let r=12.92*e;let o=1.055*Math.pow(e,.41666)-.055;return(e<a?r:o)*255}function o(){const e=i();if(e)s(e)}function i(){let t=null;n.setUiError("nodata",null);n.setUiError("parse",null);if(Array.isArray(r.get())){t=r.get()}else{let e=null;if(!a.get()||a.get()===""){n.setUiError("nodata","gradient no data");return null}try{e=JSON.parse(a.get())}catch(e){n.setUiError("parse","could not parse gradient data")}if(!e||!e.keys){n.setUiError("nodata","gradient no data");return null}t=e.keys}return t}function s(t){let a=Math.round(D.get());if(a<4)a=4;let e=0;let n=0;if(U.get()=="repeat")e=CGL.Texture.WRAP_REPEAT;else if(U.get()=="mirrored repeat")e=CGL.Texture.WRAP_MIRRORED_REPEAT;else if(U.get()=="clamp to edge")e=CGL.Texture.WRAP_CLAMP_TO_EDGE;if(R.get()=="nearest")n=CGL.Texture.FILTER_NEAREST;else if(R.get()=="linear")n=CGL.Texture.FILTER_LINEAR;else if(R.get()=="mipmap")n=CGL.Texture.FILTER_MIPMAP;const r=new CGL.Texture(k);if(E.get()=="X"||E.get()=="Y"){const s=new Uint8Array(a*4);for(let e=0;e<t.length-1;e++){const l=t[e];const c=t[e+1];for(let n=l.pos*a;n<c.pos*a;n++){let e=CABLES.map(n,l.pos*a,c.pos*a,0,1);if(N.get())e=Math.round(e);if(M.get())e=CABLES.smoothStep(e);n=Math.round(n);let t=n;if(L.get())t=a-n-1;if(P.get()){const u=B(l.r,l.g,l.b);const _=u[0];const d=u[1];const p=u[2];const g=B(c.r,c.g,c.b);const f=g[0];const m=g[1];const v=g[2];const h=e*f+(1-e)*_;const b=e*m+(1-e)*d;const x=e*v+(1-e)*p;const O=z(h,b,x);s[t*4+0]=Math.round(O[0]*255);s[t*4+1]=Math.round(O[1]*255);s[t*4+2]=Math.round(O[2]*255)}else{s[t*4+0]=Math.round((e*c.r+(1-e)*l.r)*255);s[t*4+1]=Math.round((e*c.g+(1-e)*l.g)*255);s[t*4+2]=Math.round((e*c.b+(1-e)*l.b)*255)}if(typeof l.a!=="undefined"&&typeof c.a!=="undefined"){const I=Math.round((e*c.a+(1-e)*l.a)*255);s[t*4+3]=I}else{s[t*4+3]=Math.round(255)}}}if(w.get())for(let e=0;e<s.length;e+=4){s[e+0]=F(s[e+0]);s[e+1]=F(s[e+1]);s[e+2]=F(s[e+2])}if(E.get()=="X")r.initFromData(s,a,1,n,e);if(E.get()=="Y")r.initFromData(s,1,a,n,e)}if(E.get()=="Radial"){const s=new Uint8Array(a*a*4);const y=new CABLES.Anim;const T=new CABLES.Anim;const A=new CABLES.Anim;for(let e=0;e<t.length-1;e++){y.setValue(t[e].pos,t[e].r);T.setValue(t[e].pos,t[e].g);A.setValue(t[e].pos,t[e].b)}for(let n=0;n<a;n++){for(let t=0;t<a;t++){const S=n-(a-1)/2;const C=t-(a-1)/2;let e=Math.sqrt(S*S+C*C)/a*2;if(M.get())e=CABLES.smoothStep(e);s[n*4+t*4*a+0]=y.getValue(e)*255;s[n*4+t*4*a+1]=T.getValue(e)*255;s[n*4+t*4*a+2]=A.getValue(e)*255;s[n*4+t*4*a+3]=Math.round(255)}}if(w.get())for(let e=0;e<s.length;e+=4){s[e+0]=F(s[e+0]);s[e+1]=F(s[e+1]);s[e+2]=F(s[e+2])}r.initFromData(s,a,a,n,e)}const o=[];for(let e=0;e<t.length-1;e++){o.push(t[e].r,t[e].g,t[e].b)}const i=[];for(let e=0;e<t.length-1;e++){i.push(t[e].pos)}G.set(o);V.set(i);j.set(null);j.set(r)}};Ops.Gl.GradientTexture.prototype=new CABLES.Op;CABLES.OPS["01380a50-2dbb-4465-ae80-86349b0b717a"]={f:Ops.Gl.GradientTexture,objName:"Ops.Gl.GradientTexture"};Ops.Gl.TextureEffects.ChromaticAberration=function(){CABLES.Op.apply(this,arguments);const t=this;const e={chromatic_frag:"\nIN vec2 texCoord;\nUNI sampler2D tex;\nUNI float pixel;\nUNI float onePixel;\nUNI float amount;\nUNI float lensDistort;\n\n#ifdef MASK\nUNI sampler2D texMask;\n#endif\n\n{{CGL.BLENDMODES}}\n\nvoid main()\n{\n   vec4 base=texture(tex,texCoord);\n   vec4 col=texture(tex,texCoord);\n\n   vec2 tc=texCoord;;\n   float pix = pixel;\n   if(lensDistort>0.0)\n   {\n       float dist = distance(texCoord, vec2(0.5,0.5));\n       tc-=0.5;\n       tc *=smoothstep(-0.9,1.0*lensDistort,1.0-dist);\n       tc+=0.5;\n   }\n\n    #ifdef MASK\n        vec4 m=texture(texMask,texCoord);\n        pix*=m.r*m.a;\n    #endif\n\n    #ifdef SMOOTH\n    #ifdef WEBGL2\n        float numSamples=round(pix/onePixel/4.0+1.0);\n        col.r=0.0;\n        col.b=0.0;\n\n        for(float off=0.0;off<numSamples;off++)\n        {\n            float diff=(pix/numSamples)*off;\n            col.r+=texture(tex,vec2(tc.x+diff,tc.y)).r/numSamples;\n            col.b+=texture(tex,vec2(tc.x-diff,tc.y)).b/numSamples;\n        }\n    #endif\n    #endif\n\n    #ifndef SMOOTH\n        col.r=texture(tex,vec2(tc.x+pix,tc.y)).r;\n        col.b=texture(tex,vec2(tc.x-pix,tc.y)).b;\n    #endif\n\n//   outColor = col;\n   outColor= cgl_blend(base,col,amount);\n\n}\n"};const n=t.inTrigger("render"),a=CGL.TextureEffect.AddBlendSelect(t,"Blend Mode","normal"),r=t.inValueSlider("Amount",1),o=t.inValue("Pixel",5),i=t.inValueSlider("Lens Distort",0),s=t.inValueBool("Smooth",false),l=t.inTexture("Mask"),c=t.outTrigger("trigger");const u=t.patch.cgl;const _=new CGL.Shader(u,"chromatic");CGL.TextureEffect.setupBlending(t,_,a,r);_.setSource(_.getDefaultVertexShader(),e.chromatic_frag);const d=new CGL.Uniform(_,"t","tex",0),p=new CGL.Uniform(_,"f","pixel",0),g=new CGL.Uniform(_,"f","onePixel",0),f=new CGL.Uniform(_,"t","texMask",1),m=new CGL.Uniform(_,"f","amount",r),v=new CGL.Uniform(_,"f","lensDistort",i);s.onChange=function(){if(s.get())_.define("SMOOTH");else _.removeDefine("SMOOTH")};l.onChange=function(){if(l.get())_.define("MASK");else _.removeDefine("MASK")};n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(t))return;var e=u.currentTextureEffect.getCurrentSourceTexture();p.setValue(o.get()*(1/e.width));g.setValue(1/e.width);u.pushShader(_);u.currentTextureEffect.bind();u.setTexture(0,e.tex);if(l.get())u.setTexture(1,l.get().tex);u.currentTextureEffect.finish();u.popShader();c.trigger()}};Ops.Gl.TextureEffects.ChromaticAberration.prototype=new CABLES.Op;CABLES.OPS["38ac43a1-1757-48f4-9450-29f07ac0d376"]={f:Ops.Gl.TextureEffects.ChromaticAberration,objName:"Ops.Gl.TextureEffects.ChromaticAberration"};Ops.Gl.TextureEffects.ImageCompose_v3=function(){CABLES.Op.apply(this,arguments);const n=this;const e={imgcomp_frag:"IN vec2 texCoord;\nUNI vec4 bgColor;\nUNI sampler2D tex;\n\nvoid main()\n{\n\n    #ifndef USE_TEX\n        outColor=bgColor;\n    #endif\n    #ifdef USE_TEX\n        outColor=texture(tex,texCoord);\n    #endif\n\n\n\n}\n"};const a=n.patch.cgl,t=n.inTrigger("Render"),r=n.inTexture("Base Texture"),o=n.inSwitch("Size",["Auto","Manual"],"Auto"),i=n.inValueInt("Width",640),s=n.inValueInt("Height",480),l=n.inSwitch("Filter",["nearest","linear","mipmap"],"linear"),c=n.inValueSelect("Wrap",["clamp to edge","repeat","mirrored repeat"],"repeat"),u=n.inDropDown("Pixel Format",CGL.Texture.PIXELFORMATS,CGL.Texture.PFORMATSTR_RGBA8UB),_=n.inValueSlider("R",0),d=n.inValueSlider("G",0),p=n.inValueSlider("B",0),g=n.inValueSlider("A",0),f=n.outTrigger("Next"),m=n.outTexture("texture_out",CGL.Texture.getEmptyTexture(a)),v=n.outNumber("Aspect Ratio"),h=n.outNumber("Texture Width"),b=n.outNumber("Texture Height");n.setPortGroup("Texture Size",[o,i,s]);n.setPortGroup("Texture Parameters",[c,l,u]);_.setUiAttribs({colorPick:true});n.setPortGroup("Color",[_,d,p,g]);const x=[0,0,0,0];let O=null;let I=null;let y=true;let T=false;let A=null;let S=null;let C=null;c.onChange=l.onChange=u.onChange=D;r.onLinkChanged=o.onChange=G;t.onTriggered=n.preRender=k;G();function E(){if(O)O.delete();if(I)I.delete();O=new CGL.TextureEffect(a,{isFloatingPointTexture:L()});I=new CGL.Texture(a,{name:"image_compose_v2_"+n.id,isFloatingPointTexture:L(),filter:M(),wrap:N(),width:w(),height:P()});O.setSourceTexture(I);h.set(w());b.set(P());v.set(w()/P());m.set(CGL.Texture.getEmptyTexture(a));y=false;G()}function M(){if(l.get()=="nearest")return CGL.Texture.FILTER_NEAREST;else if(l.get()=="linear")return CGL.Texture.FILTER_LINEAR;else if(l.get()=="mipmap")return CGL.Texture.FILTER_MIPMAP}function N(){if(c.get()=="repeat")return CGL.Texture.WRAP_REPEAT;else if(c.get()=="mirrored repeat")return CGL.Texture.WRAP_MIRRORED_REPEAT;else if(c.get()=="clamp to edge")return CGL.Texture.WRAP_CLAMP_TO_EDGE}function L(){T=u.get()==CGL.Texture.PFORMATSTR_RGBA32F;return T}function w(){if(r.get()&&o.get()=="Auto")return r.get().width;if(o.get()=="Auto")return a.getViewPort()[2];return Math.ceil(i.get())}function P(){if(r.get()&&o.get()=="Auto")return r.get().height;else if(o.get()=="Auto")return a.getViewPort()[3];else return Math.ceil(s.get())}function D(){y=true}function R(){if((w()!=I.width||P()!=I.height||I.isFloatingPoint()!=L()||I.filter!=M()||I.wrap!=N())&&(w()!==0&&P()!==0)){E();O.setSourceTexture(I);m.set(CGL.Texture.getEmptyTexture(a));m.set(I);U()}}function U(){let e=null;if(o.get()=="Manual"){e=null}else if(o.get()=="Auto"){if(r.get())e="Input Texture";else e="Canvas Size";e+=": "+w()+" x "+P()}let t=false;t=o.uiAttribs.info!=e;o.setUiAttribs({info:e});if(t)n.refreshParams()}function j(){if(A)A.toggleDefine("USE_TEX",r.isLinked())}function G(){_.setUiAttribs({greyout:r.isLinked()});p.setUiAttribs({greyout:r.isLinked()});d.setUiAttribs({greyout:r.isLinked()});g.setUiAttribs({greyout:r.isLinked()});i.setUiAttribs({greyout:o.get()=="Auto"});s.setUiAttribs({greyout:o.get()=="Auto"});i.setUiAttribs({hideParam:o.get()!="Manual"});s.setUiAttribs({hideParam:o.get()!="Manual"});if(I)if(L()&&M()==CGL.Texture.FILTER_MIPMAP)n.setUiError("fpmipmap","Don't use mipmap and 32bit at the same time, many systems do not support this.");else n.setUiError("fpmipmap",null);U();j()}n.preRender=()=>{k()};function V(){if(!A){A=new CGL.Shader(a,"copytextureshader");A.setSource(A.getDefaultVertexShader(),e.imgcomp_frag);S=new CGL.Uniform(A,"t","tex",0);C=new CGL.Uniform(A,"4f","bgColor",_,d,p,g);j()}a.pushShader(A);a.currentTextureEffect.bind();if(r.get())a.setTexture(0,r.get().tex);a.currentTextureEffect.finish();a.popShader()}function k(){if(!O||y)E();const e=a.getViewPort();x[0]=e[0];x[1]=e[1];x[2]=e[2];x[3]=e[3];a.pushBlend(false);R();const t=a.currentTextureEffect;a.currentTextureEffect=O;a.currentTextureEffect.imgCompVer=3;a.currentTextureEffect.width=i.get();a.currentTextureEffect.height=s.get();O.setSourceTexture(I);O.startEffect(r.get()||CGL.Texture.getEmptyTexture(a,T),true);V();f.trigger();m.set(CGL.Texture.getEmptyTexture(a));m.set(O.getCurrentSourceTexture());O.endEffect();a.setViewPort(x[0],x[1],x[2],x[3]);a.popBlend(false);a.currentTextureEffect=t}};Ops.Gl.TextureEffects.ImageCompose_v3.prototype=new CABLES.Op;CABLES.OPS["e890a050-11b7-456e-b09b-d08cd9c1ee41"]={f:Ops.Gl.TextureEffects.ImageCompose_v3,objName:"Ops.Gl.TextureEffects.ImageCompose_v3"};Ops.Gl.ColorMask=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("Execute"),a=e.inValueBool("Red",true),r=e.inValueBool("Green",true),o=e.inValueBool("Blue",true),i=e.inValueBool("Alpha",true),s=e.outTrigger("Next");const l=e.patch.cgl;n.onTriggered=function(){l.gl.colorMask(a.get(),r.get(),o.get(),i.get());s.trigger();e.patch.cgl.gl.colorMask(true,true,true,true)}};Ops.Gl.ColorMask.prototype=new CABLES.Op;CABLES.OPS["44433419-dcf4-46e6-8f40-d331598029ac"]={f:Ops.Gl.ColorMask,objName:"Ops.Gl.ColorMask"};Ops.Gl.TextureEffects.ColorChannel_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={colorchannel_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\n\nvoid main()\n{\n    vec4 color=texture(tex,texCoord);\n    vec4 col=vec4(0.0,0.0,0.0,color.a);\n\n   #ifdef CHANNEL_R\n        col.r=color.r;\n        #ifdef MONO\n            col.g=col.b=col.r;\n        #endif\n   #endif\n\n   #ifdef CHANNEL_G\n       col.g=color.g;\n       #ifdef MONO\n            col.r=col.b=col.g;\n       #endif\n   #endif\n\n   #ifdef CHANNEL_B\n       col.b=color.b;\n       #ifdef MONO\n            col.g=col.r=col.b;\n       #endif\n   #endif\n\n   #ifdef CHANNEL_A\n       col.r=col.g=col.b=color.a;\n   #endif\n\n   outColor = col;\n}"};const n=e.inTrigger("render"),a=e.inValueBool("channelR",true),r=e.inValueBool("channelG",false),o=e.inValueBool("channelB",false),i=e.inValueBool("channelA",false),s=e.inValueBool("mono",false),l=e.outTrigger("trigger");const c=e.patch.cgl;const u=new CGL.Shader(c,e.name);u.setSource(u.getDefaultVertexShader(),t.colorchannel_frag||"");let _=new CGL.Uniform(u,"t","tex",0);s.onChange=i.onChange=a.onChange=r.onChange=o.onChange=d;d();n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;c.pushShader(u);c.currentTextureEffect.bind();c.setTexture(0,c.currentTextureEffect.getCurrentSourceTexture().tex);c.currentTextureEffect.finish();c.popShader();l.trigger()};function d(){u.toggleDefine("CHANNEL_R",a.get());u.toggleDefine("CHANNEL_G",r.get());u.toggleDefine("CHANNEL_B",o.get());u.toggleDefine("CHANNEL_A",i.get());u.toggleDefine("MONO",s.get())}};Ops.Gl.TextureEffects.ColorChannel_v2.prototype=new CABLES.Op;CABLES.OPS["0a512974-0920-4aa8-89dc-4dda184c0d46"]={f:Ops.Gl.TextureEffects.ColorChannel_v2,objName:"Ops.Gl.TextureEffects.ColorChannel_v2"};Ops.Gl.TextureEffects.ColorBalance_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={colorbalance_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float r;\nUNI float g;\nUNI float b;\n\nfloat lumi(vec3 color)\n{\n    return vec3(dot(vec3(0.2126,0.7152,0.0722), color)).r;\n}\n\nvoid main()\n{\n    vec4 base=texture(tex,texCoord);\n    float l=lumi(base.rgb);\n\n    #ifdef TONE_MID\n        l=smoothstep(0.33,0.66,l);\n    #endif\n\n    #ifdef TONE_LOW\n        l=1.0-l;\n    #endif\n\n    l=l*l;\n    vec3 color=base.rgb+vec3(l*r*0.1,l*g*0.1,l*b*0.1);\n    outColor= vec4(color,base.a);\n}\n"};const n=e.inTrigger("render"),a=e.outTrigger("trigger"),r=e.inValueSelect("Tone",["Highlights","Midtones","Shadows"],"Highlights"),o=e.inValue("r"),i=e.inValue("g"),s=e.inValue("b");const l=e.patch.cgl;const c=new CGL.Shader(l,e.name);c.setSource(c.getDefaultVertexShader(),t.colorbalance_frag);const u=new CGL.Uniform(c,"t","tex",0),_=new CGL.Uniform(c,"f","r",o),d=new CGL.Uniform(c,"f","g",i),p=new CGL.Uniform(c,"f","b",s);r.onChange=function(){c.toggleDefine("TONE_HIGH",r.get()=="Highlights");c.toggleDefine("TONE_MID",r.get()=="Midtones");c.toggleDefine("TONE_LOW",r.get()=="Shadows")};n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e,3))return;l.pushShader(c);l.currentTextureEffect.bind();l.setTexture(0,l.currentTextureEffect.getCurrentSourceTexture().tex);l.currentTextureEffect.finish();l.popShader();a.trigger()}};Ops.Gl.TextureEffects.ColorBalance_v2.prototype=new CABLES.Op;CABLES.OPS["5af81475-2aa6-451b-a1f3-0980f641a72e"]={f:Ops.Gl.TextureEffects.ColorBalance_v2,objName:"Ops.Gl.TextureEffects.ColorBalance_v2"};Ops.Anim.Timer_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValue("Speed",1),n=e.inValueBool("Play",true),r=e.inTriggerButton("Reset"),o=e.inValueBool("Sync to timeline",false),i=e.outNumber("Time");e.setPortGroup("Controls",[n,r,a]);const s=new CABLES.Timer;let l=null;let c=0;let u=false;n.onChange=_;_();function _(){if(n.get()){s.play();e.patch.addOnAnimFrame(e)}else{s.pause();e.patch.removeOnAnimFrame(e)}}r.onTriggered=d;function d(){c=0;l=null;s.setTime(0);i.set(0)}o.onChange=function(){u=o.get();n.setUiAttribs({greyout:u});r.setUiAttribs({greyout:u})};e.onAnimFrame=function(e){if(s.isPlaying()){if(CABLES.overwriteTime!==undefined){i.set(CABLES.overwriteTime*a.get())}else if(u){i.set(e*a.get())}else{s.update();const t=s.get();if(l===null){l=t;return}const n=Math.abs(t-l);l=t;c+=n*a.get();if(c!=c)c=0;i.set(c)}}}};Ops.Anim.Timer_v2.prototype=new CABLES.Op;CABLES.OPS["aac7f721-208f-411a-adb3-79adae2e471a"]={f:Ops.Anim.Timer_v2,objName:"Ops.Anim.Timer_v2"};Ops.Gl.Meshes.FullscreenRectangle=function(){CABLES.Op.apply(this,arguments);const e=this;const t={shader_frag:"UNI sampler2D tex;\nIN vec2 texCoord;\n\nvoid main()\n{\n    outColor= texture(tex,texCoord);\n}\n\n",shader_vert:"{{MODULES_HEAD}}\n\nIN vec3 vPosition;\nUNI mat4 projMatrix;\nUNI mat4 mvMatrix;\n\nOUT vec2 texCoord;\nIN vec2 attrTexCoord;\n\nvoid main()\n{\n   vec4 pos=vec4(vPosition,  1.0);\n\n   texCoord=vec2(attrTexCoord.x,(1.0-attrTexCoord.y));\n\n   gl_Position = projMatrix * mvMatrix * pos;\n}\n"};const n=e.inTrigger("render"),a=e.inSwitch("Scale",["Stretch","Fit"],"Fit"),r=e.inValueBool("Flip Y"),o=e.inValueBool("Flip X"),i=e.inTexture("Texture"),s=e.outTrigger("trigger");const l=e.patch.cgl;let c=null;let u=new CGL.Geometry("fullscreen rectangle");let _=0,d=0,p=0,g=0,f=0;o.onChange=T;r.onChange=T;n.onTriggered=y;i.onLinkChanged=O;e.toWorkPortsNeedToBeLinked(n);const m=new CGL.Shader(l,"fullscreenrectangle");m.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]);m.setSource(t.shader_vert,t.shader_frag);m.fullscreenRectUniform=new CGL.Uniform(m,"t","tex",0);m.aspectUni=new CGL.Uniform(m,"f","aspectTex",0);let v=false;let h=true;let b=false;let x=[];O();i.onChange=function(){h=true};function O(){if(!CABLES.UI)return;r.setUiAttribs({greyout:!i.isLinked()});o.setUiAttribs({greyout:!i.isLinked()});a.setUiAttribs({greyout:!i.isLinked()})}function I(){let e=i.get();if(e)v=true;else v=false}e.preRender=function(){I();m.bind();if(c)c.render(m);y()};a.onChange=()=>{b=a.get()=="Fit"};function y(){if(l.getViewPort()[2]!=g||l.getViewPort()[3]!=f||!c)A();if(h)I();l.pushPMatrix();mat4.identity(l.pMatrix);mat4.ortho(l.pMatrix,0,g,f,0,-10,1e3);l.pushModelMatrix();mat4.identity(l.mMatrix);l.pushViewMatrix();mat4.identity(l.vMatrix);if(b&&i.get()){const n=i.get().width/i.get().height;let e=f;let t=f*n;if(t>g){e=g*1/n;t=g}x[0]=l.getViewPort()[0];x[1]=l.getViewPort()[1];x[2]=l.getViewPort()[2];x[3]=l.getViewPort()[3];l.setViewPort((g-t)/2,(f-e)/2,t,e)}if(v){if(i.get())l.setTexture(0,i.get().tex);c.render(m)}else{c.render(l.getShader())}l.gl.clear(l.gl.DEPTH_BUFFER_BIT);l.popPMatrix();l.popModelMatrix();l.popViewMatrix();if(b&&i.get())l.setViewPort(x[0],x[1],x[2],x[3]);s.trigger()}function T(){c=null}function A(){const e=l.getViewPort();if(e[2]==g&&e[3]==f&&c)return;let t=0,n=0;g=e[2];f=e[3];u.vertices=new Float32Array([t+g,n+f,0,t,n+f,0,t+g,n,0,t,n,0]);let a=null;if(r.get())a=new Float32Array([1,0,0,0,1,1,0,1]);else a=new Float32Array([1,1,0,1,1,0,0,0]);if(o.get()){a[0]=0;a[2]=1;a[4]=0;a[6]=1}u.setTexCoords(a);u.verticesIndices=new Uint16Array([2,1,0,3,1,2]);u.vertexNormals=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]);u.tangents=new Float32Array([-1,0,0,-1,0,0,-1,0,0,-1,0,0]);u.biTangents==new Float32Array([0,-1,0,0,-1,0,0,-1,0,0,-1,0]);if(!c)c=new CGL.Mesh(l,u);else c.setGeom(u)}};Ops.Gl.Meshes.FullscreenRectangle.prototype=new CABLES.Op;CABLES.OPS["255bd15b-cc91-4a12-9b4e-53c710cbb282"]={f:Ops.Gl.Meshes.FullscreenRectangle,objName:"Ops.Gl.Meshes.FullscreenRectangle"};Ops.Sidebar.Sidebar=function(){CABLES.Op.apply(this,arguments);const i=this;const n={style_css:" /*\n * SIDEBAR\n  http://danielstern.ca/range.css/#/\n  https://developer.mozilla.org/en-US/docs/Web/CSS/::-webkit-progress-value\n */\n\n.sidebar-icon-undo\n{\n    width:10px;\n    height:10px;\n    background-image: url(\"data:image/svg+xml;charset=utf8, %3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='none' stroke='grey' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 7v6h6'/%3E%3Cpath d='M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13'/%3E%3C/svg%3E\");\n    background-size: 19px;\n    background-repeat: no-repeat;\n    top: -19px;\n    margin-top: -7px;\n}\n\n.icon-chevron-down {\n    top: 2px;\n    right: 9px;\n}\n\n.iconsidebar-chevron-up,.sidebar__close-button {\n\tbackground-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM4ODg4ODgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0iZmVhdGhlciBmZWF0aGVyLWNoZXZyb24tdXAiPjxwb2x5bGluZSBwb2ludHM9IjE4IDE1IDEyIDkgNiAxNSI+PC9wb2x5bGluZT48L3N2Zz4=);\n}\n\n.iconsidebar-minimizebutton {\n    background-position: 98% center;\n    background-repeat: no-repeat;\n}\n\n.sidebar-cables-right\n{\n    right: 15px;\n    left: initial !important;\n}\n\n.sidebar-cables {\n    --sidebar-color: #07f78c;\n    --sidebar-width: 220px;\n    --sidebar-border-radius: 10px;\n    --sidebar-monospace-font-stack: \"SFMono-Regular\", Consolas, \"Liberation Mono\", Menlo, Courier, monospace;\n    --sidebar-hover-transition-time: .2s;\n\n    position: absolute;\n    top: 15px;\n    left: 15px;\n    border-radius: var(--sidebar-border-radius);\n    z-index: 100000;\n    color: #BBBBBB;\n    width: var(  --sidebar-width);\n    max-height: 100%;\n    box-sizing: border-box;\n    overflow-y: auto;\n    overflow-x: hidden;\n    font-size: 13px;\n    font-family: Arial;\n    line-height: 1em; /* prevent emojis from breaking height of the title */\n}\n\n.sidebar-cables::selection {\n    background-color: var(--sidebar-color);\n    color: #EEEEEE;\n}\n\n.sidebar-cables::-webkit-scrollbar {\n    background-color: transparent;\n    --cables-scrollbar-width: 8px;\n    width: var(--cables-scrollbar-width);\n}\n\n.sidebar-cables::-webkit-scrollbar-track {\n    background-color: transparent;\n    width: var(--cables-scrollbar-width);\n}\n\n.sidebar-cables::-webkit-scrollbar-thumb {\n    background-color: #333333;\n    border-radius: 4px;\n    width: var(--cables-scrollbar-width);\n}\n\n.sidebar-cables--closed {\n    width: auto;\n}\n\n.sidebar__close-button {\n    background-color: #222;\n    /*-webkit-user-select: none;  */\n    /*-moz-user-select: none;     */\n    /*-ms-user-select: none;      */\n    /*user-select: none;          */\n    /*transition: background-color var(--sidebar-hover-transition-time);*/\n    /*color: #CCCCCC;*/\n    height: 2px;\n    /*border-bottom:20px solid #222;*/\n\n    /*box-sizing: border-box;*/\n    /*padding-top: 2px;*/\n    /*text-align: center;*/\n    /*cursor: pointer;*/\n    /*border-radius: 0 0 var(--sidebar-border-radius) var(--sidebar-border-radius);*/\n    /*opacity: 1.0;*/\n    /*transition: opacity 0.3s;*/\n    /*overflow: hidden;*/\n}\n\n.sidebar__close-button-icon {\n    display: inline-block;\n    /*opacity: 0;*/\n    width: 20px;\n    height: 20px;\n    /*position: relative;*/\n    /*top: -1px;*/\n\n\n}\n\n.sidebar--closed {\n    width: auto;\n    margin-right: 20px;\n}\n\n.sidebar--closed .sidebar__close-button {\n    margin-top: 8px;\n    margin-left: 8px;\n    padding:10px;\n\n    height: 25px;\n    width:25px;\n    border-radius: 50%;\n    cursor: pointer;\n    opacity: 0.3;\n    background-repeat: no-repeat;\n    background-position: center center;\n    transform:rotate(180deg);\n}\n\n.sidebar--closed .sidebar__group\n{\n    display:none;\n\n}\n.sidebar--closed .sidebar__close-button-icon {\n    background-position: 0px 0px;\n}\n\n.sidebar__close-button:hover {\n    background-color: #111111;\n    opacity: 1.0 !important;\n}\n\n/*\n * SIDEBAR ITEMS\n */\n\n.sidebar__items {\n    /* max-height: 1000px; */\n    /* transition: max-height 0.5;*/\n    background-color: #222;\n    padding-bottom: 20px;\n}\n\n.sidebar--closed .sidebar__items {\n    /* max-height: 0; */\n    height: 0;\n    display: none;\n    pointer-interactions: none;\n}\n\n.sidebar__item__right {\n    float: right;\n}\n\n/*\n * SIDEBAR GROUP\n */\n\n.sidebar__group {\n    /*background-color: #1A1A1A;*/\n    overflow: hidden;\n    box-sizing: border-box;\n    animate: height;\n    /*background-color: #151515;*/\n    /* max-height: 1000px; */\n    /* transition: max-height 0.5s; */\n--sidebar-group-header-height: 33px;\n}\n\n.sidebar__group-items\n{\n    padding-top: 15px;\n    padding-bottom: 15px;\n}\n\n.sidebar__group--closed {\n    /* max-height: 13px; */\n    height: var(--sidebar-group-header-height);\n}\n\n.sidebar__group-header {\n    box-sizing: border-box;\n    color: #EEEEEE;\n    background-color: #151515;\n    -webkit-user-select: none;  /* Chrome all / Safari all */\n    -moz-user-select: none;     /* Firefox all */\n    -ms-user-select: none;      /* IE 10+ */\n    user-select: none;          /* Likely future */\n\n    /*height: 100%;//var(--sidebar-group-header-height);*/\n\n    padding-top: 7px;\n    text-transform: uppercase;\n    letter-spacing: 0.08em;\n    cursor: pointer;\n    /*transition: background-color var(--sidebar-hover-transition-time);*/\n    position: relative;\n}\n\n.sidebar__group-header:hover {\n  background-color: #111111;\n}\n\n.sidebar__group-header-title {\n  /*float: left;*/\n  overflow: hidden;\n  padding: 0 15px;\n  padding-top:5px;\n  padding-bottom:10px;\n  font-weight:bold;\n}\n\n.sidebar__group-header-undo {\n    float: right;\n    overflow: hidden;\n    padding-right: 15px;\n    padding-top:5px;\n    font-weight:bold;\n  }\n\n.sidebar__group-header-icon {\n    width: 17px;\n    height: 14px;\n    background-repeat: no-repeat;\n    display: inline-block;\n    position: absolute;\n    background-size: cover;\n\n    /* icon open */\n    /* feather icon: chevron up */\n    background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM4ODg4ODgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0iZmVhdGhlciBmZWF0aGVyLWNoZXZyb24tdXAiPjxwb2x5bGluZSBwb2ludHM9IjE4IDE1IDEyIDkgNiAxNSI+PC9wb2x5bGluZT48L3N2Zz4=);\n    top: 4px;\n    right: 5px;\n    opacity: 0.0;\n    transition: opacity 0.3;\n}\n\n.sidebar__group-header:hover .sidebar__group-header-icon {\n    opacity: 1.0;\n}\n\n/* icon closed */\n.sidebar__group--closed .sidebar__group-header-icon {\n    /* feather icon: chevron down */\n    background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM4ODg4ODgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0iZmVhdGhlciBmZWF0aGVyLWNoZXZyb24tZG93biI+PHBvbHlsaW5lIHBvaW50cz0iNiA5IDEyIDE1IDE4IDkiPjwvcG9seWxpbmU+PC9zdmc+);\n    top: 4px;\n    right: 5px;\n}\n\n/*\n * SIDEBAR ITEM\n */\n\n.sidebar__item\n{\n    box-sizing: border-box;\n    padding: 7px;\n    padding-left:15px;\n    padding-right:15px;\n\n    overflow: hidden;\n    position: relative;\n}\n\n.sidebar__item-label {\n    display: inline-block;\n    -webkit-user-select: none;  /* Chrome all / Safari all */\n    -moz-user-select: none;     /* Firefox all */\n    -ms-user-select: none;      /* IE 10+ */\n    user-select: none;          /* Likely future */\n    width: calc(50% - 7px);\n    margin-right: 7px;\n    margin-top: 2px;\n    text-overflow: ellipsis;\n    /* overflow: hidden; */\n}\n\n.sidebar__item-value-label {\n    font-family: var(--sidebar-monospace-font-stack);\n    display: inline-block;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n    max-width: 60%;\n}\n\n.sidebar__item-value-label::selection {\n    background-color: var(--sidebar-color);\n    color: #EEEEEE;\n}\n\n.sidebar__item + .sidebar__item,\n.sidebar__item + .sidebar__group,\n.sidebar__group + .sidebar__item,\n.sidebar__group + .sidebar__group {\n    /*border-top: 1px solid #272727;*/\n}\n\n/*\n * SIDEBAR ITEM TOGGLE\n */\n\n/*.sidebar__toggle */\n.icon_toggle{\n    cursor: pointer;\n}\n\n.sidebar__toggle-input {\n    --sidebar-toggle-input-color: #CCCCCC;\n    --sidebar-toggle-input-color-hover: #EEEEEE;\n    --sidebar-toggle-input-border-size: 2px;\n    display: inline;\n    float: right;\n    box-sizing: border-box;\n    border-radius: 50%;\n    cursor: pointer;\n    --toggle-size: 11px;\n    margin-top: 2px;\n    background-color: transparent !important;\n    border: var(--sidebar-toggle-input-border-size) solid var(--sidebar-toggle-input-color);\n    width: var(--toggle-size);\n    height: var(--toggle-size);\n    transition: background-color var(--sidebar-hover-transition-time);\n    transition: border-color var(--sidebar-hover-transition-time);\n}\n.sidebar__toggle:hover .sidebar__toggle-input {\n    border-color: var(--sidebar-toggle-input-color-hover);\n}\n\n.sidebar__toggle .sidebar__item-value-label {\n    -webkit-user-select: none;  /* Chrome all / Safari all */\n    -moz-user-select: none;     /* Firefox all */\n    -ms-user-select: none;      /* IE 10+ */\n    user-select: none;          /* Likely future */\n    max-width: calc(50% - 12px);\n}\n.sidebar__toggle-input::after { clear: both; }\n\n.sidebar__toggle--active .icon_toggle\n{\n\n    background-image: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjE1cHgiIHdpZHRoPSIzMHB4IiBmaWxsPSIjMDZmNzhiIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAwIDEwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGcgZGlzcGxheT0ibm9uZSI+PGcgZGlzcGxheT0iaW5saW5lIj48Zz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzA2Zjc4YiIgZD0iTTMwLDI3QzE3LjM1LDI3LDcsMzcuMzUsNyw1MGwwLDBjMCwxMi42NSwxMC4zNSwyMywyMywyM2g0MCBjMTIuNjUsMCwyMy0xMC4zNSwyMy0yM2wwLDBjMC0xMi42NS0xMC4zNS0yMy0yMy0yM0gzMHogTTcwLDY3Yy05LjM4OSwwLTE3LTcuNjEtMTctMTdzNy42MTEtMTcsMTctMTdzMTcsNy42MSwxNywxNyAgICAgUzc5LjM4OSw2Nyw3MCw2N3oiPjwvcGF0aD48L2c+PC9nPjwvZz48Zz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTMwLDI3QzE3LjM1LDI3LDcsMzcuMzUsNyw1MGwwLDBjMCwxMi42NSwxMC4zNSwyMywyMywyM2g0MCAgIGMxMi42NSwwLDIzLTEwLjM1LDIzLTIzbDAsMGMwLTEyLjY1LTEwLjM1LTIzLTIzLTIzSDMweiBNNzAsNjdjLTkuMzg5LDAtMTctNy42MS0xNy0xN3M3LjYxMS0xNywxNy0xN3MxNyw3LjYxLDE3LDE3ICAgUzc5LjM4OSw2Nyw3MCw2N3oiPjwvcGF0aD48L2c+PGcgZGlzcGxheT0ibm9uZSI+PGcgZGlzcGxheT0iaW5saW5lIj48cGF0aCBmaWxsPSIjMDZmNzhiIiBzdHJva2U9IiMwNmY3OGIiIHN0cm9rZS13aWR0aD0iNCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNNyw1MGMwLDEyLjY1LDEwLjM1LDIzLDIzLDIzaDQwICAgIGMxMi42NSwwLDIzLTEwLjM1LDIzLTIzbDAsMGMwLTEyLjY1LTEwLjM1LTIzLTIzLTIzSDMwQzE3LjM1LDI3LDcsMzcuMzUsNyw1MEw3LDUweiI+PC9wYXRoPjwvZz48Y2lyY2xlIGRpc3BsYXk9ImlubGluZSIgZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiMwNmY3OGIiIHN0cm9rZT0iIzA2Zjc4YiIgc3Ryb2tlLXdpZHRoPSI0IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGN4PSI3MCIgY3k9IjUwIiByPSIxNyI+PC9jaXJjbGU+PC9nPjxnIGRpc3BsYXk9Im5vbmUiPjxwYXRoIGRpc3BsYXk9ImlubGluZSIgZD0iTTcwLDI1SDMwQzE2LjIxNSwyNSw1LDM2LjIxNSw1LDUwczExLjIxNSwyNSwyNSwyNWg0MGMxMy43ODUsMCwyNS0xMS4yMTUsMjUtMjVTODMuNzg1LDI1LDcwLDI1eiBNNzAsNzEgICBIMzBDMTguNDIxLDcxLDksNjEuNTc5LDksNTBzOS40MjEtMjEsMjEtMjFoNDBjMTEuNTc5LDAsMjEsOS40MjEsMjEsMjFTODEuNTc5LDcxLDcwLDcxeiBNNzAsMzFjLTEwLjQ3NywwLTE5LDguNTIzLTE5LDE5ICAgczguNTIzLDE5LDE5LDE5czE5LTguNTIzLDE5LTE5UzgwLjQ3NywzMSw3MCwzMXogTTcwLDY1Yy04LjI3MSwwLTE1LTYuNzI5LTE1LTE1czYuNzI5LTE1LDE1LTE1czE1LDYuNzI5LDE1LDE1Uzc4LjI3MSw2NSw3MCw2NXoiPjwvcGF0aD48L2c+PC9zdmc+);\n    opacity: 1;\n    transform: rotate(0deg);\n}\n\n\n.icon_toggle\n{\n    float: right;\n    width:40px;\n    height:18px;\n    background-image: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjE1cHgiIHdpZHRoPSIzMHB4IiBmaWxsPSIjYWFhYWFhIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAwIDEwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGcgZGlzcGxheT0ibm9uZSI+PGcgZGlzcGxheT0iaW5saW5lIj48Zz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iI2FhYWFhYSIgZD0iTTMwLDI3QzE3LjM1LDI3LDcsMzcuMzUsNyw1MGwwLDBjMCwxMi42NSwxMC4zNSwyMywyMywyM2g0MCBjMTIuNjUsMCwyMy0xMC4zNSwyMy0yM2wwLDBjMC0xMi42NS0xMC4zNS0yMy0yMy0yM0gzMHogTTcwLDY3Yy05LjM4OSwwLTE3LTcuNjEtMTctMTdzNy42MTEtMTcsMTctMTdzMTcsNy42MSwxNywxNyAgICAgUzc5LjM4OSw2Nyw3MCw2N3oiPjwvcGF0aD48L2c+PC9nPjwvZz48Zz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTMwLDI3QzE3LjM1LDI3LDcsMzcuMzUsNyw1MGwwLDBjMCwxMi42NSwxMC4zNSwyMywyMywyM2g0MCAgIGMxMi42NSwwLDIzLTEwLjM1LDIzLTIzbDAsMGMwLTEyLjY1LTEwLjM1LTIzLTIzLTIzSDMweiBNNzAsNjdjLTkuMzg5LDAtMTctNy42MS0xNy0xN3M3LjYxMS0xNywxNy0xN3MxNyw3LjYxLDE3LDE3ICAgUzc5LjM4OSw2Nyw3MCw2N3oiPjwvcGF0aD48L2c+PGcgZGlzcGxheT0ibm9uZSI+PGcgZGlzcGxheT0iaW5saW5lIj48cGF0aCBmaWxsPSIjYWFhYWFhIiBzdHJva2U9IiNhYWFhYWEiIHN0cm9rZS13aWR0aD0iNCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNNyw1MGMwLDEyLjY1LDEwLjM1LDIzLDIzLDIzaDQwICAgIGMxMi42NSwwLDIzLTEwLjM1LDIzLTIzbDAsMGMwLTEyLjY1LTEwLjM1LTIzLTIzLTIzSDMwQzE3LjM1LDI3LDcsMzcuMzUsNyw1MEw3LDUweiI+PC9wYXRoPjwvZz48Y2lyY2xlIGRpc3BsYXk9ImlubGluZSIgZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiNhYWFhYWEiIHN0cm9rZT0iI2FhYWFhYSIgc3Ryb2tlLXdpZHRoPSI0IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGN4PSI3MCIgY3k9IjUwIiByPSIxNyI+PC9jaXJjbGU+PC9nPjxnIGRpc3BsYXk9Im5vbmUiPjxwYXRoIGRpc3BsYXk9ImlubGluZSIgZD0iTTcwLDI1SDMwQzE2LjIxNSwyNSw1LDM2LjIxNSw1LDUwczExLjIxNSwyNSwyNSwyNWg0MGMxMy43ODUsMCwyNS0xMS4yMTUsMjUtMjVTODMuNzg1LDI1LDcwLDI1eiBNNzAsNzEgICBIMzBDMTguNDIxLDcxLDksNjEuNTc5LDksNTBzOS40MjEtMjEsMjEtMjFoNDBjMTEuNTc5LDAsMjEsOS40MjEsMjEsMjFTODEuNTc5LDcxLDcwLDcxeiBNNzAsMzFjLTEwLjQ3NywwLTE5LDguNTIzLTE5LDE5ICAgczguNTIzLDE5LDE5LDE5czE5LTguNTIzLDE5LTE5UzgwLjQ3NywzMSw3MCwzMXogTTcwLDY1Yy04LjI3MSwwLTE1LTYuNzI5LTE1LTE1czYuNzI5LTE1LDE1LTE1czE1LDYuNzI5LDE1LDE1Uzc4LjI3MSw2NSw3MCw2NXoiPjwvcGF0aD48L2c+PC9zdmc+);\n    background-size: 50px 37px;\n    background-position: -6px -10px;\n    transform: rotate(180deg);\n    opacity: 0.4;\n}\n\n\n\n/*.sidebar__toggle--active .sidebar__toggle-input {*/\n/*    transition: background-color var(--sidebar-hover-transition-time);*/\n/*    background-color: var(--sidebar-toggle-input-color);*/\n/*}*/\n/*.sidebar__toggle--active .sidebar__toggle-input:hover*/\n/*{*/\n/*    background-color: var(--sidebar-toggle-input-color-hover);*/\n/*    border-color: var(--sidebar-toggle-input-color-hover);*/\n/*    transition: background-color var(--sidebar-hover-transition-time);*/\n/*    transition: border-color var(--sidebar-hover-transition-time);*/\n/*}*/\n\n/*\n * SIDEBAR ITEM BUTTON\n */\n\n.sidebar__button {}\n\n.sidebar__button-input {\n    -webkit-user-select: none;  /* Chrome all / Safari all */\n    -moz-user-select: none;     /* Firefox all */\n    -ms-user-select: none;      /* IE 10+ */\n    user-select: none;          /* Likely future */\n    min-height: 24px;\n    background-color: transparent;\n    color: #CCCCCC;\n    box-sizing: border-box;\n    padding-top: 3px;\n    text-align: center;\n    border-radius: 125px;\n    border:2px solid #555;\n    cursor: pointer;\n    padding-bottom: 3px;\n}\n\n.sidebar__button-input.plus, .sidebar__button-input.minus {\n    display: inline-block;\n    min-width: 20px;\n}\n\n.sidebar__button-input:hover {\n  background-color: #333;\n  border:2px solid var(--sidebar-color);\n}\n\n/*\n * VALUE DISPLAY (shows a value)\n */\n\n.sidebar__value-display {}\n\n/*\n * SLIDER\n */\n\n.sidebar__slider {\n    --sidebar-slider-input-height: 3px;\n}\n\n.sidebar__slider-input-wrapper {\n    width: 100%;\n\n    margin-top: 8px;\n    position: relative;\n}\n\n.sidebar__slider-input {\n    -webkit-appearance: none;\n    appearance: none;\n    margin: 0;\n    width: 100%;\n    height: var(--sidebar-slider-input-height);\n    background: #555;\n    cursor: pointer;\n    outline: 0;\n\n    -webkit-transition: .2s;\n    transition: background-color .2s;\n    border: none;\n}\n\n.sidebar__slider-input:focus, .sidebar__slider-input:hover {\n    border: none;\n}\n\n.sidebar__slider-input-active-track {\n    user-select: none;\n    position: absolute;\n    z-index: 11;\n    top: 0;\n    left: 0;\n    background-color: var(--sidebar-color);\n    pointer-events: none;\n    height: var(--sidebar-slider-input-height);\n    max-width: 100%;\n}\n\n/* Mouse-over effects */\n.sidebar__slider-input:hover {\n    /*background-color: #444444;*/\n}\n\n/*.sidebar__slider-input::-webkit-progress-value {*/\n/*    background-color: green;*/\n/*    color:green;*/\n\n/*    }*/\n\n/* The slider handle (use -webkit- (Chrome, Opera, Safari, Edge) and -moz- (Firefox) to override default look) */\n\n.sidebar__slider-input::-moz-range-thumb\n{\n    position: absolute;\n    height: 15px;\n    width: 15px;\n    z-index: 900 !important;\n    border-radius: 20px !important;\n    cursor: pointer;\n    background: var(--sidebar-color) !important;\n    user-select: none;\n\n}\n\n.sidebar__slider-input::-webkit-slider-thumb\n{\n    position: relative;\n    appearance: none;\n    -webkit-appearance: none;\n    user-select: none;\n    height: 15px;\n    width: 15px;\n    display: block;\n    z-index: 900 !important;\n    border: 0;\n    border-radius: 20px !important;\n    cursor: pointer;\n    background: #777 !important;\n}\n\n.sidebar__slider-input:hover ::-webkit-slider-thumb {\n    background-color: #EEEEEE !important;\n}\n\n/*.sidebar__slider-input::-moz-range-thumb {*/\n\n/*    width: 0 !important;*/\n/*    height: var(--sidebar-slider-input-height);*/\n/*    background: #EEEEEE;*/\n/*    cursor: pointer;*/\n/*    border-radius: 0 !important;*/\n/*    border: none;*/\n/*    outline: 0;*/\n/*    z-index: 100 !important;*/\n/*}*/\n\n.sidebar__slider-input::-moz-range-track {\n    background-color: transparent;\n    z-index: 11;\n}\n\n/*.sidebar__slider-input::-moz-range-thumb:hover {*/\n  /* background-color: #EEEEEE; */\n/*}*/\n\n\n/*.sidebar__slider-input-wrapper:hover .sidebar__slider-input-active-track {*/\n/*    background-color: #EEEEEE;*/\n/*}*/\n\n/*.sidebar__slider-input-wrapper:hover .sidebar__slider-input::-moz-range-thumb {*/\n/*    background-color: #fff !important;*/\n/*}*/\n\n/*.sidebar__slider-input-wrapper:hover .sidebar__slider-input::-webkit-slider-thumb {*/\n/*    background-color: #EEEEEE;*/\n/*}*/\n\n.sidebar__slider input[type=text],\n.sidebar__slider input[type=paddword]\n{\n    box-sizing: border-box;\n    /*background-color: #333333;*/\n    text-align: right;\n    color: #BBBBBB;\n    display: inline-block;\n    background-color: transparent !important;\n\n    width: 40%;\n    height: 18px;\n    outline: none;\n    border: none;\n    border-radius: 0;\n    padding: 0 0 0 4px !important;\n    margin: 0;\n}\n\n.sidebar__slider input[type=text]:active,\n.sidebar__slider input[type=text]:focus,\n.sidebar__slider input[type=text]:hover\n.sidebar__slider input[type=password]:active,\n.sidebar__slider input[type=password]:focus,\n.sidebar__slider input[type=password]:hover\n{\n\n    color: #EEEEEE;\n}\n\n/*\n * TEXT / DESCRIPTION\n */\n\n.sidebar__text .sidebar__item-label {\n    width: auto;\n    display: block;\n    max-height: none;\n    margin-right: 0;\n    line-height: 1.1em;\n}\n\n/*\n * SIDEBAR INPUT\n */\n.sidebar__text-input textarea,\n.sidebar__text-input input[type=text],\n.sidebar__text-input input[type=password] {\n    box-sizing: border-box;\n    background-color: #333333;\n    color: #BBBBBB;\n    display: inline-block;\n    width: 50%;\n    height: 18px;\n    outline: none;\n    border: none;\n    border-radius: 0;\n    border:1px solid #666;\n    padding: 0 0 0 4px !important;\n    margin: 0;\n}\n\n.sidebar__text-input textarea:focus::placeholder {\n  color: transparent;\n}\n\n.sidebar__color-picker .sidebar__item-label\n{\n    width:45%;\n}\n\n.sidebar__text-input textarea,\n.sidebar__text-input input[type=text]:active,\n.sidebar__text-input input[type=text]:focus,\n.sidebar__text-input input[type=text]:hover,\n.sidebar__text-input input[type=password]:active,\n.sidebar__text-input input[type=password]:focus,\n.sidebar__text-input input[type=password]:hover {\n    background-color: transparent;\n    color: #EEEEEE;\n}\n\n.sidebar__text-input textarea\n{\n    margin-top:10px;\n    height:60px;\n    width:100%;\n}\n\n/*\n * SIDEBAR SELECT\n */\n\n\n\n .sidebar__select {}\n .sidebar__select-select {\n    color: #BBBBBB;\n    /*-webkit-appearance: none;*/\n    /*-moz-appearance: none;*/\n    appearance: none;\n    /*box-sizing: border-box;*/\n    width: 50%;\n    /*height: 20px;*/\n    background-color: #333333;\n    /*background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM4ODg4ODgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0iZmVhdGhlciBmZWF0aGVyLWNoZXZyb24tZG93biI+PHBvbHlsaW5lIHBvaW50cz0iNiA5IDEyIDE1IDE4IDkiPjwvcG9seWxpbmU+PC9zdmc+);*/\n    background-repeat: no-repeat;\n    background-position: right center;\n    background-size: 16px 16px;\n    margin: 0;\n    /*padding: 0 2 2 6px;*/\n    border-radius: 5px;\n    border: 1px solid #777;\n    background-color: #444;\n    cursor: pointer;\n    outline: none;\n    padding-left: 5px;\n\n }\n\n.sidebar__select-select:hover,\n.sidebar__select-select:active,\n.sidebar__select-select:active {\n    background-color: #444444;\n    color: #EEEEEE;\n}\n\n/*\n * COLOR PICKER\n */\n\n\n .sidebar__color-picker input[type=text] {\n    box-sizing: border-box;\n    background-color: #333333;\n    color: #BBBBBB;\n    display: inline-block;\n    width: calc(50% - 21px); /* 50% minus space of picker circle */\n    height: 18px;\n    outline: none;\n    border: none;\n    border-radius: 0;\n    padding: 0 0 0 4px !important;\n    margin: 0;\n    margin-right: 7px;\n}\n\n.sidebar__color-picker input[type=text]:active,\n.sidebar__color-picker input[type=text]:focus,\n.sidebar__color-picker input[type=text]:hover {\n    background-color: #444444;\n    color: #EEEEEE;\n}\n\ndiv.sidebar__color-picker-color-input,\n.sidebar__color-picker input[type=color],\n.sidebar__palette-picker input[type=color] {\n    display: inline-block;\n    border-radius: 100%;\n    height: 14px;\n    width: 14px;\n\n    padding: 0;\n    border: none;\n    /*border:2px solid red;*/\n    border-color: transparent;\n    outline: none;\n    background: none;\n    appearance: none;\n    -moz-appearance: none;\n    -webkit-appearance: none;\n    cursor: pointer;\n    position: relative;\n    top: 3px;\n}\n.sidebar__color-picker input[type=color]:focus,\n.sidebar__palette-picker input[type=color]:focus {\n    outline: none;\n}\n.sidebar__color-picker input[type=color]::-moz-color-swatch,\n.sidebar__palette-picker input[type=color]::-moz-color-swatch {\n    border: none;\n}\n.sidebar__color-picker input[type=color]::-webkit-color-swatch-wrapper,\n.sidebar__palette-picker input[type=color]::-webkit-color-swatch-wrapper {\n    padding: 0;\n}\n.sidebar__color-picker input[type=color]::-webkit-color-swatch,\n.sidebar__palette-picker input[type=color]::-webkit-color-swatch {\n    border: none;\n    border-radius: 100%;\n}\n\n/*\n * Palette Picker\n */\n.sidebar__palette-picker .sidebar__palette-picker-color-input.first {\n    margin-left: 0;\n}\n.sidebar__palette-picker .sidebar__palette-picker-color-input.last {\n    margin-right: 0;\n}\n.sidebar__palette-picker .sidebar__palette-picker-color-input {\n    margin: 0 4px;\n}\n\n.sidebar__palette-picker .circlebutton {\n    width: 14px;\n    height: 14px;\n    border-radius: 1em;\n    display: inline-block;\n    top: 3px;\n    position: relative;\n}\n\n/*\n * Preset\n */\n.sidebar__item-presets-preset\n{\n    padding:4px;\n    cursor:pointer;\n    padding-left:8px;\n    padding-right:8px;\n    margin-right:4px;\n    background-color:#444;\n}\n\n.sidebar__item-presets-preset:hover\n{\n    background-color:#666;\n}\n\n.sidebar__greyout\n{\n    background: #222;\n    opacity: 0.8;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    z-index: 1000;\n    right: 0;\n    top: 0;\n}\n\n.sidebar_tabs\n{\n    background-color: #151515;\n    padding-bottom: 0px;\n}\n\n.sidebar_switchs\n{\n    float: right;\n}\n\n.sidebar_tab\n{\n    float:left;\n    background-color: #151515;\n    border-bottom:1px solid transparent;\n    padding-right:7px;\n    padding-left:7px;\n    padding-bottom: 5px;\n    padding-top: 5px;\n    cursor:pointer;\n}\n\n.sidebar_tab_active\n{\n    background-color: #272727;\n    color:white;\n}\n\n.sidebar_tab:hover\n{\n    border-bottom:1px solid #777;\n    color:white;\n}\n\n\n.sidebar_switch\n{\n    float:left;\n    background-color: #444;\n    padding-right:7px;\n    padding-left:7px;\n    padding-bottom: 5px;\n    padding-top: 5px;\n    cursor:pointer;\n}\n\n.sidebar_switch:last-child\n{\n    border-top-right-radius: 7px;\n    border-bottom-right-radius: 7px;\n}\n\n.sidebar_switch:first-child\n{\n    border-top-left-radius: 7px;\n    border-bottom-left-radius: 7px;\n}\n\n\n.sidebar_switch_active\n{\n    background-color: #999;\n    color:white;\n}\n\n.sidebar_switch:hover\n{\n    color:white;\n}\n"};const a="cables-sidebar-style";const r="cables-sidebar-dynamic-style";const s="sidebar-cables";const l="sidebar"+CABLES.uuid();const c="sidebar__items";const u="sidebar__close-button";const o="";const _="";let d=null;let e=null;let p=null;const t=i.inValueBool("Visible",true);const g=i.inValueSlider("Opacity",1);const f=i.inValueBool("Default Minimized");const m=i.inValueSlider("Minimized Opacity",.5);const v=i.inValueBool("Show undo button",false);const h=i.inValueBool("Show Minimize",false);const b=i.inString("Title","Sidebar");const x=i.inValueBool("Side");const O=i.outObject("childs");O.setUiAttribs({title:"Children"});const I=i.outBool("Opfened");I.setUiAttribs({title:"Opened"});let y=document.querySelector("."+l);if(!y){y=P()}const T=y.querySelector("."+c);O.set({parentElement:T,parentOp:i});M();U();w();t.onChange=L;g.onChange=N;f.onChange=M;m.onChange=A;v.onChange=C;i.onDelete=j;function A(){w()}h.onChange=S;function S(e){if(!e||e.uiAttribs)e=document.querySelector(".sidebar-cables .sidebar__group-header");if(!e)return;const t=document.querySelector(".sidebar-cables .sidebar__group-header .sidebar__group-header-undo");if(h.get()){e.classList.add("iconsidebar-chevron-up");e.classList.add("iconsidebar-minimizebutton");if(t)t.style.marginRight="20px"}else{e.classList.remove("iconsidebar-chevron-up");e.classList.remove("iconsidebar-minimizebutton");if(t)t.style.marginRight="initial"}}x.onChange=function(){if(x.get())y.classList.add("sidebar-cables-right");else y.classList.remove("sidebar-cables-right")};function C(){const e=document.querySelector(".sidebar-cables .sidebar__group-header");if(e){E(e)}}function E(e){if(e){const t=document.querySelector(".sidebar-cables .sidebar__group-header .sidebar__group-header-undo");if(t){if(!v.get()){t.remove()}}else{if(v.get()){const n=document.createElement("span");n.classList.add("sidebar__group-header-undo");n.classList.add("sidebar-icon-undo");n.addEventListener("click",function(e){e.stopPropagation();const t=document.querySelectorAll(".sidebar-cables .sidebar__reloadable");const n=document.createEvent("MouseEvents");n.initEvent("dblclick",true,true);t.forEach(e=>{e.dispatchEvent(n)})});e.appendChild(n)}}}S(e)}function M(){if(!d){return}if(f.get()){y.classList.add("sidebar--closed");if(t.get()){I.set(false)}}else{y.classList.remove("sidebar--closed");if(t.get()){I.set(true)}}}function N(){const e=g.get();y.style.opacity=e}function L(){if(t.get()){y.style.display="block";if(!y.classList.contains("sidebar--closed")){I.set(true)}}else{y.style.display="none";I.set(false)}}x.onChanged=function(){};function w(){const e=document.querySelectorAll("."+r);if(e){e.forEach(function(e){e.parentNode.removeChild(e)})}const t=document.createElement("style");t.classList.add(r);let n=".sidebar--closed .sidebar__close-button { ";n+="opacity: "+m.get();n+="}";const a=document.createTextNode(n);t.appendChild(a);document.body.appendChild(t)}function P(){const e=document.createElement("div");e.classList.add(s);e.classList.add(l);const t=i.patch.cgl.canvas.parentElement;const n=document.createElement("div");n.classList.add("sidebar__group");e.appendChild(n);const a=document.createElement("div");a.classList.add("sidebar__group-header");e.appendChild(a);const r=document.createElement("span");r.classList.add("sidebar__group-header-title");p=document.createElement("span");p.classList.add("sidebar__group-header-title-text");p.innerHTML=b.get();r.appendChild(p);a.appendChild(r);E(a);S(a);n.appendChild(a);e.appendChild(n);n.addEventListener("click",R);if(!t){i.warn("[sidebar] no canvas parentelement found...");return}t.appendChild(e);const o=document.createElement("div");o.classList.add(c);e.appendChild(o);d=document.createElement("div");d.classList.add(u);d.addEventListener("click",R);e.appendChild(d);return e}b.onChange=function(){if(p)p.innerHTML=b.get()};function D(e){}function R(e){e.stopPropagation();if(!y){i.logError("Sidebar could not be closed...");return}y.classList.toggle("sidebar--closed");const t=e.target;let n=o;if(y.classList.contains("sidebar--closed")){n=_;I.set(false)}else{I.set(true)}}function U(){const e=document.querySelectorAll("."+a);if(e){e.forEach(function(e){e.parentNode.removeChild(e)})}const t=document.createElement("style");t.innerHTML=n.style_css;t.classList.add(a);document.body.appendChild(t)}function j(){G(y)}function G(e){if(e&&e.parentNode&&e.parentNode.removeChild)e.parentNode.removeChild(e)}};Ops.Sidebar.Sidebar.prototype=new CABLES.Op;CABLES.OPS["5a681c35-78ce-4cb3-9858-bc79c34c6819"]={f:Ops.Sidebar.Sidebar,objName:"Ops.Sidebar.Sidebar"};Ops.Sidebar.Slider_v3=function(){CABLES.Op.apply(this,arguments);const r=this;const e={};const t=1e-5;const n=r.inObject("link");const a=r.inString("Text","Slider");const o=r.inValue("Min",0);const i=r.inValue("Max",1);const s=r.inValue("Step",t);const l=r.inString("Suffix","");const c=r.inBool("Grey Out",false);const u=r.inBool("Visible",true);const _=r.inValue("Input",.5);const d=r.inTriggerButton("Set Default");const p=r.inTriggerButton("Reset");let g=null;const f=r.inValue("Default",.5);f.setUiAttribs({hidePort:true,greyout:true});const m=r.outObject("childs");const v=r.outNumber("Result",f.get());r.toWorkNeedsParent("Ops.Sidebar.Sidebar");r.setPortGroup("Range",[o,i,s]);r.setPortGroup("Display",[c,u]);const h=document.createElement("div");h.addEventListener("dblclick",function(){v.set(parseFloat(f.get()));_.set(parseFloat(f.get()))});h.dataset.op=r.id;h.classList.add("cablesEle");h.classList.add("sidebar__item");h.classList.add("sidebar__slider");h.classList.add("sidebar__reloadable");r.patch.on("sidebarStylesChanged",()=>{w()});const b=document.createElement("div");b.classList.add("sidebar__item-label");const x=document.createElement("div");x.classList.add("sidebar__greyout");h.appendChild(x);x.style.display="none";const O=document.createTextNode(a.get());b.appendChild(O);h.appendChild(b);const I=document.createElement("input");I.value=f.get();I.classList.add("sidebar__text-input-input");I.setAttribute("type","text");I.oninput=C;h.appendChild(I);const y=document.createElement("span");h.appendChild(y);l.onChange=()=>{y.innerHTML=l.get()};const T=document.createElement("div");T.classList.add("sidebar__slider-input-wrapper");h.appendChild(T);const A=document.createElement("div");A.classList.add("sidebar__slider-input-active-track");T.appendChild(A);const S=document.createElement("input");S.classList.add("sidebar__slider-input");S.setAttribute("min",o.get());S.setAttribute("max",i.get());S.setAttribute("type","range");S.setAttribute("step",s.get());S.setAttribute("value",f.get());S.style.display="block";T.appendChild(S);w();S.addEventListener("input",N);n.onChange=j;a.onChange=U;_.onChange=E;f.onChange=R;d.onTriggered=M;o.onChange=P;i.onChange=D;s.onChange=L;r.onDelete=z;r.onLoaded=r.onInit=function(){if(r.patch.config.sidebar){r.patch.config.sidebar[a.get()];v.set(r.patch.config.sidebar[a.get()])}else{v.set(parseFloat(f.get()));_.set(parseFloat(f.get()))}};p.onTriggered=function(){const e=parseFloat(f.get());v.set(e);G(e);V(e);_.set(e);w()};c.onChange=function(){x.style.display=c.get()?"block":"none"};u.onChange=function(){h.style.display=u.get()?"block":"none"};function C(e){let t=parseFloat(e.target.value);if(isNaN(t))t=0;const n=o.get();const a=i.get();if(t<n){t=n}else if(t>a){t=a}v.set(t);w();_.set(t);r.refreshParams()}function E(){let e=parseFloat(_.get());const t=o.get();const n=i.get();if(e>n){e=n}else if(e<t){e=t}G(e);V(e);v.set(e);w()}function M(){let e=parseFloat(_.get());const t=o.get();const n=i.get();if(e>n){e=n}else if(e<t){e=t}G(e);V(e);v.set(e);f.set(e);r.refreshParams();w()}function N(e){e.preventDefault();e.stopPropagation();G(e.target.value);const t=parseFloat(e.target.value);v.set(t);_.set(t);r.refreshParams();w();return false}function L(){const e=s.get();S.setAttribute("step",e);w()}function w(e){let t=parseFloat(S.value);if(typeof e!=="undefined")t=e;let n=A.parentElement.getBoundingClientRect().width||220;if(g)n=parseInt(getComputedStyle(g.parentElement).getPropertyValue("--sidebar-width"))-20;const a=CABLES.map(t,parseFloat(S.min),parseFloat(S.max),0,n-16);A.style.width=a+"px"}function P(){const e=o.get();S.setAttribute("min",e);w()}function D(){const e=i.get();S.setAttribute("max",e);w()}function R(){const e=f.get();v.set(parseFloat(e));P();D();V(e);G(e);w(e)}function U(){const e=a.get();b.textContent=e;if(CABLES.UI)r.setTitle("Slider: "+e)}function j(){m.set(null);g=n.get();if(g&&g.parentElement){g.parentElement.appendChild(h);m.set(g)}else if(h.parentElement)h.parentElement.removeChild(h);w()}function G(e){I.value=e}function V(e){S.value=e}function k(e){if(e)e.style.display="block"}function B(e){if(e)e.style.display="none"}function z(){F(h)}function F(e){if(e&&e.parentNode&&e.parentNode.removeChild)e.parentNode.removeChild(e)}};Ops.Sidebar.Slider_v3.prototype=new CABLES.Op;CABLES.OPS["74730122-5cba-4d0d-b610-df334ec6220a"]={f:Ops.Sidebar.Slider_v3,objName:"Ops.Sidebar.Slider_v3"};Ops.Math.FlipSign=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueFloat("Value",1),a=e.outNumber("Result");n.onChange=r;r();function r(){a.set(n.get()*-1)}};Ops.Math.FlipSign.prototype=new CABLES.Op;CABLES.OPS["f5c858a2-2654-4108-86fe-319efa70ecec"]={f:Ops.Math.FlipSign,objName:"Ops.Math.FlipSign"};Ops.Math.Clamp=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueFloat("val",.5),a=e.inValueFloat("min",0),r=e.inValueFloat("max",1),o=e.inValueBool("ignore outside values"),i=e.outNumber("result");n.onChange=a.onChange=r.onChange=s;function s(){if(o.get()){if(n.get()>r.get())return;if(n.get()<a.get())return}i.set(Math.min(Math.max(n.get(),a.get()),r.get()))}};Ops.Math.Clamp.prototype=new CABLES.Op;CABLES.OPS["cda1a98e-5e16-40bd-9b18-a67e9eaad5a1"]={f:Ops.Math.Clamp,objName:"Ops.Math.Clamp"};Ops.Gl.TextureEffects.LumaKey_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={lumakeyV2_frag:"IN vec2 texCoord;\nUNI float threshholdLow;\nUNI float threshholdHigh;\nUNI sampler2D text;\n\nvoid main()\n{\n   vec4 col = texture(text, texCoord );\n\n   float gray = dot(vec3(0.2126,0.7152,0.0722), col.rgb );\n\n   #ifndef INVERT\n       if(gray < threshholdLow || gray > threshholdHigh) col.r=col.g=col.b=col.a=0.0;\n       #ifdef BLACKWHITE\n           else col.r=col.g=col.b=col.a=1.0;\n       #endif\n   #endif\n\n   #ifdef INVERT\n       if(gray > threshholdLow && gray < threshholdHigh) col.r=col.g=col.b=col.a=0.0;\n       #ifdef BLACKWHITE\n           else col.r=col.g=col.b=col.a=1.0;\n       #endif\n   #endif\n\n   outColor= col;\n}"};const n=e.inTrigger("render"),a=e.outTrigger("trigger"),r=e.inValueBool("Invert"),o=e.inValueBool("Black White"),i=e.inValueSlider("Threshold low ",.5),s=e.inValueSlider("Threshold high",1);const l=e.patch.cgl;const c=new CGL.Shader(l,"lumakey");c.setSource(c.getDefaultVertexShader(),t.lumakeyV2_frag);const u=new CGL.Uniform(c,"t","tex",0);const _=new CGL.Uniform(c,"f","threshholdLow",i);const d=new CGL.Uniform(c,"f","threshholdHigh",s);o.onChange=function(){if(o.get())c.define("BLACKWHITE");else c.removeDefine("BLACKWHITE")};r.onChange=function(){if(r.get())c.define("INVERT");else c.removeDefine("INVERT")};n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;l.pushShader(c);l.currentTextureEffect.bind();l.setTexture(0,l.currentTextureEffect.getCurrentSourceTexture().tex);l.currentTextureEffect.finish();l.popShader();a.trigger()}};Ops.Gl.TextureEffects.LumaKey_v2.prototype=new CABLES.Op;CABLES.OPS["1699f3fc-355b-4497-a23c-1620a04a9cd4"]={f:Ops.Gl.TextureEffects.LumaKey_v2,objName:"Ops.Gl.TextureEffects.LumaKey_v2"};Ops.Gl.MainLoop=function(){CABLES.Op.apply(this,arguments);const a=this;const e={};const t=a.inValue("FPS Limit",0),n=a.outTrigger("trigger"),r=a.outNumber("width"),o=a.outNumber("height"),i=a.inValueBool("Reduce FPS not focussed",true),s=a.inValueBool("Reduce FPS loading"),l=a.inValueBool("Clear",true),c=a.inValueBool("ClearAlpha",true),u=a.inValueBool("Fullscreen Button",false),_=a.inValueBool("Active",true),d=a.inValueBool("Hires Displays",false),p=a.inSwitch("Pixel Unit",["Display","CSS"],"Display");a.onAnimFrame=T;d.onChange=function(){if(d.get())a.patch.cgl.pixelDensity=window.devicePixelRatio;else a.patch.cgl.pixelDensity=1;a.patch.cgl.updateSize();if(CABLES.UI)gui.setLayout()};_.onChange=function(){a.patch.removeOnAnimFrame(a);if(_.get()){a.setUiAttrib({extendTitle:""});a.onAnimFrame=T;a.patch.addOnAnimFrame(a);a.log("adding again!")}else{a.setUiAttrib({extendTitle:"Inactive"})}};const g=a.patch.cgl;let f=0;let m=0;if(!a.patch.cgl)a.uiAttr({error:"No webgl cgl context"});const v=vec3.create();vec3.set(v,0,0,0);const h=vec3.create();vec3.set(h,0,0,-2);u.onChange=y;setTimeout(y,100);let b=null;let x=true;let O=true;window.addEventListener("blur",()=>{x=false});window.addEventListener("focus",()=>{x=true});document.addEventListener("visibilitychange",()=>{O=!document.hidden});A();p.onChange=()=>{r.set(0);o.set(0)};function I(){if(s.get()&&a.patch.loading.getProgress()<1)return 5;if(i.get()){if(!O)return 10;if(!x)return 30}return t.get()}function y(){function e(){if(b)b.style.display="block"}function t(){if(b)b.style.display="none"}a.patch.cgl.canvas.addEventListener("mouseleave",t);a.patch.cgl.canvas.addEventListener("mouseenter",e);if(u.get()){if(!b){b=document.createElement("div");const n=a.patch.cgl.canvas.parentElement;if(n)n.appendChild(b);b.addEventListener("mouseenter",e);b.addEventListener("click",function(e){if(CABLES.UI&&!e.shiftKey)gui.cycleFullscreen();else g.fullScreen()})}b.style.padding="10px";b.style.position="absolute";b.style.right="5px";b.style.top="5px";b.style.width="20px";b.style.height="20px";b.style.cursor="pointer";b.style["border-radius"]="40px";b.style.background="#444";b.style["z-index"]="9999";b.style.display="none";b.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 490 490" style="width:20px;height:20px;" xml:space="preserve" width="512px" height="512px"><g><path d="M173.792,301.792L21.333,454.251v-80.917c0-5.891-4.776-10.667-10.667-10.667C4.776,362.667,0,367.442,0,373.333V480     c0,5.891,4.776,10.667,10.667,10.667h106.667c5.891,0,10.667-4.776,10.667-10.667s-4.776-10.667-10.667-10.667H36.416     l152.459-152.459c4.093-4.237,3.975-10.99-0.262-15.083C184.479,297.799,177.926,297.799,173.792,301.792z" fill="#FFFFFF"/><path d="M480,0H373.333c-5.891,0-10.667,4.776-10.667,10.667c0,5.891,4.776,10.667,10.667,10.667h80.917L301.792,173.792     c-4.237,4.093-4.354,10.845-0.262,15.083c4.093,4.237,10.845,4.354,15.083,0.262c0.089-0.086,0.176-0.173,0.262-0.262     L469.333,36.416v80.917c0,5.891,4.776,10.667,10.667,10.667s10.667-4.776,10.667-10.667V10.667C490.667,4.776,485.891,0,480,0z" fill="#FFFFFF"/><path d="M36.416,21.333h80.917c5.891,0,10.667-4.776,10.667-10.667C128,4.776,123.224,0,117.333,0H10.667     C4.776,0,0,4.776,0,10.667v106.667C0,123.224,4.776,128,10.667,128c5.891,0,10.667-4.776,10.667-10.667V36.416l152.459,152.459     c4.237,4.093,10.99,3.975,15.083-0.262c3.992-4.134,3.992-10.687,0-14.82L36.416,21.333z" fill="#FFFFFF"/><path d="M480,362.667c-5.891,0-10.667,4.776-10.667,10.667v80.917L316.875,301.792c-4.237-4.093-10.99-3.976-15.083,0.261     c-3.993,4.134-3.993,10.688,0,14.821l152.459,152.459h-80.917c-5.891,0-10.667,4.776-10.667,10.667s4.776,10.667,10.667,10.667     H480c5.891,0,10.667-4.776,10.667-10.667V373.333C490.667,367.442,485.891,362.667,480,362.667z" fill="#FFFFFF"/></g></svg>'}else{if(b){b.style.display="none";b.remove();b=null}}}a.onDelete=function(){g.gl.clearColor(0,0,0,0);g.gl.clear(g.gl.COLOR_BUFFER_BIT|g.gl.DEPTH_BUFFER_BIT)};function T(e){if(!_.get())return;if(g.aborted||g.canvas.clientWidth===0||g.canvas.clientHeight===0)return;a.patch.cg=g;const t=performance.now();a.patch.config.fpsLimit=I();if(g.canvasWidth==-1){g.setCanvas(a.patch.config.glCanvasId);return}if(g.canvasWidth!=r.get()||g.canvasHeight!=o.get()){let e=1;if(p.get()=="CSS")e=a.patch.cgl.pixelDensity;r.set(g.canvasWidth/e);o.set(g.canvasHeight/e)}if(CABLES.now()-m>1e3){CGL.fpsReport=CGL.fpsReport||[];if(a.patch.loading.getProgress()>=1&&m!==0)CGL.fpsReport.push(f);f=0;m=CABLES.now()}CGL.MESH.lastShader=null;CGL.MESH.lastMesh=null;g.renderStart(g,v,h);if(l.get()){g.gl.clearColor(0,0,0,1);g.gl.clear(g.gl.COLOR_BUFFER_BIT|g.gl.DEPTH_BUFFER_BIT)}n.trigger();if(CGL.MESH.lastMesh)CGL.MESH.lastMesh.unBind();if(CGL.Texture.previewTexture){if(!CGL.Texture.texturePreviewer)CGL.Texture.texturePreviewer=new CGL.Texture.texturePreview(g);CGL.Texture.texturePreviewer.render(CGL.Texture.previewTexture)}g.renderEnd(g);a.patch.cg=null;if(c.get()){g.gl.clearColor(1,1,1,1);g.gl.colorMask(false,false,false,true);g.gl.clear(g.gl.COLOR_BUFFER_BIT);g.gl.colorMask(true,true,true,true)}if(!g.frameStore.phong)g.frameStore.phong={};f++;a.patch.cgl.profileData.profileMainloopMs=performance.now()-t}function A(){setTimeout(()=>{if(a.patch.getOpsByObjName(a.name).length>1){a.setUiError("multimainloop","there should only be one mainloop op!");a.patch.addEventListener("onOpDelete",A)}else a.setUiError("multimainloop",null,1)},500)}};Ops.Gl.MainLoop.prototype=new CABLES.Op;CABLES.OPS["b0472a1d-db16-4ba6-8787-f300fbdc77bb"]={f:Ops.Gl.MainLoop,objName:"Ops.Gl.MainLoop"};Ops.Anim.AnimNumber=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("exe"),a=e.inValue("Value"),r=e.inValueFloat("duration"),o=e.outTrigger("Next"),i=e.outNumber("result"),s=e.outTrigger("Finished");const l=new CABLES.Anim;l.createPort(e,"easing",p);l.loop=false;r.set(.5);r.onChange=a.onChange=p;let c=0;let u=0;let _=0;let d=true;function p(){u=performance.now();l.clear(CABLES.now()/1e3);if(d)l.setValue(CABLES.now()/1e3,a.get());l.setValue(r.get()+CABLES.now()/1e3,a.get(),g);d=false}function g(){s.trigger()}n.onTriggered=function(){let e=CABLES.now()/1e3;if(performance.now()-c>300){d=true;p()}c=performance.now();let t=l.getValue(e);i.set(t);o.trigger()}};Ops.Anim.AnimNumber.prototype=new CABLES.Op;CABLES.OPS["e5b0b016-9663-4c9d-9365-f54ae3c5fbb6"]={f:Ops.Anim.AnimNumber,objName:"Ops.Anim.AnimNumber"};Ops.Ui.VizGraph=function(){CABLES.Op.apply(this,arguments);const l=this;const e={};const t=l.inFloat("Number 1"),n=l.inFloat("Number 2"),a=l.inFloat("Number 3"),r=l.inFloat("Number 4"),o=l.inFloat("Number 5"),i=l.inFloat("Number 6"),s=l.inFloat("Number 7"),c=l.inFloat("Number 8"),u=l.inTriggerButton("Reset");l.setUiAttrib({height:150,resizable:true});let _=[];let d=-Number.MAX_VALUE;let p=Number.MAX_VALUE;t.onLinkChanged=n.onLinkChanged=a.onLinkChanged=r.onLinkChanged=o.onLinkChanged=i.onLinkChanged=s.onLinkChanged=c.onLinkChanged=u.onTriggered=()=>{d=-Number.MAX_VALUE;p=Number.MAX_VALUE;_=[]};l.renderVizLayer=(a,r)=>{const e=CABLES.UI.uiProfiler.start("previewlayer graph");const t=["#00ffff","#ffff00","#ff00ff","#0000ff","#00ff00","#ff0000","#ffffff","#888888"];a.fillStyle="#222";a.fillRect(r.x,r.y,r.width,r.height);for(let n=0;n<l.portsIn.length;n++){if(!l.portsIn[n].isLinked())continue;const o=l.portsIn[n].get();d=Math.max(l.portsIn[n].get(),d);p=Math.min(l.portsIn[n].get(),p);if(!_[n])_[n]=[];_[n].push(o);if(_[n].length>60)_[n].shift();const i=5;const s=r.width/60;a.lineWidth=2;a.strokeStyle="#555555";a.beginPath();a.moveTo(r.x,CABLES.map(0,p,d,r.height,0)+r.y);a.lineTo(r.x+r.width,CABLES.map(0,p,d,r.height,0)+r.y);a.stroke();a.strokeStyle=t[n];a.beginPath();for(let t=0;t<_[n].length;t++){let e=_[n][t];e=CABLES.map(e,p,d,r.height,0);e+=r.y;if(t===0)a.moveTo(r.x,e);else a.lineTo(r.x+t*s,e)}a.stroke()}a.fillStyle="#888";a.fillText("max:"+Math.round(d*100)/100,r.x+10,r.y+r.height-10);a.fillText("min:"+Math.round(p*100)/100,r.x+10,r.y+r.height-30);e.finish()}};Ops.Ui.VizGraph.prototype=new CABLES.Op;CABLES.OPS["13c54eb4-60ef-4b9c-8425-d52a431f5c87"]={f:Ops.Ui.VizGraph,objName:"Ops.Ui.VizGraph"};Ops.Value.NumberSwitchBoolean=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueBool("Boolean"),a=e.inValue("Value false",0),r=e.inValue("Value true",1),o=e.outNumber("Result");n.onChange=r.onChange=a.onChange=i;e.setPortGroup("Output Values",[r,a]);function i(){if(n.get())o.set(r.get());else o.set(a.get())}};Ops.Value.NumberSwitchBoolean.prototype=new CABLES.Op;CABLES.OPS["637c5fa8-840d-4535-96ab-3d27b458a8ba"]={f:Ops.Value.NumberSwitchBoolean,objName:"Ops.Value.NumberSwitchBoolean"};Ops.Math.Compare.GreaterThan=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueFloat("number1"),a=e.inValueFloat("number2"),r=e.outBoolNum("result");e.setTitle(">");n.onChange=a.onChange=o;function o(){r.set(n.get()>a.get())}};Ops.Math.Compare.GreaterThan.prototype=new CABLES.Op;CABLES.OPS["b250d606-f7f8-44d3-b099-c29efff2608a"]={f:Ops.Math.Compare.GreaterThan,objName:"Ops.Math.Compare.GreaterThan"};Ops.Value.GateNumber=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValue("Value In",0);const a=e.inValueBool("Pass Through");const r=e.outNumber("Value Out");n.onChange=o;a.onChange=o;n.changeAlways=true;r.changeAlways=true;function o(){if(a.get()){r.set(n.get())}}};Ops.Value.GateNumber.prototype=new CABLES.Op;CABLES.OPS["594105c8-1fdb-4f3c-bbd5-29b9ad6b33e0"]={f:Ops.Value.GateNumber,objName:"Ops.Value.GateNumber"};Ops.Trigger.IsTriggered=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("Trigger"),a=e.outTrigger("Next"),r=e.outBool("Was Triggered",false);let o=0;e.onAnimFrame=function(e){o++;if(o>1)r.set(false)};n.onTriggered=function(){o=0;r.set(true);a.trigger()}};Ops.Trigger.IsTriggered.prototype=new CABLES.Op;CABLES.OPS["7c96fee9-4c2f-45e1-a41b-096b06d286b8"]={f:Ops.Trigger.IsTriggered,objName:"Ops.Trigger.IsTriggered"};Ops.Math.Exp=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueFloat("number");const a=e.outNumber("result");n.onChange=function(){let e=Math.exp(n.get());if(isNaN(e))e=0;a.set(e)}};Ops.Math.Exp.prototype=new CABLES.Op;CABLES.OPS["612727c2-b2e5-446c-99bb-7e30132f2ff6"]={f:Ops.Math.Exp,objName:"Ops.Math.Exp"};Ops.Trigger.TimedSequence=function(){CABLES.Op.apply(this,arguments);const n=this;const e={};const t=n.inTrigger("exe");const r=n.inValueInt("current",0);const o=n.inValueBool("overwriteTime");const i=n.inValueBool("ignoreInSubPatch",false);const s=n.outTrigger("triggerAlways");const a=n.outArray("Names",[]);const l=n.outNumber("currentKeyTime");const c=n.outNumber("Current");let u=[];for(let t=0;t<32;t++){let e=n.outTrigger("trigger "+t);e.onLinkChanged=_;u.push(e)}function _(){let t=[];for(let e=0;e<u.length;e++)if(u[e].isLinked())t.push(u[e].links[0].getOtherPort(u[e]).parent.uiAttribs.title);else t.push("none");a.set(t)}n.onLoaded=_;let d=-1;t.onTriggered=p;function p(a){let t=0;let e=Math.round(r.get()-.5);if(window.gui){if(r.get()!=d){d=r.get();for(t=0;t<u.length;t++){if(t==d)u[t].setUiActiveState(true);else u[t].setUiActiveState(false)}}}if(r.anim){let e=a;if(a===undefined)e=r.parent.patch.timer.getTime();let t=r.anim.getKey(e);let n=0;if(t)n=t.time;l.set(e-n);if(r.isAnimated()){if(o.get()){r.parent.patch.timer.overwriteTime=l.get()}}}if(n.patch.gui&&i.get()){for(let e=0;e<u.length;e++){for(t=0;t<u[e].links.length;t++){if(u[e].links[t]){if(u[e].links[t].portIn.parent.patchId){if(CABLES.UI)if(gui.patchView.getCurrentSubPatch()==u[e].links[t].portIn.parent.patchId.get()){n.patch.timer.overwriteTime=-1;u[e].trigger();return}}}}}}if(e>=0&&e<u.length){c.set(e);u[e].trigger()}n.patch.timer.overwriteTime=-1;s.trigger()}};Ops.Trigger.TimedSequence.prototype=new CABLES.Op;CABLES.OPS["73c892c9-3e81-4ddc-952a-fbe6bf00ef2c"]={f:Ops.Trigger.TimedSequence,objName:"Ops.Trigger.TimedSequence"};Ops.Gl.Render2Texture=function(){CABLES.Op.apply(this,arguments);const r=this;const e={};const o=r.patch.cgl;const t=r.inTrigger("render"),n=r.inValueBool("use viewport size",true),a=r.inValueInt("texture width",512),i=r.inValueInt("texture height",512),s=r.inBool("Auto Aspect",false),l=r.inSwitch("filter",["nearest","linear","mipmap"],"linear"),c=r.inSwitch("Wrap",["Clamp","Repeat","Mirror"],"Repeat"),u=r.inSwitch("MSAA",["none","2x","4x","8x"],"none"),_=r.outTrigger("trigger"),d=r.outTexture("texture"),p=r.outTexture("textureDepth"),g=r.inValueBool("HDR"),f=r.inValueBool("Depth",true),m=r.inValueBool("Clear",true);let v=null;let h=true;d.set(CGL.Texture.getEmptyTexture(o));r.setPortGroup("Size",[n,a,i,s]);const b=[0,0,0,0];g.setUiAttribs({title:"Pixelformat Float 32bit"});g.onChange=f.onChange=m.onChange=l.onChange=c.onChange=u.onChange=O;n.onChange=x;t.onTriggered=r.preRender=I;x();function x(){a.setUiAttribs({greyout:n.get()});i.setUiAttribs({greyout:n.get()});s.setUiAttribs({greyout:n.get()})}function O(){h=true}function I(){const e=o.getViewPort();b[0]=e[0];b[1]=e[1];b[2]=e[2];b[3]=e[3];if(!v||h){if(v)v.delete();let n=CGL.Texture.WRAP_REPEAT;if(c.get()=="Clamp")n=CGL.Texture.WRAP_CLAMP_TO_EDGE;else if(c.get()=="Mirror")n=CGL.Texture.WRAP_MIRRORED_REPEAT;let a=CGL.Texture.FILTER_NEAREST;if(l.get()=="nearest")a=CGL.Texture.FILTER_NEAREST;else if(l.get()=="linear")a=CGL.Texture.FILTER_LINEAR;else if(l.get()=="mipmap")a=CGL.Texture.FILTER_MIPMAP;if(g.get()&&l.get()=="mipmap")r.setUiError("fpmipmap","Don't use mipmap and HDR at the same time, many systems do not support this.");else r.setUiError("fpmipmap",null);if(o.glVersion>=2){let e=true;let t=4;if(u.get()=="none"){t=0;e=false}if(u.get()=="2x")t=2;if(u.get()=="4x")t=4;if(u.get()=="8x")t=8;v=new CGL.Framebuffer2(o,8,8,{name:"render2texture "+r.id,isFloatingPointTexture:g.get(),multisampling:e,wrap:n,filter:a,depth:f.get(),multisamplingSamples:t,clear:m.get()})}else{v=new CGL.Framebuffer(o,8,8,{isFloatingPointTexture:g.get(),clear:m.get()})}p.set(v.getTextureDepth());h=false}if(n.get()){a.set(o.getViewPort()[2]);i.set(o.getViewPort()[3])}if(v.getWidth()!=Math.ceil(a.get())||v.getHeight()!=Math.ceil(i.get())){v.setSize(Math.max(1,Math.ceil(a.get())),Math.max(1,Math.ceil(i.get())))}v.renderStart(o);if(s.get())mat4.perspective(o.pMatrix,45,a.get()/i.get(),.1,1e3);_.trigger();v.renderEnd(o);o.setViewPort(b[0],b[1],b[2],b[3]);d.set(CGL.Texture.getEmptyTexture(r.patch.cgl));d.set(v.getTextureColor())}};Ops.Gl.Render2Texture.prototype=new CABLES.Op;CABLES.OPS["d01fa820-396c-4cb5-9d78-6b14762852af"]={f:Ops.Gl.Render2Texture,objName:"Ops.Gl.Render2Texture"};Ops.Boolean.ToggleBoolValue=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueBool("in bool"),a=e.outBoolNum("out bool");n.changeAlways=true;n.onChange=function(){a.set(!(n.get()==true))}};Ops.Boolean.ToggleBoolValue.prototype=new CABLES.Op;CABLES.OPS["7b1abd02-3aad-4106-9848-7f4c3cfab6a9"]={f:Ops.Boolean.ToggleBoolValue,objName:"Ops.Boolean.ToggleBoolValue"};Ops.Math.Compare.GreaterOrEquals=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.outBoolNum("result"),a=e.inValueFloat("number1"),r=e.inValueFloat("number2");a.onLinkChanged=r.onLinkChanged=a.onChange=r.onChange=o;function o(){n.set(a.get()>=r.get())}};Ops.Math.Compare.GreaterOrEquals.prototype=new CABLES.Op;CABLES.OPS["5f9ce320-1e8d-49cb-9927-337e0b3f4d45"]={f:Ops.Math.Compare.GreaterOrEquals,objName:"Ops.Math.Compare.GreaterOrEquals"};Ops.Sidebar.Toggle_v3=function(){CABLES.Op.apply(this,arguments);const t=this;const e={};const n=true;const a=t.inObject("link");const r=t.inString("Text","Toggle");const o=t.inValueBool("Input",n);const i=t.inTriggerButton("Set Default");const s=t.inValueBool("Default",n);s.setUiAttribs({hidePort:true,greyout:true});const l=t.inBool("Grey Out",false);const c=t.inBool("Visible",true);const u=t.outObject("childs");const _=t.outNumber("Value",s.get());const d=document.createElement("div");d.dataset.op=t.id;d.classList.add("cablesEle");d.classList.add("sidebar__item");d.classList.add("sidebar__toggle");d.classList.add("sidebar__reloadable");if(n)d.classList.add("sidebar__toggle--active");d.addEventListener("dblclick",function(){_.set(s.get());o.set(s.get())});const p=document.createElement("div");p.classList.add("sidebar__item-label");const g=document.createTextNode(r.get());p.appendChild(g);d.appendChild(p);const f=document.createElement("div");f.classList.add("icon_toggle");f.addEventListener("click",h);d.appendChild(f);const m=document.createElement("div");m.classList.add("sidebar__greyout");d.appendChild(m);m.style.display="none";a.onChange=O;r.onChange=x;o.onChange=b;t.onDelete=T;i.onTriggered=v;function v(){const e=o.get();s.set(e);_.set(e);t.refreshParams()}function h(){d.classList.toggle("sidebar__toggle--active");if(d.classList.contains("sidebar__toggle--active")){_.set(true);o.set(true);f.classList.add("icon_toggle_true");f.classList.remove("icon_toggle_false")}else{f.classList.remove("icon_toggle_true");f.classList.add("icon_toggle_false");_.set(false);o.set(false)}t.refreshParams()}function b(){const e=o.get();if(e){d.classList.add("sidebar__toggle--active");_.set(true)}else{d.classList.remove("sidebar__toggle--active");_.set(false)}}function x(){const e=r.get();p.textContent=e;if(CABLES.UI)t.setTitle("Toggle: "+e)}function O(){u.set(null);const e=a.get();if(e&&e.parentElement){e.parentElement.appendChild(d);u.set(e)}else if(d.parentElement)d.parentElement.removeChild(d)}function I(e){if(e)e.style.display="block"}function y(e){if(e)e.style.display="none"}function T(){A(d)}function A(e){if(e&&e.parentNode&&e.parentNode.removeChild)e.parentNode.removeChild(d)}l.onChange=function(){m.style.display=l.get()?"block":"none"};c.onChange=function(){d.style.display=c.get()?"block":"none"}};Ops.Sidebar.Toggle_v3.prototype=new CABLES.Op;CABLES.OPS["fb60ab7d-f2f2-4fc5-bcd0-88c6ed481908"]={f:Ops.Sidebar.Toggle_v3,objName:"Ops.Sidebar.Toggle_v3"};Ops.Value.RouteNumber=function(){CABLES.Op.apply(this,arguments);const a=this;const e={};const r=10;const t=0;let n=null;const o=a.inValue("Index",0);const i=a.inValue("Value",0);const s=a.inValue("Default Value",t);const l=a.inBool("Set inactive to default",false);const c=u(t);o.onChange=d;i.onChange=d;s.onChange=_;l.onChange=g;_();function u(){let n=[];for(let t=0;t<r;t++){let e=a.outNumber("Index "+t+" Value");n.push(e)}return n}function _(){const t=s.get();c.forEach(e=>{e.set(t)})}function d(){let e=o.get();e=Math.round(e);e=p(e,0,r-1);if(l.get()&&n!==null&&n!=e){c[n].set(s.get())}const t=i.get();c[e].set(t);n=e}function p(e,t,n){return Math.min(Math.max(e,t),n)}function g(){if(l.get()){_();d()}}};Ops.Value.RouteNumber.prototype=new CABLES.Op;CABLES.OPS["e3b1fc2d-a813-4d9b-8cb0-595fc95af4e2"]={f:Ops.Value.RouteNumber,objName:"Ops.Value.RouteNumber"};Ops.Math.Compare.LessThan=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValue("number1");const a=e.inValue("number2");const r=e.outBoolNum("result");e.setTitle("<");n.onChange=o;a.onChange=o;o();function o(){r.set(n.get()<a.get())}};Ops.Math.Compare.LessThan.prototype=new CABLES.Op;CABLES.OPS["04fd113f-ade1-43fb-99fa-f8825f8814c0"]={f:Ops.Math.Compare.LessThan,objName:"Ops.Math.Compare.LessThan"};Ops.Array.ArrayFromNumbers=function(){CABLES.Op.apply(this,arguments);const t=this;const e={};const n=t.inTrigger("Update"),a=t.inInt("Limit",30),r=t.inBool("Slider",false),o=t.outTrigger("Next"),i=t.outArray("Array");const s=[];for(let e=0;e<30;e++){const _=t.inFloat("Index "+e,0);s.push(_)}const l=[];let c=null;n.onTriggered=u;r.onChange=()=>{const e=a.get();for(let e=0;e<s.length;e++)if(r.get())s[e].setUiAttribs({display:"range"});else s[e].setUiAttribs({display:null});t.refreshParams()};a.onChange=()=>{clearTimeout(c);c=setTimeout(()=>{const t=a.get();for(let e=0;e<s.length;e++){s[e].setUiAttribs({greyout:e>=t})}},300)};function u(){const t=Math.max(0,Math.ceil(Math.min(a.get(),s.length)));l.length=t;for(let e=0;e<t;e++){l[e]=s[e].get()}i.set(null);i.set(l);o.trigger()}};Ops.Array.ArrayFromNumbers.prototype=new CABLES.Op;CABLES.OPS["fb698158-3cf8-49d6-805e-6ea38fdab8c1"]={f:Ops.Array.ArrayFromNumbers,objName:"Ops.Array.ArrayFromNumbers"};Ops.Array.ArrayContains_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inArray("Array"),a=e.inFloat("SearchValue"),r=e.outBool("Found",false),o=e.outNumber("Index",-1);a.onChange=n.onChange=i;function i(){if(n.get()){const e=n.get().indexOf(a.get());o.set(e);r.set(e>-1)}}};Ops.Array.ArrayContains_v2.prototype=new CABLES.Op;CABLES.OPS["b982d7e3-c9cf-41dd-aead-66daad785fa8"]={f:Ops.Array.ArrayContains_v2,objName:"Ops.Array.ArrayContains_v2"};Ops.Json.ArrayGetNumberByPath=function(){CABLES.Op.apply(this,arguments);const o=this;const e={};const i=o.inArray("Array");const s=o.inString("Path");const l=o.outNumber("Output");const c=o.outBool("Found");i.onChange=t;s.onChange=t;function t(){const t=i.get();const n=s.get();o.setUiError("missing",null);if(t&&n){if(!Array.isArray(t)&&!(typeof t==="object")){c.set(false);o.setUiError("notiterable","input object of type "+typeof t+" is not travesable by path")}else{o.setUiError("notiterable",null);const a=n.split(".");o.setUiAttrib({extendTitle:a[a.length-1]+""});let e=u(n,t);if(e===undefined){const r="could not find element at path "+n;c.set(false);e=null;o.setUiError("missing",r,2)}else if(typeof e!=="number"){const r="element at path "+n+" is not a number";c.set(false);e=null;o.setUiError("missing",r,2)}else{c.set(true)}l.set(e)}}else{c.set(false)}}function u(e,t=self,n="."){const a=Array.isArray(e)?e:e.split(n);return a.reduce((e,t)=>e&&e[t],t)}};Ops.Json.ArrayGetNumberByPath.prototype=new CABLES.Op;CABLES.OPS["9a8ac7c9-dc88-44cb-b4f7-fead5ebb9ed7"]={f:Ops.Json.ArrayGetNumberByPath,objName:"Ops.Json.ArrayGetNumberByPath"};Ops.String.NumberToString_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValue("Number"),a=e.outString("Result");n.onChange=r;r();function r(){a.set(String(n.get()||0))}};Ops.String.NumberToString_v2.prototype=new CABLES.Op;CABLES.OPS["5c6d375a-82db-4366-8013-93f56b4061a9"]={f:Ops.String.NumberToString_v2,objName:"Ops.String.NumberToString_v2"};Ops.Math.SmoothStep_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.outNumber("result"),a=e.inValueFloat("number",0),r=e.inValueFloat("min",0),o=e.inValueFloat("max",1);a.onChange=o.onChange=r.onChange=i;i();function i(){let e=Math.max(0,Math.min(1,(a.get()-r.get())/(o.get()-r.get())));n.set(e*e*(3-2)*(o.get()-r.get()))}};Ops.Math.SmoothStep_v2.prototype=new CABLES.Op;CABLES.OPS["b5c41eea-ac30-4ac7-9481-eefe42e8199c"]={f:Ops.Math.SmoothStep_v2,objName:"Ops.Math.SmoothStep_v2"};Ops.Gl.Textures.SwitchTextures_v2=function(){CABLES.Op.apply(this,arguments);const t=this;const e={};const n=t.inTrigger("exec"),a=this.inValueInt("num"),r=t.inValueBool("Default Texture Transparent",true),o=t.outTrigger("Next"),i=this.outTexture("texture");const s=t.patch.cgl;const l=[];let c=0;let u=-1;let _=CGL.Texture.getEmptyTexture(s);t.toWorkPortsNeedToBeLinked(n);n.onTriggered=function(){p();o.trigger()};r.onChange=function(){if(r.get())_=CGL.Texture.getEmptyTexture(s);else _=CGL.Texture.getTempTexture(s);p(true)};for(let e=0;e<16;e++){const g=t.inTexture("texture"+e);l.push(g);g.onChange=d}function d(){p(true)}function p(e){c=parseInt(a.get(),10);if(!e){if(c==u)return;if(c!=c)return}if(isNaN(c)||c<0||c>l.length-1)c=0;if(l[c].get())i.set(l[c].get());else i.set(_);u=c}};Ops.Gl.Textures.SwitchTextures_v2.prototype=new CABLES.Op;CABLES.OPS["a82ae429-ac07-4760-882b-595a857c7ae0"]={f:Ops.Gl.Textures.SwitchTextures_v2,objName:"Ops.Gl.Textures.SwitchTextures_v2"};Ops.Value.PreviousValueStore=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueFloat("Value"),a=e.outNumber("Current Value"),r=e.outNumber("Previous Value");let o=0;n.onChange=function(){r.set(o);o=n.get();a.set(n.get())}};Ops.Value.PreviousValueStore.prototype=new CABLES.Op;CABLES.OPS["01716872-67bd-4b31-a4a2-e0ccadf48411"]={f:Ops.Value.PreviousValueStore,objName:"Ops.Value.PreviousValueStore"};Ops.Ui.Area=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inString("Title","");n.setUiAttribs({hidePort:true});e.setUiAttrib({hasArea:true});e.init=n.onChange=e.onLoaded=a;a();function a(){if(CABLES.UI){gui.setStateUnsaved();e.uiAttr({comment_title:n.get()||" "});e.name=n.get()}}};Ops.Ui.Area.prototype=new CABLES.Op;CABLES.OPS["38f79614-b0de-4960-8da5-2827e7f43415"]={f:Ops.Ui.Area,objName:"Ops.Ui.Area"};Ops.Sidebar.XYPad=function(){CABLES.Op.apply(this,arguments);const r=this;const e={};const t=r.inObject("Link"),n=r.inString("Text","XY Pad"),i=r.inSwitch("Range",["0-1","-1-1"],"0-1"),o=r.inValueSlider("Input X",0),s=r.inValueSlider("Input Y",0),l=r.inBool("Flip X",false),c=r.inBool("Flip Y",false),a=r.inTriggerButton("Set Default"),u=r.inValueString("Default X",.5),_=r.inValueString("Default Y",.5),d=r.inBool("Visible",true);const p=r.outObject("Children");u.setUiAttribs({hidePort:true,greyout:true});_.setUiAttribs({hidePort:true,greyout:true});const g=r.outNumber("X",0);const f=r.outNumber("Y",0);const m=document.createElement("div");m.dataset.op=r.id;m.classList.add("cablesEle");m.addEventListener("dblclick",function(){S(u.get(),_.get());C()});m.classList.add("sidebar__item");m.classList.add("sidebar__color-picker");m.classList.add("sidebar__reloadable");const v=document.createElement("div");v.classList.add("sidebar__item-label");const h=document.createTextNode(n.get());v.appendChild(h);m.appendChild(v);const b=document.createElement("input");b.classList.add("sidebar__text-input-input");b.setAttribute("type","text");b.style.width="40px";b.style.backgroundColor="transparent";m.appendChild(b);const x=document.createElement("input");x.classList.add("sidebar__text-input-input");x.setAttribute("type","text");x.style.width="40px";x.style.backgroundColor="transparent";m.appendChild(x);b.addEventListener("input",O);x.addEventListener("input",O);a.onTriggered=E;d.onChange=function(){m.style.display=d.get()?"block":"none"};function O(){let e=parseFloat(b.value);let t=parseFloat(x.value);if(e!=e||t!=t)return;let n=0;let a=1;let r=0;let o=1;e=Math.max(Math.min(e,a),n);t=Math.max(Math.min(t,o),r);if(i.get()=="-1-1"){r=n=-1;o=a=1}S(CABLES.map(e,n,a,0,1),CABLES.map(t,r,o,0,1))}const I=190;const y=document.createElement("canvas");y.width=y.height=I;y.style.width=I+"px";y.style.height=I+"px";y.style.marginTop="6px";y.style.position="initial";m.appendChild(y);const T=y.getContext("2d");t.onChange=L;n.onChange=N;r.onDelete=D;i.onChange=()=>{S(u.get(),_.get());C()};C();l.onChange=c.onChange=()=>{S(o.get(),s.get())};y.addEventListener("pointerdown",e=>{try{y.setPointerCapture(e.pointerId)}catch(e){}});y.addEventListener("pointerup",e=>{try{y.releasePointerCapture(e.pointerId)}catch(e){}});o.onChange=()=>{S(o.get(),s.get())};s.onChange=()=>{S(o.get(),s.get())};function A(n){if(n.buttons==1){let e=Math.min(I,Math.max(n.offsetX,0));let t=Math.min(I,Math.max(n.offsetY,0));if(n.shiftKey){const a=I/10;e=Math.round(e/a)*a;t=Math.round(t/a)*a}S(e/I,t/I);o.set(e/I);s.set(t/I);r.refreshParams()}}y.addEventListener("pointermove",A,false);y.addEventListener("pointerdown",A,false);function S(e,t){o.set(e);s.set(t);if(l.get())e=1-e;if(c.get())t=1-t;let n=e;let a=t;if(i.get()=="0-1"){g.set(n);f.set(a)}else{g.set((n-.5)*2);f.set((a-.5)*2)}if(b.value!=""+g.get())b.value=""+g.get();if(x.value!=""+f.get())x.value=""+f.get();C()}function C(){T.lineWidth=1;T.strokeWidth=1;T.clearRect(0,0,I,I);T.fillStyle="#333";T.fillRect(0,0,I,I);T.strokeStyle="#555";T.strokeRect(0,I/2,I,0);T.strokeRect(I/2,0,0,I);T.strokeRect(0,0,I,I);T.strokeStyle="#fff";T.beginPath();T.arc(o.get()*I,s.get()*I,5,0,Math.PI*2,true);T.stroke()}function E(){_.set(s.get());u.set(o.get());S(u.get(),_.get());C();r.refreshParams()}function M(){C()}function N(){const e=n.get();v.textContent=e;r.setUiAttrib({extendTitle:e})}function L(){p.set(null);const e=t.get();if(e&&e.parentElement){e.parentElement.appendChild(m);p.set(e)}else if(m.parentElement)m.parentElement.removeChild(m)}function w(e){if(e)e.style.display="block"}function P(e){if(e)e.style.display="none"}function D(){R(m)}function R(e){if(e&&e.parentNode&&e.parentNode.removeChild){e.parentNode.removeChild(e)}}};Ops.Sidebar.XYPad.prototype=new CABLES.Op;CABLES.OPS["84f3d05f-0991-4721-88cb-66776b16a094"]={f:Ops.Sidebar.XYPad,objName:"Ops.Sidebar.XYPad"};Ops.Sidebar.Incrementor_v2=function(){CABLES.Op.apply(this,arguments);const t=this;const e={};const n=t.inObject("link");const a=t.inString("Label","Incrementor");const r=t.inValue("min",0);const o=t.inValue("max",10);const i=t.inValue("stepsize",1);const s=t.inValue("Default",0);const l=t.inArray("Values");const c=t.inTriggerButton("Set Default");c.onTriggered=A;const u=t.outObject("childs");const _=t.outNumber("value");let d=0;const p=document.createElement("div");p.dataset.op=t.id;p.classList.add("cablesEle");p.classList.add("sidebar__item");const g=document.createElement("div");g.classList.add("sidebar__item-label");g.addEventListener("dblclick",function(){_.set(s.get())});const f=document.createTextNode(a.get());g.appendChild(f);p.appendChild(g);const m=document.createElement("span");m.classList.add("sidebar__item__right");const v=document.createElement("span");v.style.marginRight="10px";let h=document.createTextNode(r.get());if(Array.isArray(l.get())){h=document.createTextNode(l.get()[d])}v.appendChild(h);m.appendChild(v);const b=document.createElement("span");b.classList.add("sidebar--button");b.style.marginRight="3px";const x=document.createElement("div");x.classList.add("sidebar__button-input");x.classList.add("minus");b.appendChild(x);x.addEventListener("click",E);const O=document.createTextNode("-");x.appendChild(O);m.appendChild(b);const I=document.createElement("span");I.classList.add("sidebar--button");const y=document.createElement("div");y.classList.add("sidebar__button-input");y.classList.add("plus");I.appendChild(y);y.addEventListener("click",C);const T=document.createTextNode("+");y.appendChild(T);m.appendChild(I);p.appendChild(m);t.toWorkNeedsParent("Ops.Sidebar.Sidebar");function A(){s.set(_.get());t.refreshParams()}n.onChange=M;l.onChange=S;a.onChange=N;t.onDelete=L;t.onLoaded=t.onInit=function(){if(Array.isArray(l.get())){s.setUiAttribs({greyout:true})}else{_.set(s.get());h.textContent=s.get()}};function S(){const e=l.get();let t=r.get();if(Array.isArray(e)){t=e[d];r.setUiAttribs({greyout:true});o.set(e.length-1);o.setUiAttribs({greyout:true});i.setUiAttribs({greyout:true});i.set(1);s.setUiAttribs({greyout:true});s.set(0)}else{r.setUiAttribs({greyout:false});o.setUiAttribs({greyout:false});i.setUiAttribs({greyout:false});s.setUiAttribs({greyout:false})}_.set(t);h.textContent=t}function C(){const e=l.get();let t=0;if(!Array.isArray(e)){const n=_.get();t=Math.min(n+i.get(),o.get())}else{if(d<e.length-1){d+=Math.ceil(i.get())}t=e[d]}h.textContent=t;_.set(t)}function E(){const e=l.get();let t=0;if(!Array.isArray(e)){const n=_.get();t=Math.max(n-i.get(),r.get())}else{if(d>0){d-=Math.ceil(i.get())}t=e[d]}h.textContent=t;_.set(t)}function M(){u.set(null);const e=n.get();if(e&&e.parentElement){e.parentElement.appendChild(p);u.set(e)}else if(p.parentElement){p.parentElement.removeChild(p)}}function N(){const e=a.get();g.textContent=e;if(CABLES.UI){t.setTitle(e)}}function L(){w(p)}function w(e){if(e&&e.parentNode&&e.parentNode.removeChild){e.parentNode.removeChild(e)}}};Ops.Sidebar.Incrementor_v2.prototype=new CABLES.Op;CABLES.OPS["13932cbc-2bd4-4b2a-b6e0-cda6df4cec54"]={f:Ops.Sidebar.Incrementor_v2,objName:"Ops.Sidebar.Incrementor_v2"};Ops.Math.Log=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueFloat("number");const a=e.outNumber("result");n.onChange=function(){let e=Math.log(n.get());if(isNaN(e))e=0;a.set(e)}};Ops.Math.Log.prototype=new CABLES.Op;CABLES.OPS["7440b1ca-71d9-42a3-a927-d7b45b8857f9"]={f:Ops.Math.Log,objName:"Ops.Math.Log"};Ops.Gl.TextureEffects.Wobble=function(){CABLES.Op.apply(this,arguments);const e=this;const t={wobble_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI sampler2D texMask;\nUNI float time;\nUNI float speedX;\nUNI float speedY;\nUNI float repeatX;\nUNI float repeatY;\nUNI float mul;\n\nconst vec4 lumcoeff = vec4(0.299,0.587,0.114, 0.);\n\nvoid main()\n{\n    vec4 col=vec4(1.0,0.0,0.0,1.0);\n\nfloat mult=mul;\n#ifdef MASK\n    mult*=texture(texMask,texCoord).r;\n#endif\n\n    vec2 tc = texCoord + cos( (time*vec2(speedX, speedY) + vec2(texCoord.s*repeatX,texCoord.t*repeatY)))*mult;\n\n    col=texture(tex,tc);\n\n    outColor= col;\n}"};const n=e.inTrigger("Render"),a=e.inValue("time",0),r=e.inValue("SpeedX",4),o=e.inValue("SpeedY",8),i=e.inValue("RepeatX",11),s=e.inValue("RepeatY",11),l=e.inValue("Multiply",.01),c=e.inTexture("Mask"),u=e.outTrigger("Trigger");const _=e.patch.cgl;const d=new CGL.Shader(_,e.name);d.setSource(d.getDefaultVertexShader(),t.wobble_frag);const p=new CGL.Uniform(d,"t","tex",0);const g=new CGL.Uniform(d,"f","time",a);const f=new CGL.Uniform(d,"f","speedX",r);const m=new CGL.Uniform(d,"f","speedY",o);const v=new CGL.Uniform(d,"f","repeatX",i);const h=new CGL.Uniform(d,"f","repeatY",s);const b=new CGL.Uniform(d,"f","mul",l);const x=new CGL.Uniform(d,"t","texMask",1);c.onChange=function(){d.toggleDefine("MASK",c.isLinked())};n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;_.pushShader(d);_.currentTextureEffect.bind();_.setTexture(0,_.currentTextureEffect.getCurrentSourceTexture().tex);if(c.get())_.setTexture(1,c.get().tex);_.currentTextureEffect.finish();_.popShader();u.trigger()}};Ops.Gl.TextureEffects.Wobble.prototype=new CABLES.Op;CABLES.OPS["c349f178-eb83-4753-829e-c9a50b7f459c"]={f:Ops.Gl.TextureEffects.Wobble,objName:"Ops.Gl.TextureEffects.Wobble"};Ops.Trigger.GateTrigger=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("Execute"),a=e.inValueBool("Pass Through",true),r=e.outTrigger("Trigger out");n.onTriggered=function(){if(a.get())r.trigger()}};Ops.Trigger.GateTrigger.prototype=new CABLES.Op;CABLES.OPS["65e8b8a2-ba13-485f-883a-2bcf377989da"]={f:Ops.Trigger.GateTrigger,objName:"Ops.Trigger.GateTrigger"};Ops.Boolean.ToggleBool=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTriggerButton("trigger"),a=e.inTriggerButton("reset"),r=e.outBool("result"),o=e.inBool("Default",false);let i=false;r.set(i);r.ignoreValueSerialize=true;n.onTriggered=function(){i=!i;r.set(i)};a.onTriggered=function(){i=o.get();r.set(i)}};Ops.Boolean.ToggleBool.prototype=new CABLES.Op;CABLES.OPS["712a25f4-3a93-4042-b8c5-2f56169186cc"]={f:Ops.Boolean.ToggleBool,objName:"Ops.Boolean.ToggleBool"};Ops.Gl.TextureEffects.Gradient=function(){CABLES.Op.apply(this,arguments);const e=this;const t={gradient_frag:"IN vec2 texCoord;\nUNI float amount;\nUNI float pos;\nUNI float width;\n\nUNI vec3 colA;\nUNI vec3 colB;\nUNI vec3 colC;\nUNI sampler2D tex;\n\n{{CGL.BLENDMODES}}\n\nvoid main()\n{\n    vec4 base=texture(tex,texCoord);\n    vec4 col;\n    float ax=texCoord.x;\n\n    #ifdef GRAD_Y\n        ax=texCoord.y;\n    #endif\n    #ifdef GRAD_XY\n        ax=(texCoord.x+texCoord.y)/2.0;\n    #endif\n    #ifdef GRAD_RADIAL\n        ax=distance(texCoord,vec2(0.5,0.5))*2.0;\n    #endif\n\n    ax=((ax-0.5)*width)+0.5;\n\n    // ax-=0.03;\n\n    #ifndef GRAD_SMOOTHSTEP\n        if(ax<=pos) col = vec4(mix(colA, colB, ax*1.0/pos),1.0);\n        else col = vec4(mix(colB, colC, min(1.0,(ax-pos)*1.0/(1.0-pos))),1.0);\n    #endif\n\n    #ifdef GRAD_SMOOTHSTEP\n        if(ax<=pos) col = vec4(mix(colA, colB, smoothstep(0.0,1.0,ax*1.0/pos)),1.0);\n        else col = vec4(mix(colB, colC, smoothstep(0.0,1.0,min(1.0,(ax-pos)*1.0/(1.0-pos)))),1.0);\n    #endif\n\n    outColor=cgl_blend(base,col,amount);\n}"};const n=e.inTrigger("Render");const a=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal");const r=e.inValueSlider("Amount",1);const o=e.inValue("Width",1);const i=e.inSwitch("Type",["X","Y","XY","Radial"],"X");const s=e.inValueSlider("Pos",.5);const l=e.inValueBool("Smoothstep",true);const c=e.inValueSlider("r",Math.random());const u=e.inValueSlider("g",Math.random());const _=e.inValueSlider("b",Math.random());c.setUiAttribs({colorPick:true});const d=e.inValueSlider("r2",Math.random());const p=e.inValueSlider("g2",Math.random());const g=e.inValueSlider("b2",Math.random());d.setUiAttribs({colorPick:true});const f=e.inValueSlider("r3",Math.random());const m=e.inValueSlider("g3",Math.random());const v=e.inValueSlider("b3",Math.random());f.setUiAttribs({colorPick:true});l.onChange=M;e.setPortGroup("Blending",[a,r]);e.setPortGroup("Color A",[c,u,_]);e.setPortGroup("Color B",[d,p,g]);e.setPortGroup("Color C",[f,m,v]);const h=e.inTriggerButton("Randomize");const b=e.outTrigger("Next");const x=e.patch.cgl;const O=new CGL.Shader(x,"gradient");O.setSource(O.getDefaultVertexShader(),t.gradient_frag);const I=new CGL.Uniform(O,"f","amount",r);const y=new CGL.Uniform(O,"f","pos",s);const T=new CGL.Uniform(O,"f","width",o);const A=new CGL.Uniform(O,"t","tex",0);let S,C,E;d.onChange=p.onChange=g.onChange=L;f.onChange=m.onChange=v.onChange=w;c.onChange=u.onChange=_.onChange=N;N();L();w();M();function M(){if(l.get())O.define("GRAD_SMOOTHSTEP");else O.removeDefine("GRAD_SMOOTHSTEP")}i.onChange=function(){O.removeDefine("GRAD_X");O.removeDefine("GRAD_Y");O.removeDefine("GRAD_XY");O.removeDefine("GRAD_RADIAL");if(i.get()=="XY")O.define("GRAD_XY");if(i.get()=="X")O.define("GRAD_X");if(i.get()=="Y")O.define("GRAD_Y");if(i.get()=="Radial")O.define("GRAD_RADIAL")};CGL.TextureEffect.setupBlending(e,O,a,r);h.onTriggered=function(){c.set(Math.random());u.set(Math.random());_.set(Math.random());d.set(Math.random());p.set(Math.random());g.set(Math.random());f.set(Math.random());m.set(Math.random());v.set(Math.random())};function N(){const e=[c.get(),u.get(),_.get()];if(!E)E=new CGL.Uniform(O,"3f","colA",e);else E.setValue(e)}function L(){const e=[d.get(),p.get(),g.get()];if(!C)C=new CGL.Uniform(O,"3f","colB",e);else C.setValue(e)}function w(){const e=[f.get(),m.get(),v.get()];if(!S)S=new CGL.Uniform(O,"3f","colC",e);else S.setValue(e)}n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;x.pushShader(O);x.currentTextureEffect.bind();x.setTexture(0,x.currentTextureEffect.getCurrentSourceTexture().tex);x.currentTextureEffect.finish();x.popShader();b.trigger()}};Ops.Gl.TextureEffects.Gradient.prototype=new CABLES.Op;CABLES.OPS["5ada9bd8-227a-4a1f-87ad-0f879c7aa84d"]={f:Ops.Gl.TextureEffects.Gradient,objName:"Ops.Gl.TextureEffects.Gradient"};Ops.Devices.Keyboard.KeyPressLearn=function(){CABLES.Op.apply(this,arguments);const n=this;const e={};const a=n.inValueInt("key code");const t=n.inValueBool("canvas only",true);const r=n.inValueSelect("Mod Key",["none","alt"],"none");const o=n.inValueBool("Enabled",true);const i=n.inValueBool("Prevent Default");const s=n.inTriggerButton("learn");const l=n.outTrigger("on press");const c=n.outTrigger("on release");const u=n.outBoolNum("Pressed",false);const _=n.outString("Key");const d=n.patch.cgl;let p=false;r.onChange=a.onChange=x;function g(e){if(p){a.set(e.keyCode);if(CABLES.UI){n.refreshParams()}p=false;v();m();if(CABLES.UI)gui.emitEvent("portValueEdited",n,a,a.get())}else{if(e.keyCode==a.get()){if(r.get()=="alt"){if(e.altKey===true){l.trigger();u.set(true);if(i.get())e.preventDefault()}}else{l.trigger();u.set(true);if(i.get())e.preventDefault()}}}}function f(e){if(e.keyCode==a.get()){c.trigger();u.set(false)}}n.onDelete=function(){d.canvas.removeEventListener("keyup",f,false);d.canvas.removeEventListener("keydown",g,false);document.removeEventListener("keyup",f,false);document.removeEventListener("keydown",g,false)};s.onTriggered=function(){p=true;b();setTimeout(function(){p=false;v();m()},3e3)};function m(){if(t.get())h();else b()}function v(){document.removeEventListener("keydown",g,false);document.removeEventListener("keyup",f,false);d.canvas.removeEventListener("keydown",g,false);d.canvas.removeEventListener("keyup",f,false);u.set(false)}function h(){d.canvas.addEventListener("keydown",g,false);d.canvas.addEventListener("keyup",f,false)}function b(){document.addEventListener("keydown",g,false);document.addEventListener("keyup",f,false)}o.onChange=function(){if(!o.get()){v()}else{m()}};t.onChange=function(){v();m()};function x(){let e=CABLES.keyCodeToName(a.get());const t=r.get();if(t&&t!=="none"){e=t.charAt(0).toUpperCase()+t.slice(1)+"-"+e}n.setUiAttribs({extendTitle:e});_.set(e)}h()};Ops.Devices.Keyboard.KeyPressLearn.prototype=new CABLES.Op;CABLES.OPS["f069c0db-4051-4eae-989e-6ef7953787fd"]={f:Ops.Devices.Keyboard.KeyPressLearn,objName:"Ops.Devices.Keyboard.KeyPressLearn"};Ops.Trigger.SetNumberOnTrigger=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTriggerButton("Set"),a=e.inValueFloat("Number"),r=e.outTrigger("Next"),o=e.outNumber("Out Value");o.changeAlways=true;n.onTriggered=function(){o.set(a.get());r.trigger()}};Ops.Trigger.SetNumberOnTrigger.prototype=new CABLES.Op;CABLES.OPS["9989b1c0-1073-4d5f-bfa0-36dd98b66e27"]={f:Ops.Trigger.SetNumberOnTrigger,objName:"Ops.Trigger.SetNumberOnTrigger"};Ops.Gl.TextureEffects.ColorMap=function(){CABLES.Op.apply(this,arguments);const e=this;const t={colormap_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI sampler2D gradient;\nUNI float pos;\nUNI float amount;\nUNI float vmin;\nUNI float vmax;\n\n{{CGL.BLENDMODES}}\n\n\nfloat lumi(vec3 color)\n{\n   return vec3(dot(vec3(0.2126,0.7152,0.0722), color)).r;\n}\n\nvoid main()\n{\n    vec4 base=texture(tex,texCoord);\n\n   base=clamp(base,vmin,vmax);\n\n    #ifdef METH_LUMI\n        vec4 color=texture(gradient,vec2(lumi(base.rgb),pos));\n    #endif\n\n    #ifdef METH_CHANNELS\n        vec4 color=vec4(1.0);\n        color.r=texture(gradient,vec2(base.r,pos)).r;\n        color.g=texture(gradient,vec2(base.g,pos)).g;\n        color.b=texture(gradient,vec2(base.b,pos)).b;\n    #endif\n\n//   outColor= vec4(color);\n   outColor=cgl_blend(base,color,amount);\n\n}\n"};let n=e.inTrigger("render");let a=e.outTrigger("trigger");const r=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal");const o=e.inValueSlider("Amount",1);let i=e.inTexture("Gradient");let s=e.inSwitch("Method",["Luminance","Channels"],"Luminance");let l=e.inFloatSlider("Min",0);let c=e.inFloatSlider("Max",1);let u=e.inValueSlider("Position",.5);e.setPortGroup("Vertical Position",[l,c,u]);let _=e.patch.cgl;let d=new CGL.Shader(_,e.name);d.define("METH_LUMI");d.setSource(d.getDefaultVertexShader(),t.colormap_frag);var p=new CGL.Uniform(d,"t","tex",0);var p=new CGL.Uniform(d,"t","gradient",1);let g=new CGL.Uniform(d,"f","pos",u);let f=new CGL.Uniform(d,"f","vmin",l);let m=new CGL.Uniform(d,"f","vmax",c);let v=new CGL.Uniform(d,"f","amount",o);CGL.TextureEffect.setupBlending(e,d,r,o);s.onChange=()=>{d.toggleDefine("METH_LUMI",s.get()=="Luminance");d.toggleDefine("METH_CHANNELS",s.get()=="Channels")};n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;if(!i.get())return;_.pushShader(d);_.currentTextureEffect.bind();_.setTexture(0,_.currentTextureEffect.getCurrentSourceTexture().tex);_.setTexture(1,i.get().tex);_.currentTextureEffect.finish();_.popShader();a.trigger()}};Ops.Gl.TextureEffects.ColorMap.prototype=new CABLES.Op;CABLES.OPS["58e302d7-4b84-4077-aa13-4f3cf0885205"]={f:Ops.Gl.TextureEffects.ColorMap,objName:"Ops.Gl.TextureEffects.ColorMap"};Ops.Gl.TextureEffects.Mirror=function(){CABLES.Op.apply(this,arguments);const e=this;const t={mirror_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float axis;\nUNI float width;\nUNI float flip;\nUNI float offset;\n\nvoid main()\n{\n   vec4 col=vec4(1.0,0.0,0.0,1.0);\n\n   float tc=texCoord.x;\n   if(axis==1.0) tc=(texCoord.y);\n\n   float x=(tc);\n   if(tc>=0.5)x=1.0-tc;\n\n   x*=width*2.0;\n   if(flip==1.0)x=1.0-x;\n   x*=1.0-offset;\n\n   if(axis==1.0) col=texture(tex,vec2(texCoord.x,x) );\n       else col=texture(tex,vec2(x,texCoord.y) );\n\n   outColor= col;\n}"};const n=e.inTrigger("render"),a=e.outTrigger("trigger"),r=e.inSwitch("axis",["X","Y"],"X"),o=e.inValueFloat("width",.5),i=e.inValueFloat("offset"),s=e.inValueBool("flip");const l=e.patch.cgl;const c=new CGL.Shader(l,e.name);c.setSource(c.getDefaultVertexShader(),t.mirror_frag);const u=new CGL.Uniform(c,"t","tex",0),_=new CGL.Uniform(c,"f","axis",0),d=new CGL.Uniform(c,"f","width",o),p=new CGL.Uniform(c,"f","offset",i),g=new CGL.Uniform(c,"f","flip",0);s.onChange=function(){if(s.get())g.setValue(1);else g.setValue(0)};r.onChange=function(){if(r.get()=="X")_.setValue(0);else if(r.get()=="Y")_.setValue(1)};n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;l.pushShader(c);l.currentTextureEffect.bind();l.setTexture(0,l.currentTextureEffect.getCurrentSourceTexture().tex);l.currentTextureEffect.finish();l.popShader();a.trigger()}};Ops.Gl.TextureEffects.Mirror.prototype=new CABLES.Op;CABLES.OPS["10d3c769-9a7f-4bd3-a849-7354d3e5f7f0"]={f:Ops.Gl.TextureEffects.Mirror,objName:"Ops.Gl.TextureEffects.Mirror"};Ops.Gl.TextureEffects.Waveform_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={wave_v2_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI sampler2D tex1;\nUNI float amount;\n\nUNI float r;\nUNI float g;\nUNI float b;\n\nUNI float uAmp;\nUNI float uFreq;\nUNI float uWidth;\nUNI float uGlow;\nUNI float uWaveSelect;\nUNI bool uInvert;\nUNI bool uSolid;\n\nUNI float uOffSetX;\nUNI float uOffSetY;\nUNI float uRotate;\n\n{{CGL.BLENDMODES}}\n\n#define PI 3.14159265359\n#define TAU (2.0*PI)\n\nfloat vmax(vec2 v)\n{\n\treturn max(v.x, v.y);\n}\n\nvoid pR(inout vec2 p, float a)\n{\n    float s = sin(a),c=cos(a); p *= mat2(c,s,-s,c);\n}\n\nfloat pMod1(inout float p, float size)\n{\n\tfloat halfsize = size * 0.5;\n\tfloat c = floor((p + halfsize) / size);\n\tp = mod(p + halfsize, size) - halfsize;\n\treturn c;\n}\n\nfloat pModMirror1(inout float p, float size)\n{\n\tfloat halfsize = size * 0.5;\n\tfloat c = floor((p + halfsize) / size);\n\tp = mod(p + halfsize,size) - halfsize;\n\tp *= mod(c, 2.0) * 2.0 - 1.0;\n\treturn c;\n}\n\nfloat fCapsule2D(vec2 p, float r, float c)\n{\n\treturn mix(abs(p.x) - r, length(vec2(p.x, abs(p.y) - c)) - r, step(c, abs(p.y)));\n}\n\nfloat SineWave(vec2 p, float amplitude, float frequency, float line_width, float line_glow, bool solid)\n{\n    float v = sin(p.x * frequency * PI);\n    v *= amplitude;\n\n    float d = 0.0;\n\n    if (solid == false)\n    {\n        d = abs(v * amplitude - p.y * 0.5);\n        d -= line_width;\n        return smoothstep(0.0, line_glow, d);\n    }\n    else\n    {\n        d = v * amplitude - p.y * 0.5;\n        d -= -line_width;\n        return smoothstep(0.0, line_glow, -d);\n    }\n}\n\nfloat SawWave(vec2 p, float amplitude, float frequency, float line_width, float line_glow, bool solid)\n{\n    float inverse_frequency = 2.0 / frequency;\n    vec2 p1 = p;\n    pMod1(p1.x, inverse_frequency);\n\n    float d1 = fCapsule2D(p1, 0.0, amplitude);\n    p.x += inverse_frequency * 0.5;\n    pMod1(p.x, inverse_frequency);\n    pR(p, atan(inverse_frequency, amplitude * 2.0));\n\n    float d = fCapsule2D(p, 0.0, 0.5 * length(vec2(inverse_frequency, 2.0 * amplitude)));\n\td = min(d, d1);\n    d -= line_width;\n\n    if(solid == false)\n    {\n        return smoothstep(0.0, line_glow, d);\n    }\n    else\n        return smoothstep(0.0, line_glow, min(d,p.x));\n}\n\nfloat TriangleWave(vec2 p, float amplitude, float frequency, float line_width, float line_glow, bool solid)\n{\n    float inverse_frequency = 1.0 / frequency;\n    p.x -= inverse_frequency;\n    pModMirror1(p.x, inverse_frequency);\n    pR(p, atan(inverse_frequency, amplitude * 2.0));\n\n    float d = fCapsule2D(p, 0.0, 0.5 * length(vec2(inverse_frequency, 2.0 * amplitude)));\n    d -= line_width;\n\n    if (solid == false)\n    {\n        return smoothstep(0.0, line_glow, d);\n    }\n    else\n        return smoothstep(0.0, line_glow, min(d,p.x));\n}\n\nfloat SquareWave(vec2 p, float amplitude, float frequency, float line_width, float line_glow, bool solid)\n{\n    float inverse_frequency = 0.5 / frequency;\n    vec2 p1 = p;\n    pMod1(p1.x, 2.0 * inverse_frequency);\n\n    float d1 = fCapsule2D(p1, 0.0, abs(amplitude));\n    p.x -= inverse_frequency * 0.5;\n    float cell = pMod1(p.x, inverse_frequency);\n\n    if(cell < 0.0) cell = -cell + 1.0;\n    if(int(cell * 0.5) % 2 == 1) p.y -= amplitude;\n        else p.y += amplitude;\n\n    float d = fCapsule2D(p.yx, 0.0, abs(inverse_frequency));\n    d = min(d, d1);\n    d -= line_width;\n\n    if (solid == false)\n    {\n        return smoothstep(0.0, line_glow, d);\n    }\n    else\n        return smoothstep(0.0, line_glow, p.y);\n}\n\nvoid main()\n{\n    vec4 rgb = vec4(r,g,b,1.0);\n\tvec2 uv = texCoord;\n\n    uv -= 0.5;\n    pR(uv.xy,uRotate * TAU);\n    uv += 0.5;\n\n    float wave = 0.0;\n    #ifdef SINE\n        wave = 1.0 - SineWave     (uv - vec2(uOffSetX,uOffSetY), uAmp,  uFreq , uWidth, uGlow, uSolid);\n    #endif\n    #ifdef SAWTOOTH\n        wave = 1.0 - SawWave      (uv - vec2(uOffSetX,uOffSetY), uAmp,  uFreq, uWidth, uGlow, uSolid);\n    #endif\n    #ifdef TRIANGLE\n        wave = 1.0 - TriangleWave (uv - vec2(uOffSetX,uOffSetY), uAmp,  uFreq, uWidth, uGlow, uSolid);\n    #endif\n    #ifdef SQUARE\n        wave = 1.0 - SquareWave   (uv - vec2(uOffSetX,uOffSetY), uAmp,  uFreq, uWidth, uGlow, uSolid);\n    #endif\n\n    #ifdef INVERT\n        wave = 1.0-wave;\n    #endif\n\n    vec4 col = vec4(r,g,b,1.0);\n\n    vec4 base=texture(tex,texCoord);\n\n    outColor=cgl_blend(base,col,wave*amount);\n}\n"};const n=e.inTrigger("render"),a=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),r=e.inValueSlider("Amount",1),o=e.inValueSelect("Waveform",["Sine","Sawtooth","Triangle","Square"],"Sine"),i=e.inValueSlider("Amplitude",.5),s=e.inFloat("Frequency",2),l=e.inValueSlider("Line Width",.1),c=e.inValueSlider("Line Glow",.1),u=e.inValueBool("invert color",false),_=e.inValueBool("Solid fill",false),d=e.inValueSlider("Offset X",0),p=e.inValueSlider("Offset Y",.5),g=e.inValueSlider("Rotate",0),f=e.inValueSlider("r",1),m=e.inValueSlider("g",1),v=e.inValueSlider("b",1);const h=e.outTrigger("trigger");f.setUiAttribs({colorPick:true});const b=e.patch.cgl;const x=new CGL.Shader(b,e.name);x.setSource(x.getDefaultVertexShader(),t.wave_v2_frag);const O=new CGL.Uniform(x,"t","tex",0);const I=new CGL.Uniform(x,"f","amount",r);const y=new CGL.Uniform(x,"f","r",f);const T=new CGL.Uniform(x,"f","g",m);const A=new CGL.Uniform(x,"f","b",v);const S=new CGL.Uniform(x,"f","uAmp",i);const C=new CGL.Uniform(x,"f","uFreq",s);const E=new CGL.Uniform(x,"f","uWidth",l);const M=new CGL.Uniform(x,"f","uGlow",c);const N=new CGL.Uniform(x,"f","uWaveSelect",1);const L=new CGL.Uniform(x,"b","uInvert",u);const w=new CGL.Uniform(x,"b","uSolid",_);const P=new CGL.Uniform(x,"f","uOffSetX",d);const D=new CGL.Uniform(x,"f","uOffSetY",p);const R=new CGL.Uniform(x,"f","uRotate",g);o.onChange=u.onChange=U;U();function U(){x.toggleDefine("SINE",o.get()=="Sine");x.toggleDefine("SAWTOOTH",o.get()=="Sawtooth");x.toggleDefine("TRIANGLE",o.get()=="Triangle");x.toggleDefine("SQUARE",o.get()=="Square");x.toggleDefine("INVERT",u.get()==true)}CGL.TextureEffect.setupBlending(e,x,a,r);n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;b.pushShader(x);b.currentTextureEffect.bind();b.setTexture(0,b.currentTextureEffect.getCurrentSourceTexture().tex);b.currentTextureEffect.finish();b.popShader();h.trigger()}};Ops.Gl.TextureEffects.Waveform_v2.prototype=new CABLES.Op;CABLES.OPS["46c786f1-3d60-4fa4-9c89-e785db4ac692"]={f:Ops.Gl.TextureEffects.Waveform_v2,objName:"Ops.Gl.TextureEffects.Waveform_v2"};Ops.Gl.TextureEffects.Twirl_v3=function(){CABLES.Op.apply(this,arguments);const t=this;const e={twirl_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float amount;\nUNI float twistAmount;\nUNI float times;\nUNI float radius;\nUNI float centerX;\nUNI float centerY;\n\n{{CGL.BLENDMODES}}\n\nvoid main()\n{\n    vec2 center=vec2(centerX,centerY);\n    vec2 tc = texCoord;\n    tc -= center;\n    float dist = length(tc);\n    if (dist < radius)\n    {\n        float percent = (radius - dist) / radius;\n        float theta = percent * percent * twistAmount * 8.0;\n        float s = sin(theta);\n        float c = cos(theta);\n        tc = vec2(dot(tc, vec2(c, -s)), dot(tc, vec2(s, c)));\n    }\n    tc += center;\n\n    vec4 col = texture(tex, tc);\n    vec4 base=texture(tex,texCoord);\n    outColor=cgl_blend(base,col,amount);\n}\n"};const n=t.inTrigger("Render"),a=CGL.TextureEffect.AddBlendSelect(t,"Blend Mode","normal"),r=t.inValueSlider("Amount",1),o=t.inValue("Twist amount",200),i=t.inValue("Radius",.5),s=t.inValue("Center X",.5),l=t.inValue("Center Y",.5),c=t.outTrigger("Next");const u=t.patch.cgl;const _=new CGL.Shader(u,t.name);_.setSource(_.getDefaultVertexShader(),e.twirl_frag);const d=new CGL.Uniform(_,"t","tex",0),p=new CGL.Uniform(_,"f","amount",r),g=new CGL.Uniform(_,"f","twistAmount",1),f=new CGL.Uniform(_,"f","radius",i),m=new CGL.Uniform(_,"f","centerX",s),v=new CGL.Uniform(_,"f","centerY",l);CGL.TextureEffect.setupBlending(t,_,a,r);n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(t))return;let e=u.currentTextureEffect.getCurrentSourceTexture();g.setValue(o.get()*(1/e.width));u.pushShader(_);u.currentTextureEffect.bind();u.setTexture(0,u.currentTextureEffect.getCurrentSourceTexture().tex);u.currentTextureEffect.finish();u.popShader();c.trigger()}};Ops.Gl.TextureEffects.Twirl_v3.prototype=new CABLES.Op;CABLES.OPS["5c128ea4-14df-4248-a02e-b05d2783ed58"]={f:Ops.Gl.TextureEffects.Twirl_v3,objName:"Ops.Gl.TextureEffects.Twirl_v3"};Ops.Trigger.TriggerSend=function(){CABLES.Op.apply(this,arguments);const a=this;const e={};const t=a.inTriggerButton("Trigger");a.varName=a.inValueSelect("Named Trigger",[],"",true);a.varName.onChange=r;t.onTriggered=o;a.patch.addEventListener("namedTriggersChanged",n);n();function n(){if(CABLES.UI){const e=[];const t=a.patch.namedTriggers;e.push("+ create new one");for(const n in t)e.push(n);a.varName.uiAttribs.values=e}}function r(){if(CABLES.UI){if(a.varName.get()=="+ create new one"){new CABLES.UI.ModalDialog({prompt:true,title:"New Trigger",text:"enter a name for the new trigger",promptValue:"",promptOk:e=>{a.varName.set(e);a.patch.namedTriggers[e]=a.patch.namedTriggers[e]||[];n()}});return}a.refreshParams()}if(!a.patch.namedTriggers[a.varName.get()]){a.patch.namedTriggers[a.varName.get()]=a.patch.namedTriggers[a.varName.get()]||[];a.patch.emitEvent("namedTriggersChanged")}a.setTitle(">"+a.varName.get());a.refreshParams();a.patch.emitEvent("opTriggerNameChanged",a,a.varName.get())}function o(){const t=a.patch.namedTriggers[a.varName.get()];a.patch.emitEvent("namedTriggerSent",a.varName.get());if(!t){a.setUiError("unknowntrigger","unknown trigger");return}else a.setUiError("unknowntrigger",null);for(let e=0;e<t.length;e++){t[e]()}}};Ops.Trigger.TriggerSend.prototype=new CABLES.Op;CABLES.OPS["ce1eaf2b-943b-4dc0-ab5e-ee11b63c9ed0"]={f:Ops.Trigger.TriggerSend,objName:"Ops.Trigger.TriggerSend"};Ops.Trigger.TriggerReceive=function(){CABLES.Op.apply(this,arguments);const a=this;const e={};const t=a.outTrigger("Triggered");a.varName=a.inValueSelect("Named Trigger",[],"",true);o();a.patch.addEventListener("namedTriggersChanged",o);let n=null;function r(){t.trigger()}function o(){if(CABLES.UI){let t=[];let n=a.patch.namedTriggers;for(let e in n)t.push(e);a.varName.uiAttribs.values=t}}a.varName.onChange=function(){if(n){let e=a.patch.namedTriggers[n];let t=e.indexOf(r);if(t!=-1)e.splice(t,1)}a.setTitle(">"+a.varName.get());a.patch.namedTriggers[a.varName.get()]=a.patch.namedTriggers[a.varName.get()]||[];let e=a.patch.namedTriggers[a.varName.get()];e.push(r);n=a.varName.get();i();a.patch.emitEvent("opTriggerNameChanged",a,a.varName.get())};a.on("uiParamPanel",i);function i(){if(!a.varName.get()){a.setUiError("unknowntrigger","unknown trigger")}else a.setUiError("unknowntrigger",null)}};Ops.Trigger.TriggerReceive.prototype=new CABLES.Op;CABLES.OPS["0816c999-f2db-466b-9777-2814573574c5"]={f:Ops.Trigger.TriggerReceive,objName:"Ops.Trigger.TriggerReceive"};Ops.Gl.TextureEffects.RepeatTexture=function(){CABLES.Op.apply(this,arguments);const e=this;const t={repeat_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI sampler2D mulTex;\nUNI float amount;\nUNI float amountX;\nUNI float amountY;\n\n{{CGL.BLENDMODES}}\n\nvoid main()\n{\n    float am=amount;\n\n    float mul=1.0;\n\n    #ifdef HAS_MASK\n        mul=texture(mulTex,texCoord).r;\n    #endif\n\n    vec2 coord = vec2(\n        mod(texCoord.x*amountX*mul,1.0),\n        mod(texCoord.y*amountY*mul,1.0));\n\n    vec4 col=texture(tex,coord);\n    vec4 base=texture(tex,texCoord);\n\n\n\n    outColor=cgl_blend(base,col,am);\n}"};const n=e.inTrigger("render");const a=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal");const r=e.inValueSlider("Amount",1);const o=e.inValue("x",3);const i=e.inValue("y",3);const s=e.outTrigger("trigger");const l=e.inTexture("Multiply");const c=e.patch.cgl;const u=new CGL.Shader(c,e.name);u.setSource(u.getDefaultVertexShader(),t.repeat_frag);const _=new CGL.Uniform(u,"t","tex",0);const d=new CGL.Uniform(u,"t","mulTex",2);const p=new CGL.Uniform(u,"f","amount",r);const g=new CGL.Uniform(u,"f","amountX",o);const f=new CGL.Uniform(u,"f","amountY",i);CGL.TextureEffect.setupBlending(e,u,a,r);l.onChange=()=>{u.toggleDefine("HAS_MASK",l.get())};n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;c.pushShader(u);c.currentTextureEffect.bind();c.setTexture(0,c.currentTextureEffect.getCurrentSourceTexture().tex);if(l.get())c.setTexture(2,l.get().tex);c.currentTextureEffect.finish();c.popShader();s.trigger()}};Ops.Gl.TextureEffects.RepeatTexture.prototype=new CABLES.Op;CABLES.OPS["f477746c-2699-4da5-9786-04867aeae8a6"]={f:Ops.Gl.TextureEffects.RepeatTexture,objName:"Ops.Gl.TextureEffects.RepeatTexture"};Ops.Gl.TextureEffects.PolarCoords=function(){CABLES.Op.apply(this,arguments);const e=this;const t={polarcoords_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float amount;\nUNI float inner;\nUNI float outer;\n\nvoid main()\n{\n    vec4 col=vec4(1.0,0.0,0.0,1.0);\n    vec2 x = texCoord - vec2(0.5);\n    float radius = length(x);\n    float angle = atan(x.y, x.x);\n\n    vec2 tc;\n    tc.s = ( radius - inner) / (outer - inner);\n    tc.t = angle * 0.5 / 3.141592653589793 + 0.5;\n\n    #ifdef CROP_IMAGE\n        if(tc.s<0.0 || tc.t<0.0 || tc.s>1.0 || tc.t>1.0) discard;\n    #endif\n\n    col=texture(tex,tc);\n    outColor= col;\n}\n"};const n=e.inTrigger("render"),a=e.inValueSlider("Radius Inner",0),r=e.inValueSlider("Radius Outer",1),o=e.inValueBool("Crop",false),i=e.outTrigger("trigger"),s=e.patch.cgl;const l=new CGL.Shader(s,e.name);l.setSource(l.getDefaultVertexShader(),t.polarcoords_frag);const c=new CGL.Uniform(l,"t","tex",0),u=new CGL.Uniform(l,"f","inner",a),_=new CGL.Uniform(l,"f","outer",r);o.onChange=d;function d(){if(o.get())l.define("CROP_IMAGE");else l.removeDefine("CROP_IMAGE")}n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;s.pushShader(l);s.currentTextureEffect.bind();s.setTexture(0,s.currentTextureEffect.getCurrentSourceTexture().tex);s.currentTextureEffect.finish();s.popShader();i.trigger()}};Ops.Gl.TextureEffects.PolarCoords.prototype=new CABLES.Op;CABLES.OPS["1555fefe-4eb4-4aed-84c0-ad54e0dae1c1"]={f:Ops.Gl.TextureEffects.PolarCoords,objName:"Ops.Gl.TextureEffects.PolarCoords"};Ops.Anim.SineAnim=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("exe"),a=e.inSwitch("Mode",["Sine","Cosine"],"Sine"),r=e.inValueFloat("phase",0),o=e.inValueFloat("frequency",1),i=e.inValueFloat("amplitude",1),s=e.outTrigger("Trigger out"),l=e.outNumber("result");let c=0;const u=0;const _=1;e.toWorkPortsNeedToBeLinked(n);n.onTriggered=p;a.onChange=d;p();d();function d(){let e=a.get();if(e==="Sine")c=u;else if(e==="Cosine")c=_;p()}function p(){if(c==u)l.set(i.get()*Math.sin(e.patch.freeTimer.get()*o.get()+r.get()));else l.set(i.get()*Math.cos(e.patch.freeTimer.get()*o.get()+r.get()));s.trigger()}};Ops.Anim.SineAnim.prototype=new CABLES.Op;CABLES.OPS["736d3d0e-c920-449e-ade0-f5ca6018fb5c"]={f:Ops.Anim.SineAnim,objName:"Ops.Anim.SineAnim"};Ops.Math.Abs=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValue("number"),a=e.outNumber("result");n.onChange=function(){a.set(Math.abs(n.get()))}};Ops.Math.Abs.prototype=new CABLES.Op;CABLES.OPS["6b5af21d-065f-44d2-9442-8b7a254753f6"]={f:Ops.Math.Abs,objName:"Ops.Math.Abs"};Ops.Math.Sine=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValue("value"),a=e.inValue("phase",0),r=e.inValue("frequency",1),o=e.inValue("amplitude",1),i=e.inValueBool("asine",false),s=e.outNumber("result");let l=Math.sin;r.onChange=o.onChange=a.onChange=n.onChange=function(){s.set(o.get()*l(n.get()*r.get()+a.get()))};i.onChange=function(){if(i.get())l=Math.asin;else l=Math.sin}};Ops.Math.Sine.prototype=new CABLES.Op;CABLES.OPS["d24da018-9f3d-428b-85c9-6ff14d77548b"]={f:Ops.Math.Sine,objName:"Ops.Math.Sine"};Ops.Gl.TextureEffects.Plasma=function(){CABLES.Op.apply(this,arguments);const e=this;const t={plasma_frag:"#define PI 3.1415926535897932384626433832795\n\nUNI float time;\nUNI float w;\nUNI float h;\nUNI float mul;\nUNI float amount;\nUNI sampler2D tex;\nUNI float offsetX;\nUNI float offsetY;\n\nIN vec2 texCoord;\n\n{{CGL.BLENDMODES}}\n\nvoid main() {\n   vec2 size=vec2(w,h);\n    float v = 0.0;\n    vec2 c = texCoord * size - size/2.0;\n\n    c.x+=offsetX;\n    c.y+=offsetY;\n\n    v += sin((c.x+time));\n    v += sin((c.y+time)/2.0);\n    v += sin((c.x+c.y+time)/2.0);\n    c += size/2.0 * vec2(sin(time/3.0), cos(time/2.0));\n\n    v += sin(sqrt(c.x*c.x+c.y*c.y+1.0)+time);\n    v = v/2.0;\n\n    vec3 newColor = vec3(sin(PI*v*mul/4.0), sin(PI*v*mul), cos(PI*v*mul))*.5 + .5;\n    vec4 base=texture(tex,texCoord);\n\n    #ifndef GREY\n       vec4 col=vec4( _blend(base.rgb,newColor) ,1.0);\n    #endif\n    #ifdef GREY\n       vec4 col=vec4( _blend(base.rgb,vec3(newColor.g)) ,1.0);\n    #endif\n\n    outColor=cgl_blend(base,col,amount);\n\n}"};const n=e.inTrigger("render"),a=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),r=e.inValueSlider("Amount",1),o=e.inValue("Width",20),i=e.inValue("Height",20),s=e.inValue("Mul",1),l=e.inValue("offset X",0),c=e.inValue("offset Y",0),u=e.inValue("Time",1),_=e.inValueBool("Greyscale",true),d=e.outTrigger("trigger");const p=e.patch.cgl;const g=new CGL.Shader(p,e.name);g.setSource(g.getDefaultVertexShader(),t.plasma_frag);g.define("GREY");const f=new CGL.Uniform(g,"f","w",o),m=new CGL.Uniform(g,"f","h",i),v=new CGL.Uniform(g,"f","time",u),h=new CGL.Uniform(g,"f","mul",s),b=new CGL.Uniform(g,"f","offsetX",l),x=new CGL.Uniform(g,"f","offsetY",c),O=new CGL.Uniform(g,"t","tex",0),I=new CGL.Uniform(g,"f","amount",r);_.onChange=function(){if(_.get())g.define("GREY");else g.removeDefine("GREY")};CGL.TextureEffect.setupBlending(e,g,a,r);n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;p.pushShader(g);p.currentTextureEffect.bind();p.setTexture(0,p.currentTextureEffect.getCurrentSourceTexture().tex);p.currentTextureEffect.finish();p.popShader();d.trigger()}};Ops.Gl.TextureEffects.Plasma.prototype=new CABLES.Op;CABLES.OPS["6c82c11d-1931-43b1-8e6c-5d20cb1a0d87"]={f:Ops.Gl.TextureEffects.Plasma,objName:"Ops.Gl.TextureEffects.Plasma"};Ops.Gl.TextureEffects.ScaleTexture=function(){CABLES.Op.apply(this,arguments);const e=this;const t={scale_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI sampler2D multiplierTex;\nUNI float amount;\nUNI float uScaleX,uScaleY;\nUNI float offsetX,offsetY;\nUNI float centerX,centerY;\n\n{{CGL.BLENDMODES}}\n\nvoid main()\n{\n    float multiplier = 1.0;\n    vec2 uv = texCoord;\n\n    #ifdef MASK_SCALE\n        multiplier = dot(vec3(0.2126,0.7152,0.0722), texture(multiplierTex,texCoord).rgb);\n    #endif\n\n    uv.x = (uv.x - centerX) / (uScaleX * multiplier)  + centerX+offsetX ;\n    uv.y = (uv.y - centerY) / (uScaleY * multiplier)  + centerY+offsetY ;\n\n\n\n\n    //blend section\n    vec4 col = texture(tex,uv);\n\n\n\n    //original texture\n    vec4 base = texture(tex,texCoord);\n\n    //blend stuff\n    float a=amount;\n\n\n    outColor=cgl_blend(base,col,a);\n\n    if(uv.x>1.0||uv.y>1.0||uv.x<0.0||uv.y<0.0)\n    {\n        outColor.a=0.0;\n        // a=0.0;\n    }\n\n}\n"};const n=e.inTrigger("render"),a=e.inTexture("Multiplier"),r=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),o=e.inValueSlider("Amount",1),i=e.inValue("Scale X",1.5),s=e.inValue("Scale Y",1.5),l=e.inValueSlider("offset X",0),c=e.inValueSlider("offset Y",0),u=e.inValueSlider("center X",.5),_=e.inValueSlider("center Y",.5),d=e.outTrigger("trigger");const p=e.patch.cgl;const g=new CGL.Shader(p,e.name);g.setSource(g.getDefaultVertexShader(),t.scale_frag);const f=new CGL.Uniform(g,"t","tex",0),m=new CGL.Uniform(g,"t","multiplierTex",1),v=new CGL.Uniform(g,"f","amount",o),h=new CGL.Uniform(g,"f","uScaleX",i),b=new CGL.Uniform(g,"f","uScaleY",s),x=new CGL.Uniform(g,"f","centerX",u),O=new CGL.Uniform(g,"f","centerY",_),I=new CGL.Uniform(g,"f","offsetX",l),y=new CGL.Uniform(g,"f","offsetY",c);CGL.TextureEffect.setupBlending(e,g,r,o);a.onChange=function(){g.toggleDefine("MASK_SCALE",a.isLinked())};n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;p.pushShader(g);p.currentTextureEffect.bind();p.setTexture(0,p.currentTextureEffect.getCurrentSourceTexture().tex);if(a.get())p.setTexture(1,a.get().tex);p.currentTextureEffect.finish();p.popShader();d.trigger()}};Ops.Gl.TextureEffects.ScaleTexture.prototype=new CABLES.Op;CABLES.OPS["12cfa989-d575-4ee2-9deb-5392097c5a27"]={f:Ops.Gl.TextureEffects.ScaleTexture,objName:"Ops.Gl.TextureEffects.ScaleTexture"};Ops.Gl.TextureEffects.FastBlur=function(){CABLES.Op.apply(this,arguments);const e=this;const t={blur_frag:"\nUNI sampler2D tex;\n#ifdef USE_MASK\n    UNI sampler2D texMask;\n#endif\nUNI float amount;\nUNI float pass;\n\nIN vec2 texCoord;\n\nUNI float dirX;\nUNI float dirY;\nUNI float width;\nUNI float height;\n\nIN vec2 coord0;\nIN vec2 coord1;\nIN vec2 coord2;\nIN vec2 coord3;\nIN vec2 coord4;\nIN vec2 coord5;\nIN vec2 coord6;\n\n#ifdef HAS_MASK\n    UNI sampler2D imageMask;\n#endif\n\nvoid main()\n{\n    vec4 color = vec4(0.0);\n\n    #ifdef USE_MASK\n        #ifdef MASK_INVERT\n            if(texture(texMask,texCoord).r<0.5)\n            {\n                outColor= texture(tex, texCoord);\n                return;\n            }\n        #endif\n\n        #ifndef MASK_INVERT\n            if(texture(texMask,texCoord).r>0.5)\n            {\n                outColor= texture(tex, texCoord);\n                return;\n            }\n        #endif\n    #endif\n\n    color += texture(tex, coord0) * 0.06927096443792478;\n    color += texture(tex, coord1) * 0.1383328848652136;\n    color += texture(tex, coord2) * 0.21920904690397863;\n    color += texture(tex, coord3) * 0.14637421;\n    color += texture(tex, coord4) * 0.21920904690397863;\n    color += texture(tex, coord5) * 0.1383328848652136;\n    color += texture(tex, coord6) * 0.06927096443795711;\n\n    color.a=1.0;\n    outColor= color;\n}",blur_vert:"\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 mvMatrix;\nUNI mat4 modelMatrix;\n\nUNI float pass;\nUNI float dirX;\nUNI float dirY;\nUNI float width;\nUNI float height;\n\nOUT vec2 coord0;\nOUT vec2 coord1;\nOUT vec2 coord2;\nOUT vec2 coord3;\nOUT vec2 coord4;\nOUT vec2 coord5;\nOUT vec2 coord6;\n\n// http://dev.theomader.com/gaussian-kernel-calculator/\n// http://rastergrid.com/blog/2010/09/efficient-gaussian-blur-with-linear-sampling/\n\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    {{MODULE_VERTEX_POSITION}}\n\n    vec2 dir=vec2(dirX,dirY);\n    vec2 res=vec2( (1.) / width , (1.) / height )*dir;\n\n    coord3= attrTexCoord;\n\n    coord0= attrTexCoord + (-3.0368997744118595 * res);\n    coord1= attrTexCoord + (-2.089778445362373 * res);\n    coord2= attrTexCoord + (-1.2004366090034069 * res);\n    coord4= attrTexCoord + (1.2004366090034069 * res);\n    coord5= attrTexCoord + (2.089778445362373* res);\n    coord6= attrTexCoord + (3.0368997744118595 * res);\n\n    #ifdef CLAMP\n        coord0=clamp(coord0,0.0,1.0);\n        coord1=clamp(coord1,0.0,1.0);\n        coord2=clamp(coord2,0.0,1.0);\n        coord3=clamp(coord3,0.0,1.0);\n        coord4=clamp(coord4,0.0,1.0);\n        coord5=clamp(coord5,0.0,1.0);\n        coord6=clamp(coord6,0.0,1.0);\n    #endif\n\n    gl_Position = projMatrix * mvMatrix * pos;\n}\n"};const n=e.inTrigger("render"),a=e.outTrigger("trigger"),r=e.inFloat("amount",3),o=e.inBool("Clamp",false),i=e.inBool("Mask Invert",false),s=e.inTexture("Mask");const l=e.patch.cgl;const c=new CGL.Shader(l,"fastblur");c.setSource(t.blur_vert,t.blur_frag);const u=new CGL.Uniform(c,"t","tex",0),_=new CGL.Uniform(c,"f","dirX",0),d=new CGL.Uniform(c,"f","dirY",0),p=new CGL.Uniform(c,"f","width",0),g=new CGL.Uniform(c,"f","height",0),f=new CGL.Uniform(c,"f","pass",0),m=new CGL.Uniform(c,"f","amount",r.get()),v=new CGL.Uniform(c,"t","texMask",1);r.onChange=()=>{m.setValue(r.get())};const h=e.inDropDown("direction",["both","vertical","horizontal"]);let b=0;h.set("both");h.onChange=()=>{if(h.get()=="both")b=0;if(h.get()=="horizontal")b=1;if(h.get()=="vertical")b=2};o.onChange=()=>{c.toggleDefine("CLAMP",o.get())};i.onChange=s.onChange=()=>{c.toggleDefine("USE_MASK",s.isLinked());c.toggleDefine("MASK_INVERT",i.get())};n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;p.setValue(l.currentTextureEffect.getCurrentSourceTexture().width);g.setValue(l.currentTextureEffect.getCurrentSourceTexture().height);const t=r.get();if(s.get())l.setTexture(1,s.get().tex);for(let e=0;e<t;e++){l.pushShader(c);f.setValue(e/t);if(b===0||b==2){l.currentTextureEffect.bind();l.setTexture(0,l.currentTextureEffect.getCurrentSourceTexture().tex);_.setValue(0);d.setValue(1+e*e);l.currentTextureEffect.finish()}if(b===0||b==1){l.currentTextureEffect.bind();l.setTexture(0,l.currentTextureEffect.getCurrentSourceTexture().tex);_.setValue(1+e*e);d.setValue(0);l.currentTextureEffect.finish()}l.popShader()}a.trigger()}};Ops.Gl.TextureEffects.FastBlur.prototype=new CABLES.Op;CABLES.OPS["720ca148-dcf7-433b-bb1f-edbfb7433c6c"]={f:Ops.Gl.TextureEffects.FastBlur,objName:"Ops.Gl.TextureEffects.FastBlur"};Ops.Gl.TextureEffects.Hue=function(){CABLES.Op.apply(this,arguments);const e=this;const t={hue_frag:"UNI float hue;\n\n#ifdef HAS_TEXTURES\n  IN vec2 texCoord;\n  UNI sampler2D tex;\n#endif\n\n#ifdef TEX_MASK\n    UNI sampler2D texMask;\n#endif\n#ifdef TEX_OFFSET\n    UNI sampler2D texOffset;\n#endif\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid main()\n{\n   vec4 col=vec4(1.0,0.0,0.0,1.0);\n    #ifdef HAS_TEXTURES\n        col=texture(tex,texCoord);\n        float h=hue;\n\n        #ifdef TEX_OFFSET\n            h += texture(texOffset,texCoord).r;\n        #endif\n\n\n        vec3 hsv = rgb2hsv(col.rgb);\n        hsv.x=hsv.x+h;\n\n        #ifndef TEX_MASK\n            col.rgb = hsv2rgb(hsv);\n        #endif\n\n        #ifdef TEX_MASK\n            col.rgb = mix(col.rgb,hsv2rgb(hsv),texture(texMask,texCoord).r);\n        #endif\n\n   #endif\n   outColor= col;\n}"};const n=e.inTrigger("render"),a=e.inValueSlider("hue",1),r=e.inTexture("Mask"),o=e.inTexture("Offset"),i=e.outTrigger("trigger");const s=e.patch.cgl;const l=new CGL.Shader(s,e.name);l.setSource(l.getDefaultVertexShader(),t.hue_frag);const c=new CGL.Uniform(l,"t","tex",0);const u=new CGL.Uniform(l,"t","texMask",1);const _=new CGL.Uniform(l,"t","texOffset",2);const d=new CGL.Uniform(l,"f","hue",1);a.onChange=function(){d.setValue(a.get())};r.onChange=o.onChange=()=>{l.toggleDefine("TEX_MASK",r.get());l.toggleDefine("TEX_OFFSET",o.get())};n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;s.pushShader(l);s.currentTextureEffect.bind();s.setTexture(0,s.currentTextureEffect.getCurrentSourceTexture().tex);if(r.get())s.setTexture(1,r.get().tex);if(o.get())s.setTexture(2,o.get().tex);s.currentTextureEffect.finish();s.popShader();i.trigger()}};Ops.Gl.TextureEffects.Hue.prototype=new CABLES.Op;CABLES.OPS["94ef0da0-c920-415c-81b0-fecbd437991d"]={f:Ops.Gl.TextureEffects.Hue,objName:"Ops.Gl.TextureEffects.Hue"};Ops.Gl.TextureEffects.EdgeDetection_v3=function(){CABLES.Op.apply(this,arguments);const e=this;const t={edgedetect_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float amount;\nUNI float width;\nUNI float strength;\nUNI float texWidth;\nUNI float texHeight;\nUNI float mulColor;\n\nconst vec4 lumcoeff = vec4(0.299,0.587,0.114, 0.);\n\nvec3 desaturate(vec3 color)\n{\n    return vec3(dot(vec3(0.2126,0.7152,0.0722), color));\n}\n\n{{CGL.BLENDMODES}}\n\nvoid main()\n{\n    // vec4 col=vec4(1.0,0.0,0.0,1.0);\n\n    // float pixelX=0.27/texWidth;\n    // float pixelY=0.27/texHeight;\n    float pixelX=(width+0.01)*4.0/texWidth;\n    float pixelY=(width+0.01)*4.0/texHeight;\n\nvec2 tc=texCoord;\n// #ifdef OFFSETPIXEL\n    tc.x+=1.0/texWidth*0.5;\n    tc.y+=1.0/texHeight*0.5;\n// #endif\n    // col=texture(tex,texCoord);\n\n    float count=1.0;\n\n\tvec4 horizEdge = vec4( 0.0 );\n\thorizEdge -= texture( tex, vec2( tc.x - pixelX, tc.y - pixelY ) ) * 1.0;\n\thorizEdge -= texture( tex, vec2( tc.x - pixelX, tc.y     ) ) * 2.0;\n\thorizEdge -= texture( tex, vec2( tc.x - pixelX, tc.y + pixelY ) ) * 1.0;\n\thorizEdge += texture( tex, vec2( tc.x + pixelX, tc.y - pixelY ) ) * 1.0;\n\thorizEdge += texture( tex, vec2( tc.x + pixelX, tc.y     ) ) * 2.0;\n\thorizEdge += texture( tex, vec2( tc.x + pixelX, tc.y + pixelY ) ) * 1.0;\n\tvec4 vertEdge = vec4( 0.0 );\n\tvertEdge -= texture( tex, vec2( tc.x - pixelX, tc.y - pixelY ) ) * 1.0;\n\tvertEdge -= texture( tex, vec2( tc.x    , tc.y - pixelY ) ) * 2.0;\n\tvertEdge -= texture( tex, vec2( tc.x + pixelX, tc.y - pixelY ) ) * 1.0;\n\tvertEdge += texture( tex, vec2( tc.x - pixelX, tc.y + pixelY ) ) * 1.0;\n\tvertEdge += texture( tex, vec2( tc.x    , tc.y + pixelY ) ) * 2.0;\n\tvertEdge += texture( tex, vec2( tc.x + pixelX, tc.y + pixelY ) ) * 1.0;\n\n\n\tvec3 edge = sqrt((horizEdge.rgb/count * horizEdge.rgb/count) + (vertEdge.rgb/count * vertEdge.rgb/count));\n\n    edge=desaturate(edge);\n    edge*=strength;\n\n    if(mulColor>0.0) edge*=texture( tex, texCoord ).rgb*mulColor*4.0;\n    edge=max(min(edge,1.0),0.0);\n\n    //blend section\n    vec4 col=vec4(edge,1.0);\n    vec4 base=texture(tex,texCoord);\n\n    outColor=cgl_blend(base,col,amount);\n}\n\n"};const n=e.inTrigger("Render"),a=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),r=e.inValueSlider("Amount",1),o=e.inFloat("Strength",4),i=e.inValueSlider("Width",.1),s=e.inValueSlider("Mul Color",0),l=e.outTrigger("Trigger");const c=e.patch.cgl;const u=new CGL.Shader(c,e.name);u.setSource(u.getDefaultVertexShader(),t.edgedetect_frag);const _=new CGL.Uniform(u,"t","tex",0),d=new CGL.Uniform(u,"f","amount",r),p=new CGL.Uniform(u,"f","strength",o),g=new CGL.Uniform(u,"f","width",i),f=new CGL.Uniform(u,"f","texWidth",128),m=new CGL.Uniform(u,"f","texHeight",128),v=new CGL.Uniform(u,"f","mulColor",s);CGL.TextureEffect.setupBlending(e,u,a,r);n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;c.pushShader(u);c.currentTextureEffect.bind();c.setTexture(0,c.currentTextureEffect.getCurrentSourceTexture().tex);f.setValue(c.currentTextureEffect.getCurrentSourceTexture().width);m.setValue(c.currentTextureEffect.getCurrentSourceTexture().height);c.currentTextureEffect.finish();c.popShader();l.trigger()}};Ops.Gl.TextureEffects.EdgeDetection_v3.prototype=new CABLES.Op;CABLES.OPS["3cdc351c-8d6e-4d3d-8da0-0777a6062c0d"]={f:Ops.Gl.TextureEffects.EdgeDetection_v3,objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"};Ops.Boolean.IfTrueThen_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("exe"),a=e.inValueBool("boolean",false),r=e.outTrigger("then"),o=e.outTrigger("else");n.onTriggered=i;function i(){if(a.get())r.trigger();else o.trigger()}};Ops.Boolean.IfTrueThen_v2.prototype=new CABLES.Op;CABLES.OPS["9549e2ed-a544-4d33-a672-05c7854ccf5d"]={f:Ops.Boolean.IfTrueThen_v2,objName:"Ops.Boolean.IfTrueThen_v2"};Ops.TimeLine.TimeLineTime=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.outNumber("time");e.onAnimFrame=function(e){n.set(e)}};Ops.TimeLine.TimeLineTime.prototype=new CABLES.Op;CABLES.OPS["3ab26f26-a12a-4c48-9411-20591a5f569d"]={f:Ops.TimeLine.TimeLineTime,objName:"Ops.TimeLine.TimeLineTime"};Ops.Ui.PatchInput=function(){CABLES.Op.apply(this,arguments);const r=this;const e={};const o=r.addOutPort(new CABLES.Port(r,"create port",CABLES.OP_PORT_TYPE_DYNAMIC));function i(){for(let e in r.patch.ops){if(r.patch.ops[e].patchId){if(r.patch.ops[e].patchId.get()==r.uiAttribs.subPatch){return r.patch.ops[e]}}}}o.onLinkChanged=()=>{const e=i();if(!o.links.length)return;const t=o.links[0].getOtherPort(o);o.removeLinks();const n=e.addNewInPort(t);const a=gui.scene().link(t.parent,t.getName(),r,n);e.saveData()}};Ops.Ui.PatchInput.prototype=new CABLES.Op;CABLES.OPS["e3f68bc3-892a-4c78-9974-aca25c27025d"]={f:Ops.Ui.PatchInput,objName:"Ops.Ui.PatchInput"};Ops.Ui.PatchOutput=function(){CABLES.Op.apply(this,arguments);const r=this;const e={};const o=r.addInPort(new CABLES.Port(r,"create port",CABLES.OP_PORT_TYPE_DYNAMIC));function i(){for(let e in r.patch.ops){if(r.patch.ops[e].patchId){if(r.patch.ops[e].patchId.get()==r.uiAttribs.subPatch){return r.patch.ops[e]}}}}o.onLinkChanged=()=>{const e=i();if(!o.links.length)return;const t=o.links[0].getOtherPort(o);o.removeLinks();const n=e.addNewOutPort(t);const a=gui.scene().link(t.parent,t.getName(),r,n);e.saveData()}};Ops.Ui.PatchOutput.prototype=new CABLES.Op;CABLES.OPS["851b44cb-5667-4140-9800-5aeb7031f1d7"]={f:Ops.Ui.PatchOutput,objName:"Ops.Ui.PatchOutput"};Ops.Ui.SubPatch=function(){CABLES.Op.apply(this,arguments);const c=this;const e={};c.dyn=c.addInPort(new CABLES.Port(c,"create port",CABLES.OP_PORT_TYPE_DYNAMIC));c.dynOut=c.addOutPort(new CABLES.Port(c,"create port out",CABLES.OP_PORT_TYPE_DYNAMIC));const t=c.addInPort(new CABLES.Port(c,"dataStr",CABLES.OP_PORT_TYPE_VALUE,{display:"readonly"}));c.patchId=c.addInPort(new CABLES.Port(c,"patchId",CABLES.OP_PORT_TYPE_VALUE,{display:"readonly"}));if(CABLES.UI&&CABLES.sandbox.isDevEnv()){const s=c.inTriggerButton("Create Blueprint");s.setUiAttribs({hidePort:true});s.onTriggered=r}t.setUiAttribs({hideParam:true});c.patchId.setUiAttribs({hideParam:true});let u={ports:[],portsOut:[]};let n=CABLES.generateUUID();c.patchId.set(n);g();p();let _=false;c.saveData=i;c.patchId.onChange=function(){const t=c.patch.getSubPatchOps(n);if(t.length==2){for(let e=0;e<t.length;e++){c.patch.deleteOp(t[e].id)}}else{}};c.onLoaded=function(){};c.onLoadedValueSet=function(){u=JSON.parse(t.get());if(!u){u={ports:[],portsOut:[]}}o()};function a(){}t.onChange=function(){if(_)return;if(!t.get())return;try{a()}catch(e){c.logError("cannot load subpatch data...");c.logError(e)}};function i(){t.set(JSON.stringify(u))}c.addPortListener=d;function d(n,e){if(!n.hasSubpatchLstener){n.hasSubpatchLstener=true;n.addEventListener("onUiAttrChange",function(t){if(t.title){let e=0;for(e=0;e<u.portsOut.length;e++)if(u.portsOut[e].name==n.name)u.portsOut[e].title=t.title;for(e=0;e<u.ports.length;e++)if(u.ports[e].name==n.name)u.ports[e].title=t.title;i()}})}if(n.direction==CABLES.PORT_DIR_IN){if(n.type==CABLES.OP_PORT_TYPE_FUNCTION){n.onTriggered=function(){if(e.isLinked())e.trigger()}}else{n.onChange=function(){e.set(n.get());if(!n.isLinked()){for(let e=0;e<u.ports.length;e++){if(u.ports[e].name===n.name){u.ports[e].value=n.get()}}i()}}}}}c.setupPorts=o;function o(){if(!c.patchId.get())return;const e=u.ports||[];const t=u.portsOut||[];let n=0;for(n=0;n<e.length;n++){if(!c.getPortByName(e[n].name)){const a=c.addInPort(new CABLES.Port(c,e[n].name,e[n].type));const r=g();const o=r.addOutPort(new CABLES.Port(r,e[n].name,e[n].type));a.ignoreValueSerialize=true;a.setUiAttribs({editableTitle:true});if(e[n].title){a.setUiAttribs({title:e[n].title});o.setUiAttribs({title:e[n].title})}if(e[n].objType){a.setUiAttribs({objType:e[n].objType});o.setUiAttribs({objType:e[n].objType})}if(e[n].value){a.set(e[n].value);o.set(e[n].value)}d(a,o)}}for(n=0;n<t.length;n++){if(!c.getPortByName(t[n].name)){const i=c.addOutPort(new CABLES.Port(c,t[n].name,t[n].type));const s=p();const l=s.addInPort(new CABLES.Port(s,t[n].name,t[n].type));i.ignoreValueSerialize=true;i.setUiAttribs({editableTitle:true});if(t[n].title){i.setUiAttribs({title:t[n].title});l.setUiAttribs({title:t[n].title})}if(t[n].objType){i.setUiAttribs({objType:t[n].objType});l.setUiAttribs({objType:t[n].objType})}d(l,i)}}_=true}c.addNewInPort=function(e,t,n){const a="in"+u.ports.length+" "+e.parent.name+" "+e.name;const r={name:a,type:e.type};if(e.uiAttribs.objType)r.objType=e.uiAttribs.objType;u.ports.push(r);o();return a};c.dyn.onLinkChanged=function(){if(c.dyn.isLinked()){const e=c.dyn.links[0].getOtherPort(c.dyn);c.dyn.removeLinks();e.removeLinkTo(c.dyn);c.log("dyn link changed!!!");const t=c.addNewInPort(e);const n=gui.scene().link(e.parent,e.getName(),c,t);_=true;i()}else{setTimeout(function(){c.dyn.removeLinks()},100)}};c.addNewOutPort=function(e,t,n){const a="out"+u.portsOut.length+" "+e.parent.name+" "+e.name;const r={name:a,type:e.type};if(e.uiAttribs.objType)r.objType=e.uiAttribs.objType;u.portsOut.push(r);o();return a};c.dynOut.onLinkChanged=function(){if(c.dynOut.isLinked()){const e=c.dynOut.links[0].getOtherPort(c.dynOut);c.dynOut.removeLinks();e.removeLinkTo(c.dynOut);const t=c.addNewOutPort(e);gui.scene().link(e.parent,e.getName(),c,t);_=true;i()}else{setTimeout(function(){c.dynOut.removeLinks()},100);c.log("dynOut unlinked...")}};function p(){let e=c.patch.getSubPatchOp(c.patchId.get(),"Ops.Ui.PatchOutput");if(!e){c.patch.addOp("Ops.Ui.PatchOutput",{subPatch:c.patchId.get(),translate:{x:0,y:0}});e=c.patch.getSubPatchOp(c.patchId.get(),"Ops.Ui.PatchOutput");if(!e)c.warn("no patchoutput!")}return e}function g(){let e=c.patch.getSubPatchOp(c.patchId.get(),"Ops.Ui.PatchInput");if(!e){c.patch.addOp("Ops.Ui.PatchInput",{subPatch:c.patchId.get(),translate:{x:0,y:0}});e=c.patch.getSubPatchOp(c.patchId.get(),"Ops.Ui.PatchInput");if(!e)c.warn("no patchinput2!")}return e}c.addSubLink=function(e,t){const n=u.ports.length;const a="in"+(n-1)+" "+t.parent.name+" "+t.name;if(e.direction==CABLES.PORT_DIR_IN){gui.scene().link(e.parent,e.getName(),g(),a)}else{const o=u.portsOut.length;gui.scene().link(e.parent,e.getName(),p(),"out"+(o-1)+" "+t.parent.name+" "+t.name)}const r=gui.patchView.getSubPatchBounds(c.patchId.get());g().uiAttr({translate:{x:r.minx,y:r.miny-100}});p().uiAttr({translate:{x:r.minx,y:r.maxy+100}});i();return a};c.onDelete=function(){for(let e=c.patch.ops.length-1;e>=0;e--){if(c.patch.ops[e]&&c.patch.ops[e].uiAttribs&&c.patch.ops[e].uiAttribs.subPatch==c.patchId.get()){c.patch.deleteOp(c.patch.ops[e].id)}}};function r(){const e=c.patch.addOp(CABLES.UI.DEFAULTOPNAMES.blueprint);e.getPortByName("externalPatchId").set(gui.patchId);e.getPortByName("subPatchId").set(c.patchId.get());e.getPortByName("active").set(true);e.uiAttr({translate:{x:c.uiAttribs.translate.x-150,y:c.uiAttribs.translate.y}})}c.rebuildListeners=()=>{c.log("rebuild listeners...");const t=p();for(let e=0;e<t.portsIn.length;e++){if(t.portsIn[e].isLinked()){d(t.portsIn[e],this.portsOut[e])}}}};Ops.Ui.SubPatch.prototype=new CABLES.Op;CABLES.OPS["84d9a6f0-ed7a-466d-b386-225ed9e89c60"]={f:Ops.Ui.SubPatch,objName:"Ops.Ui.SubPatch"};Ops.Value.Number=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueFloat("value"),a=e.outNumber("result");n.onChange=r;function r(){a.set(Number(n.get()))}};Ops.Value.Number.prototype=new CABLES.Op;CABLES.OPS["8fb2bb5d-665a-4d0a-8079-12710ae453be"]={f:Ops.Value.Number,objName:"Ops.Value.Number"};Ops.Array.ArrayPack3=function(){CABLES.Op.apply(this,arguments);const o=this;const e={};const t=o.inTrigger("Trigger in"),i=o.inArray("Array 1"),s=o.inArray("Array 2"),l=o.inArray("Array 3"),c=o.outTrigger("Trigger out"),u=o.outArray("Array out",3),_=o.outNumber("Num Points"),d=o.outNumber("Array length");let n=false;let p=[];let g=[];let f=true;t.onTriggered=r;i.onChange=s.onChange=l.onChange=a;function a(){f=true}function r(){let t=i.get();let n=s.get();let a=l.get();if(!t&&!n&&!a){u.set(null);_.set(0);return}if(f){let e=0;if(!t||!n||!a){if(t)e=t.length;else if(n)e=n.length;else if(a)e=a.length;if(g.length!=e)for(var r=0;r<e;r++)g[r]=0;if(!t)t=g;if(!n)n=g;if(!a)a=g}if(t.length!==n.length||n.length!==a.length){o.setUiError("arraylen","Arrays do not have the same length !");return}o.setUiError("arraylen",null);p.length=t.length;for(var r=0;r<t.length;r++){p[r*3+0]=t[r];p[r*3+1]=n[r];p[r*3+2]=a[r]}f=false;u.set(null);u.set(p);_.set(p.length/3);d.set(p.length)}c.trigger()}};Ops.Array.ArrayPack3.prototype=new CABLES.Op;CABLES.OPS["2bcf32fe-3cbd-48fd-825a-61255bebda9b"]={f:Ops.Array.ArrayPack3,objName:"Ops.Array.ArrayPack3"};Ops.Array.ArraySetNumber_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTriggerButton("Execute"),a=e.inArray("Array"),r=e.inInt("Index",0),o=e.inFloat("Number",1),i=e.outTrigger("Next"),s=e.outArray("Result");let l=[];a.onChange=()=>{l=a.get()};n.onTriggered=()=>{if(!l){s.set(null);return}const t=[];for(let e=0;e<l.length;e++)t[e]=l[e];const e=Math.floor(r.get());if(e>=0){t[e]=o.get()}l=t;s.set(null);s.set(t);i.trigger()}};Ops.Array.ArraySetNumber_v2.prototype=new CABLES.Op;CABLES.OPS["a6366c3e-dab0-4b4c-b790-e66b82b93a25"]={f:Ops.Array.ArraySetNumber_v2,objName:"Ops.Array.ArraySetNumber_v2"};Ops.Array.Array_v3=function(){CABLES.Op.apply(this,arguments);const t=this;const e={};const a=t.inValueInt("Array length",10),n=t.inSwitch("Mode select",["Number","1,2,3,4","0-1"],"Number"),r=t.inValueFloat("Default Value"),o=t.inBool("Reverse",false),i=t.outArray("Array"),s=t.outNumber("Array length out");let l=[];let c=0;const u=0;const _=1;const d=2;n.onChange=p;o.onChange=r.onChange=a.onChange=g;p();g();function p(){let e=n.get();if(e==="Number")c=u;else if(e==="1,2,3,4")c=_;else if(e==="0-1")c=d;r.setUiAttribs({greyout:c!==u});t.setUiAttrib({extendTitle:n.get()});g()}function g(){l.length=0;let e=a.get();let t=r.get();let n;if(c===u){for(n=0;n<e;n++){l[n]=t}}else if(c===_){for(n=0;n<e;n++){l[n]=n}}else if(c===d){for(n=0;n<e;n++){l[n]=n/(e-1)}}if(o.get())l=l.reverse();i.set(null);i.set(l);s.set(l.length)}};Ops.Array.Array_v3.prototype=new CABLES.Op;CABLES.OPS["e4d31a46-bf64-42a8-be34-4cbb2bbc2600"]={f:Ops.Array.Array_v3,objName:"Ops.Array.Array_v3"};Ops.Array.ArrayGetNumber=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inArray("array"),a=e.inValueInt("index"),r=e.outNumber("value");n.ignoreValueSerialize=true;a.onChange=n.onChange=o;function o(){if(n.get()){let e=n.get()[a.get()];if(isNaN(e)){r.set(0);return}r.set(parseFloat(e))}}};Ops.Array.ArrayGetNumber.prototype=new CABLES.Op;CABLES.OPS["d1189078-70cf-437d-9a37-b2ebe89acdaf"]={f:Ops.Array.ArrayGetNumber,objName:"Ops.Array.ArrayGetNumber"};Ops.String.StringCompose_v3=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inString("Format","hello $a, $b $c und $d"),a=e.inString("String A","world"),r=e.inString("String B",1),o=e.inString("String C",2),i=e.inString("String D",3),s=e.inString("String E"),l=e.inString("String F"),c=e.outString("Result");n.onChange=a.onChange=r.onChange=o.onChange=i.onChange=s.onChange=l.onChange=u;u();function u(){var e=n.get()||"";if(typeof e!="string")e="";e=e.replace(/\$a/g,a.get());e=e.replace(/\$b/g,r.get());e=e.replace(/\$c/g,o.get());e=e.replace(/\$d/g,i.get());e=e.replace(/\$e/g,s.get());e=e.replace(/\$f/g,l.get());c.set(e)}};Ops.String.StringCompose_v3.prototype=new CABLES.Op;CABLES.OPS["6afea9f4-728d-4f3c-9e75-62ddc1448bf0"]={f:Ops.String.StringCompose_v3,objName:"Ops.String.StringCompose_v3"};Ops.Ui.VizString=function(){CABLES.Op.apply(this,arguments);const t=this;const e={};const n=t.inString("String","");const a=t.outString("Result");t.setUiAttrib({widthOnlyGrow:true});n.onChange=()=>{let e=n.get();if(t.patch.isEditorMode()){if(e===null)e="null";else if(e===undefined)e="undefined";else e='"'+(String(e)||"")+'"';t.setTitle(e)}a.set(n.get())}};Ops.Ui.VizString.prototype=new CABLES.Op;CABLES.OPS["b04ff547-f557-4a54-a3ad-8a668fe1303d"]={f:Ops.Ui.VizString,objName:"Ops.Ui.VizString"};Ops.String.StringContains_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inString("String"),a=e.inString("SearchValue"),r=e.outBoolNum("Found",false),o=e.outNumber("Index",-1);a.onChange=n.onChange=i;i();function i(){if(n.get()&&a.get().length>0){const e=n.get().indexOf(a.get());o.set(e);r.set(e>-1)}else{o.set(-1);r.set(false)}}};Ops.String.StringContains_v2.prototype=new CABLES.Op;CABLES.OPS["2ca3e5d7-e6b4-46a7-8381-3fe1ad8b6879"]={f:Ops.String.StringContains_v2,objName:"Ops.String.StringContains_v2"};Ops.String.ArrayContainsString=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inArray("Array"),a=e.inString("SearchValue"),r=e.outBoolNum("Found",false),o=e.outNumber("Index",-1);a.onChange=()=>{e.setUiAttrib({extendTitle:a.get()});i()};n.onChange=i;function i(){if(n.get()){const e=n.get().indexOf(a.get());o.set(e);r.set(e>-1)}}};Ops.String.ArrayContainsString.prototype=new CABLES.Op;CABLES.OPS["bace9c9b-5e96-4a82-9bcd-02e316afb9de"]={f:Ops.String.ArrayContainsString,objName:"Ops.String.ArrayContainsString"};Ops.Math.Divide=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueFloat("number1",1),a=e.inValueFloat("number2",2),r=e.outNumber("result");e.setTitle("/");n.onChange=a.onChange=o;o();function o(){r.set(n.get()/a.get())}};Ops.Math.Divide.prototype=new CABLES.Op;CABLES.OPS["86fcfd8c-038d-4b91-9820-a08114f6b7eb"]={f:Ops.Math.Divide,objName:"Ops.Math.Divide"};Ops.Json.CsvArray=function(){CABLES.Op.apply(this,arguments);const r=this;const e={};const t=r.inUrl("file"),o=r.outArray("result"),i=r.outNumber("num items");const n=function(){CABLES.ajax(r.patch.getFilePath(t.get()),function(e,t,n){try{const a=JSON.parse(t);o.set(a);i.set(a.length)}catch(e){r.logError(e);o.set(null);i.set(0)}})};t.onChange=n};Ops.Json.CsvArray.prototype=new CABLES.Op;CABLES.OPS["2e76c1f8-19ac-4e9d-8db8-58b2f9fbc1d3"]={f:Ops.Json.CsvArray,objName:"Ops.Json.CsvArray"};Ops.Ui.VizNumberBar=function(){CABLES.Op.apply(this,arguments);const i=this;const e={};const s=i.inFloat("Number",0);i.setUiAttrib({height:100,width:200,resizable:true});let l=-Number.MAX_VALUE;let c=Number.MAX_VALUE;s.onLinkChanged=()=>{l=-Number.MAX_VALUE;c=Number.MAX_VALUE};i.renderVizLayer=(r,o)=>{r.fillStyle="#222";r.fillRect(o.x,o.y,o.width,o.height);{l=Math.max(l,s.get());c=Math.min(c,s.get());if(i.uiAttribs.color)r.fillStyle=i.uiAttribs.color;else r.fillStyle="#555";let e=CABLES.map(0,c,l,0,o.width);let t=CABLES.map(s.get(),c,l,0,o.width);let n=Math.min(e,t);let a=Math.max(e,t);r.fillRect(n+o.x,o.y,a-n,o.height)}{const e=10;if(i.uiAttribs.color)r.fillStyle="#fff";else r.fillStyle="#ccc";const t=o.height*.7;r.font="normal "+t+"px sourceCodePro";r.fillText(Math.round(s.get()*1e4)/1e4,o.x+e,o.y+t)}}};Ops.Ui.VizNumberBar.prototype=new CABLES.Op;CABLES.OPS["37575d2e-4ba6-4d2b-b00c-c503666867c5"]={f:Ops.Ui.VizNumberBar,objName:"Ops.Ui.VizNumberBar"};Ops.Math.Round=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueFloat("number"),a=e.inInt("Decimal Places",0),r=e.outNumber("result");let o=0;n.onChange=s;a.onChange=i;i();function i(){o=Math.pow(10,a.get());s()}function s(){r.set(Math.round(n.get()*o)/o)}};Ops.Math.Round.prototype=new CABLES.Op;CABLES.OPS["1a1ef636-6d02-42ba-ae1e-627b917d0d2b"]={f:Ops.Math.Round,objName:"Ops.Math.Round"};Ops.Gl.Matrix.Transform=function(){CABLES.Op.apply(this,arguments);const n=this;const e={};const t=n.inTrigger("render"),a=n.inValue("posX",0),r=n.inValue("posY",0),o=n.inValue("posZ",0),i=n.inValue("scale",1),s=n.inValue("rotX",0),l=n.inValue("rotY",0),c=n.inValue("rotZ",0),u=n.outTrigger("trigger");n.setPortGroup("Rotation",[s,l,c]);n.setPortGroup("Position",[a,r,o]);n.setPortGroup("Scale",[i]);n.setUiAxisPorts(a,r,o);const _=vec3.create();const d=vec3.create();const p=mat4.create();mat4.identity(p);let g=false,f=false,m=true,v=true,h=true;s.onChange=l.onChange=c.onChange=T;a.onChange=r.onChange=o.onChange=I;i.onChange=y;t.onTriggered=function(){let e=false;if(m){x();e=true}if(v){O();e=true}if(h)e=true;if(e)b();const t=n.patch.cgl;t.pushModelMatrix();mat4.multiply(t.mMatrix,t.mMatrix,p);u.trigger();t.popModelMatrix();if(CABLES.UI&&CABLES.UI.showCanvasTransforms)gui.setTransform(n.id,a.get(),r.get(),o.get());if(n.isCurrentUiOp())gui.setTransformGizmo({posX:a,posY:r,posZ:o})};n.transform3d=function(){return{pos:[a,r,o]}};function b(){mat4.identity(p);if(f)mat4.translate(p,p,_);if(s.get()!==0)mat4.rotateX(p,p,s.get()*CGL.DEG2RAD);if(l.get()!==0)mat4.rotateY(p,p,l.get()*CGL.DEG2RAD);if(c.get()!==0)mat4.rotateZ(p,p,c.get()*CGL.DEG2RAD);if(g)mat4.scale(p,p,d);h=false}function x(){f=false;if(a.get()!==0||r.get()!==0||o.get()!==0)f=true;vec3.set(_,a.get(),r.get(),o.get());m=false}function O(){g=true;vec3.set(d,i.get(),i.get(),i.get());v=false}function I(){m=true}function y(){v=true}function T(){h=true}b()};Ops.Gl.Matrix.Transform.prototype=new CABLES.Op;CABLES.OPS["650baeb1-db2d-4781-9af6-ab4e9d4277be"]={f:Ops.Gl.Matrix.Transform,objName:"Ops.Gl.Matrix.Transform"};Ops.Ui.VizNumber=function(){CABLES.Op.apply(this,arguments);const n=this;const e={};const a=n.inFloat("Number",0);const r=n.outNumber("Result");n.setUiAttrib({widthOnlyGrow:true});a.onChange=()=>{let t=a.get();if(n.patch.isEditorMode()){let e="";if(t===null)e="null";else if(t===undefined)e="undefined";else{e=""+Math.round(t*1e4)/1e4;if(e[0]!="-")e=" "+e}n.setUiAttribs({extendTitle:e})}r.set(t)}};Ops.Ui.VizNumber.prototype=new CABLES.Op;CABLES.OPS["2b60d12d-2884-4ad0-bda4-0caeb6882f5c"]={f:Ops.Ui.VizNumber,objName:"Ops.Ui.VizNumber"};Ops.Gl.Matrix.ScaleXYZ=function(){CABLES.Op.apply(this,arguments);const t=this;const e={};const n=t.inTrigger("render"),a=t.inValueFloat("x",1),r=t.inValueFloat("y",1),o=t.inValueFloat("z",1),i=t.outTrigger("trigger");const s=vec3.create();let l=true;a.onChange=r.onChange=o.onChange=u;u();n.onTriggered=c;function c(){const e=t.patch.cg||t.patch.cgl;if(l){vec3.set(s,a.get(),r.get(),o.get());l=false}e.pushModelMatrix();mat4.scale(e.mMatrix,e.mMatrix,s);i.trigger();e.popModelMatrix()}function u(){l=true}};Ops.Gl.Matrix.ScaleXYZ.prototype=new CABLES.Op;CABLES.OPS["9ba52457-5f0d-4b20-a97c-4ec4856b8e29"]={f:Ops.Gl.Matrix.ScaleXYZ,objName:"Ops.Gl.Matrix.ScaleXYZ"};Ops.Math.Pow=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueFloat("Base"),a=e.inValueFloat("Exponent"),r=e.outNumber("Result");a.set(2);n.onChange=o;a.onChange=o;function o(){let e=Math.pow(n.get(),a.get());if(isNaN(e))e=0;r.set(e)}};Ops.Math.Pow.prototype=new CABLES.Op;CABLES.OPS["3bb3f98f-27d6-44c4-b4e5-186e10f0809d"]={f:Ops.Math.Pow,objName:"Ops.Math.Pow"};Ops.Trigger.TriggerCounterLoop=function(){CABLES.Op.apply(this,arguments);const n=this;const e={};const t=n.inTriggerButton("trigger in"),a=n.inTriggerButton("reset"),r=n.outTrigger("trigger out"),o=n.outNumber("current count"),i=n.inValueInt("Loop min",0),s=n.inValueInt("Loop max",4);let l=Math.floor(i.get());t.onTriggered=function(){let e=Math.floor(i.get());let t=Math.floor(s.get());if(e<t){if(l<e){l=i.get()}else if(l>=t){l=i.get()}else{l++}}else if(e>t){if(l<t){l=e}else if(l>e){e}else if(l<=t){l=e}else{l--}}o.set(l);n.setUiAttrib({extendTitle:l});r.trigger()};a.onTriggered=function(){let e=Math.floor(i.get());let t=Math.floor(s.get());if(e<t){l=e}else if(t<e){l=e}else{l=0}n.setUiAttrib({extendTitle:l});o.set(l)}};Ops.Trigger.TriggerCounterLoop.prototype=new CABLES.Op;CABLES.OPS["d3356c53-e278-433f-af0b-d8327cd99a2d"]={f:Ops.Trigger.TriggerCounterLoop,objName:"Ops.Trigger.TriggerCounterLoop"};Ops.Math.Incrementor=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTriggerButton("Increment"),a=e.inTriggerButton("Decrement"),r=e.inValueInt("Length"),o=e.inBool("Limit",true),i=e.inTriggerButton("Reset"),s=e.inSwitch("Mode",["Rewind","Stop at Max"],"Rewind"),l=e.inValueInt("Default",0),c=e.outTrigger("Changed"),u=e.outNumber("Value"),_=e.outTrigger("Restarted");u.ignoreValueSerialize=true;r.set(10);let d=0;u.set(0);r.onTriggered=i;l.onChange=m;i.onTriggered=m;const p=0;const g=1;let f=p;s.onChange=function(){if(s.get()=="Rewind"){f=p}if(s.get()=="Stop at Max"){f=g}};o.onChange=()=>{r.setUiAttribs({greyout:!o.get()})};function m(){u.set(null);d=l.get();u.set(d);_.trigger()}a.onTriggered=function(){d--;if(o.get()){if(f==p&&d<0)d=r.get()-1;if(f==g&&d<0)d=0}u.set(d);c.trigger()};n.onTriggered=function(){d++;if(o.get()){if(f==p&&d>=r.get()){d=0;_.trigger()}if(f==g&&d>=r.get())d=r.get()-1}u.set(d);c.trigger()}};Ops.Math.Incrementor.prototype=new CABLES.Op;CABLES.OPS["45cc0011-ada8-4423-8f5b-39a3810b8389"]={f:Ops.Math.Incrementor,objName:"Ops.Math.Incrementor"};Ops.Gl.ShaderEffects.AreaDiscardPixel_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={areadiscard_frag:"\n\nfloat MOD_de=0.0;\n\n#ifdef MOD_AREA_SPHERE\n    MOD_de=distance(vec3(MOD_x,MOD_y,MOD_z)/MOD_sizeAxis,MOD_areaPos.xyz/MOD_sizeAxis);\n#endif\n\n#ifdef MOD_AREA_BOX\n    if( abs(MOD_y/MOD_sizeAxis.y-MOD_areaPos.y/(MOD_sizeAxis.y*MOD_size))>0.5 ||\n        abs(MOD_x/MOD_sizeAxis.x-MOD_areaPos.x/(MOD_sizeAxis.x*MOD_size))>0.5 ||\n        abs(MOD_z/MOD_sizeAxis.z-MOD_areaPos.z/(MOD_sizeAxis.z*MOD_size))>0.5 ) MOD_de=1.0;\n#endif\n\n#ifdef MOD_AREA_AXIS_X\n    MOD_de=abs(MOD_x-MOD_areaPos.x);\n#endif\n#ifdef MOD_AREA_AXIS_XY\n    MOD_de=abs(MOD_x-MOD_areaPos.x+MOD_areaPos.y);\n#endif\n#ifdef MOD_AREA_AXIS_XZ\n    MOD_de=abs(MOD_x-MOD_areaPos.x+MOD_areaPos.z);\n#endif\n#ifdef MOD_AREA_AXIS_YZ\n    MOD_de=abs(MOD_y-MOD_areaPos.y+MOD_areaPos.z);\n#endif\n#ifdef MOD_AREA_AXIS_Y\n    MOD_de=abs(MOD_y-MOD_areaPos.y);\n#endif\n#ifdef MOD_AREA_AXIS_Z\n    MOD_de=abs(MOD_z-MOD_areaPos.z);\n#endif\n\n#ifdef MOD_AREA_AXIS_X_INFINITE\n    MOD_de=MOD_x-MOD_areaPos.x;\n#endif\n#ifdef MOD_AREA_AXIS_Y_INFINITE\n    MOD_de=MOD_y-MOD_areaPos.y;\n#endif\n#ifdef MOD_AREA_AXIS_Z_INFINITE\n    MOD_de=MOD_z-MOD_areaPos.z;\n#endif\n\n#ifdef MOD_AREA_REPEAT\n    MOD_de=mod(MOD_de,MOD_size+MOD_repeat);\n#endif\n\nMOD_de=MOD_de/MOD_size;\n\n#ifdef MOD_AREA_INVERT\n    MOD_de=1.0-MOD_de;\n#endif\n\n\nif(MOD_de<=0.5) discard;\n\n",areadiscard_head_frag:"IN vec4 MOD_areaPos;\n"};const n=e.inTrigger("render"),a=e.inValueBool("Invert"),r=e.inValueSelect("Area",["Sphere","Box","Axis X","Axis Y","Axis Z","Axis XY","Axis XZ","Axis YZ","Axis X Infinite","Axis Y Infinite","Axis Z Infinite"],"Sphere"),o=e.inValue("Size",1),i=e.inValueFloat("Size X",1),s=e.inValueFloat("Size Y",1),l=e.inValueFloat("Size Z",1),c=e.inValueBool("Repeat"),u=e.inValueFloat("Repeat Distance",0),_=e.inValue("x"),d=e.inValue("y"),p=e.inValue("z"),g=e.inValueBool("WorldSpace",true),f=e.outTrigger("trigger");const m=e.patch.cgl;e.setPortGroup("Size",[o,s,i,l]);e.setPortGroup("Position",[_,d,p,g]);const v="".endl()+"OUT vec4 MOD_areaPos;".endl();const h="".endl()+"#ifndef MOD_WORLDSPACE".endl()+"   MOD_areaPos=pos;".endl()+"#endif".endl()+"#ifdef MOD_WORLDSPACE".endl()+"   MOD_areaPos=mMatrix*pos;".endl()+"#endif".endl();g.onChange=a.onChange=c.onChange=r.onChange=x;const b=new CGL.ShaderModifier(m,e.name);b.addModule({priority:2,title:e.objName,name:"MODULE_VERTEX_POSITION",srcHeadVert:v,srcBodyVert:h});b.addModule({title:e.objName,name:"MODULE_COLOR",srcHeadFrag:t.areadiscard_head_frag||"",srcBodyFrag:t.areadiscard_frag||""});b.addUniformFrag("f","MOD_size",o);b.addUniformFrag("f","MOD_x",_);b.addUniformFrag("f","MOD_y",d);b.addUniformFrag("f","MOD_z",p);b.addUniformFrag("3f","MOD_sizeAxis",i,s,l);b.addUniformFrag("f","MOD_repeat",u);x();function x(){b.toggleDefine("MOD_WORLDSPACE",g.get());b.toggleDefine("MOD_AREA_INVERT",a.get());b.toggleDefine("MOD_AREA_REPEAT",c.get());b.toggleDefine("MOD_AREA_BOX",r.get()=="Box");b.toggleDefine("MOD_AREA_SPHERE",r.get()=="Sphere");b.toggleDefine("MOD_AREA_AXIS_X",r.get()=="Axis X");b.toggleDefine("MOD_AREA_AXIS_Y",r.get()=="Axis Y");b.toggleDefine("MOD_AREA_AXIS_Z",r.get()=="Axis Z");b.toggleDefine("MOD_AREA_AXIS_XY",r.get()=="Axis XY");b.toggleDefine("MOD_AREA_AXIS_XZ",r.get()=="Axis XZ");b.toggleDefine("MOD_AREA_AXIS_YZ",r.get()=="Axis YZ");b.toggleDefine("MOD_AREA_AXIS_X_INFINITE",r.get()=="Axis X Infinite");b.toggleDefine("MOD_AREA_AXIS_Y_INFINITE",r.get()=="Axis Y Infinite");b.toggleDefine("MOD_AREA_AXIS_Z_INFINITE",r.get()=="Axis Z Infinite")}n.onTriggered=function(){if(e.isCurrentUiOp())gui.setTransformGizmo({posX:_,posY:d,posZ:p});if(m.shouldDrawHelpers(e))CABLES.GL_MARKER.drawSphere(e,o.get());b.bind();f.trigger();b.unbind()}};Ops.Gl.ShaderEffects.AreaDiscardPixel_v2.prototype=new CABLES.Op;CABLES.OPS["0d39986b-c594-44d5-815d-c46a280fe16c"]={f:Ops.Gl.ShaderEffects.AreaDiscardPixel_v2,objName:"Ops.Gl.ShaderEffects.AreaDiscardPixel_v2"};Ops.Anim.BoolAnim=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=new CABLES.Anim;const a=e.inTrigger("exe"),r=e.inValueBool("bool"),o=n.createPort(e,"easing"),i=e.inValue("duration",.5),s=e.inValueSelect("Direction",["Animate Both","Only True","Only False"],"Both"),l=e.inValue("value false",0),c=e.inValue("value true",1),u=e.outTrigger("trigger"),_=e.outNumber("value"),d=e.outBoolNum("finished"),p=e.outTrigger("Finished Trigger");const g=CABLES.now();e.toWorkPortsNeedToBeLinked(a);e.setPortGroup("Animation",[i,o]);e.setPortGroup("Values",[l,c]);s.onChange=r.onChange=l.onChange=c.onChange=i.onChange=f;f();function f(){d.set(false);const e=(CABLES.now()-g)/1e3;const t=n.getValue(e);n.clear();n.setValue(e,t);if(!r.get()){if(s.get()!="Only True")n.setValue(e+i.get(),l.get());else n.setValue(e,l.get())}else{if(s.get()!="Only False")n.setValue(e+i.get(),c.get());else n.setValue(e,c.get())}}a.onTriggered=function(){const e=(CABLES.now()-g)/1e3;_.set(n.getValue(e));if(n.hasEnded(e)){if(!d.get())p.trigger();d.set(true)}u.trigger()}};Ops.Anim.BoolAnim.prototype=new CABLES.Op;CABLES.OPS["06ad9d35-ccf5-4d31-889c-e23fa062588a"]={f:Ops.Anim.BoolAnim,objName:"Ops.Anim.BoolAnim"};Ops.Gl.MeshInstancer_v4=function(){CABLES.Op.apply(this,arguments);const e=this;const t={instancer_body_frag:"#ifdef COLORIZE_INSTANCES\n    #ifdef BLEND_MODE_MULTIPLY\n        col.rgb *= frag_instColor.rgb;\n        col.a *= frag_instColor.a;\n    #endif\n\n    #ifdef BLEND_MODE_ADD\n        col.rgb += frag_instColor.rgb;\n        col.a += frag_instColor.a;\n    #endif\n\n    #ifdef BLEND_MODE_NONE\n        col.rgb = frag_instColor.rgb;\n        col.a = frag_instColor.a;\n    #endif\n#endif\n",instancer_body_vert:"\n\n#ifdef HAS_TEXCOORDS\ntexCoord=(texCoord*instTexCoords.zw)+instTexCoords.xy;\n#endif\n\nmMatrix*=instMat;\npos.xyz*=MOD_scale;\n\n#ifdef HAS_COLORS\nfrag_instColor=instColor;\n#endif\n#ifndef HAS_COLORS\nfrag_instColor=vec4(1.0);\n#endif\n\n",instancer_head_frag:"IN vec4 frag_instColor;\n",instancer_head_vert:"\nIN vec4 instColor;\nIN mat4 instMat;\nIN vec4 instTexCoords;\nOUT mat4 instModelMat;\nOUT vec4 frag_instColor;\n\n#define INSTANCING\n\n"};const n=e.inTrigger("exe"),a=e.inObject("geom",null,"geometry"),r=e.inValue("Scale",1),o=e.inValueBool("Limit Instances",false),i=e.inValueInt("Limit",100),u=e.inArray("positions",3),_=e.inArray("Scale Array",3),d=e.inArray("Rotations",3),p=e.inSwitch("Rotation Type",["Euler","Quaternions"],"Euler"),s=e.inSwitch("Material blend mode",["Multiply","Add","Normal"],"Multiply"),g=e.inArray("Colors",4),f=e.inArray("TexCoords",4),l=e.outTrigger("Trigger Out"),c=e.outNumber("Num");e.setPortGroup("Limit Number of Instances",[i,o]);e.setPortGroup("Parameters",[_,d,u,p]);e.toWorkPortsNeedToBeLinked(a);e.toWorkPortsNeedToBeLinked(n);a.ignoreValueSerialize=true;const m=e.patch.cgl;const v=mat4.create();let h=new Float32Array(1),b=new Float32Array(1),x=new Float32Array(1),O=null,I=true,y=0,T=true,A=true,S=true;const C=new CGL.ShaderModifier(m,e.name);C.addModule({name:"MODULE_VERTEX_POSITION",title:e.name,priority:-2,srcHeadVert:t.instancer_head_vert,srcBodyVert:t.instancer_body_vert});C.addModule({name:"MODULE_COLOR",priority:-2,title:e.name,srcHeadFrag:t.instancer_head_frag,srcBodyFrag:t.instancer_body_frag});C.addUniformVert("f","MOD_scale",r);let E=true;s.onChange=()=>{E=true};o.onChange=P;n.onTriggered=D;n.onLinkChanged=function(){if(!n.isLinked())L()};P();d.onChange=_.onChange=u.onChange=p.onChange=function(){S=true;I=true};f.onChange=function(){A=true;I=true;E=true};g.onChange=function(){T=true;I=true;E=true};function M(){T=true,S=true;I=true}function N(){C.toggleDefine("COLORIZE_INSTANCES",g.get());C.toggleDefine("TEXCOORDS_INSTANCES",f.get());C.toggleDefine("BLEND_MODE_MULTIPLY",s.get()==="Multiply");C.toggleDefine("BLEND_MODE_ADD",s.get()==="Add");C.toggleDefine("BLEND_MODE_NONE",s.get()==="Normal");E=false}a.onChange=function(){if(O)O.dispose();if(!a.get()){O=null;return}O=new CGL.Mesh(m,a.get());M()};function L(){}function w(){if(!O)return;let e=u.get();if(!e)e=[0,0,0];y=Math.floor(e.length/3);if(E)N();const n=g.get();const a=f.get();const r=_.get();const o=p.get()=="Quaternions";const i=p.get()=="Normals";let t=3;if(o)t=4;d.setUiAttribs({stride:t});if(h.length!=y*16)h=new Float32Array(y*16);if(b.length!=y*4){T=true;b=new Float32Array(y*4)}if(x.length!=y*4){A=true;x=new Float32Array(y*4)}const s=d.get();for(let t=0;t<y;t++){mat4.identity(v);mat4.translate(v,v,[e[t*3],e[t*3+1],e[t*3+2]]);if(s){if(o){const l=mat4.create();const c=[s[t*4+0],s[t*4+1],s[t*4+2],s[t*4+3]];quat.normalize(c,c);mat4.fromQuat(l,c);mat4.mul(v,v,l)}if(i){}else{mat4.rotateX(v,v,s[t*3+0]*CGL.DEG2RAD);mat4.rotateY(v,v,s[t*3+1]*CGL.DEG2RAD);mat4.rotateZ(v,v,s[t*3+2]*CGL.DEG2RAD)}}if(T&&n){b[t*4+0]=n[t*4+0];b[t*4+1]=n[t*4+1];b[t*4+2]=n[t*4+2];b[t*4+3]=n[t*4+3]}if(A&&a){x[t*4+0]=a[t*4+0];x[t*4+1]=a[t*4+1];x[t*4+2]=a[t*4+2];x[t*4+3]=a[t*4+3]}if(r&&r.length>t)mat4.scale(v,v,[r[t*3],r[t*3+1],r[t*3+2]]);else mat4.scale(v,v,[1,1,1]);for(let e=0;e<16;e++)h[t*16+e]=v[e]}O.numInstances=y;if(S)O.addAttribute("instMat",h,16);if(T)O.addAttribute("instColor",b,4,{instanced:true});if(A)O.addAttribute("instTexCoords",x,4,{instanced:true});C.toggleDefine("HAS_TEXCOORDS",a);C.toggleDefine("HAS_COLORS",n);T=false;I=false}function P(){i.setUiAttribs({greyout:!o.get()})}function D(){if(!O)return;if(I)w();C.bind();if(o.get())O.numInstances=Math.min(y,i.get());else O.numInstances=y;c.set(this.name,O.numInstances);if(O.numInstances>0)O.render(m.getShader());l.trigger();C.unbind()}};Ops.Gl.MeshInstancer_v4.prototype=new CABLES.Op;CABLES.OPS["cb58f461-a0bd-4159-a3cb-5e396198b4e9"]={f:Ops.Gl.MeshInstancer_v4,objName:"Ops.Gl.MeshInstancer_v4"};Ops.Gl.Meshes.ParametricSurface=function(){CABLES.Op.apply(this,arguments);const C=this;const e={};const a=[{title:"Rectangle",xFunction:"u",yFunction:"v",zFunction:"0",uMin:0,uMax:2,vMin:0,vMax:1,isPiU:false,isPiV:false,uSegments:24,vSegments:24,scaleX:1,scaleY:1,scaleZ:1,displaceU:-1,displaceV:-.5},{title:"Archimedic Spiral",xFunction:"u*cos(u)",yFunction:"v",zFunction:"u*sin(u)",uMin:0,uMax:50,vMin:0,vMax:1,isPiU:false,isPiV:false,uSegments:300,vSegments:20,scaleX:.05,scaleY:.05,scaleZ:.05,displaceU:0,displaceV:-3},{title:"Cylinder",xFunction:"0.5*cos(u)",yFunction:"v",zFunction:"0.5*sin(u)",uMin:-1,uMax:1,vMin:0,vMax:1,isPiU:true,isPiV:false,uSegments:50,vSegments:50,scaleX:1,scaleY:1,scaleZ:1,displaceU:0,displaceV:0},{title:"Pillow",zFunction:"cos(u)",yFunction:"-1*cos(v)",xFunction:"0.8*sin(u)*sin(v)",uMin:0,uMax:1,vMin:-1,vMax:1,isPiU:true,isPiV:true,uSegments:50,vSegments:50,scaleX:.8,scaleY:.8,scaleZ:.8,displaceU:0,displaceV:0},{title:"Sine Surface",zFunction:"sin(u)",yFunction:"sin(v)",xFunction:"sin(u+v)",uMin:-1,uMax:1,vMin:-1,vMax:1,isPiU:true,isPiV:true,uSegments:50,vSegments:50,scaleX:.8,scaleY:.8,scaleZ:.8,displaceU:0,displaceV:0},{title:"Steinbach Screw",xFunction:"v*cos(u)",yFunction:"u*sin(v)",zFunction:"u*cos(v)",uMin:-4,uMax:4,vMin:0,vMax:2,isPiU:false,isPiV:true,uSegments:50,vSegments:50,scaleX:.18,scaleY:.18,scaleZ:.18,displaceU:0,displaceV:0},{title:"Moebius Band",xFunction:"cos(v)*(1 + u*cos(v/2))",yFunction:"sin(v)*(1 + u*cos(v/2))",zFunction:"u*sin(v/2)",uMin:-.3,uMax:.3,vMin:0,vMax:2,isPiU:false,isPiV:true,uSegments:50,vSegments:50,scaleX:.6,scaleY:.6,scaleZ:.6,displaceU:0,displaceV:0},{title:"Wavy Sphere",xFunction:"u*cos(cos(u))*cos(v)",yFunction:"u*cos(cos(u))*sin(v)",zFunction:"u*sin(cos(u))",uMin:0,uMax:45,vMin:0,vMax:2,isPiU:false,isPiV:true,uSegments:100,vSegments:100,scaleX:.02,scaleY:.02,scaleZ:.02,displaceU:0,displaceV:0},{title:"Spring",xFunction:"(2 + 0.5*cos(v))*cos(u)",yFunction:"(2 + 0.5*cos(v))*sin(u)",zFunction:"0.5*(sin(v) + 2*u/PI)",uMin:0,uMax:15,vMin:0,vMax:2,isPiU:true,isPiV:true,uSegments:100,vSegments:100,scaleX:.1,scaleY:.1,scaleZ:.1,displaceU:0,displaceV:0},{title:"Folium",xFunction:"cos(u)*(2*v/PI - tanh(v))",yFunction:"cos(u + 2*PI/3)/cosh(v)",zFunction:"cos(u - 2*PI/3)/cosh(v)",uMin:-1,uMax:1,vMin:-1,vMax:1,isPiU:true,isPiV:true,uSegments:50,vSegments:50,scaleX:1.3,scaleY:1.3,scaleZ:1.3,displaceU:0,displaceV:0},{title:"Hyperbolic Octahedron",xFunction:"pow(cos(u)*cos(v), 3)",yFunction:"pow(sin(u)*cos(v), 3)",zFunction:"pow(sin(v), 3)",uMin:-1/2,uMax:1/2,vMin:-1,vMax:1,isPiU:true,isPiV:true,uSegments:50,vSegments:50,scaleX:1.3,scaleY:1.3,scaleZ:1.3,displaceU:0,displaceV:0},{title:"Maeder's Owl",xFunction:"v*cos(u)-0.5*v*v*cos(2*u)",yFunction:"-1*v*sin(u) - 0.5*v*v*sin(2*u)",zFunction:"4*exp(1.5*log(v))*cos(3*u/2)/3",uMin:0,uMax:4,vMin:.001,vMax:4,isPiU:true,isPiV:false,uSegments:100,vSegments:100,scaleX:.071,scaleY:.071,scaleZ:.071,displaceU:0,displaceV:0},{title:"Tranguloid Trefoil",xFunction:"2*sin(3*u)/(2+cos(v))",yFunction:"2*(sin(u) + 2*sin(2*u))/(2+cos(v+2*PI/3))",zFunction:"(cos(u)-2*cos(2*u))*(2+cos(v+2*PI/3))/4",uMin:-1,uMax:1,vMin:-1,vMax:1,isPiU:true,isPiV:true,uSegments:50,vSegments:50,scaleX:.3,scaleY:.2,scaleZ:.3,displaceU:0,displaceV:0},{title:"Apple",xFunction:"cos(u)*(5 + 4.8 *cos(v)) + pow(v/PI, 20)",yFunction:"-2.3*log(1-v*0.3157) + 6*sin(v) + 2*cos(v) ",zFunction:"sin(u)*(5 + 4.8*cos(v)) + 0.25*cos(5*u)",uMin:-1,uMax:1,vMin:-1,vMax:1,isPiU:true,isPiV:true,uSegments:50,vSegments:50,scaleX:.06,scaleY:.06,scaleZ:.06,displaceU:0,displaceV:0},{title:"Kuen's Surface",xFunction:"(2*(cos(u) + u*sin(u))*sin(v))/(1+u*u*sin(v)*sin(v))",yFunction:"(2*(-u*cos(u) + sin(u))*sin(v))/(1+u*u*sin(v)*sin(v))",zFunction:"log(tan(v/2)) + 2*cos(v)/(1+u*u*sin(v)*sin(v))",uMin:-4.3,uMax:4.3,vMin:.03,vMax:31.11,isPiU:false,isPiV:false,uSegments:100,vSegments:100,scaleX:.7,scaleY:.7,scaleZ:.7,displaceU:0,displaceV:0},{title:"Henneberg's Surface",xFunction:"2*cos(v)*sinh(u)-0.667*cos(3*v)*sinh(3*u)",yFunction:"2*sin(v)*sinh(u)+0.667*sin(3*v)*sinh(3*u)",zFunction:"2*cos(2*v)*cosh(2*u)",uMin:-1,uMax:1,vMin:-.5,vMax:.5,isPiU:false,isPiV:true,uSegments:100,vSegments:100,scaleX:.1,scaleY:.1,scaleZ:.1,displaceU:0,displaceV:0},{title:"Pseudoheliceras subcatenatum",xFunction:"exp(0.075*u)*(1.5 + 1.6 * cos(v))*cos(1.0*u)",yFunction:"-1 * exp(0.075*u)*(1.5 + 1.6 * cos(v))*sin(1.0*u)",zFunction:"exp(0.075*u)*(-7 + 1.6 * sin(v))",uMin:-50,uMax:-1,vMin:0,vMax:2,isPiU:false,isPiV:true,uSegments:50,vSegments:50,scaleX:.3,scaleY:.3,scaleZ:.3,displaceU:0,displaceV:0},{title:"Little Cycloid",xFunction:"cos(u/2)*cos(u/5)*(10 + cos(v)) + sin(u/5)*sin(v)*cos(v)",yFunction:"sin(u/2)*cos(u/5)*(10 + cos(v)) + sin(u/5)*sin(v)*cos(v)",zFunction:"-sin(u/5)*(10+cos(v))*sin(v)*cos(v)",uMin:0,uMax:2*5*2,vMin:0,vMax:4,isPiU:true,isPiV:true,uSegments:100,vSegments:100,scaleX:.05,scaleY:.05,scaleZ:.05,displaceU:0,displaceV:-3},{title:"Torus Knot",xFunction:"(50+90*cos(7*u) + 12.5*cos(v)) * cos(8*u)",yFunction:"12.5*sin(v) + 90*sin(7*u)",zFunction:"(50+90*cos(7*u) + 12.5*cos(v)) * sin(8*u)",uMin:0,uMax:2,vMin:0,vMax:2,isPiU:true,isPiV:true,uSegments:200,vSegments:200,scaleX:.005,scaleY:.005,scaleZ:.005,displaceU:0,displaceV:0},{title:"Triaxial Tritorus",yFunction:"sin(u)*(1 + cos(v))",xFunction:"sin(u+2*PI/3)*(1+cos(v+2*PI/3))",zFunction:"sin(u+4*PI/3)*(1+cos(v+4*PI/3))",uMin:-1,uMax:1,vMin:-1,vMax:1,isPiU:true,isPiV:true,uSegments:100,vSegments:100,scaleX:.7,scaleY:.7,scaleZ:.7,displaceU:0,displaceV:0},{title:"Triaxial Hexatorus",xFunction:"sin(u)/(sqrt(2)+cos(v))",yFunction:"sin(u+2*PI/3)/(sqrt(2)+cos(v+2*PI/3))",zFunction:"cos(u-2*PI/3)/(sqrt(2)+cos(v-2*PI/3))",uMin:0,uMax:2,vMin:0,vMax:2,isPiU:true,isPiV:true,uSegments:100,vSegments:100,scaleX:.8,scaleY:.8,scaleZ:.8,displaceU:0,displaceV:0},{title:"Hyperbolic Helicoid",xFunction:"sinh(v)*cos(4.13*u)/(1+cosh(u)*cosh(v))",yFunction:"sinh(v)*sin(4.13*u)/(1+cosh(u)*cosh(v))",zFunction:"cosh(v)*sinh(u)/(1+cosh(u)*cosh(v))",uMin:-4,uMax:4,vMin:-4,vMax:4,isPiU:false,isPiV:false,uSegments:100,vSegments:100,scaleX:1,scaleY:1,scaleZ:1,displaceU:0,displaceV:0},{title:"Triple Corkscrew III",xFunction:"u*1.3",yFunction:"0.5*(0.4*(1 - abs(u)) * cos(v) + cos(0.4)*cos(u*PI/2)*cos(u*10*PI))",zFunction:"0.5*(0.4*(1-abs(u))*sin(v) + cos(0.4)*cos(u*PI/2)*sin(u*10*PI))",uMin:-1,uMax:1,vMin:-1,vMax:1,isPiU:false,isPiV:true,uSegments:190,vSegments:190,scaleX:1,scaleY:1,scaleZ:1,displaceU:0,displaceV:0},{title:"Breather Surface",xFunction:"-u + (2*(1-0.4*0.4)*cosh(0.4*u)*sinh(0.4*u)/(0.4*( pow(sqrt(1-0.4*0.4) * cosh(0.4*u), 2) + pow(0.4*sin(sqrt(1-0.4*0.4)*v), 2) )))",yFunction:"2*(sqrt(1-0.4*0.4))*cosh(0.4*u)*(-1*((sqrt(1-0.4*0.4))*cos(v)*cos((sqrt(1-0.4*0.4))*v)) - (sin(v) * sin((sqrt(1-0.4*0.4))*v)))/(0.4*( pow(sqrt(1-0.4*0.4) * cosh(0.4*u), 2) + pow(0.4*sin(sqrt(1-0.4*0.4)*v), 2) ))",zFunction:"2*sqrt(1-0.4*0.4)*cosh(0.4*u) * (-1* (sqrt(1-0.4*0.4)*sin(v)*cos(sqrt(1-0.4*0.4)*v)) + (cos(v)*sin(sqrt(1-0.4*0.4)*v)))/(0.4*( pow(sqrt(1-0.4*0.4) * cosh(0.4*u), 2) + pow(0.4*sin(sqrt(1-0.4*0.4)*v), 2) ))",uMin:-13.2,uMax:13.2,vMin:-37.4,vMax:37.4,isPiU:false,isPiV:false,uSegments:190,vSegments:190,scaleX:.2,scaleY:.2,scaleZ:.2,displaceU:0,displaceV:0},{title:"Breather Surface II",xFunction:"-u + (2*(1-0.6*0.6)*cosh(0.6*u)*sinh(0.6*u)/(0.6*( pow(sqrt(1-0.6*0.6) * cosh(0.6*u), 2) + pow(0.6*sin(sqrt(1-0.6*0.6)*v), 2) )))",yFunction:"2*(sqrt(1-0.6*0.6))*cosh(0.6*u)*(-1*((sqrt(1-0.6*0.6))*cos(v)*cos((sqrt(1-0.6*0.6))*v)) - (sin(v) * sin((sqrt(1-0.6*0.6))*v)))/(0.6*( pow(sqrt(1-0.6*0.6) * cosh(0.6*u), 2) + pow(0.6*sin(sqrt(1-0.6*0.6)*v), 2) ))",zFunction:"2*sqrt(1-0.6*0.6)*cosh(0.6*u) * (-1* (sqrt(1-0.6*0.6)*sin(v)*cos(sqrt(1-0.6*0.6)*v)) + (cos(v)*sin(sqrt(1-0.6*0.6)*v)))/(0.6*( pow(sqrt(1-0.6*0.6) * cosh(0.6*u), 2) + pow(0.6*sin(sqrt(1-0.6*0.6)*v), 2) ))",uMin:-8,uMax:8,vMin:-15.55,vMax:15.55,isPiU:false,isPiV:false,uSegments:190,vSegments:190,scaleX:.2,scaleY:.2,scaleZ:.2,displaceU:0,displaceV:0}];let t=true;let E=true;const n=C.inDropDown("shapes",a.map(e=>{return e.title}));const r=C.inTrigger("render");const M=C.inValueInt("u Segments",48);const N=C.inValueInt("v Segments",48);const L=C.inValueBool("Multiple of PI - u",false);const w=C.inValueFloat("uMin",-2);const P=C.inValueFloat("uMax",2);const D=C.inValueFloat("Displace U",0);const R=C.inValueBool("Multiple of PI - v",false);const U=C.inValueFloat("vMin",-1);const j=C.inValueFloat("vMax",1);const G=C.inValueFloat("Displace V",0);C.setPortGroup("Segments",[M,N]);C.setPortGroup("V range",[R,j,U,G]);C.setPortGroup("U range",[L,P,w,D]);const V=C.inString("X Function","u");const k=C.inString("Y Function","v");const B=C.inString("Z Function","0");const z=C.inFloatSlider("Scale X",1);const F=C.inFloatSlider("Scale Y",1);const X=C.inFloatSlider("Scale Z",1);C.setPortGroup("XYZ Functions",[V,z,k,F,B,X]);C.setPortGroup("Scaling",[z,F,X]);const o=C.inValueBool("Draw",true);C.setPortGroup("Draw",[o]);const i={xFunction:V,yFunction:k,zFunction:B,isPiU:L,uMin:w,uMax:P,isPiV:R,vMin:U,vMax:j,uSegments:M,vSegments:N,scaleX:z,scaleY:F,scaleZ:X,displaceU:D,displaceV:G};const s=C.outTrigger("trigger");const H=C.outObject("geometry");const l=C.outArray("Position");const c=C.outNumber("Position Amount");H.ignoreValueSerialize=true;Object.keys(i).forEach(e=>{i[e].set(a[0][e])});n.set("Rectangle");n.onChange=({value:t})=>{const[n]=a.filter(e=>{return e.title===t});Object.keys(i).forEach(e=>{i[e].set(n[e])});C.refreshParams();u()};const Y=C.patch.cgl;let W=null;let q=null;const u=()=>{if(t){const d=M.get();const p=N.get();let o=w.get()>P.get()?w.get():P.get();let i=U.get()>j.get()?U.get():j.get();let s=P.get()<w.get()?P.get():w.get();let l=j.get()<U.get()?j.get():U.get();o=L.get()?o*Math.PI:o;i=R.get()?i*Math.PI:i;s=L.get()?s*Math.PI:s;l=R.get()?l*Math.PI:l;const g=D.get();const f=G.get();const a=V.get();const r=k.get();const m=B.get();const v=z.get();const h=F.get();const b=X.get();let c;let u;let _;const x=[];const O=[];const I=[];let e;let t;let n;try{c=new Function("m","u","v",`with(m) { return ${a} }`);u=new Function("m","u","v",`with(m) { return ${r} }`);_=new Function("m","u","v",`with(m) { return ${m} }`);for(let r=0;r<=d;r+=1){for(let a=0;a<=p;a+=1){const y=s+r*(o-s)/d;const T=l+a*(i-l)/p;const A=g+y;const S=f+T;let e=c(Math,A,S);let t=u(Math,A,S);let n=_(Math,A,S);if(E){e*=v;t*=h;n*=b}x.push(e,t,n);O.push(CABLES.map(y,s,o,0,1),CABLES.map(T,l,i,1,0));if(r<d&&a<p){I.push(r*(p+1)+a);I.push((r+1)*(p+1)+a);I.push(r*(p+1)+a+1);I.push((r+1)*(p+1)+a);I.push((r+1)*(p+1)+a+1);I.push(r*(p+1)+a+1)}}}t=[];n=[];e=[]}catch(e){if(e instanceof ReferenceError||e instanceof SyntaxError){C.logError(e);return}C.log(e)}q=new CGL.Geometry("parametric surface");q.clear();q.vertices=x||[];q.texCoords=O;q.verticesIndices=I;q.calculateNormals();q.calcTangentsBitangents();if(q.vertices.length==0)return;if(!W){W=new CGL.Mesh(Y,q)}else{W.setGeom(q)}H.set(null);H.set(q)}l.set(null);l.set(q.vertices);c.set(q.vertices.length);t=false;E=false};u();const _=()=>{E=true;t=true};const d=()=>{E=true;t=true};o.onChange=M.onChange=N.onChange=P.onChange=j.onChange=w.onChange=U.onChange=G.onChange=D.onChange=R.onChange=L.onChange=V.onChange=k.onChange=B.onChange=_;z.onChange=F.onChange=X.onChange=d;r.onTriggered=function(){if(t)u();if(o.get()){W.render(Y.getShader())}s.trigger()}};Ops.Gl.Meshes.ParametricSurface.prototype=new CABLES.Op;CABLES.OPS["5d3211a6-801d-4e59-ba6f-546ffe5fd34a"]={f:Ops.Gl.Meshes.ParametricSurface,objName:"Ops.Gl.Meshes.ParametricSurface"};Ops.Gl.ShaderEffects.ExplodeDividedMesh_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={explode_divided_mesh_vert:"\nfloat MOD_rand(vec2 co)\n{\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvec4 MOD_deform(vec4 pos,vec3 normal,float index)\n{\n    index=floor(index/3.0);\n\n    vec4 p=abs(pos);\n    p.x+=MOD_x+0.01;\n    p.y+=MOD_y+0.01;\n    p.z+=MOD_z+0.01;\n\n    vec4 pp=vec4(normal*(MOD_rand(vec2(index)) * MOD_dist-MOD_dist/2.0),1.0) * p;\n\n    #ifdef MOD_ABSOLUTE\n        pp=abs(pp);\n    #endif\n\n    pp.x*=MOD_mulx;\n    pp.y*=MOD_muly;\n    pp.z*=MOD_mulz;\n\n\n    float MOD_falloff=0.2;\n    float distMul=distance(vec3(MOD_posx,MOD_posy,MOD_posz),pos.xyz);\n    distMul=1.0-smoothstep(MOD_falloff*MOD_size,MOD_size,distMul);\n\n\n\n    pos.xyz += distMul*pp.xyz;\n\n    return pos;\n}\n"};const n=e.inTrigger("Render"),a=e.inValue("Distance",1),r=e.inValue("Size",1),o=e.inValueBool("Absolute",false),i=e.inValue("add x"),s=e.inValue("add y"),l=e.inValue("add z"),c=e.inValue("mul x",1),u=e.inValue("mul y",1),_=e.inValue("mul z",1),d=e.inValue("x"),p=e.inValue("y"),g=e.inValue("z"),f=e.outTrigger("Next");e.setPortGroup("Add",[i,l,s]);e.setPortGroup("Multiply",[c,_,u]);e.setPortGroup("Position",[d,g,p]);const m=e.patch.cgl;const v=t.explode_divided_mesh_vert;const h="".endl()+"pos=MOD_deform(pos,attrVertNormal,attrVertIndex);".endl();o.onChange=function(){b.toggleDefine("MOD_ABSOLUTE",o.get())};const b=new CGL.ShaderModifier(m,e.name);b.addModule({title:e.objName,name:"MODULE_VERTEX_POSITION",srcHeadVert:v,srcBodyVert:h});b.addUniform("f","MOD_dist",a);b.addUniform("f","MOD_x",i);b.addUniform("f","MOD_y",s);b.addUniform("f","MOD_z",l);b.addUniform("f","MOD_mulx",c);b.addUniform("f","MOD_muly",u);b.addUniform("f","MOD_mulz",_);b.addUniform("f","MOD_posx",d);b.addUniform("f","MOD_posy",p);b.addUniform("f","MOD_posz",g);b.addUniform("f","MOD_size",r);n.onTriggered=function(){if(e.isCurrentUiOp())gui.setTransformGizmo({posX:d,posY:p,posZ:g});b.bind();f.trigger();b.unbind()}};Ops.Gl.ShaderEffects.ExplodeDividedMesh_v2.prototype=new CABLES.Op;CABLES.OPS["a12f2aab-0cde-44ce-923e-f78a605c783c"]={f:Ops.Gl.ShaderEffects.ExplodeDividedMesh_v2,objName:"Ops.Gl.ShaderEffects.ExplodeDividedMesh_v2"};Ops.Gl.Phong.PhongMaterial_v6=function(){CABLES.Op.apply(this,arguments);const e=this;const s={phong_frag:'IN vec3 viewDirection;\nIN vec3 normInterpolated;\nIN vec2 texCoord;\n\n#ifdef ENABLE_FRESNEL\n    IN vec4 cameraSpace_pos;\n#endif\n\n// IN mat3 normalMatrix; // when instancing...\n\n#ifdef HAS_TEXTURE_NORMAL\n    IN mat3 TBN_Matrix; // tangent bitangent normal space transform matrix\n#endif\n\nIN vec3 fragPos;\nIN vec3 v_viewDirection;\n\nUNI vec4 inDiffuseColor;\nUNI vec4 inMaterialProperties;\n\n#ifdef ADD_EMISSIVE_COLOR\n    UNI vec4 inEmissiveColor; // .w = intensity\n#endif\n\n#ifdef ENABLE_FRESNEL\n    UNI mat4 viewMatrix;\n    UNI vec4 inFresnel;\n    UNI vec2 inFresnelWidthExponent;\n#endif\n\n#ifdef ENVMAP_MATCAP\n    IN vec3 viewSpaceNormal;\n    IN vec3 viewSpacePosition;\n#endif\n\nstruct Light {\n    vec3 color;\n    vec3 position;\n    vec3 specular;\n\n\n    // * SPOT LIGHT * //\n    #ifdef HAS_SPOT\n        vec3 conePointAt;\n        #define COSCONEANGLE x\n        #define COSCONEANGLEINNER y\n        #define SPOTEXPONENT z\n        vec3 spotProperties;\n    #endif\n\n    #define INTENSITY x\n    #define ATTENUATION y\n    #define FALLOFF z\n    #define RADIUS w\n    vec4 lightProperties;\n\n    int castLight;\n};\n\n/* CONSTANTS */\n#define NONE -1\n#define ALBEDO x\n#define ROUGHNESS y\n#define SHININESS z\n#define SPECULAR_AMT w\n#define NORMAL x\n#define AO y\n#define SPECULAR z\n#define EMISSIVE w\nconst float PI = 3.1415926535897932384626433832795;\nconst float TWO_PI = (2. * PI);\nconst float EIGHT_PI = (8. * PI);\n\n#define RECIPROCAL_PI 1./PI\n#define RECIPROCAL_PI2 RECIPROCAL_PI/2.\n\n// TEXTURES\n// #ifdef HAS_TEXTURES\n    UNI vec4 inTextureIntensities;\n\n    #ifdef HAS_TEXTURE_ENV\n        #ifdef TEX_FORMAT_CUBEMAP\n            UNI samplerCube texEnv;\n            #ifndef WEBGL1\n                #define SAMPLETEX textureLod\n            #endif\n            #ifdef WEBGL1\n                #define SAMPLETEX textureCubeLodEXT\n            #endif\n        #endif\n\n        #ifdef TEX_FORMAT_EQUIRECT\n            UNI sampler2D texEnv;\n            #ifdef WEBGL1\n                // #extension GL_EXT_shader_texture_lod : enable\n                #ifdef GL_EXT_shader_texture_lod\n                    #define textureLod texture2DLodEXT\n                #endif\n                // #define textureLod texture2D\n            #endif\n\n            #define SAMPLETEX sampleEquirect\n\n            const vec2 invAtan = vec2(0.1591, 0.3183);\n            vec4 sampleEquirect(sampler2D tex,vec3 direction,float lod)\n            {\n                #ifndef WEBGL1\n                    vec3 newDirection = normalize(direction);\n            \t\tvec2 sampleUV;\n            \t\tsampleUV.x = -1. * (atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.75);\n            \t\tsampleUV.y = asin( clamp(direction.y, -1., 1.) ) * RECIPROCAL_PI + 0.5;\n                #endif\n\n                #ifdef WEBGL1\n                    vec3 newDirection = normalize(direction);\n                \t\tvec2 sampleUV = vec2(atan(newDirection.z, newDirection.x), asin(newDirection.y+1e-6));\n                        sampleUV *= vec2(0.1591, 0.3183);\n                        sampleUV += 0.5;\n                #endif\n                return textureLod(tex, sampleUV, lod);\n            }\n        #endif\n        #ifdef ENVMAP_MATCAP\n            UNI sampler2D texEnv;\n            #ifdef WEBGL1\n                // #extension GL_EXT_shader_texture_lod : enable\n                #ifdef GL_EXT_shader_texture_lod\n                    #define textureLod texture2DLodEXT\n                #endif\n                // #define textureLod texture2D\n            #endif\n\n\n            // * taken & modified from https://github.com/mrdoob/three.js/blob/dev/src/renderers/shaders/ShaderLib/meshmatcap_frag.glsl.js\n            vec2 getMatCapUV(vec3 viewSpacePosition, vec3 viewSpaceNormal) {\n                vec3 viewDir = normalize(-viewSpacePosition);\n            \tvec3 x = normalize(vec3(viewDir.z, 0.0, - viewDir.x));\n            \tvec3 y = normalize(cross(viewDir, x));\n            \tvec2 uv = vec2(dot(x, viewSpaceNormal), dot(y, viewSpaceNormal)) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n            \treturn uv;\n            }\n        #endif\n\n        UNI float inEnvMapIntensity;\n        UNI float inEnvMapWidth;\n    #endif\n\n    #ifdef HAS_TEXTURE_LUMINANCE_MASK\n        UNI sampler2D texLuminance;\n        UNI float inLuminanceMaskIntensity;\n    #endif\n\n    #ifdef HAS_TEXTURE_DIFFUSE\n        UNI sampler2D texDiffuse;\n    #endif\n\n    #ifdef HAS_TEXTURE_SPECULAR\n        UNI sampler2D texSpecular;\n    #endif\n\n    #ifdef HAS_TEXTURE_NORMAL\n        UNI sampler2D texNormal;\n    #endif\n\n    #ifdef HAS_TEXTURE_AO\n        UNI sampler2D texAO;\n    #endif\n\n    #ifdef HAS_TEXTURE_EMISSIVE\n        UNI sampler2D texEmissive;\n    #endif\n\n    #ifdef HAS_TEXTURE_EMISSIVE_MASK\n        UNI sampler2D texMaskEmissive;\n        UNI float inEmissiveMaskIntensity;\n    #endif\n    #ifdef HAS_TEXTURE_ALPHA\n        UNI sampler2D texAlpha;\n    #endif\n// #endif\n\n{{MODULES_HEAD}}\n\nfloat when_gt(float x, float y) { return max(sign(x - y), 0.0); } // comparator function\nfloat when_lt(float x, float y) { return max(sign(y - x), 0.0); }\nfloat when_eq(float x, float y) { return 1. - abs(sign(x - y)); } // comparator function\nfloat when_neq(float x, float y) { return abs(sign(x - y)); } // comparator function\nfloat when_ge(float x, float y) { return 1.0 - when_lt(x, y); }\nfloat when_le(float x, float y) { return 1.0 - when_gt(x, y); }\n\n#ifdef FALLOFF_MODE_A\n    float CalculateFalloff(float distance, vec3 lightDirection, float falloff, float radius) {\n        // * original falloff\n        float denom = distance / radius + 1.0;\n        float attenuation = 1.0 / (denom*denom);\n        float t = (attenuation - falloff) / (1.0 - falloff);\n        return max(t, 0.0);\n    }\n#endif\n\n#ifdef FALLOFF_MODE_B\n    float CalculateFalloff(float distance, vec3 lightDirection, float falloff, float radius) {\n        float distanceSquared = dot(lightDirection, lightDirection);\n        float factor = distanceSquared * falloff;\n        float smoothFactor = clamp(1. - factor * factor, 0., 1.);\n        float attenuation = smoothFactor * smoothFactor;\n\n        return attenuation * 1. / max(distanceSquared, 0.00001);\n    }\n#endif\n\n#ifdef FALLOFF_MODE_C\n    float CalculateFalloff(float distance, vec3 lightDirection, float falloff, float radius) {\n        // https://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf\n        float falloffNumerator = 1. - pow(distance/radius, 4.);\n        falloffNumerator = clamp(falloffNumerator, 0., 1.);\n        falloffNumerator *= falloffNumerator;\n\n        float denominator = distance*distance + falloff;\n\n        return falloffNumerator/denominator;\n    }\n#endif\n\n#ifdef FALLOFF_MODE_D\n    float CalculateFalloff(float distance, vec3 lightDirection, float falloff, float radius) {\n        // inverse square falloff, "physically correct"\n        return 1.0 / max(distance * distance, 0.0001);\n    }\n#endif\n\n#ifdef ENABLE_FRESNEL\n    float CalculateFresnel(vec3 direction, vec3 normal)\n    {\n        vec3 nDirection = normalize( direction );\n        vec3 nNormal = normalize( mat3(viewMatrix) * normal );\n        vec3 halfDirection = normalize( nNormal + nDirection );\n\n        float cosine = dot( halfDirection, nDirection );\n        float product = max( cosine, 0.0 );\n        float factor = pow(product, inFresnelWidthExponent.y);\n\n        return 5. * factor;\n    }\n#endif\n\n#ifdef CONSERVE_ENERGY\n    // http://www.rorydriscoll.com/2009/01/25/energy-conservation-in-games/\n    // http://www.farbrausch.de/~fg/articles/phong.pdf\n    float EnergyConservation(float shininess) {\n        #ifdef SPECULAR_PHONG\n            return (shininess + 2.)/TWO_PI;\n        #endif\n        #ifdef SPECULAR_BLINN\n            return (shininess + 8.)/EIGHT_PI;\n        #endif\n\n        #ifdef SPECULAR_SCHLICK\n            return (shininess + 8.)/EIGHT_PI;\n        #endif\n\n        #ifdef SPECULAR_GAUSS\n            return (shininess + 8.)/EIGHT_PI;\n        #endif\n    }\n#endif\n\n#ifdef ENABLE_OREN_NAYAR_DIFFUSE\n    float CalculateOrenNayar(vec3 lightDirection, vec3 viewDirection, vec3 normal) {\n        float LdotV = dot(lightDirection, viewDirection);\n        float NdotL = dot(lightDirection, normal);\n        float NdotV = dot(normal, viewDirection);\n\n        float albedo = inMaterialProperties.ALBEDO;\n        albedo *= 1.8;\n        float s = LdotV - NdotL * NdotV;\n        float t = mix(1., max(NdotL, NdotV), step(0., s));\n\n        float roughness = inMaterialProperties.ROUGHNESS;\n        float sigma2 = roughness * roughness;\n        float A = 1. + sigma2 * (albedo / (sigma2 + 0.13) + 0.5 / (sigma2 + 0.33));\n        float B = 0.45 * sigma2 / (sigma2 + 0.09);\n\n        float factor = albedo * max(0., NdotL) * (A + B * s / t) / PI;\n\n        return factor;\n\n    }\n#endif\n\nvec3 CalculateDiffuseColor(\n    vec3 lightDirection,\n    vec3 viewDirection,\n    vec3 normal,\n    vec3 lightColor,\n    vec3 materialColor,\n    inout float lambert\n) {\n    #ifndef ENABLE_OREN_NAYAR_DIFFUSE\n        lambert = clamp(dot(lightDirection, normal), 0., 1.);\n    #endif\n\n    #ifdef ENABLE_OREN_NAYAR_DIFFUSE\n        lambert = CalculateOrenNayar(lightDirection, viewDirection, normal);\n    #endif\n\n    vec3 diffuseColor = lambert * lightColor * materialColor;\n    return diffuseColor;\n}\n\nvec3 CalculateSpecularColor(\n    vec3 specularColor,\n    float specularCoefficient,\n    float shininess,\n    vec3 lightDirection,\n    vec3 viewDirection,\n    vec3 normal,\n    float lambertian\n) {\n    vec3 resultColor = vec3(0.);\n\n    #ifdef SPECULAR_PHONG\n        vec3 reflectDirection = reflect(-lightDirection, normal);\n        float specularAngle = max(dot(reflectDirection, viewDirection), 0.);\n        float specularFactor = pow(specularAngle, max(0., shininess));\n    resultColor = lambertian * specularFactor * specularCoefficient * specularColor;\n    #endif\n\n    #ifdef SPECULAR_BLINN\n        vec3 halfDirection = normalize(lightDirection + viewDirection);\n        float specularAngle = max(dot(halfDirection, normal), 0.);\n        float specularFactor = pow(specularAngle, max(0., shininess));\n        resultColor = lambertian * specularFactor * specularCoefficient * specularColor;\n    #endif\n\n    #ifdef SPECULAR_SCHLICK\n        vec3 halfDirection = normalize(lightDirection + viewDirection);\n        float specularAngle = dot(halfDirection, normal);\n        float schlickShininess = max(0., shininess);\n        float specularFactor = specularAngle / (schlickShininess - schlickShininess*specularAngle + specularAngle);\n        resultColor = lambertian * specularFactor * specularCoefficient * specularColor;\n    #endif\n\n    #ifdef SPECULAR_GAUSS\n        vec3 halfDirection = normalize(lightDirection + viewDirection);\n        float specularAngle = acos(max(dot(halfDirection, normal), 0.));\n        float exponent = specularAngle * shininess * 0.17;\n        exponent = -(exponent*exponent);\n        float specularFactor = exp(exponent);\n\n        resultColor = lambertian * specularFactor * specularCoefficient * specularColor;\n    #endif\n\n    #ifdef CONSERVE_ENERGY\n        float conserveEnergyFactor = EnergyConservation(shininess);\n        resultColor = conserveEnergyFactor * resultColor;\n    #endif\n\n    return resultColor;\n}\n\n#ifdef HAS_SPOT\n    float CalculateSpotLightEffect(vec3 lightPosition, vec3 conePointAt, float cosConeAngle, float cosConeAngleInner, float spotExponent, vec3 lightDirection) {\n        vec3 spotLightDirection = normalize(lightPosition-conePointAt);\n        float spotAngle = dot(-lightDirection, spotLightDirection);\n        float epsilon = cosConeAngle - cosConeAngleInner;\n\n        float spotIntensity = clamp((spotAngle - cosConeAngle)/epsilon, 0.0, 1.0);\n        spotIntensity = pow(spotIntensity, max(0.01, spotExponent));\n\n        return max(0., spotIntensity);\n    }\n#endif\n\n\n\n{{PHONG_FRAGMENT_HEAD}}\n\n\nvoid main()\n{\n    {{MODULE_BEGIN_FRAG}}\n\n    vec4 col=vec4(0., 0., 0., inDiffuseColor.a);\n    vec3 calculatedColor = vec3(0.);\n    vec3 normal = normalize(normInterpolated);\n    vec3 baseColor = inDiffuseColor.rgb;\n\n    {{MODULE_BASE_COLOR}}\n\n\n    vec3 viewDirection = normalize(v_viewDirection);\n\n    #ifdef DOUBLE_SIDED\n        if(!gl_FrontFacing) normal = normal * -1.0;\n    #endif\n\n    #ifdef HAS_TEXTURES\n        #ifdef HAS_TEXTURE_DIFFUSE\n            baseColor = texture(texDiffuse, texCoord).rgb;\n\n            #ifdef COLORIZE_TEXTURE\n                baseColor *= inDiffuseColor.rgb;\n            #endif\n        #endif\n\n        #ifdef HAS_TEXTURE_NORMAL\n            normal = texture(texNormal, texCoord).rgb;\n            normal = normalize(normal * 2. - 1.);\n            float normalIntensity = inTextureIntensities.NORMAL;\n            normal = normalize(mix(vec3(0., 0., 1.), normal, 2. * normalIntensity));\n            normal = normalize(TBN_Matrix * normal);\n        #endif\n    #endif\n\n    {{PHONG_FRAGMENT_BODY}}\n\n\n\n\n\n\n    #ifdef ENABLE_FRESNEL\n        calculatedColor += inFresnel.rgb * (CalculateFresnel(vec3(cameraSpace_pos), normal) * inFresnel.w * inFresnelWidthExponent.x);\n    #endif\n\n     #ifdef HAS_TEXTURE_ALPHA\n        #ifdef ALPHA_MASK_ALPHA\n            col.a*=texture(texAlpha,texCoord).a;\n        #endif\n        #ifdef ALPHA_MASK_LUMI\n            col.a*= dot(vec3(0.2126,0.7152,0.0722), texture(texAlpha,texCoord).rgb);\n        #endif\n        #ifdef ALPHA_MASK_R\n            col.a*=texture(texAlpha,texCoord).r;\n        #endif\n        #ifdef ALPHA_MASK_G\n            col.a*=texture(texAlpha,texCoord).g;\n        #endif\n        #ifdef ALPHA_MASK_B\n            col.a*=texture(texAlpha,texCoord).b;\n        #endif\n    #endif\n\n    #ifdef DISCARDTRANS\n        if(col.a<0.2) discard;\n    #endif\n\n\n    #ifdef HAS_TEXTURE_ENV\n        vec3 luminanceColor = vec3(0.);\n\n        #ifndef ENVMAP_MATCAP\n            float environmentMapWidth = inEnvMapWidth;\n            float glossyExponent = inMaterialProperties.SHININESS;\n            float glossyCoefficient = inMaterialProperties.SPECULAR_AMT;\n\n            vec3 envMapNormal =  normal;\n            vec3 reflectDirection = reflect(normalize(-viewDirection), normal);\n\n            float lambertianCoefficient = dot(viewDirection, reflectDirection); //0.44; // TODO: need prefiltered map for this\n            // lambertianCoefficient = 1.;\n            float specularAngle = max(dot(reflectDirection, viewDirection), 0.);\n            float specularFactor = pow(specularAngle, max(0., inMaterialProperties.SHININESS));\n\n            glossyExponent = specularFactor;\n\n            float maxMIPLevel = 10.;\n            float MIPlevel = log2(environmentMapWidth / 1024. * sqrt(3.)) - 0.5 * log2(glossyExponent + 1.);\n\n            luminanceColor = inEnvMapIntensity * (\n                inDiffuseColor.rgb *\n                SAMPLETEX(texEnv, envMapNormal, maxMIPLevel).rgb\n                +\n                glossyCoefficient * SAMPLETEX(texEnv, reflectDirection, MIPlevel).rgb\n            );\n        #endif\n        #ifdef ENVMAP_MATCAP\n            luminanceColor = inEnvMapIntensity * (\n                texture(texEnv, getMatCapUV(viewSpacePosition, viewSpaceNormal)).rgb\n                //inDiffuseColor.rgb\n                //* textureLod(texEnv, getMatCapUV(envMapNormal), maxMIPLevel).rgb\n                //+\n                //glossyCoefficient * textureLod(texEnv, getMatCapUV(reflectDirection), MIPlevel).rgb\n            );\n        #endif\n\n\n\n        #ifdef HAS_TEXTURE_LUMINANCE_MASK\n            luminanceColor *= texture(texLuminance, texCoord).r * inLuminanceMaskIntensity;\n        #endif\n\n        #ifdef HAS_TEXTURE_AO\n            // luminanceColor *= mix(vec3(1.), texture(texAO, texCoord).rgb, inTextureIntensities.AO);\n            luminanceColor *= texture(texAO, texCoord).g*inTextureIntensities.AO;\n        #endif\n\n        #ifdef ENV_BLEND_ADD\n            calculatedColor.rgb += luminanceColor;\n        #endif\n        #ifdef ENV_BLEND_MUL\n            calculatedColor.rgb *= luminanceColor;\n        #endif\n\n        #ifdef ENV_BLEND_MIX\n            calculatedColor.rgb=mix(luminanceColor,calculatedColor.rgb,luminanceColor);\n        #endif\n\n\n    #endif\n\n    #ifdef ADD_EMISSIVE_COLOR\n        vec3 emissiveRadiance = mix(calculatedColor, inEmissiveColor.rgb, inEmissiveColor.w); // .w = intensity of color;\n\n        #ifdef HAS_TEXTURE_EMISSIVE\n            float emissiveIntensity = inTextureIntensities.EMISSIVE;\n            emissiveRadiance = mix(calculatedColor, texture(texEmissive, texCoord).rgb, emissiveIntensity);\n        #endif\n\n        #ifdef HAS_TEXTURE_EMISSIVE_MASK\n           float emissiveMixValue = mix(1., texture(texMaskEmissive, texCoord).r, inEmissiveMaskIntensity);\n           calculatedColor = mix(calculatedColor, emissiveRadiance, emissiveMixValue);\n        #endif\n\n        #ifndef HAS_TEXTURE_EMISSIVE_MASK\n            calculatedColor = emissiveRadiance;\n        #endif\n    #endif\n\n    col.rgb = clamp(calculatedColor, 0., 1.);\n\n\n    {{MODULE_COLOR}}\n\n    outColor = col;\n}\n',phong_vert:"\n{{MODULES_HEAD}}\n\n#define NONE -1\n#define AMBIENT 0\n#define POINT 1\n#define DIRECTIONAL 2\n#define SPOT 3\n\n#define TEX_REPEAT_X x;\n#define TEX_REPEAT_Y y;\n#define TEX_OFFSET_X z;\n#define TEX_OFFSET_Y w;\n\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN float attrVertIndex;\nIN vec3 attrTangent;\nIN vec3 attrBiTangent;\n\nOUT vec2 texCoord;\nOUT vec3 normInterpolated;\nOUT vec3 fragPos;\n\n#ifdef HAS_TEXTURE_NORMAL\n    OUT mat3 TBN_Matrix; // tangent bitangent normal space transform matrix\n#endif\n\n#ifdef ENABLE_FRESNEL\n    OUT vec4 cameraSpace_pos;\n#endif\n\nOUT vec3 v_viewDirection;\nOUT mat3 normalMatrix;\nOUT mat4 mvMatrix;\n\n#ifdef HAS_TEXTURES\n    UNI vec4 inTextureRepeatOffset;\n#endif\n\nUNI vec3 camPos;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\n#ifdef ENVMAP_MATCAP\n    OUT vec3 viewSpaceNormal;\n    OUT vec3 viewSpacePosition;\n#endif\n\n\nmat3 transposeMat3(mat3 m)\n{\n    return mat3(m[0][0], m[1][0], m[2][0],\n        m[0][1], m[1][1], m[2][1],\n        m[0][2], m[1][2], m[2][2]);\n}\n\nmat3 inverseMat3(mat3 m)\n{\n    float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n    float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n    float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n    float b01 = a22 * a11 - a12 * a21;\n    float b11 = -a22 * a10 + a12 * a20;\n    float b21 = a21 * a10 - a11 * a20;\n\n    float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n    return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n        b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n        b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nvoid main()\n{\n    mat4 mMatrix=modelMatrix;\n    vec4 pos=vec4(vPosition,  1.0);\n\n    texCoord=attrTexCoord;\n    texCoord.y = 1. - texCoord.y;\n    vec3 norm=attrVertNormal;\n\n    vec3 tangent = attrTangent;\n    vec3 bitangent = attrBiTangent;\n\n    {{MODULE_VERTEX_POSITION}}\n\n    normalMatrix = transposeMat3(inverseMat3(mat3(mMatrix)));\n    mvMatrix = (viewMatrix * mMatrix);\n\n\n\n    #ifdef ENABLE_FRESNEL\n        cameraSpace_pos = mvMatrix * pos;\n    #endif\n\n    #ifdef HAS_TEXTURES\n        float repeatX = inTextureRepeatOffset.TEX_REPEAT_X;\n        float offsetX = inTextureRepeatOffset.TEX_OFFSET_X;\n        float repeatY = inTextureRepeatOffset.TEX_REPEAT_Y;\n        float offsetY = inTextureRepeatOffset.TEX_OFFSET_Y;\n\n        texCoord.x *= repeatX;\n        texCoord.x += offsetX;\n        texCoord.y *= repeatY;\n        texCoord.y += offsetY;\n    #endif\n\n   normInterpolated = vec3(normalMatrix*norm);\n\n    #ifdef HAS_TEXTURE_NORMAL\n        vec3 normCameraSpace = normalize((vec4(normInterpolated, 0.0)).xyz);\n        vec3 tangCameraSpace = normalize((mMatrix * vec4(tangent, 0.0)).xyz);\n        vec3 bitangCameraSpace = normalize((mMatrix * vec4(bitangent, 0.0)).xyz);\n\n        // re orthogonalization for smoother normals\n        tangCameraSpace = normalize(tangCameraSpace - dot(tangCameraSpace, normCameraSpace) * normCameraSpace);\n        bitangCameraSpace = cross(normCameraSpace, tangCameraSpace);\n\n        TBN_Matrix = mat3(tangCameraSpace, bitangCameraSpace, normCameraSpace);\n    #endif\n\n    fragPos = vec3((mMatrix) * pos);\n    v_viewDirection = normalize(camPos - fragPos);\n    // modelPos=mMatrix*pos;\n\n    #ifdef ENVMAP_MATCAP\n        mat3 viewSpaceNormalMatrix = normalMatrix = transposeMat3(inverseMat3(mat3(mvMatrix)));\n        viewSpaceNormal = normalize(viewSpaceNormalMatrix * norm);\n        viewSpacePosition = vec3(mvMatrix * pos);\n    #endif\n    gl_Position = projMatrix * mvMatrix * pos;\n}\n",snippet_body_ambient_frag:"    // * AMBIENT LIGHT {{LIGHT_INDEX}} *\n    vec3 diffuseColor{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.lightProperties.INTENSITY*phongLight{{LIGHT_INDEX}}.color;\n    calculatedColor += diffuseColor{{LIGHT_INDEX}};\n",snippet_body_directional_frag:"    // * DIRECTIONAL LIGHT {{LIGHT_INDEX}} *\n\n    if (phongLight{{LIGHT_INDEX}}.castLight == 1) {\n        vec3 phongLightDirection{{LIGHT_INDEX}} = normalize(phongLight{{LIGHT_INDEX}}.position);\n\n        float phongLambert{{LIGHT_INDEX}} = 1.; // inout variable\n\n        vec3 lightColor{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.color;\n        vec3 lightSpecular{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.specular;\n\n        #ifdef HAS_TEXTURES\n            #ifdef HAS_TEXTURE_AO\n                // lightColor{{LIGHT_INDEX}} *= mix(vec3(1.), texture(texAO, texCoord).rgb, inTextureIntensities.AO);\n                lightColor{{LIGHT_INDEX}} *= texture(texAO, texCoord).g, inTextureIntensities.AO;\n\n            #endif\n\n            #ifdef HAS_TEXTURE_SPECULAR\n                lightSpecular{{LIGHT_INDEX}} *= mix(1., texture(texSpecular, texCoord).r, inTextureIntensities.SPECULAR);\n            #endif\n        #endif\n\n        vec3 diffuseColor{{LIGHT_INDEX}} = CalculateDiffuseColor(phongLightDirection{{LIGHT_INDEX}}, viewDirection, normal, lightColor{{LIGHT_INDEX}}, baseColor, phongLambert{{LIGHT_INDEX}});\n        vec3 specularColor{{LIGHT_INDEX}} = CalculateSpecularColor(\n            lightSpecular{{LIGHT_INDEX}},\n            inMaterialProperties.SPECULAR_AMT,\n            inMaterialProperties.SHININESS,\n            phongLightDirection{{LIGHT_INDEX}},\n            viewDirection,\n            normal,\n            phongLambert{{LIGHT_INDEX}}\n        );\n\n        vec3 combinedColor{{LIGHT_INDEX}} = (diffuseColor{{LIGHT_INDEX}} + specularColor{{LIGHT_INDEX}});\n\n        vec3 lightModelDiff{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.position - fragPos.xyz;\n\n        combinedColor{{LIGHT_INDEX}} *= phongLight{{LIGHT_INDEX}}.lightProperties.INTENSITY;\n        calculatedColor += combinedColor{{LIGHT_INDEX}};\n    }",snippet_body_point_frag:"// * POINT LIGHT {{LIGHT_INDEX}} *\n    if (phongLight{{LIGHT_INDEX}}.castLight == 1) {\n        vec3 phongLightDirection{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.position - fragPos.xyz;\n        // * get length before normalization for falloff calculation\n        phongLightDirection{{LIGHT_INDEX}} = normalize(phongLightDirection{{LIGHT_INDEX}});\n        float phongLightDistance{{LIGHT_INDEX}} = length(phongLightDirection{{LIGHT_INDEX}});\n\n        float phongLambert{{LIGHT_INDEX}} = 1.; // inout variable\n\n        vec3 lightColor{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.color;\n        vec3 lightSpecular{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.specular;\n\n        #ifdef HAS_TEXTURES\n            #ifdef HAS_TEXTURE_AO\n                // lightColor{{LIGHT_INDEX}} *= mix(vec3(1.), texture(texAO, texCoord).rgb, inTextureIntensities.AO);\n                lightColor{{LIGHT_INDEX}} *= texture(texAO, texCoord).g, inTextureIntensities.AO;\n\n            #endif\n\n            #ifdef HAS_TEXTURE_SPECULAR\n                lightSpecular{{LIGHT_INDEX}} *= mix(1., texture(texSpecular, texCoord).r, inTextureIntensities.SPECULAR);\n            #endif\n        #endif\n\n        vec3 diffuseColor{{LIGHT_INDEX}} = CalculateDiffuseColor(phongLightDirection{{LIGHT_INDEX}}, viewDirection, normal, lightColor{{LIGHT_INDEX}}, baseColor, phongLambert{{LIGHT_INDEX}});\n        vec3 specularColor{{LIGHT_INDEX}} = CalculateSpecularColor(\n            lightSpecular{{LIGHT_INDEX}},\n            inMaterialProperties.SPECULAR_AMT,\n            inMaterialProperties.SHININESS,\n            phongLightDirection{{LIGHT_INDEX}},\n            viewDirection,\n            normal,\n            phongLambert{{LIGHT_INDEX}}\n        );\n\n        vec3 combinedColor{{LIGHT_INDEX}} = (diffuseColor{{LIGHT_INDEX}} + specularColor{{LIGHT_INDEX}});\n\n        combinedColor{{LIGHT_INDEX}} *= phongLight{{LIGHT_INDEX}}.lightProperties.INTENSITY;\n\n        float attenuation{{LIGHT_INDEX}} = CalculateFalloff(\n            phongLightDistance{{LIGHT_INDEX}},\n            phongLightDirection{{LIGHT_INDEX}},\n            phongLight{{LIGHT_INDEX}}.lightProperties.FALLOFF,\n            phongLight{{LIGHT_INDEX}}.lightProperties.RADIUS\n        );\n\n        attenuation{{LIGHT_INDEX}} *= when_gt(phongLambert{{LIGHT_INDEX}}, 0.);\n        combinedColor{{LIGHT_INDEX}} *= attenuation{{LIGHT_INDEX}};\n\n        calculatedColor += combinedColor{{LIGHT_INDEX}};\n    }\n",snippet_body_spot_frag:"    // * SPOT LIGHT {{LIGHT_INDEX}} *\n    if (phongLight{{LIGHT_INDEX}}.castLight == 1) {\n        vec3 phongLightDirection{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.position - fragPos.xyz;\n        phongLightDirection{{LIGHT_INDEX}} = normalize( phongLightDirection{{LIGHT_INDEX}});\n        float phongLightDistance{{LIGHT_INDEX}} = length(phongLightDirection{{LIGHT_INDEX}});\n\n        float phongLambert{{LIGHT_INDEX}} = 1.; // inout variable\n\n        vec3 lightColor{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.color;\n        vec3 lightSpecular{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.specular;\n\n        #ifdef HAS_TEXTURES\n            #ifdef HAS_TEXTURE_AO\n                // lightColor{{LIGHT_INDEX}} *= mix(vec3(1.), texture(texAO, texCoord).rgb, inTextureIntensities.AO);\n                lightColor{{LIGHT_INDEX}} *= texture(texAO, texCoord).g, inTextureIntensities.AO;\n\n            #endif\n\n            #ifdef HAS_TEXTURE_SPECULAR\n                lightSpecular{{LIGHT_INDEX}} *= mix(1., texture(texSpecular, texCoord).r, inTextureIntensities.SPECULAR);\n            #endif\n        #endif\n\n        vec3 diffuseColor{{LIGHT_INDEX}} = CalculateDiffuseColor(phongLightDirection{{LIGHT_INDEX}}, viewDirection, normal, lightColor{{LIGHT_INDEX}}, baseColor, phongLambert{{LIGHT_INDEX}});\n        vec3 specularColor{{LIGHT_INDEX}} = CalculateSpecularColor(\n            lightSpecular{{LIGHT_INDEX}},\n            inMaterialProperties.SPECULAR_AMT,\n            inMaterialProperties.SHININESS,\n            phongLightDirection{{LIGHT_INDEX}},\n            viewDirection,\n            normal,\n            phongLambert{{LIGHT_INDEX}}\n        );\n\n        vec3 combinedColor{{LIGHT_INDEX}} = (diffuseColor{{LIGHT_INDEX}} + specularColor{{LIGHT_INDEX}});\n\n        float spotIntensity{{LIGHT_INDEX}} = CalculateSpotLightEffect(\n            phongLight{{LIGHT_INDEX}}.position, phongLight{{LIGHT_INDEX}}.conePointAt, phongLight{{LIGHT_INDEX}}.spotProperties.COSCONEANGLE,\n            phongLight{{LIGHT_INDEX}}.spotProperties.COSCONEANGLEINNER, phongLight{{LIGHT_INDEX}}.spotProperties.SPOTEXPONENT,\n            phongLightDirection{{LIGHT_INDEX}}\n        );\n\n        combinedColor{{LIGHT_INDEX}} *= spotIntensity{{LIGHT_INDEX}};\n\n        vec3 lightModelDiff{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.position - fragPos.xyz;\n\n        float attenuation{{LIGHT_INDEX}} = CalculateFalloff(\n            phongLightDistance{{LIGHT_INDEX}},\n            phongLightDirection{{LIGHT_INDEX}},\n            phongLight{{LIGHT_INDEX}}.lightProperties.FALLOFF,\n            phongLight{{LIGHT_INDEX}}.lightProperties.RADIUS\n        );\n\n        attenuation{{LIGHT_INDEX}} *= when_gt(phongLambert{{LIGHT_INDEX}}, 0.);\n\n        combinedColor{{LIGHT_INDEX}} *= attenuation{{LIGHT_INDEX}};\n\n        combinedColor{{LIGHT_INDEX}} *= phongLight{{LIGHT_INDEX}}.lightProperties.INTENSITY;\n        calculatedColor += combinedColor{{LIGHT_INDEX}};\n    }",snippet_head_frag:"UNI Light phongLight{{LIGHT_INDEX}};\n"};const t=e.patch.cgl;const n=s.snippet_head_frag;const a={point:s.snippet_body_point_frag,spot:s.snippet_body_spot_frag,ambient:s.snippet_body_ambient_frag,directional:s.snippet_body_directional_frag,area:s.snippet_body_area_frag};const r=new RegExp("{{LIGHT_INDEX}}","g");const l=e=>{return n.replace("{{LIGHT_INDEX}}",e)};const c=(e,t)=>{return a[t].replace(r,e)};function o(){const e=s.phong_vert;let t=s.phong_frag;let n="";let a="";n=n.concat(l(0));a=a.concat(c(0,rt[0].type));t=t.replace(me,n);t=t.replace(ve,a);ge.setSource(e,t);ge.define("HAS_POINT");ge.removeDefine("HAS_SPOT");ge.removeDefine("HAS_DIRECTIONAL");ge.removeDefine("HAS_AMBIENT")}const i=e.inTrigger("Trigger In");const u=e.inFloat("R",Math.random());const _=e.inFloat("G",Math.random());const d=e.inFloat("B",Math.random());const p=e.inFloatSlider("A",1);const g=[u,_,d,p];e.setPortGroup("Diffuse Color",g);const f=e.inBool("Enable",false);const m=e.inFloatSlider("Albedo",.707);const v=e.inFloatSlider("Roughness",.835);f.setUiAttribs({hidePort:true});m.setUiAttribs({greyout:true});v.setUiAttribs({greyout:true});u.setUiAttribs({colorPick:true});e.setPortGroup("Oren-Nayar Diffuse",[f,m,v]);f.onChange=function(){ge.toggleDefine("ENABLE_OREN_NAYAR_DIFFUSE",f);m.setUiAttribs({greyout:!f.get()});v.setUiAttribs({greyout:!f.get()})};const h=e.inValueBool("Active",false);h.setUiAttribs({hidePort:true});const b=e.inValueSlider("Fresnel Intensity",.7);const x=e.inFloat("Fresnel Width",1);const O=e.inFloat("Fresnel Exponent",6);const I=e.inFloat("Fresnel R",1);const y=e.inFloat("Fresnel G",1);const T=e.inFloat("Fresnel B",1);I.setUiAttribs({colorPick:true});const A=[b,x,O,I,y,T];A.forEach(function(e){e.setUiAttribs({greyout:true})});e.setPortGroup("Fresnel",A.concat([h]));let S=null;let C=null;h.onChange=function(){ge.toggleDefine("ENABLE_FRESNEL",h);if(h.get()){if(!S)S=new CGL.Uniform(ge,"4f","inFresnel",I,y,T,b);if(!C)C=new CGL.Uniform(ge,"2f","inFresnelWidthExponent",x,O)}else{if(S){ge.removeUniform("inFresnel");S=null}if(C){ge.removeUniform("inFresnelWidthExponent");C=null}}A.forEach(function(e){e.setUiAttribs({greyout:!h.get()})})};const E=e.inBool("Emissive Active",false);const M=e.inFloatSlider("Color Intensity",.3);const N=e.inFloatSlider("Emissive R",Math.random());const L=e.inFloatSlider("Emissive G",Math.random());const w=e.inFloatSlider("Emissive B",Math.random());N.setUiAttribs({colorPick:true});e.setPortGroup("Emissive Color",[E,M,N,L,w]);M.setUiAttribs({greyout:!E.get()});N.setUiAttribs({greyout:!E.get()});L.setUiAttribs({greyout:!E.get()});w.setUiAttribs({greyout:!E.get()});let P=null;E.onChange=()=>{ge.toggleDefine("ADD_EMISSIVE_COLOR",E);if(E.get()){P=new CGL.Uniform(ge,"4f","inEmissiveColor",N,L,w,M);Y.setUiAttribs({greyout:false});W.setUiAttribs({greyout:false});if(Y.get())oe.setUiAttribs({greyout:false});if(W.get())ie.setUiAttribs({greyout:false})}else{e.log("ayayay");Y.setUiAttribs({greyout:true});W.setUiAttribs({greyout:true});oe.setUiAttribs({greyout:true});ie.setUiAttribs({greyout:true});ge.removeUniform("inEmissiveColor");P=null}if(Y.get()){M.setUiAttribs({greyout:true});N.setUiAttribs({greyout:true});L.setUiAttribs({greyout:true});w.setUiAttribs({greyout:true})}else{if(E.get()){M.setUiAttribs({greyout:false});N.setUiAttribs({greyout:false});L.setUiAttribs({greyout:false});w.setUiAttribs({greyout:false})}else{M.setUiAttribs({greyout:true});N.setUiAttribs({greyout:true});L.setUiAttribs({greyout:true});w.setUiAttribs({greyout:true})}}};const D=e.inFloat("Shininess",4);const R=e.inFloatSlider("Specular Amount",.5);const U=e.inSwitch("Specular Model",["Blinn","Schlick","Phong","Gauss"],"Blinn");U.setUiAttribs({hidePort:true});const j=[D,R,U];e.setPortGroup("Specular",j);const G=e.inValueBool("Energy Conservation",false);const V=e.inBool("Double Sided Material",false);const k=e.inSwitch("Falloff Mode",["A","B","C","D"],"A");G.setUiAttribs({hidePort:true});V.setUiAttribs({hidePort:true});k.setUiAttribs({hidePort:true});k.onChange=()=>{const e=["A","B","C","D"];ge.define("FALLOFF_MODE_"+k.get());e.filter(e=>{return e!==k.get()}).forEach(e=>{return ge.removeDefine("FALLOFF_MODE_"+e)})};const B=[G,V,k];e.setPortGroup("Light Options",B);const z=e.inTexture("Diffuse Texture");const F=e.inTexture("Specular Texture");const X=e.inTexture("Normal Map");const H=e.inTexture("AO Texture");const Y=e.inTexture("Emissive Texture");const W=e.inTexture("Emissive Mask");const q=e.inTexture("Opacity Texture");const $=e.inTexture("Environment Map");const K=e.inTexture("Env Map Mask");e.setPortGroup("Textures",[z,F,X,H,Y,W,q,$,K]);const Z=e.inBool("Colorize Texture",false);const Q=e.inFloat("Diffuse Repeat X",1);const J=e.inFloat("Diffuse Repeat Y",1);const ee=e.inFloat("Texture Offset X",0);const te=e.inFloat("Texture Offset Y",0);const ne=e.inFloatSlider("Specular Intensity",1);const ae=e.inFloatSlider("Normal Map Intensity",.5);const re=e.inFloatSlider("AO Intensity",1);const oe=e.inFloatSlider("Emissive Intensity",1);const ie=e.inFloatSlider("Emissive Mask Intensity",1);const se=e.inFloatSlider("Env Map Intensity",1);const le=e.inSwitch("Env Map Blend",["Add","Multiply","Mix"],"Add");const ce=e.inFloatSlider("Env Mask Intensity",1);Z.setUiAttribs({hidePort:true});e.setPortGroup("Texture Transforms",[Z,J,Q,te,ee]);e.setPortGroup("Texture Intensities",[ae,re,ne,oe,le,ie,se,ce]);const ue=e.inSwitch("Alpha Mask Source",["Luminance","R","G","B","A"],"Luminance");ue.setUiAttribs({greyout:true});const _e=e.inValueBool("Discard Transparent Pixels");_e.setUiAttribs({hidePort:true});e.setPortGroup("Opacity Texture",[ue,_e]);const de=e.outTrigger("Trigger Out");const pe=e.outObject("Shader",null,"shader");pe.ignoreValueSerialize=true;const ge=new CGL.Shader(t,"phongmaterial_"+e.id);ge.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG","MODULE_BASE_COLOR"]);ge.setSource(s.simosphong_vert,s.simosphong_frag);let fe=false;ge.define("FALLOFF_MODE_A");if(t.glVersion<2){ge.enableExtension("GL_OES_standard_derivatives");if(t.gl.getExtension("OES_texture_float"))ge.enableExtension("GL_OES_texture_float");else e.log("error loading extension OES_texture_float");if(t.gl.getExtension("OES_texture_float_linear"))ge.enableExtension("GL_OES_texture_float_linear");else e.log("error loading extention OES_texture_float_linear");if(t.gl.getExtension("GL_OES_texture_half_float"))ge.enableExtension("GL_OES_texture_half_float");else e.log("error loading extention GL_OES_texture_half_float");if(t.gl.getExtension("GL_OES_texture_half_float_linear"))ge.enableExtension("GL_OES_texture_half_float_linear");else e.log("error loading extention GL_OES_texture_half_float_linear")}const me=new RegExp("{{PHONG_FRAGMENT_HEAD}}","g");const ve=new RegExp("{{PHONG_FRAGMENT_BODY}}","g");const he={directional:false,spot:false,ambient:false,point:false};function be(t){let e=s.phong_frag;let n="";let a="";he.directional=false;he.spot=false;he.ambient=false;he.point=false;for(let e=0;e<t.length;e+=1){const r=t[e];const o=r.type;if(!he[o]){he[o]=true}n=n.concat(l(e));a=a.concat(c(e,r.type))}e=e.replace(me,n);e=e.replace(ve,a);ge.setSource(s.phong_vert,e);for(let e=0,t=Object.keys(he);e<t.length;e+=1){const i=t[e];if(he[i]){if(!ge.hasDefine("HAS_"+i.toUpperCase())){ge.define("HAS_"+i.toUpperCase())}}else{if(ge.hasDefine("HAS_"+i.toUpperCase())){ge.removeDefine("HAS_"+i.toUpperCase())}}}}pe.set(ge);let xe=null;let Oe=null;let Ie=null;let ye=null;let Te=null;let Ae=null;let Se=null;let Ce=null;let Ee=null;let Me=null;let Ne=null;let Le=null;let we=null;Z.onChange=function(){ge.toggleDefine("COLORIZE_TEXTURE",Z.get())};function Pe(){if(z.get()){if(!ge.hasDefine("HAS_TEXTURE_DIFFUSE")){ge.define("HAS_TEXTURE_DIFFUSE");if(!xe)xe=new CGL.Uniform(ge,"t","texDiffuse",0)}}else{ge.removeUniform("texDiffuse");ge.removeDefine("HAS_TEXTURE_DIFFUSE");xe=null}}function De(){if(F.get()){ne.setUiAttribs({greyout:false});if(!ge.hasDefine("HAS_TEXTURE_SPECULAR")){ge.define("HAS_TEXTURE_SPECULAR");if(!Oe)Oe=new CGL.Uniform(ge,"t","texSpecular",0)}}else{ne.setUiAttribs({greyout:true});ge.removeUniform("texSpecular");ge.removeDefine("HAS_TEXTURE_SPECULAR");Oe=null}}function Re(){if(X.get()){ae.setUiAttribs({greyout:false});if(!ge.hasDefine("HAS_TEXTURE_NORMAL")){ge.define("HAS_TEXTURE_NORMAL");if(!Ie)Ie=new CGL.Uniform(ge,"t","texNormal",0)}}else{ae.setUiAttribs({greyout:true});ge.removeUniform("texNormal");ge.removeDefine("HAS_TEXTURE_NORMAL");Ie=null}}ye=new CGL.Uniform(ge,"t","texAO");function Ue(){ge.toggleDefine("HAS_TEXTURE_AO",H.get());re.setUiAttribs({greyout:!H.get()})}function je(){if(Y.get()){N.setUiAttribs({greyout:true});L.setUiAttribs({greyout:true});w.setUiAttribs({greyout:true});M.setUiAttribs({greyout:true});if(E.get()){oe.setUiAttribs({greyout:false})}if(!ge.hasDefine("HAS_TEXTURE_EMISSIVE")){ge.define("HAS_TEXTURE_EMISSIVE");if(!Te)Te=new CGL.Uniform(ge,"t","texEmissive",0)}}else{oe.setUiAttribs({greyout:true});if(E.get()){N.setUiAttribs({greyout:false});L.setUiAttribs({greyout:false});w.setUiAttribs({greyout:false});M.setUiAttribs({greyout:false})}else{Y.setUiAttribs({greyout:true})}ge.removeUniform("texEmissive");ge.removeDefine("HAS_TEXTURE_EMISSIVE");Te=null}}function Ge(){if(W.get()){if(E.get()){ie.setUiAttribs({greyout:false})}if(!ge.hasDefine("HAS_TEXTURE_EMISSIVE_MASK")){ge.define("HAS_TEXTURE_EMISSIVE_MASK");if(!Ae)Ae=new CGL.Uniform(ge,"t","texMaskEmissive",0);if(!Se)Se=new CGL.Uniform(ge,"f","inEmissiveMaskIntensity",ie)}}else{if(!E.get()){W.setUiAttribs({greyout:true})}ie.setUiAttribs({greyout:true});ge.removeUniform("texMaskEmissive");ge.removeUniform("inEmissiveMaskIntensity");ge.removeDefine("HAS_TEXTURE_EMISSIVE_MASK");Ae=null;Se=null}}let Ve=false;function ke(){ge.toggleDefine("HAS_TEXTURE_ENV",$.get());se.setUiAttribs({greyout:!$.get()});if($.get()){if(!Ee)Ee=new CGL.Uniform(ge,"t","texEnv",0);ge.toggleDefine("TEX_FORMAT_CUBEMAP",$.get().cubemap);if($.get().cubemap){ge.removeDefine("TEX_FORMAT_EQUIRECT");ge.removeDefine("ENVMAP_MATCAP");if(!Me)Me=new CGL.Uniform(ge,"f","inEnvMapIntensity",se);if(!Ne)Ne=new CGL.Uniform(ge,"f","inEnvMapWidth",$.get().cubemap.width)}else{const e=$.get().width===$.get().height;ge.toggleDefine("TEX_FORMAT_EQUIRECT",!e);ge.toggleDefine("ENVMAP_MATCAP",e);if(!Me)Me=new CGL.Uniform(ge,"f","inEnvMapIntensity",se);if(!Ne)Ne=new CGL.Uniform(ge,"f","inEnvMapWidth",$.get().width)}}else{ge.removeUniform("inEnvMapIntensity");ge.removeUniform("inEnvMapWidth");ge.removeUniform("texEnv");ge.removeDefine("HAS_TEXTURE_ENV");ge.removeDefine("ENVMAP_MATCAP");Ee=null;Me=null}Ve=false}function Be(){if(K.get()){ce.setUiAttribs({greyout:false});if(!Le){ge.define("HAS_TEXTURE_LUMINANCE_MASK");Le=new CGL.Uniform(ge,"t","texLuminance",0);we=new CGL.Uniform(ge,"f","inLuminanceMaskIntensity",ce)}}else{ce.setUiAttribs({greyout:true});ge.removeDefine("HAS_TEXTURE_LUMINANCE_MASK");ge.removeUniform("inLuminanceMaskIntensity");ge.removeUniform("texLuminance");Le=null;we=null}}function ze(){ge.toggleDefine("ENV_BLEND_ADD",le.get()=="Add");ge.toggleDefine("ENV_BLEND_MUL",le.get()=="Multiply");ge.toggleDefine("ENV_BLEND_MIX",le.get()=="Mix");ge.toggleDefine("ALPHA_MASK_ALPHA",ue.get()=="Alpha Channel");ge.toggleDefine("ALPHA_MASK_LUMI",ue.get()=="Luminance");ge.toggleDefine("ALPHA_MASK_R",ue.get()=="R");ge.toggleDefine("ALPHA_MASK_G",ue.get()=="G");ge.toggleDefine("ALPHA_MASK_B",ue.get()=="B")}le.onChange=ze;ue.onChange=ze;function Fe(){if(q.get()){if(Ce!==null)return;ge.removeUniform("texAlpha");ge.define("HAS_TEXTURE_ALPHA");if(!Ce)Ce=new CGL.Uniform(ge,"t","texAlpha",0);ue.setUiAttribs({greyout:false});_e.setUiAttribs({greyout:false})}else{ge.removeUniform("texAlpha");ge.removeDefine("HAS_TEXTURE_ALPHA");Ce=null;ue.setUiAttribs({greyout:true});_e.setUiAttribs({greyout:true})}ze()}_e.onChange=function(){ge.toggleDefine("DISCARDTRANS",_e.get())};z.onChange=Pe;F.onChange=De;X.onChange=Re;H.onChange=Ue;Y.onChange=je;W.onChange=Ge;q.onChange=Fe;$.onChange=()=>{Ve=true};K.onChange=Be;const Xe=t.maxUniformsFrag;const He=Xe===64?6:16;ge.define("MAX_LIGHTS",He.toString());ge.define("SPECULAR_PHONG");U.onChange=function(){if(U.get()==="Phong"){ge.define("SPECULAR_PHONG");ge.removeDefine("SPECULAR_BLINN");ge.removeDefine("SPECULAR_GAUSS");ge.removeDefine("SPECULAR_SCHLICK")}else if(U.get()==="Blinn"){ge.define("SPECULAR_BLINN");ge.removeDefine("SPECULAR_PHONG");ge.removeDefine("SPECULAR_GAUSS");ge.removeDefine("SPECULAR_SCHLICK")}else if(U.get()==="Gauss"){ge.define("SPECULAR_GAUSS");ge.removeDefine("SPECULAR_BLINN");ge.removeDefine("SPECULAR_PHONG");ge.removeDefine("SPECULAR_SCHLICK")}else if(U.get()==="Schlick"){ge.define("SPECULAR_SCHLICK");ge.removeDefine("SPECULAR_BLINN");ge.removeDefine("SPECULAR_PHONG");ge.removeDefine("SPECULAR_GAUSS")}};G.onChange=function(){ge.toggleDefine("CONSERVE_ENERGY",G.get())};V.onChange=function(){ge.toggleDefine("DOUBLE_SIDED",V.get())};const Ye=new CGL.Uniform(ge,"4f","inMaterialProperties",m,v,D,R);const We=new CGL.Uniform(ge,"4f","inDiffuseColor",u,_,d,p);const qe=new CGL.Uniform(ge,"4f","inTextureIntensities",ae,re,ne,oe);const $e=new CGL.Uniform(ge,"4f","inTextureRepeatOffset",Q,J,ee,te);ge.uniformColorDiffuse=We;const Ke=[];let Ze=0;function Qe(t){for(let e=0;e<Ke.length;e+=1){Ke[e]=null}for(let e=0;e<t;e+=1){Ke[e]=null;if(!Ke[e]){Ke[e]={color:new CGL.Uniform(ge,"3f","phongLight"+e+".color",[1,1,1]),position:new CGL.Uniform(ge,"3f","phongLight"+e+".position",[0,11,0]),specular:new CGL.Uniform(ge,"3f","phongLight"+e+".specular",[1,1,1]),lightProperties:new CGL.Uniform(ge,"4f","phongLight"+e+".lightProperties",[1,1,1,1]),conePointAt:new CGL.Uniform(ge,"3f","phongLight"+e+".conePointAt",vec3.create()),spotProperties:new CGL.Uniform(ge,"3f","phongLight"+e+".spotProperties",[0,0,0,0]),castLight:new CGL.Uniform(ge,"i","phongLight"+e+".castLight",1)}}}}function Je(e){nt.position.setValue(e.position);nt.color.setValue(e.color);nt.specular.setValue(e.specular);nt.lightProperties.setValue([e.intensity,e.attenuation,e.falloff,e.radius]);nt.conePointAt.setValue(e.conePointAt);nt.spotProperties.setValue([e.cosConeAngle,e.cosConeAngleInner,e.spotExponent])}function et(t){for(let e=0;e<t.length;e+=1){const n=t[e];n.isUsed=true;Ke[e].position.setValue(n.position);Ke[e].color.setValue(n.color);Ke[e].specular.setValue(n.specular);Ke[e].lightProperties.setValue([n.intensity,n.attenuation,n.falloff,n.radius]);Ke[e].conePointAt.setValue(n.conePointAt);Ke[e].spotProperties.setValue([n.cosConeAngle,n.cosConeAngleInner,n.spotExponent]);Ke[e].castLight.setValue(n.castLight)}}function tt(e){if(e.length!==Ze){be(e);Qe(e.length);Ze=e.length;et(e);fe=false}else{if(fe){be(e);Qe(e.length);fe=false}et(e)}}let nt=null;function at(){nt={color:new CGL.Uniform(ge,"3f","phongLight"+0+".color",[1,1,1]),specular:new CGL.Uniform(ge,"3f","phongLight"+0+".specular",[1,1,1]),position:new CGL.Uniform(ge,"3f","phongLight"+0+".position",[0,11,0]),lightProperties:new CGL.Uniform(ge,"4f","phongLight"+0+".lightProperties",[1,1,1,1]),conePointAt:new CGL.Uniform(ge,"3f","phongLight"+0+".conePointAt",vec3.create()),spotProperties:new CGL.Uniform(ge,"3f","phongLight"+0+".spotProperties",[0,0,0,0]),castLight:new CGL.Uniform(ge,"i","phongLight"+0+".castLight",1)}}const rt=[{type:"point",position:[5,5,5],color:[1,1,1],specular:[1,1,1],intensity:1,attenuation:0,falloff:.5,radius:80,castLight:1}];const ot=mat4.create();function it(){if(t.frameStore.lightStack){if(t.frameStore.lightStack.length===0){e.setUiError("deflight","Default light is enabled. Please add lights to your patch to make this warning disappear.",1)}else e.setUiError("deflight",null)}if(!t.frameStore.lightStack||!t.frameStore.lightStack.length){if(!nt){o();at()}mat4.invert(ot,t.vMatrix);rt[0].position=[ot[12],ot[13],ot[14]];Je(rt[0]);Ze=-1}else{if(ge){if(t.frameStore.lightStack){if(t.frameStore.lightStack.length){nt=null;tt(t.frameStore.lightStack)}}}}}const st=function(){if(!ge){e.log("NO SHADER");return}t.pushShader(ge);ge.popTextures();de.trigger();t.popShader()};e.preRender=function(){ge.bind();st()};const lt=mat4.create();const ct=vec3.create();const ut=vec3.create();i.onTriggered=function(){if(!ge){e.log("phong has no shader...");return}if(Ve)ke();t.pushShader(ge);ge.popTextures();if(z.get())ge.pushTexture(xe,z.get());if(F.get())ge.pushTexture(Oe,F.get());if(X.get())ge.pushTexture(Ie,X.get());if(H.get())ge.pushTexture(ye,H.get());if(Y.get())ge.pushTexture(Te,Y.get());if(W.get())ge.pushTexture(Ae,W.get());if(q.get())ge.pushTexture(Ce,q.get());if($.get()){if($.get().cubemap)ge.pushTexture(Ee,$.get().cubemap,t.gl.TEXTURE_CUBE_MAP);else ge.pushTexture(Ee,$.get())}if(K.get()){ge.pushTexture(Le,K.get())}it();de.trigger();t.popShader()};if(t.glVersion==1){if(!t.gl.getExtension("EXT_shader_texture_lod")){e.log("no EXT_shader_texture_lod texture extension")}else{ge.enableExtension("GL_EXT_shader_texture_lod");t.gl.getExtension("OES_texture_float");t.gl.getExtension("OES_texture_float_linear");t.gl.getExtension("OES_texture_half_float");t.gl.getExtension("OES_texture_half_float_linear");ge.enableExtension("GL_OES_standard_derivatives");ge.enableExtension("GL_OES_texture_float");ge.enableExtension("GL_OES_texture_float_linear");ge.enableExtension("GL_OES_texture_half_float");ge.enableExtension("GL_OES_texture_half_float_linear")}}Pe();De();Re();Ue();Fe();je();Ge();ke();Be()};Ops.Gl.Phong.PhongMaterial_v6.prototype=new CABLES.Op;CABLES.OPS["0d83ed06-cdbe-4fe0-87bb-0ccece7fb6e1"]={f:Ops.Gl.Phong.PhongMaterial_v6,objName:"Ops.Gl.Phong.PhongMaterial_v6"};Ops.Gl.ShaderEffects.AreaRotate_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={area_rotate_vert:"\n\nvec4 MOD_scaler(vec4 pos,mat4 modelMatrix)\n{\n    vec3 forcePos=vec3(MOD_x,MOD_y,MOD_z);\n    vec3 vecToOrigin=(modelMatrix*pos).xyz-forcePos;\n    float dist=abs(length(vecToOrigin));\n    float distAlpha = (MOD_size - dist) ;\n\n    if(MOD_smooth) distAlpha=smoothstep(0.0,MOD_size,distAlpha);\n\n    // pos.xyz*=(1.0+(distAlpha*MOD_strength));\n\n    mat3 rotation = mat3(\n        vec3( cos(MOD_strength*distAlpha),  sin(MOD_strength*distAlpha),  0.0),\n        vec3(-sin(MOD_strength*distAlpha),  cos(MOD_strength*distAlpha),  0.0),\n        vec3(        0.0,         0.0,  1.0)\n    );\n    pos =vec4(rotation * pos.xyz, 1.0);\n\n\n    return pos;\n}\n"};const n=e.inTrigger("render"),a=e.inValue("Size",1),r=e.inValue("Strength",1),o=e.inValueBool("Smooth",true),i=e.inValue("x"),s=e.inValue("y"),l=e.inValue("z"),c=e.outTrigger("trigger");const u=e.patch.cgl;const _="".endl()+"pos=MOD_scaler(pos,mMatrix);".endl();const d=new CGL.ShaderModifier(u,e.name);d.addModule({priority:2,title:"vert"+e.name,name:"MODULE_VERTEX_POSITION",srcHeadVert:t.area_rotate_vert,srcBodyVert:_});d.addUniform("f","MOD_x",i);d.addUniform("f","MOD_y",s);d.addUniform("f","MOD_z",l);d.addUniform("f","MOD_size",a);d.addUniform("f","MOD_strength",r);d.addUniform("b","MOD_smooth",o);n.onTriggered=function(){if(!u.getShader()){c.trigger();return}if(e.isCurrentUiOp())gui.setTransformGizmo({posX:i,posY:s,posZ:l});d.bind();c.trigger();d.unbind()}};Ops.Gl.ShaderEffects.AreaRotate_v2.prototype=new CABLES.Op;CABLES.OPS["ebfd3f0c-7a58-44d3-aba0-72d91fafd7ae"]={f:Ops.Gl.ShaderEffects.AreaRotate_v2,objName:"Ops.Gl.ShaderEffects.AreaRotate_v2"};Ops.Gl.ShaderEffects.DeformArea=function(){CABLES.Op.apply(this,arguments);const e=this;const t={deformarea_vert:"vec4 MOD_deform(vec4 pos,mat4 mMatrix)\n{\n    vec4 modelPos=pos;\n\n    #ifdef MOD_WORLDSPACE\n       modelPos=mMatrix*pos;\n    #endif\n\n    vec3 forcePos=vec3(MOD_x,MOD_y,MOD_z);\n    vec3 vecToOrigin=modelPos.xyz-forcePos;\n    float dist=abs(length(vecToOrigin));\n    float distAlpha = (MOD_size - dist) / MOD_size;\n\n    if(MOD_size > dist)\n    {\n        vec3 vecNormal=normalize(vecToOrigin);\n\n        if(MOD_smooth>0.0) distAlpha=smoothstep(0.0,MOD_size,distAlpha);\n\n        vec3 velocity = (vecNormal * distAlpha * MOD_strength );\n\n        pos.xyz+=velocity*0.1;\n    }\n\n    return pos;\n\n}\n"};const n=e.inTrigger("render"),a=e.outTrigger("trigger"),r=e.inValue("Size",1),o=e.inValue("Strength",.5),i=e.inValueBool("Smooth",true),s=e.inValueBool("WorldSpace",false),l=e.inValue("x"),c=e.inValue("y"),u=e.inValue("z");const _=e.patch.cgl;s.onChange=f;const d=t.deformarea_vert;const p="".endl()+"pos=MOD_deform(pos,mMatrix);".endl();const g=new CGL.ShaderModifier(_,e.name);g.addModule({title:e.name,name:"MODULE_VERTEX_POSITION",srcHeadVert:t.deformarea_vert,srcBodyVert:p});g.addUniformVert("f","MOD_size",r);g.addUniformVert("f","MOD_strength",o);g.addUniformVert("f","MOD_smooth",i);g.addUniformVert("f","MOD_x",l);g.addUniformVert("f","MOD_y",c);g.addUniformVert("f","MOD_z",u);n.onTriggered=function(){if(CABLES.UI){if(e.isCurrentUiOp())gui.setTransformGizmo({posX:l,posY:c,posZ:u});if(_.shouldDrawHelpers(e)){_.pushModelMatrix();mat4.translate(_.mMatrix,_.mMatrix,[l.get(),c.get(),u.get()]);CABLES.GL_MARKER.drawSphere(e,r.get());_.popModelMatrix()}}g.bind();a.trigger();g.unbind()};function f(){g.toggleDefine("MOD_WORLDSPACE",s.get())}};Ops.Gl.ShaderEffects.DeformArea.prototype=new CABLES.Op;CABLES.OPS["6c40cfcb-75c8-4c64-bc13-c37faaea73df"]={f:Ops.Gl.ShaderEffects.DeformArea,objName:"Ops.Gl.ShaderEffects.DeformArea"};Ops.Trigger.TriggerIfIncreased=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inFloat("Value"),a=e.outTrigger("Trigger");let r=-Number.MAX_VALUE;n.onChange=function(){const e=n.get();if(e>r){a.trigger()}r=e}};Ops.Trigger.TriggerIfIncreased.prototype=new CABLES.Op;CABLES.OPS["bc820891-48c7-4287-9b5e-4196e192741b"]={f:Ops.Trigger.TriggerIfIncreased,objName:"Ops.Trigger.TriggerIfIncreased"};Ops.Deprecated.Gl.Matrix.CircleTransform=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("render"),i=e.inValueInt("segments",40),s=e.inValueFloat("radius",1),l=e.inValueSlider("percent",1),c=e.inBool("Absolute",true),u=e.inBool("Flip",false),a=e.inValueBool("Rotate"),r=e.outTrigger("trigger"),o=e.outNumber("index");const _=e.patch.cgl;i.set(40);s.set(1);l.set(1);const d=[];u.onChange=c.onChange=i.onChange=s.onChange=l.onChange=f;let p=true;n.onTriggered=g;function g(){if(p)m();const t=a.get();const n=l.get();for(let e=0;e<d.length;e++){_.pushModelMatrix();mat4.translate(_.mMatrix,_.mMatrix,d[e]);if(t)mat4.rotateZ(_.mMatrix,_.mMatrix,e/d.length*n*CGL.DEG2RAD*-360);o.set(e);r.trigger();_.popModelMatrix()}}function f(){p=true}function m(){d.length=0;let e=0,t=0;let n=i.get();if(n<1)n=1;let a=Math.round(n*l.get());let r=360/Math.round(n);if(!c.get()){a=n;r=360/Math.round(n)*l.get()}const o=u.get();for(e=0;e<a;e++){if(o)t=(360-r*e)*CGL.DEG2RAD;else t=r*e*CGL.DEG2RAD;d.push([Math.sin(t)*s.get(),Math.cos(t)*s.get(),0])}p=false}};Ops.Deprecated.Gl.Matrix.CircleTransform.prototype=new CABLES.Op;CABLES.OPS["4e96d5a2-a1ec-4f83-954d-7c34a9021e9c"]={f:Ops.Deprecated.Gl.Matrix.CircleTransform,objName:"Ops.Deprecated.Gl.Matrix.CircleTransform"};Ops.Math.Floor=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValue("Number");const a=e.outNumber("Result");n.onChange=r;function r(){a.set(Math.floor(n.get()))}};Ops.Math.Floor.prototype=new CABLES.Op;CABLES.OPS["0c77617c-b688-4b55-addf-2cbcaabf98af"]={f:Ops.Math.Floor,objName:"Ops.Math.Floor"};Ops.Gl.Matrix.Camera=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("render");const a=e.outTrigger("trigger");const r=e.inValueSelect("projection mode",["prespective","ortogonal"],"prespective");const o=e.inValue("frustum near",.01);const i=e.inValue("frustum far",5e3);const s=e.inValue("fov",45);const l=e.inValueBool("Auto Aspect Ratio",true);const c=e.inValue("Aspect Ratio",1);const u=e.inValue("eye X",0);const _=e.inValue("eye Y",0);const d=e.inValue("eye Z",5);const p=e.inValue("center X",0);const g=e.inValue("center Y",0);const f=e.inValue("center Z",0);const m=e.inValue("truck",0);const v=e.inValue("boom",0);const h=e.inValue("dolly",0);const b=e.inValue("tilt",0);const x=e.inValue("pan",0);const O=e.inValue("roll",0);const I=e.outNumber("Aspect");const y=e.outArray("Look At Array");const T=e.patch.cgl;let A=0;const S=vec3.create();const C=vec3.create();const E=vec3.create();const M=mat4.create();mat4.identity(M);const N=[];const L=vec3.create();const w=mat4.create();mat4.identity(w);let P=true;n.onTriggered=function(){if(T.frameStore.shadowPass)return a.trigger();if(!l.get())A=c.get();else A=T.getViewPort()[2]/T.getViewPort()[3];I.set(A);T.pushViewMatrix();if(P){mat4.identity(w);vec3.set(L,m.get(),v.get(),h.get());if(m.get()!==0||v.get()!==0||h.get()!==0)mat4.translate(w,w,L);if(b.get()!==0)mat4.rotateX(w,w,b.get()*CGL.DEG2RAD);if(x.get()!==0)mat4.rotateY(w,w,x.get()*CGL.DEG2RAD);if(O.get()!==0)mat4.rotateZ(w,w,O.get()*CGL.DEG2RAD);P=false}mat4.multiply(T.vMatrix,T.vMatrix,w);T.pushPMatrix();T.pushViewMatrix();if(r.get()=="prespective"){mat4.perspective(T.pMatrix,s.get()*.0174533,A,o.get(),i.get())}else if(r.get()=="ortogonal"){mat4.ortho(T.pMatrix,-1*(s.get()/14),1*(s.get()/14),-1*(s.get()/14)/A,1*(s.get()/14)/A,o.get(),i.get())}N[0]=u.get();N[1]=_.get();N[2]=d.get();N[3]=p.get();N[4]=g.get();N[5]=f.get();N[6]=0;N[7]=1;N[8]=0;y.set(null);y.set(N);vec3.set(S,0,1,0);vec3.set(C,u.get(),_.get(),d.get());vec3.set(E,p.get(),g.get(),f.get());mat4.lookAt(M,C,E,S);mat4.multiply(T.vMatrix,T.vMatrix,M);a.trigger();T.popViewMatrix();T.popPMatrix();T.popViewMatrix();if(e.isCurrentUiOp())gui.setTransformGizmo({posX:m,posY:v,posZ:h})};const D=function(){if(!l.get()){c.setUiAttribs({greyout:false})}else{c.setUiAttribs({greyout:true})}};const R=function(){P=true};m.onChange=R;v.onChange=R;h.onChange=R;b.onChange=R;x.onChange=R;O.onChange=R;l.onChange=D;D()};Ops.Gl.Matrix.Camera.prototype=new CABLES.Op;CABLES.OPS["b24dbfdc-485c-49d2-92a1-7258efd9239a"]={f:Ops.Gl.Matrix.Camera,objName:"Ops.Gl.Matrix.Camera"};Ops.Gl.ShaderEffects.VertexWobble_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={sinewobble_vert:"\n#ifndef MOD_WORLDSPACE\n   vec4 MOD_vertPos=vec4(vPosition,1.0);\n#endif\n#ifdef MOD_WORLDSPACE\n   vec4 MOD_vertPos=mMatrix*pos;\n#endif\n\n#ifdef MOD_AREA_SPHERE\n    float MOD_de=distance(\n        MOD_posSize.xyz,\n        vec3(MOD_vertPos.x,MOD_vertPos.y,MOD_vertPos.z)\n        );\n#endif\n\n#ifdef MOD_AREA_BOX\n    float MOD_de=0.0;\n    if(abs(MOD_vertPos.y-MOD_posSize.y)>MOD_posSize.w ||\n        abs(MOD_vertPos.x-MOD_posSize.x)>MOD_posSize.w ||\n        abs(MOD_vertPos.z-MOD_posSize.z)>MOD_posSize.w ) MOD_de=1.0;\n#endif\n\n#ifdef MOD_AREA_AXIS_X\n    float MOD_de=abs(MOD_posSize.x-MOD_vertPos.x);\n#endif\n#ifdef MOD_AREA_AXIS_Y\n    float MOD_de=abs(MOD_posSize.y-MOD_vertPos.y);\n#endif\n#ifdef MOD_AREA_AXIS_Z\n    float MOD_de=abs(MOD_posSize.z-MOD_vertPos.z);\n#endif\n\n#ifdef MOD_AREA_AXIS_X_INFINITE\n    float MOD_de=MOD_posSize.x-MOD_vertPos.x;\n#endif\n#ifdef MOD_AREA_AXIS_Y_INFINITE\n    float MOD_de=MOD_posSize.y-MOD_vertPos.y;\n#endif\n#ifdef MOD_AREA_AXIS_Z_INFINITE\n    float MOD_de=MOD_posSize.z-MOD_vertPos.z;\n#endif\n\n#ifndef MOD_AREA_BOX\n    MOD_de=1.0-smoothstep(MOD_falloff,MOD_posSize.w,MOD_de);\n#endif\n\n#ifdef MOD_AREA_INVERT\n    MOD_de=1.0-MOD_de;\n#endif\n\nfloat MOD_v=0.0;\n\n#ifdef MOD_SRC_XZ\n   MOD_v=(MOD_vertPos.x+MOD_vertPos.z);\n#endif\n#ifdef MOD_SRC_XY\n   MOD_v=(MOD_vertPos.x+MOD_vertPos.y);\n#endif\n#ifdef MOD_SRC_X\n   MOD_v=MOD_vertPos.x;\n#endif\n#ifdef MOD_SRC_Y\n   MOD_v=MOD_vertPos.y;\n#endif\n#ifdef MOD_SRC_Z\n   MOD_v=MOD_vertPos.z;\n#endif\n\n\nfloat MOD_amnt=MOD_amount*MOD_de;\n\nMOD_v=sin( (MOD_time)+( MOD_v*MOD_scale  ) ) ;\n#ifdef MOD_POSITIVE\n    MOD_v=(MOD_v+1.0)/2.0;\n#endif\nMOD_v*=MOD_amnt;\n\n\n\n\n#ifdef MOD_TO_AXIS_X\n   pos.x+=MOD_v;\n//   norm.x+=MOD_v;\n#endif\n\n#ifdef MOD_TO_AXIS_Y\n   pos.y+=MOD_v;\n//   norm.y+=MOD_v;\n#endif\n\n#ifdef MOD_TO_AXIS_Z\n   pos.z+=MOD_v;\n//   norm.z+=MOD_v;\n#endif\n\n// norm=normalize(norm);\n\n\n\n\n\n"};let n=this;const a=e.patch.cgl;const r=e.inTrigger("render");let o=e.inValueSelect("Source",["X * Z + Time","X * Y + Time","X + Time","Y + Time","Z + Time"],"X * Z + Time");const i=e.inValueSlider("amount",.1),s=e.inFloat("Time",0),l=e.inValueFloat("Scale",3),c=e.inValueBool("axisX",true),u=e.inValueBool("axisY",true),_=e.inValueBool("axisZ",true),d=e.inSwitch("Range",["-1 to 1","0 to 1"],"-1 to 1"),p=e.inValueSelect("Area",["Sphere","Box","Axis X","Axis Y","Axis Z","Axis X Infinite","Axis Y Infinite","Axis Z Infinite"],"Sphere"),g=e.inValue("Size",1),f=e.inValueSlider("Falloff",0),m=e.inValue("x"),v=e.inValue("y"),h=e.inValue("z"),b=e.inValueBool("WorldSpace",true),x=e.inValueBool("Invert"),O=this.outTrigger("trigger");e.setPortGroup("Area",[p,g,m,v,h,f,b,x]);d.onChange=p.onChange=b.onChange=g.onChange=o.onChange=_.onChange=c.onChange=u.onChange=T;const I="";const y=new CGL.ShaderModifier(a,e.name);y.addModule({title:e.name,name:"MODULE_VERTEX_POSITION",srcHeadVert:I,srcBodyVert:t.sinewobble_vert});y.addUniform("4f","MOD_posSize",m,v,h,g);y.addUniformVert("f","MOD_time",s);y.addUniformVert("f","MOD_amount",i);y.addUniformVert("f","MOD_scale",l);y.addUniformVert("f","MOD_falloff",f);T();function T(){y.toggleDefine("MOD_AREA_INVERT",x.get());y.toggleDefine("MOD_POSITIVE",d.get()=="0 to 1");y.toggleDefine("MOD_WORLDSPACE",b.get());y.toggleDefine("MOD_AREA_AXIS_X",p.get()=="Axis X");y.toggleDefine("MOD_AREA_AXIS_Y",p.get()=="Axis Y");y.toggleDefine("MOD_AREA_AXIS_Z",p.get()=="Axis Z");y.toggleDefine("MOD_AREA_AXIS_X_INFINITE",p.get()=="Axis X Infinite");y.toggleDefine("MOD_AREA_AXIS_Y_INFINITE",p.get()=="Axis Y Infinite");y.toggleDefine("MOD_AREA_AXIS_Z_INFINITE",p.get()=="Axis Z Infinite");y.toggleDefine("MOD_AREA_SPHERE",p.get()=="Sphere");y.toggleDefine("MOD_AREA_BOX",p.get()=="Box");y.toggleDefine("MOD_TO_AXIS_X",c.get());y.toggleDefine("MOD_TO_AXIS_Y",u.get());y.toggleDefine("MOD_TO_AXIS_Z",_.get());y.toggleDefine("MOD_SRC_XZ",!o.get()||o.get()=="X * Z + Time"||o.get()==="");y.toggleDefine("MOD_SRC_XY",o.get()=="X * Y + Time");y.toggleDefine("MOD_SRC_X",o.get()=="X + Time");y.toggleDefine("MOD_SRC_Y",o.get()=="Y + Time");y.toggleDefine("MOD_SRC_Z",o.get()=="Z + Time")}r.onTriggered=function(){y.bind();O.trigger();y.unbind()}};Ops.Gl.ShaderEffects.VertexWobble_v2.prototype=new CABLES.Op;CABLES.OPS["76983d1c-be6d-453d-b34f-472efe8221e7"]={f:Ops.Gl.ShaderEffects.VertexWobble_v2,objName:"Ops.Gl.ShaderEffects.VertexWobble_v2"};Ops.Gl.TextureEffects.Math.RgbMath=function(){CABLES.Op.apply(this,arguments);const e=this;const t={rgbmul_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\n#ifdef MOD_MASK\n    UNI sampler2D texMask;\n#endif\nUNI float r;\nUNI float g;\nUNI float b;\nUNI float a;\n\n\n\nvoid main()\n{\n    vec4 col=texture(tex,texCoord);\n    vec4 v=vec4(r,g,b,a);\n\n    #ifdef MOD_MASK\n        v*=texture(texMask,texCoord);\n    #endif\n\n    #ifdef MOD_OP_SUB_CX\n        #ifdef MOD_CHAN_R\n            col.r=col.r-v.r;\n        #endif\n        #ifdef MOD_CHAN_G\n            col.g=col.g-v.g;\n        #endif\n        #ifdef MOD_CHAN_B\n            col.b=col.b-v.b;\n        #endif\n        #ifdef MOD_CHAN_A\n            col.a=col.a-v.a;\n        #endif\n    #endif\n\n    #ifdef MOD_OP_SUB_XC\n        #ifdef MOD_CHAN_R\n            col.r=v.r-col.r;\n        #endif\n        #ifdef MOD_CHAN_G\n            col.g=v.g-col.g;\n        #endif\n        #ifdef MOD_CHAN_B\n            col.b=v.b-col.b;\n        #endif\n        #ifdef MOD_CHAN_A\n            col.a=v.a-col.a;\n        #endif\n    #endif\n\n    #ifdef MOD_OP_ADD\n        #ifdef MOD_CHAN_R\n            col.r+=v.r;\n        #endif\n        #ifdef MOD_CHAN_G\n            col.g+=v.g;\n        #endif\n        #ifdef MOD_CHAN_B\n            col.b+=v.b;\n        #endif\n        #ifdef MOD_CHAN_A\n            col.a+=v.a;\n        #endif\n    #endif\n\n    #ifdef MOD_OP_MUL\n        #ifdef MOD_CHAN_R\n            col.r*=v.r;\n        #endif\n        #ifdef MOD_CHAN_G\n            col.g*=v.g;\n        #endif\n        #ifdef MOD_CHAN_B\n            col.b*=v.b;\n        #endif\n        #ifdef MOD_CHAN_A\n            col.a*=v.a;\n        #endif\n    #endif\n\n    #ifdef MOD_OP_DIV_XC\n        #ifdef MOD_CHAN_R\n            col.r=v.r/col.r;\n        #endif\n        #ifdef MOD_CHAN_G\n            col.g=v.g/col.g;\n        #endif\n        #ifdef MOD_CHAN_B\n            col.b=v.b/col.b;\n        #endif\n        #ifdef MOD_CHAN_A\n            col.a=v.a/col.a;\n        #endif\n    #endif\n\n    #ifdef MOD_OP_DIV_CX\n        #ifdef MOD_CHAN_R\n            col.r=col.r/v.r;\n        #endif\n        #ifdef MOD_CHAN_G\n            col.g=col.g/v.g;\n        #endif\n        #ifdef MOD_CHAN_B\n            col.b=col.b/v.b;\n        #endif\n        #ifdef MOD_CHAN_A\n            col.a=col.a/v.a;\n        #endif\n    #endif\n\n    #ifdef MOD_OP_MODULO\n        col=mod(col,v);\n    #endif\n\n// csdcsd\n   outColor= col;\n}\n"};const n=e.inTrigger("Render"),a=e.inSwitch("Operation",["c-x","x-c","c+x","c*x","x/c","c/x","c%x"],"c*x"),r=e.inBool("R Active",true),o=e.inBool("G Active",true),i=e.inBool("B Active",true),s=e.inBool("A Active",false),l=e.inValue("r",1),c=e.inValue("g",1),u=e.inValue("b",1),_=e.inValue("a",1),d=e.inTexture("Mask"),p=e.outTrigger("trigger");const g=e.patch.cgl;const f=new CGL.Shader(g,e.name);f.setSource(f.getDefaultVertexShader(),t.rgbmul_frag);const m=new CGL.Uniform(f,"t","tex",0),v=new CGL.Uniform(f,"t","texMask",1),h=new CGL.Uniform(f,"f","r",l),b=new CGL.Uniform(f,"f","g",c),x=new CGL.Uniform(f,"f","b",u),O=new CGL.Uniform(f,"f","a",_);r.onChange=d.onChange=o.onChange=i.onChange=s.onChange=a.onChange=I;I();function I(){f.toggleDefine("MOD_MASK",d.get());f.toggleDefine("MOD_OP_SUB_CX",a.get()==="c-x");f.toggleDefine("MOD_OP_SUB_XC",a.get()==="x-c");f.toggleDefine("MOD_OP_ADD",a.get()==="c+x");f.toggleDefine("MOD_OP_MUL",a.get()==="c*x");f.toggleDefine("MOD_OP_DIV_XC",a.get()==="x/c");f.toggleDefine("MOD_OP_DIV_CX",a.get()==="c/x");f.toggleDefine("MOD_OP_MODULO",a.get()==="c%x");f.toggleDefine("MOD_CHAN_R",r.get());l.setUiAttribs({greyout:!r.get()});f.toggleDefine("MOD_CHAN_G",o.get());c.setUiAttribs({greyout:!o.get()});f.toggleDefine("MOD_CHAN_B",i.get());u.setUiAttribs({greyout:!i.get()});f.toggleDefine("MOD_CHAN_A",s.get());_.setUiAttribs({greyout:!s.get()})}n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;g.pushShader(f);g.currentTextureEffect.bind();g.setTexture(0,g.currentTextureEffect.getCurrentSourceTexture().tex);if(d.get())g.setTexture(1,d.get().tex);g.currentTextureEffect.finish();g.popShader();p.trigger()}};Ops.Gl.TextureEffects.Math.RgbMath.prototype=new CABLES.Op;CABLES.OPS["dc858e71-1f12-4de5-89f5-67fb41ebfa39"]={f:Ops.Gl.TextureEffects.Math.RgbMath,objName:"Ops.Gl.TextureEffects.Math.RgbMath"};Ops.Gl.Shader.PointMaterial_v4=function(){CABLES.Op.apply(this,arguments);const e=this;const t={pointmat_frag:"\n{{MODULES_HEAD}}\n\nUNI vec4 color;\n// IN vec2 pointCoord;\nIN float ps;\n\n#ifdef HAS_TEXTURE_DIFFUSE\n    UNI sampler2D diffTex;\n#endif\n#ifdef HAS_TEXTURE_MASK\n    UNI sampler2D texMask;\n#endif\n#ifdef HAS_TEXTURE_COLORIZE\n    IN vec4 colorize;\n#endif\n#ifdef HAS_TEXTURE_OPACITY\n    IN float opacity;\n#endif\n#ifdef VERTEX_COLORS\n    IN vec4 vertexColor;\n#endif\n\nvoid main()\n{\n    #ifdef FLIP_TEX\n        vec2 pointCoord=vec2(gl_PointCoord.x,(1.0-gl_PointCoord.y));\n    #endif\n    #ifndef FLIP_TEX\n        vec2 pointCoord=gl_PointCoord;\n    #endif\n    {{MODULE_BEGIN_FRAG}}\n\n    if(ps<1.0)discard;\n\n    vec4 col=color;\n\n    #ifdef HAS_TEXTURE_MASK\n        float mask;\n        #ifdef TEXTURE_MASK_R\n            mask=texture(texMask,pointCoord).r;\n        #endif\n        #ifdef TEXTURE_MASK_A\n            mask=texture(texMask,pointCoord).a;\n        #endif\n        #ifdef TEXTURE_MASK_LUMI\n        \tvec3 lumcoeff = vec3(0.299,0.587,0.114);\n        \tmask = dot(texture(texMask,pointCoord).rgb, lumcoeff);\n        #endif\n\n    #endif\n\n    #ifdef HAS_TEXTURE_DIFFUSE\n        col=texture(diffTex,pointCoord);\n        #ifdef COLORIZE_TEXTURE\n          col.rgb*=color.rgb;\n        #endif\n    #endif\n    col.a*=color.a;\n\n    {{MODULE_COLOR}}\n\n    #ifdef MAKE_ROUND\n\n        #ifndef MAKE_ROUNDAA\n            if ((gl_PointCoord.x-0.5)*(gl_PointCoord.x-0.5) + (gl_PointCoord.y-0.5)*(gl_PointCoord.y-0.5) > 0.25) discard; //col.a=0.0;\n        #endif\n\n        #ifdef MAKE_ROUNDAA\n            float circ=(gl_PointCoord.x-0.5)*(gl_PointCoord.x-0.5) + (gl_PointCoord.y-0.5)*(gl_PointCoord.y-0.5);\n\n            float a=smoothstep(0.25,0.25-fwidth(gl_PointCoord.x),circ);\n            if(a==0.0)discard;\n            col.a=a*color.a;\n        #endif\n    #endif\n\n    #ifdef HAS_TEXTURE_COLORIZE\n        col*=colorize;\n    #endif\n\n    #ifdef TEXTURE_COLORIZE_MUL\n        col*=color;\n    #endif\n\n    #ifdef HAS_TEXTURE_MASK\n        col.a*=mask;\n    #endif\n\n    #ifdef HAS_TEXTURE_OPACITY\n        col.a*=opacity;\n    #endif\n\n    #ifdef VERTEX_COLORS\n        col.rgb = vertexColor.rgb;\n        col.a *= vertexColor.a;\n    #endif\n\n    if (col.a <= 0.0) discard;\n\n    #ifdef HAS_TEXTURE_COLORIZE\n        col*=colorize;\n    #endif\n\n    outColor = col;\n}\n",pointmat_vert:"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent;\nIN vec3 attrBiTangent;\n\n#ifdef VERTEX_COLORS\n    IN vec4 attrVertColor;\n    OUT vec4 vertexColor;\n#endif\n\nOUT vec3 norm;\nOUT float ps;\n\nOUT vec2 texCoord;\n\n\n#ifdef HAS_TEXTURES\n#endif\n\n#ifdef HAS_TEXTURE_COLORIZE\n   UNI sampler2D texColorize;\n   OUT vec4 colorize;\n#endif\n#ifdef HAS_TEXTURE_OPACITY\n    UNI sampler2D texOpacity;\n    OUT float opacity;\n#endif\n\n#ifdef HAS_TEXTURE_POINTSIZE\n   UNI sampler2D texPointSize;\n   UNI float texPointSizeMul;\n#endif\n\nUNI mat4 projMatrix;\nUNI mat4 modelMatrix;\nUNI mat4 viewMatrix;\n\nUNI float pointSize;\nUNI vec3 camPos;\n\nUNI float canvasWidth;\nUNI float canvasHeight;\nUNI float camDistMul;\nUNI float randomSize;\n\nIN float attrVertIndex;\n\n\n\nfloat rand(float n){return fract(sin(n) * 5711.5711123);}\n\n#define POINTMATERIAL\n\nvoid main()\n{\n    norm=attrVertNormal;\n    #ifdef PIXELSIZE\n        float psMul=1.0;\n    #endif\n\n    #ifndef PIXELSIZE\n        float psMul=sqrt(canvasWidth/canvasHeight)+0.00000000001;\n    #endif\n\n    // float sizeMultiply=1.0;\n\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n\n\n    #ifdef VERTEX_COLORS\n        vertexColor=attrVertColor;\n    #endif\n\n    // #ifdef HAS_TEXTURES\n        texCoord=attrTexCoord;\n    // #endif\n\n    #ifdef HAS_TEXTURE_OPACITY\n        // opacity=texture(texOpacity,vec2(rand(attrVertIndex+texCoord.x*texCoord.y+texCoord.y+texCoord.x),rand(texCoord.y*texCoord.x-texCoord.x-texCoord.y-attrVertIndex))).r;\n        opacity=texture(texOpacity,texCoord).r;\n    #endif\n\n\n    #ifdef HAS_TEXTURE_COLORIZE\n        #ifdef RANDOM_COLORIZE\n            colorize=texture(texColorize,vec2(rand(attrVertIndex+texCoord.x*texCoord.y+texCoord.y+texCoord.x),rand(texCoord.y*texCoord.x-texCoord.x-texCoord.y-attrVertIndex)));\n        #endif\n        #ifndef RANDOM_COLORIZE\n            colorize=texture(texColorize,texCoord);\n        #endif\n    #endif\n\n\n\n\n\n    mat4 mMatrix=modelMatrix;\n    vec4 pos = vec4( vPosition, 1. );\n\n    gl_PointSize=0.0;\n\n    {{MODULE_VERTEX_POSITION}}\n\n    vec4 model=mMatrix * pos;\n\n    psMul+=rand(texCoord.x*texCoord.y+texCoord.y*3.0+texCoord.x*2.0+attrVertIndex)*randomSize;\n    // psMul*=sizeMultiply;\n\n    float addPointSize=0.0;\n    #ifdef HAS_TEXTURE_POINTSIZE\n\n        #ifdef POINTSIZE_CHAN_R\n            addPointSize=texture(texPointSize,texCoord).r;\n        #endif\n        #ifdef POINTSIZE_CHAN_G\n            addPointSize=texture(texPointSize,texCoord).g;\n        #endif\n        #ifdef POINTSIZE_CHAN_B\n            addPointSize=texture(texPointSize,texCoord).b;\n        #endif\n\n\n        #ifdef DOTSIZEREMAPABS\n            // addPointSize=(( (texture(texPointSize,texCoord).r) * texPointSizeMul)-0.5)*2.0;\n\n            addPointSize=1.0-(distance(addPointSize,0.5)*2.0);\n            // addPointSize=abs(1.0-(distance(addPointSize,0.5)*2.0));\n            addPointSize=addPointSize*addPointSize*addPointSize*2.0;\n\n            // addPointSize=(( (texture(texPointSize,texCoord).r) * texPointSizeMul)-0.5)*2.0;\n        #endif\n\n        addPointSize*=texPointSizeMul;\n\n    #endif\n\n    ps=0.0;\n    #ifndef SCALE_BY_DISTANCE\n        ps = (pointSize+addPointSize) * psMul;\n    #endif\n    #ifdef SCALE_BY_DISTANCE\n        float cameraDist = distance(model.xyz, camPos);\n        ps = ( (pointSize+addPointSize) / cameraDist) * psMul;\n    #endif\n\n    gl_PointSize += ps;\n\n\n    gl_Position = projMatrix * viewMatrix * model;\n}\n"};const n=e.patch.cgl;const a=e.inTrigger("render"),r=e.inValueFloat("PointSize",3),o=e.inBool("Size in Pixels",false),i=e.inValue("Random Size",0),s=e.inValueBool("Round",true),l=e.inValueBool("Round Antialias",false),c=e.inValueBool("Scale by Distance",false),u=e.inValueSlider("r",Math.random()),_=e.inValueSlider("g",Math.random()),d=e.inValueSlider("b",Math.random()),p=e.inValueSlider("a",1),g=e.inBool("Vertex Colors",false),f=e.inTexture("texture"),m=e.inBool("Colorize Texture"),v=e.inTexture("Texture Mask"),h=e.inSwitch("Mask Channel",["R","A","Luminance"],"R"),b=e.inTexture("Texture Colorize"),x=e.inValueBool("Colorize Randomize",true),O=e.inTexture("Texture Opacity"),I=e.inTexture("Texture Point Size"),y=e.inSwitch("Point Size Channel",["R","G","B"],"R"),T=e.inFloat("Texture Point Size Mul",1),A=e.inSwitch("Map Size 0",["Black","Grey"],"Black"),S=e.inValueBool("Flip Texture",false),C=e.outTrigger("trigger"),E=e.outObject("shader",null,"shader");e.setPortGroup("Texture",[f,m,v,h,b,O,x]);e.setPortGroup("Color",[u,_,d,p,g]);e.setPortGroup("Size",[r,i,s,l,c,o,I,T,y,A]);u.setUiAttribs({colorPick:true});const M=new CGL.Shader(n,"PointMaterial");M.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]);M.define("MAKE_ROUND");const N=new CGL.Uniform(M,"f","pointSize",r),L=new CGL.Uniform(M,"f","texPointSizeMul",T),w=new CGL.Uniform(M,"f","randomSize",i),P=new CGL.Uniform(M,"4f","color",u,_,d,p),D=new CGL.Uniform(M,"f","canvasWidth",n.canvasWidth),R=new CGL.Uniform(M,"f","canvasHeight",n.canvasHeight),U=new CGL.Uniform(M,"t","diffTex"),j=new CGL.Uniform(M,"t","texColorize"),G=new CGL.Uniform(M,"t","texOpacity"),V=new CGL.Uniform(M,"t","texPointSize"),k=new CGL.Uniform(M,"t","texPointSize"),B=new CGL.Uniform(M,"t","texMask");M.setSource(t.pointmat_vert,t.pointmat_frag);M.glPrimitive=n.gl.POINTS;E.set(M);E.ignoreValueSerialize=true;a.onTriggered=z;c.onChange=s.onChange=l.onChange=f.onChange=b.onChange=v.onChange=x.onChange=S.onChange=h.onChange=o.onChange=O.onChange=I.onChange=A.onChange=y.onChange=m.onChange=g.onChange=X;F();e.preRender=function(){if(M)M.bind();z()};function z(){D.setValue(n.canvasWidth);R.setValue(n.canvasHeight);n.pushShader(M);M.popTextures();if(f.get()&&!f.get().deleted)M.pushTexture(U,f.get());if(v.get())M.pushTexture(B,v.get());if(b.get())M.pushTexture(j,b.get());if(O.get())M.pushTexture(G,O.get());if(I.get())M.pushTexture(k,I.get());C.trigger();n.popShader()}function F(){h.setUiAttribs({greyout:!v.isLinked()});y.setUiAttribs({greyout:!I.isLinked()});T.setUiAttribs({greyout:!I.isLinked()});A.setUiAttribs({greyout:!I.isLinked()})}function X(){M.toggleDefine("SCALE_BY_DISTANCE",c.get());M.toggleDefine("MAKE_ROUND",s.get());M.toggleDefine("MAKE_ROUNDAA",l.get());M.toggleDefine("VERTEX_COLORS",g.get());M.toggleDefine("RANDOM_COLORIZE",x.get());M.toggleDefine("HAS_TEXTURE_DIFFUSE",f.get());M.toggleDefine("HAS_TEXTURE_MASK",v.get());M.toggleDefine("HAS_TEXTURE_COLORIZE",b.get());M.toggleDefine("HAS_TEXTURE_OPACITY",O.get());M.toggleDefine("HAS_TEXTURE_POINTSIZE",I.get());M.toggleDefine("TEXTURE_COLORIZE_MUL",m.get());M.toggleDefine("FLIP_TEX",S.get());M.toggleDefine("TEXTURE_MASK_R",h.get()=="R");M.toggleDefine("TEXTURE_MASK_A",h.get()=="A");M.toggleDefine("TEXTURE_MASK_LUMI",h.get()=="Luminance");M.toggleDefine("PIXELSIZE",o.get());M.toggleDefine("POINTSIZE_CHAN_R",y.get()=="R");M.toggleDefine("POINTSIZE_CHAN_G",y.get()=="G");M.toggleDefine("POINTSIZE_CHAN_B",y.get()=="B");M.toggleDefine("DOTSIZEREMAPABS",A.get()=="Grey");F()}};Ops.Gl.Shader.PointMaterial_v4.prototype=new CABLES.Op;CABLES.OPS["a7cb5d1c-cd4a-4c28-bb13-7bb9bda187ed"]={f:Ops.Gl.Shader.PointMaterial_v4,objName:"Ops.Gl.Shader.PointMaterial_v4"};Ops.Gl.Meshes.PointCloudFromTexture=function(){CABLES.Op.apply(this,arguments);const e=this;const t={vertposbody_vert:"\n// float tx=mod(attrVertIndex,(MOD_texSize))/(MOD_texSize);\n// float ty=float(int((attrVertIndex/(MOD_texSize))))/(MOD_texSize);\n\nhighp vec4 col=texture(MOD_tex,texCoord);//vec2(tx,ty));\n\n// vec4 col=texture(MOD_tex,texCoord);\n\n#ifdef MOD_HAS_PS_TEX\n    psMul*=texture(MOD_texPointSize,texCoord).r;\n    // psMul*=attrVertIndex/21000.0;\n#endif\n\nvec3 MOD_pos=col.xyz+pos.xyz;\n\n#ifdef MOD_NORMALIZE\n    MOD_pos=(MOD_pos.xyz-0.5)*2.0;\n#endif\n\n#ifdef MOD_AXIS_XYZ\n    pos.xyz=MOD_pos.xyz+pos.xyz;\n#endif\n\n#ifdef MOD_AXIS_XY\n    pos.xy=MOD_pos.xy+pos.xy;\n    pos.z=0.0+pos.z;\n    pos.w=1.0;\n#endif\n\n#ifdef MOD_REMOVEZERO\n    if(MOD_pos.x==0.0 && MOD_pos.y==0.0 && MOD_pos.z==0.0) psMul=0.0;\n#endif\n"};const n=e.inTrigger("render"),a=e.inInt("Num Points",0),r=e.inSwitch("Axis",["XYZ","XY"],"XYZ"),o=e.inTexture("Texture",null,"texture"),i=e.inTexture("Point Size",null,"texture"),s=e.inBool("Normalize",false),l=e.inBool("Remove Point at 0",false),c=e.outTrigger("Trigger"),u=e.outNumber("Total Points",0);const _=e.patch.cgl;let d=null;let p=0;let g=0;const f=new CGL.ShaderModifier(_,e.name);f.addModule({priority:-10,title:e.name,name:"MODULE_VERTEX_POSITION",srcHeadVert:"",srcBodyVert:t.vertposbody_vert});f.addUniformVert("t","MOD_tex");f.addUniformVert("t","MOD_texPointSize");n.onTriggered=h;v();f.addUniformVert("f","MOD_texSize",0);s.onChange=i.onChange=l.onChange=r.onChange=v;let m=true;o.onChange=()=>{if(o.get()!=CGL.Texture.getEmptyTexture(_))m=true};a.onChange=()=>{m=true};v();function v(){f.toggleDefine("MOD_REMOVEZERO",l);f.toggleDefine("MOD_AXIS_XY",r.get()=="XY");f.toggleDefine("MOD_AXIS_XYZ",r.get()=="XYZ");f.toggleDefine("MOD_NORMALIZE",s.get());f.toggleDefine("MOD_HAS_PS_TEX",i.get())}function h(){if(o.get()==CGL.Texture.getEmptyTexture(_)){c.trigger();return}if(m)b();if(!o.get()||!o.get().tex)return;f.bind();if(o.get())f.pushTexture("MOD_tex",o.get().tex);if(i.get())f.pushTexture("MOD_texPointSize",i.get().tex);f.setUniformValue("MOD_texSize",o.get().width+1);if(p>0&&a.get()>=0&&d){if(a.get()>0)d.setNumVertices(Math.min(p,a.get()));else d.setNumVertices(p);d.render(_.getShader())}c.trigger();f.unbind()}function b(){if(!o.get()){u.set(0);return}const e=o.get().width*o.get().height;u.set(e);if(e==g)return;g=e;let t=new Float32Array(e*3);let n=new Float32Array(e*2);let a=.5*(1/o.get().width);for(let t=0;t<o.get().width;t++)for(let e=0;e<o.get().height;e++){n[(t+e*o.get().width)*2]=t/o.get().width+a;n[(t+e*o.get().width)*2+1]=e/o.get().height+a}const r=new CGL.Geometry("pointcloudfromTexture");r.setPointVertices(t);r.setTexCoords(n);r.verticesIndices=[];p=t.length/3;if(d)d.dispose();if(p>0)d=new CGL.Mesh(_,r,_.gl.POINTS);if(!d)return;d.addVertexNumbers=true;d.setGeom(r);m=false}};Ops.Gl.Meshes.PointCloudFromTexture.prototype=new CABLES.Op;CABLES.OPS["105d8812-e641-47f2-bbaf-e45d5bc3ea8b"]={f:Ops.Gl.Meshes.PointCloudFromTexture,objName:"Ops.Gl.Meshes.PointCloudFromTexture"};Ops.Array.SplinePositionAtDistanceArray3=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTriggerButton("Calculate"),r=e.inArray("Array3x"),a=e.inValue("Distance"),o=e.inValueBool("Normalized"),i=e.outTrigger("Next"),s=e.outNumber("X"),l=e.outNumber("Y"),c=e.outNumber("Z"),u=e.outNumber("Spline Length");let _=new CABLES.Anim;let d=new CABLES.Anim;let p=new CABLES.Anim;let g=true;function f(e,t,n,a,r,o){let i=e-a;let s=t-r;let l=n-o;return Math.sqrt(i*i+s*s+l*l)}function m(t){let n=0;for(let e=3;e<t.length;e+=3){n+=f(t[e-3],t[e-2],t[e-1],t[e+0],t[e+1],t[e+2])}u.set(n);return n}function v(){_.clear();d.clear();p.clear();let n=r.get();let e=m(n);let a=0;for(let t=0;t<n.length;t+=3){let e=t/(n.length-3);if(t>0){a+=f(n[t-3],n[t-2],n[t-1],n[t+0],n[t+1],n[t+2])}_.setValue(a,n[t+0]);d.setValue(a,n[t+1]);p.setValue(a,n[t+2])}g=false}r.onChange=function(){g=true};n.onTriggered=function(){if(g)v();let e=a.get();if(o.get())e*=u.get();s.set(_.getValue(e));l.set(d.getValue(e));c.set(p.getValue(e));i.trigger()}};Ops.Array.SplinePositionAtDistanceArray3.prototype=new CABLES.Op;CABLES.OPS["02100bb5-fe07-4c1b-8792-67f9add7afff"]={f:Ops.Array.SplinePositionAtDistanceArray3,objName:"Ops.Array.SplinePositionAtDistanceArray3"};Ops.Gl.Textures.TextureToCoordinateGrid=function(){CABLES.Op.apply(this,arguments);const e=this;const t={rgbe2fp_frag:"UNI sampler2D tex;\nIN vec2 texCoord;\nUNI float aspect;\nUNI float threshold;\n\nvoid main()\n{\n    vec4 col=texture(tex,texCoord);\n    vec4 outCol=vec4(111111110.0);\n\n    if(col.r>threshold)\n    {\n        outCol=vec4(vec2((texCoord.x-0.5)*aspect,texCoord.y-0.5),0.0,1.0);\n        // outCol=vec4(texCoord,0.0,1.0);\n    }\n\n\n    outColor = outCol;\n}"};const n=e.inTrigger("Execute"),a=e.inTexture("RGBE Texture"),r=e.inFloat("Aspect",1),o=e.inFloatSlider("Threshold",.2),i=e.outTrigger("Next"),s=e.outTexture("HDR Texture");const l=new CGL.CopyTexture(e.patch.cgl,"rgbe2hdr",{shader:t.rgbe2fp_frag,isFloatingPointTexture:true});const c=new CGL.Uniform(l.bgShader,"f","aspect",r);const u=new CGL.Uniform(l.bgShader,"f","threshold",o);n.onTriggered=()=>{if(!a.get())return;s.set(CGL.Texture.getEmptyTexture(e.patch.cgl));s.set(l.copy(a.get()));i.trigger()}};Ops.Gl.Textures.TextureToCoordinateGrid.prototype=new CABLES.Op;CABLES.OPS["91f30465-4a4c-4447-9b16-072252f0a977"]={f:Ops.Gl.Textures.TextureToCoordinateGrid,objName:"Ops.Gl.Textures.TextureToCoordinateGrid"};Ops.Gl.Meshes.GeometryToTexture_v2=function(){CABLES.Op.apply(this,arguments);const n=this;const e={fragpos_frag:"col=vec4(MOD_pos.xyz,1.0);\n",vertpos_vert:"\n#ifdef MOD_ATTRIB_POS\nMOD_pos=pos.xyz;\n#endif\n#ifdef MOD_ATTRIB_NORMAL\nMOD_pos=norm.xyz;\n#endif\n#ifdef MOD_ATTRIB_TC\nMOD_pos=vec3(attrTexCoord,1.0);\n#endif\n\nfloat tx=mod(attrVertIndex,MOD_texSize)+1.0/MOD_texSize;\nfloat ty=floor(attrVertIndex/MOD_texSize);\n\ngl_PointSize=1.0;\n\npos=vec4(tx,ty+1.0,0.0,1.0);\n"};const t=n.inTrigger("Render"),a=n.inObject("Geometry",null,"geometry"),r=n.inDropDown("Order",["Sequential","Random","Vertex X","Vertex Y","Vertex Z"],"Sequential"),o=n.inSwitch("Content",["Vertex Pos","Normals","TexCoords"],"Vertex Pos"),i=n.inSwitch("Size",["Auto","Manual"],"Auto"),s=n.inValueInt("Tex Width",256),l=n.inValueSelect("filter",["nearest","linear"],"nearest"),c=n.inValueSelect("wrap",["clamp to edge","repeat","mirrored repeat"],"clamp to edge"),u=n.outTrigger("Next"),_=n.outNumber("Total Vertices"),d=n.outTexture("Texture");n.setPortGroup("Texture settings",[l,c,s,i]);const p=n.patch.cgl;const g=[0,0,0,0];const f=null;let m=true;let v=true;let h=true;let b=null;let x=0;let O=null;let I=true;let y=null;let T=new Float32Array(1);let A=1;l.onChange=c.onChange=w;s.onChange=i.onChange=P;o.onChange=M;L();const S="vert_"+n.name;const C=new CGL.ShaderModifier(p,n.name);C.addModule({priority:200,title:S,name:"MODULE_VERTEX_POSITION",srcHeadVert:"OUT vec3 MOD_pos;",srcBodyVert:e.vertpos_vert});C.addModule({title:n.name,name:"MODULE_COLOR",srcHeadFrag:"IN vec3 MOD_pos;",srcBodyFrag:e.fragpos_frag});C.addUniformVert("f","MOD_texSize",0);M();function E(e){let t=0;let n=0;let a=null;for(t=e.length-1;t>0;t-=1){n=Math.floor(Math.seededRandom()*(t+1));a=e[t];e[t]=e[n];e[n]=a}}a.onChange=function(){h=true;v=true};function M(){C.toggleDefine("MOD_ATTRIB_POS",o.get()=="Vertex Pos");C.toggleDefine("MOD_ATTRIB_TC",o.get()=="TexCoords");C.toggleDefine("MOD_ATTRIB_NORMAL",o.get()=="Normals");v=true}r.onChange=()=>{v=true};function N(){}function L(){s.setUiAttribs({greyout:i.get()=="Auto"})}function w(){I=true;v=true;N();L()}function P(){const e=x;x=s.get();m=i.get()=="Auto";const t=a.get();if(m&&!t){h=true;x=-1;return}if(m&&t&&t.vertices){x=Math.ceil(Math.sqrt(t.vertices.length/3))}x=Math.ceil(Math.max(1,x));L();if(e!=x)v=true;h=false;n.log("size",x)}function D(){if(O)O=O.delete();d.set(CGL.Texture.getEmptyTexture(p));if(x<1)return;let e=CGL.Texture.FILTER_NEAREST;if(l.get()=="linear")e=CGL.Texture.FILTER_LINEAR;let t=CGL.Texture.WRAP_CLAMP_TO_EDGE;if(c.get()=="repeat")t=CGL.Texture.WRAP_REPEAT;if(c.get()=="mirrored repeat")t=CGL.Texture.WRAP_MIRRORED_REPEAT;if(p.glVersion>=2){O=new CGL.Framebuffer2(p,x,x,{isFloatingPointTexture:true,multisampling:false,wrap:t,filter:e,depth:true,multisamplingSamples:0,clear:true})}else{O=new CGL.Framebuffer(p,x,x,{isFloatingPointTexture:true,filter:e,wrap:t})}I=false}t.onTriggered=function(){P();if(!O||I)D();if(!v)return u.trigger();if(d.get()!=CGL.Texture.getEmptyTexture(p))d.set(CGL.Texture.getEmptyTexture(p));const e=a.get();if(!e||!e.copy||!e.vertices)return u.trigger();if(x<1){v=true;return}if(O&&O.getWidth()!=x)O.setSize(x,x);const n=e.copy();if(!y)y=new CGL.Mesh(p,new CGL.Geometry("a"),p.gl.POINTS);n.glPrimitive=p.gl.POINTS;y.setGeom(n);A=n.vertices.length/3;if(T.length!=A)T=new Float32Array(A);for(let e=0;e<A;e++)T[e]=e;if(r.get()=="Random")E(T);if(r.get()=="Vertex X")T.sort(function(e,t){return n.vertices[e*3+0]-n.vertices[t*3+0]});if(r.get()=="Vertex Y")T.sort(function(e,t){return n.vertices[e*3+1]-n.vertices[t*3+1]});if(r.get()=="Vertex Z")T.sort(function(e,t){return n.vertices[e*3+2]-n.vertices[t*3+2]});y._setVertexNumbers(T);_.set(A);R();v=false;u.trigger()};function R(){if(!p.getShader()){n.setUiError("not in mainloop","Needs to be connected to mainloop branch");return}else n.setUiError("not in mainloop",null);const e=p.getViewPort();g[0]=e[0];g[1]=e[1];g[2]=e[2];g[3]=e[3];O.renderStart(p);p.pushPMatrix();mat4.identity(p.pMatrix);p.pushViewMatrix();mat4.identity(p.vMatrix);p.pushModelMatrix();mat4.identity(p.mMatrix);p.gl.viewport(0,0,x,x);mat4.ortho(p.pMatrix,0,x,0,x,-1,100);C.bind();C.setUniformValue("MOD_texSize",x);y.render(p.getShader());C.unbind();p.popPMatrix();p.popModelMatrix();p.popViewMatrix();O.renderEnd(p);d.set(O.getTextureColor());p.gl.viewport(g[0],g[1],g[2],g[3])}};Ops.Gl.Meshes.GeometryToTexture_v2.prototype=new CABLES.Op;CABLES.OPS["d3435879-6b19-460b-911c-87ae5a8d00ad"]={f:Ops.Gl.Meshes.GeometryToTexture_v2,objName:"Ops.Gl.Meshes.GeometryToTexture_v2"};Ops.Gl.Matrix.OrbitControls=function(){CABLES.Op.apply(this,arguments);const r=this;const e={};const t=r.inTrigger("render"),o=r.inValueFloat("min distance"),i=r.inValueFloat("max distance"),s=r.inValue("min rot y",0),l=r.inValue("max rot y",0),n=r.inValue("initial radius",0),a=r.inValueSlider("initial axis y"),c=r.inValueSlider("initial axis x"),u=r.inValueFloat("mul"),_=r.inValueSlider("Smoothness",1),d=r.inValue("Speed X",1),p=r.inValue("Speed Y",1),g=r.inValueBool("Active",true),f=r.inValueBool("Allow Panning",true),m=r.inValueBool("Allow Zooming",true),v=r.inValueBool("Allow Rotation",true),h=r.inValueBool("restricted",true),b=r.outTrigger("trigger"),x=r.outNumber("radius"),O=r.outNumber("Rot X"),I=r.outNumber("Rot Y"),y=r.inTriggerButton("Reset");r.setPortGroup("Initial Values",[a,c,n]);r.setPortGroup("Interaction",[u,_,d,p]);r.setPortGroup("Boundaries",[s,l,o,i]);u.set(1);o.set(.05);i.set(99999);y.onTriggered=W;let T=vec3.create();const A=vec3.create();const S=vec3.create();const C=mat4.create();const E=mat4.create();const M=vec3.create();const N=vec3.create();a.set(.5);let L=false;let w=5;x.set(w);let P=0,D=0;let R=0,U=0;vec3.set(S,0,0,0);vec3.set(A,0,1,0);const j=vec3.create();const G=vec3.create();const V=vec3.create();const k=vec3.create();let B=0;let z=0;let F=1;let X=null;q();r.onDelete=de;const H=Math.PI;const Y=Math.PI*2;function W(){let e=0;if(B%Y<-H){e=-Y;B%=-Y}else if(B%Y>H){e=Y;B%=Y}else B%=Y;z%=Math.PI;vec3.set(M,0,0,0);vec3.set(S,0,0,0);vec3.set(A,0,1,0);R=c.get()*Math.PI*2+e;U=a.get()-.5;w=n.get();T=ee(U)}function q(){F=_.get()*10+1}_.onChange=q;let $=true;function K(e,t){if($)return t;return e+(t-e)/F}let Z=0;const Q=0;t.onTriggered=function(){const e=r.patch.cg;if(!X){ue(e.canvas);_e()}e.pushViewMatrix();B=K(B,R);z=K(z,U);let t=(z+.5)*180;if(s.get()!==0&&t<s.get()){t=s.get();z=Z}else if(l.get()!==0&&t>l.get()){t=l.get();z=Z}else{Z=z}const n=B*CGL.RAD2DEG;I.set(t);O.set(n);J(T,z);vec3.add(j,T,M);vec3.add(V,S,M);G[0]=K(G[0],j[0]);G[1]=K(G[1],j[1]);G[2]=K(G[2],j[2]);k[0]=K(k[0],V[0]);k[1]=K(k[1],V[1]);k[2]=K(k[2],V[2]);const a=vec3.create();mat4.lookAt(C,G,k,A);mat4.rotate(C,C,B,A);mat4.multiply(e.vMatrix,e.vMatrix,C);b.trigger();e.popViewMatrix();$=false};function J(e,t){const n=u.get();if(w<o.get()*n)w=o.get()*n;if(w>i.get()*n)w=i.get()*n;x.set(w*n);let a=0,r=0;r=360*t/2*CGL.DEG2RAD;vec3.set(e,Math.cos(r)*w*n,Math.sin(r)*w*n,0);return e}function ee(e){const t=u.get();if(w<o.get()*t)w=o.get()*t;if(w>i.get()*t)w=i.get()*t;x.set(w*t);let n=0,a=0;const r=vec3.create();a=360*e/2*CGL.DEG2RAD;vec3.set(r,Math.cos(a)*w*t,Math.sin(a)*w*t,0);return r}function te(e){if(!L)return;const t=e.clientX;const n=e.clientY;let a=t-P;let r=n-D;a*=d.get();r*=p.get();if(e.buttons==2&&f.get()){M[2]+=a*.01*u.get();M[1]+=r*.01*u.get()}else if(e.buttons==4&&m.get()){w+=r*.05;T=ee(U)}else{if(v.get()){R+=a*.003;U+=r*.002;if(h.get()){if(U>.5)U=.5;if(U<-.5)U=-.5}}}P=t;D=n}function ne(e){P=e.clientX;D=e.clientY;L=true;try{X.setPointerCapture(e.pointerId)}catch(e){}}function ae(e){L=false;try{X.releasePointerCapture(e.pointerId)}catch(e){}}function re(){const e=r.patch.cg.canvas;if(document.pointerLockElement===e||document.mozPointerLockElement===e||document.webkitPointerLockElement===e){document.addEventListener("mousemove",te,false)}}function oe(e){}n.onChange=function(){w=n.get();W()};c.onChange=function(){B=R=c.get()*Math.PI*2};a.onChange=function(){z=U=a.get()-.5;T=ee(U)};const ie=function(e){if(m.get()){const t=CGL.getWheelSpeed(e)*.06;w+=parseFloat(t)*1.2;T=ee(U)}};const se=function(e){if(e.touches&&e.touches.length>0)ne(e.touches[0])};const le=function(e){ae()};const ce=function(e){if(e.touches&&e.touches.length>0)te(e.touches[0])};g.onChange=function(){if(g.get())_e();else de()};function ue(e){de();X=e;_e()}function _e(){if(!X)return;X.addEventListener("pointermove",te);X.addEventListener("pointerdown",ne);X.addEventListener("pointerup",ae);X.addEventListener("pointerleave",ae);X.addEventListener("pointerenter",oe);X.addEventListener("contextmenu",function(e){e.preventDefault()});X.addEventListener("wheel",ie,{passive:true})}function de(){if(!X)return;X.removeEventListener("pointermove",te);X.removeEventListener("pointerdown",ne);X.removeEventListener("pointerup",ae);X.removeEventListener("pointerleave",ae);X.removeEventListener("pointerenter",ae);X.removeEventListener("wheel",ie)}T=ee(0);c.set(.25);n.set(.05)};Ops.Gl.Matrix.OrbitControls.prototype=new CABLES.Op;CABLES.OPS["eaf4f7ce-08a3-4d1b-b9f4-ebc0b7b1cde1"]={f:Ops.Gl.Matrix.OrbitControls,objName:"Ops.Gl.Matrix.OrbitControls"};Ops.Gl.Meshes.Cube_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("Render"),a=e.inValueBool("Render Mesh",true),i=e.inValue("Width",1),s=e.inValue("Length",1),l=e.inValue("Height",1),c=e.inValueBool("Center",true),u=e.inSwitch("Mapping",["Side","Cube +-"],"Side"),d=e.inValue("Bias",0),p=e.inValueBool("Flip X",true),_=e.inValueBool("Top",true),g=e.inValueBool("Bottom",true),f=e.inValueBool("Left",true),m=e.inValueBool("Right",true),v=e.inValueBool("Front",true),h=e.inValueBool("Back",true),r=e.outTrigger("Next"),b=e.outObject("geometry",null,"geometry");const x=e.patch.cgl;e.toWorkPortsNeedToBeLinked(n);e.setPortGroup("Mapping",[u,d,p]);e.setPortGroup("Geometry",[i,l,s,c]);e.setPortGroup("Sides",[_,g,f,m,v,h]);let O=null,I=null,y=true,T=true;d.onChange=p.onChange=_.onChange=g.onChange=f.onChange=m.onChange=v.onChange=h.onChange=u.onChange=i.onChange=l.onChange=s.onChange=c.onChange=o;function o(){T=true}n.onLinkChanged=function(){if(!n.isLinked()){b.set(null);return}A()};n.onTriggered=function(){if(T)A();if(a.get()&&I&&y)I.render(x.getShader());r.trigger()};e.preRender=function(){A();I.render(x.getShader())};function A(){if(!O)O=new CGL.Geometry("cubemesh");O.clear();let e=i.get();let t=-1*i.get();let n=l.get();let a=-1*l.get();let r=s.get();let o=-1*s.get();if(!c.get()){t=0;a=0;o=0}else{e*=.5;t*=.5;n*=.5;a*=.5;r*=.5;o*=.5}if(u.get()=="Side")S(O,e,n,r,t,a,o);else C(O,e,n,r,t,a,o);O.verticesIndices=[];if(_.get())O.verticesIndices.push(8,9,10,8,10,11);if(g.get())O.verticesIndices.push(12,13,14,12,14,15);if(f.get())O.verticesIndices.push(20,21,22,20,22,23);if(m.get())O.verticesIndices.push(16,17,18,16,18,19);if(h.get())O.verticesIndices.push(4,5,6,4,6,7);if(v.get())O.verticesIndices.push(0,1,2,0,2,3);if(O.verticesIndices.length===0)y=false;else y=true;if(I)I.dispose();I=new CGL.Mesh(x,O);b.set(null);b.set(O);T=false}e.onDelete=function(){if(I)I.dispose()};function S(e,t,n,a,r,o,i){e.vertices=[r,o,a,t,o,a,t,n,a,r,n,a,r,o,i,r,n,i,t,n,i,t,o,i,r,n,i,r,n,a,t,n,a,t,n,i,r,o,i,t,o,i,t,o,a,r,o,a,t,o,i,t,n,i,t,n,a,t,o,a,r,o,i,r,o,a,r,n,a,r,n,i];const s=d.get();let l=1;let c=0;if(p.get()){l=0;c=1}e.setTexCoords([c+s,1-s,l-s,1-s,l-s,0+s,c+s,0+s,l-s,1-s,l-s,0+s,c+s,0+s,c+s,1-s,c+s,0+s,c+s,1-s,l-s,1-s,l-s,0+s,l-s,0+s,c+s,0+s,c+s,1-s,l-s,1-s,l-s,1-s,l-s,0+s,c+s,0+s,c+s,1-s,c+s,1-s,l-s,1-s,l-s,0+s,c+s,0+s]);e.vertexNormals=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]);e.tangents=new Float32Array([-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1]);e.biTangents=new Float32Array([0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0])}function C(e,t,n,a,r,o,i){e.vertices=[r,o,a,t,o,a,t,n,a,r,n,a,r,o,i,r,n,i,t,n,i,t,o,i,r,n,i,r,n,a,t,n,a,t,n,i,r,o,i,t,o,i,t,o,a,r,o,a,t,o,i,t,n,i,t,n,a,t,o,a,r,o,i,r,o,a,r,n,a,r,n,i];const s=.25;const l=1/3;const c=d.get();let u=0;if(p.get())u=1;const _=[];_.push(u+s+c,l*2-c,u+s*2-c,l*2-c,u+s*2-c,l+c,u+s+c,l+c,u+s*4-c,l*2-c,u+s*4-c,l+c,u+s*3+c,l+c,u+s*3+c,l*2-c);if(p.get())_.push(s+c,0-c,s*2-c,0-c,s*2-c,l*1+c,s+c,l*1+c,s+c,l*3+c,s+c,l*2-c,s*2-c,l*2-c,s*2-c,l*3+c);else _.push(s+c,0+c,s+c,l*1-c,s*2-c,l*1-c,s*2-c,0+c,s+c,l*3-c,s*2-c,l*3-c,s*2-c,l*2+c,s+c,l*2+c);_.push(u+s*3-c,1-l-c,u+s*3-c,1-l*2+c,u+s*2+c,1-l*2+c,u+s*2+c,1-l-c,u+s*0+c,1-l-c,u+s*1-c,1-l-c,u+s*1-c,1-l*2+c,u+s*0+c,1-l*2+c);e.setTexCoords(_);e.vertexNormals=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0];e.tangents=new Float32Array([-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1]);e.biTangents=new Float32Array([0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0])}};Ops.Gl.Meshes.Cube_v2.prototype=new CABLES.Op;CABLES.OPS["37b92ba4-cea5-42ae-bf28-a513ca28549c"]={f:Ops.Gl.Meshes.Cube_v2,objName:"Ops.Gl.Meshes.Cube_v2"};Ops.Array.Array3GetNumbers=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inArray("Array",3),a=e.inValueInt("Index"),r=e.outNumber("X"),o=e.outNumber("Y"),i=e.outNumber("Z");n.onChange=a.onChange=s;function s(){let e=n.get();if(!e){r.set(0);o.set(0);i.set(0);return}let t=Math.min(e.length-3,a.get()*3);if(e){r.set(e[t+0]);o.set(e[t+1]);i.set(e[t+2])}}};Ops.Array.Array3GetNumbers.prototype=new CABLES.Op;CABLES.OPS["56882cc4-c40d-4dc0-bf7c-db1b5a7acad0"]={f:Ops.Array.Array3GetNumbers,objName:"Ops.Array.Array3GetNumbers"};Ops.Array.RandomNumbersArray3_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const o=e.inValueInt("numValues",100),i=e.inValueFloat("Min",-1),s=e.inValueFloat("Max",1),l=e.inValueFloat("random seed"),c=e.inValueBool("Last == First"),u=e.inValueBool("Integer",false),_=e.outArray("values",null,3),d=e.outNumber("Total points"),p=e.outNumber("Array length");e.setPortGroup("Value Range",[i,s]);e.setPortGroup("",[l,c]);_.ignoreValueSerialize=true;c.onChange=s.onChange=i.onChange=o.onChange=l.onChange=u.onChange=n;const g=[];n();function n(){Math.randomSeed=l.get();const t=u.get();const n=g.length=Math.max(0,Math.floor(Math.abs((o.get()||0)*3)));if(n===0){_.set(null);d.set(0);p.set(0);return}const a=i.get();const r=s.get();for(let e=0;e<n;e+=3){if(!t){g[e+0]=Math.seededRandom()*(r-a)+a;g[e+1]=Math.seededRandom()*(r-a)+a;g[e+2]=Math.seededRandom()*(r-a)+a}else{g[e+0]=Math.floor(Math.seededRandom()*(r-a+1)+a);g[e+1]=Math.floor(Math.seededRandom()*(r-a+1)+a);g[e+2]=Math.floor(Math.seededRandom()*(r-a+1)+a)}}if(c.get()&&n>3){g[n-3+0]=g[0];g[n-3+1]=g[1];g[n-3+2]=g[2]}_.set(null);_.set(g);d.set(n/3);p.set(n)}};Ops.Array.RandomNumbersArray3_v2.prototype=new CABLES.Op;CABLES.OPS["45b2113a-1ca0-41d8-8d90-db3e394b669c"]={f:Ops.Array.RandomNumbersArray3_v2,objName:"Ops.Array.RandomNumbersArray3_v2"};Ops.Array.LoopArray3=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inArray("Array in"),a=e.outArray("Array out");let r=[];n.onChange=function(){let e=n.get();if(!e){a.set(null);return}if(r.length!==e.length)r.length=e.length+3;let t;for(t=0;t<e.length;t+=3){r[t+0]=e[t+0];r[t+1]=e[t+1];r[t+2]=e[t+2]}r[t+0]=e[0];r[t+1]=e[1];r[t+2]=e[2];a.set(null);a.set(r)}};Ops.Array.LoopArray3.prototype=new CABLES.Op;CABLES.OPS["9a911a46-af51-47c4-acb6-4f7ad026caab"]={f:Ops.Array.LoopArray3,objName:"Ops.Array.LoopArray3"};Ops.Array.LissajouseSpline=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const u=e.inValueSelect("Formula",[1,2,3],1),_=e.inValueInt("A",5),d=e.inValueInt("B",4),p=e.inValueInt("C",1),g=e.inValueInt("D",2),f=e.outArray("Result"),m=e.outNumber("Total points"),v=e.outNumber("Array length");u.onChange=_.onChange=d.onChange=p.onChange=g.onChange=n;n();function n(){var e=13200;var t=40;var n=[];var a=0,r=0,o=0;var i=parseInt(u.get());var s=.03;for(var l=0;l<e;l+=t){var c=l/t;if(i==1){a=Math.sin(l*_.get()*.001);r=Math.cos(l*d.get()*.001);o=Math.sin(l*p.get()*.001)}else if(i==2){a=(Math.cos(l*_.get()*.001)+Math.cos(l*d.get()*.001))/2;r=(Math.sin(l*_.get()*.001)+Math.sin(l*p.get()*.001))/2;o=Math.sin(l*g.get()*.001)}else if(i==3){a=Math.sin(l*_.get()*.001)*(1+Math.cos(l*d.get()*.001))/2;r=Math.sin(l*_.get()*.001)*(1+Math.sin(l*p.get()*.001))/2;o=Math.sin(l*g.get()*.001)}n[c*3+0]=a;n[c*3+1]=r;n[c*3+2]=o;if(c>10&&Math.abs(a-n[0])<s&&Math.abs(r-n[1])<s&&Math.abs(o-n[2])<s){break}}f.set(n);m.set(n.length/3);v.set(n.length)}};Ops.Array.LissajouseSpline.prototype=new CABLES.Op;CABLES.OPS["b4be3f11-20ed-43a0-865d-2b88f0879a6f"]={f:Ops.Array.LissajouseSpline,objName:"Ops.Array.LissajouseSpline"};Ops.Gl.Meshes.Rectangle_v3=function(){CABLES.Op.apply(this,arguments);const y=this;const e={};const t=y.inTrigger("render"),n=y.inValueBool("dorender",true),T=y.inValue("width",1),A=y.inValue("height",1),S=y.inSwitch("pivot x",["left","center","right"],"center"),C=y.inSwitch("pivot y",["top","center","bottom"],"center"),E=y.inSwitch("axis",["xy","xz"],"xy"),M=y.inBool("Flip TexCoord X",false),N=y.inBool("Flip TexCoord Y",true),L=y.inValueInt("num columns",1),w=y.inValueInt("num rows",1),a=y.outTrigger("trigger"),P=y.outObject("geometry",null,"geometry");P.ignoreValueSerialize=true;const D=new CGL.Geometry("rectangle");n.setUiAttribs({title:"Render"});t.setUiAttribs({title:"Trigger"});a.setUiAttribs({title:"Next"});y.setPortGroup("Pivot",[S,C,E]);y.setPortGroup("Size",[T,A]);y.setPortGroup("Structure",[L,w]);y.toWorkPortsNeedToBeLinked(t);let R=null;let U=true;E.onChange=S.onChange=C.onChange=M.onChange=N.onChange=T.onChange=A.onChange=w.onChange=L.onChange=r;function r(){U=true}t.onLinkChanged=()=>{if(!a.isLinked()){if(R)R.dispose();R=null;P.set(null);r()}};y.preRender=t.onTriggered=function(){if(U)o();if(R&&n.get())R.render(y.patch.cg.getShader());a.trigger()};y.onDelete=function(){if(R)R.dispose();r()};function o(){let e=T.get();let t=parseFloat(A.get());let n=0;let a=0;if(typeof e=="string")e=parseFloat(e);if(typeof t=="string")t=parseFloat(t);if(S.get()=="center")n=0;else if(S.get()=="right")n=-e/2;else if(S.get()=="left")n=+e/2;if(C.get()=="center")a=0;else if(C.get()=="top")a=-t/2;else if(C.get()=="bottom")a=+t/2;const r=[];const o=[];const i=[];const s=[];const l=[];const c=[];const u=Math.round(w.get());const _=Math.round(L.get());const d=e/_;const p=t/u;y.log("rect build");let g,f,m;m=E.get();for(f=0;f<=u;f++){for(g=0;g<=_;g++){r.push(g*d-T.get()/2+n);if(m=="xz")r.push(0);r.push(f*p-A.get()/2+a);if(m=="xy")r.push(0);o.push(g/_);o.push(f/u);if(m=="xy"){i.push(0,0,1);s.push(1,0,0);l.push(0,1,0)}else if(m=="xz"){i.push(0,1,0);s.push(1,0,0);l.push(0,0,1)}}}for(g=0;g<_;g++){for(f=0;f<u;f++){const h=g+(_+1)*f;const b=h;const x=h+1;const O=h+_+1;const I=h+1+_+1;if(m=="xy"){c.push(b);c.push(x);c.push(O);c.push(O);c.push(x);c.push(I)}else if(m=="xz"){c.push(b);c.push(O);c.push(x);c.push(x);c.push(O);c.push(I)}}}if(N.get())for(let e=0;e<o.length;e+=2)o[e+1]=1-o[e+1];if(M.get())for(let e=0;e<o.length;e+=2)o[e]=1-o[e];D.clear();D.vertices=r;D.texCoords=o;D.verticesIndices=c;D.vertexNormals=i;D.tangents=s;D.biTangents=l;if(_*u>64e3)D.unIndex();const v=y.patch.cgl;if(!R)R=y.patch.cg.createMesh(D);else R.setGeom(D);P.set(null);P.set(D);U=false}};Ops.Gl.Meshes.Rectangle_v3.prototype=new CABLES.Op;CABLES.OPS["82bb2f8a-77f4-4218-a3ae-8f158f1b7fb1"]={f:Ops.Gl.Meshes.Rectangle_v3,objName:"Ops.Gl.Meshes.Rectangle_v3"};Ops.Trigger.TriggerIfDecreased=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValue("Value"),a=e.outTrigger("Trigger");let r=-Number.MAX_VALUE;n.onChange=function(){const e=n.get();if(e<r){a.trigger()}r=e}};Ops.Trigger.TriggerIfDecreased.prototype=new CABLES.Op;CABLES.OPS["16ec4069-3682-461e-95ff-1d86e3f44512"]={f:Ops.Trigger.TriggerIfDecreased,objName:"Ops.Trigger.TriggerIfDecreased"};Ops.Anim.InOutInAnim=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=new CABLES.Anim;const a=e.inTrigger("Update"),r=e.inValue("Duration Out",.25),o=n.createPort(e,"Easing Out"),i=e.inValue("Value Out",0),s=e.inValue("Hold duration",0),l=e.inValue("Duration In",.25),c=n.createPort(e,"Easing In"),u=e.inValue("Value In",1),_=e.inTriggerButton("Start"),d=e.outTrigger("Next"),p=e.outNumber("Result",0),g=e.outTrigger("Started"),f=e.outTrigger("Middle"),m=e.outTrigger("finished");let v=0;_.onTriggered=h;a.onTriggered=function(){v=CABLES.now()/1e3;if(n.isStarted(v))p.set(n.getValue(v));else p.set(u.get());d.trigger()};u.onChange=function(){p.set(u.get())};function h(){n.clear();n.setValue(v,u.get(),function(){g.trigger()});n.setValue(v+r.get(),i.get(),function(){});n.setValue(v+r.get()+s.get(),i.get(),function(){f.trigger()});n.setValue(v+r.get()+l.get()+s.get(),u.get(),function(){m.trigger()});n.keys[0].setEasing(n.easingFromString(o.get()));n.keys[2].setEasing(n.easingFromString(c.get()))}};Ops.Anim.InOutInAnim.prototype=new CABLES.Op;CABLES.OPS["ae46d30d-9ea6-417b-968b-e7b5726afdde"]={f:Ops.Anim.InOutInAnim,objName:"Ops.Anim.InOutInAnim"};Ops.Trigger.TriggersPerSecond=function(){CABLES.Op.apply(this,arguments);const t=this;const e={};const n=t.inTrigger("exe"),a=t.outNumber("cps");let r=0;let o=0;n.onTriggered=function(){if(r===0)r=CABLES.now();let e=CABLES.now();if(e-r>1e3){r=CABLES.now();t.setUiAttrib({extendTitle:o});a.set(o);o=0}o++}};Ops.Trigger.TriggersPerSecond.prototype=new CABLES.Op;CABLES.OPS["ece2f153-eb31-4268-b0e5-8143ad2fdd81"]={f:Ops.Trigger.TriggersPerSecond,objName:"Ops.Trigger.TriggersPerSecond"};Ops.Value.TriggerOnChangeNumber=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inFloat("Value"),a=e.outTrigger("Next"),r=e.outNumber("Number");n.onChange=function(){r.set(n.get());a.trigger()}};Ops.Value.TriggerOnChangeNumber.prototype=new CABLES.Op;CABLES.OPS["f5c8c433-ce13-49c4-9a33-74e98f110ed0"]={f:Ops.Value.TriggerOnChangeNumber,objName:"Ops.Value.TriggerOnChangeNumber"};Ops.Gl.TextureEffects.ImageCompose=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("render");const a=e.inBool("use viewport size");const r=e.inValueInt("width");const o=e.inValueInt("height");const i=e.inSwitch("filter",["nearest","linear","mipmap"],"linear");const s=e.inValueSelect("wrap",["clamp to edge","repeat","mirrored repeat"]);const l=e.inValueBool("HDR");const c=e.outTrigger("trigger");const u=e.outTexture("texture_out");const _=e.inValueSlider("Background Alpha",0);const d=e.outValue("Aspect Ratio");e.setPortGroup("Texture Size",[a,r,o]);e.setPortGroup("Texture Settings",[s,i,l]);const p=e.patch.cgl;u.set(CGL.Texture.getEmptyTexture(p));let g=null;let f=null;let m=8,v=8;const h=[0,0,0,0];let b=true;const x="".endl()+"uniform float a;".endl()+"void main()".endl()+"{".endl()+"   outColor= vec4(0.0,0.0,0.0,a);".endl()+"}";const O=new CGL.Shader(p,"imgcompose bg");O.setSource(O.getDefaultVertexShader(),x);const I=new CGL.Uniform(O,"f","a",_);let y=CGL.Texture.FILTER_LINEAR;let T=CGL.Texture.WRAP_CLAMP_TO_EDGE;function A(){if(g)g.delete();if(f)f.delete();g=new CGL.TextureEffect(p,{isFloatingPointTexture:l.get()});f=new CGL.Texture(p,{name:"image compose",isFloatingPointTexture:l.get(),filter:y,wrap:T,width:Math.ceil(r.get()),height:Math.ceil(o.get())});g.setSourceTexture(f);u.set(CGL.Texture.getEmptyTexture(p));b=false}l.onChange=function(){b=true};function S(){if(!g)A();if(a.get()){m=p.getViewPort()[2];v=p.getViewPort()[3]}else{m=Math.ceil(r.get());v=Math.ceil(o.get())}if((m!=f.width||v!=f.height)&&(m!==0&&v!==0)){o.set(v);r.set(m);f.setSize(m,v);d.set(m/v);g.setSourceTexture(f);u.set(CGL.Texture.getEmptyTexture(p));u.set(f)}if(u.get()&&y!=CGL.Texture.FILTER_NEAREST){if(!u.get().isPowerOfTwo())e.setUiError("hintnpot","texture dimensions not power of two! - texture filtering when scaling will not work on ios devices.",0);else e.setUiError("hintnpot",null,0)}else e.setUiError("hintnpot",null,0)}function C(){if(a.get()){r.setUiAttribs({greyout:true});o.setUiAttribs({greyout:true})}else{r.setUiAttribs({greyout:false});o.setUiAttribs({greyout:false})}}a.onChange=function(){C();if(a.get()){r.onChange=null;o.onChange=null}else{r.onChange=S;o.onChange=S}S()};e.preRender=function(){E();O.bind()};var E=function(){if(!g||b){A()}const e=p.getViewPort();h[0]=e[0];h[1]=e[1];h[2]=e[2];h[3]=e[3];p.gl.blendFunc(p.gl.SRC_ALPHA,p.gl.ONE_MINUS_SRC_ALPHA);S();p.currentTextureEffect=g;g.setSourceTexture(f);g.startEffect();p.pushShader(O);p.currentTextureEffect.bind();p.setTexture(0,p.currentTextureEffect.getCurrentSourceTexture().tex);p.currentTextureEffect.finish();p.popShader();c.trigger();u.set(g.getCurrentSourceTexture());g.endEffect();p.setViewPort(h[0],h[1],h[2],h[3]);p.gl.blendFunc(p.gl.SRC_ALPHA,p.gl.ONE_MINUS_SRC_ALPHA);p.currentTextureEffect=null};function M(){if(s.get()=="repeat")T=CGL.Texture.WRAP_REPEAT;if(s.get()=="mirrored repeat")T=CGL.Texture.WRAP_MIRRORED_REPEAT;if(s.get()=="clamp to edge")T=CGL.Texture.WRAP_CLAMP_TO_EDGE;b=true;S()}s.set("repeat");s.onChange=M;function N(){if(i.get()=="nearest")y=CGL.Texture.FILTER_NEAREST;if(i.get()=="linear")y=CGL.Texture.FILTER_LINEAR;if(i.get()=="mipmap")y=CGL.Texture.FILTER_MIPMAP;b=true;S()}i.set("linear");i.onChange=N;a.set(true);n.onTriggered=E;e.preRender=E;r.set(640);o.set(360);N();M();C()};Ops.Gl.TextureEffects.ImageCompose.prototype=new CABLES.Op;CABLES.OPS["5c04608d-1e42-4e36-be00-1be4a81fc309"]={f:Ops.Gl.TextureEffects.ImageCompose,objName:"Ops.Gl.TextureEffects.ImageCompose"};Ops.Gl.TextureEffects.DrawImage_v2=function(){CABLES.Op.apply(this,arguments);const n=this;const e={drawimage_frag:"#ifdef HAS_TEXTURES\n    IN vec2 texCoord;\n    UNI sampler2D tex;\n    UNI sampler2D image;\n#endif\n\nIN mat3 transform;\nUNI float rotate;\n\n{{CGL.BLENDMODES}}\n\n#ifdef HAS_TEXTUREALPHA\n   UNI sampler2D imageAlpha;\n#endif\n\nUNI float amount;\n\n#ifdef ASPECT_RATIO\n    UNI float aspectTex;\n    UNI float aspectPos;\n#endif\n\nvoid main()\n{\n    vec4 blendRGBA=vec4(0.0,0.0,0.0,1.0);\n    #ifdef HAS_TEXTURES\n        vec2 tc=texCoord;\n\n        #ifdef TEX_FLIP_X\n            tc.x=1.0-tc.x;\n        #endif\n        #ifdef TEX_FLIP_Y\n            tc.y=1.0-tc.y;\n        #endif\n\n        #ifdef ASPECT_RATIO\n            #ifdef ASPECT_AXIS_X\n                tc.y=(1.0-aspectPos)-(((1.0-aspectPos)-tc.y)*aspectTex);\n            #endif\n            #ifdef ASPECT_AXIS_Y\n                tc.x=(1.0-aspectPos)-(((1.0-aspectPos)-tc.x)/aspectTex);\n            #endif\n        #endif\n\n        #ifdef TEX_TRANSFORM\n            vec3 coordinates=vec3(tc.x, tc.y,1.0);\n            tc=(transform * coordinates ).xy;\n        #endif\n\n        blendRGBA=texture(image,tc);\n\n        vec3 blend=blendRGBA.rgb;\n        vec4 baseRGBA=texture(tex,texCoord);\n        vec3 base=baseRGBA.rgb;\n        vec3 colNew=_blend(base,blend);\n\n        #ifdef REMOVE_ALPHA_SRC\n            blendRGBA.a=1.0;\n        #endif\n\n        #ifdef HAS_TEXTUREALPHA\n            vec4 colImgAlpha=texture(imageAlpha,tc);\n            float colImgAlphaAlpha=colImgAlpha.a;\n\n            #ifdef ALPHA_FROM_LUMINANCE\n                vec3 gray = vec3(dot(vec3(0.2126,0.7152,0.0722), colImgAlpha.rgb ));\n                colImgAlphaAlpha=(gray.r+gray.g+gray.b)/3.0;\n            #endif\n\n            #ifdef ALPHA_FROM_INV_UMINANCE\n                vec3 gray = vec3(dot(vec3(0.2126,0.7152,0.0722), colImgAlpha.rgb ));\n                colImgAlphaAlpha=1.0-(gray.r+gray.g+gray.b)/3.0;\n            #endif\n\n            #ifdef INVERT_ALPHA\n            colImgAlphaAlpha=clamp(colImgAlphaAlpha,0.0,1.0);\n            colImgAlphaAlpha=1.0-colImgAlphaAlpha;\n            #endif\n\n            blendRGBA.a=colImgAlphaAlpha*blendRGBA.a;\n        #endif\n    #endif\n\n    float am=amount;\n\n    #ifdef CLIP_REPEAT\n        if(tc.y>1.0 || tc.y<0.0 || tc.x>1.0 || tc.x<0.0)\n        {\n            // colNew.rgb=vec3(0.0);\n            am=0.0;\n        }\n    #endif\n\n    #ifdef ASPECT_RATIO\n        #ifdef ASPECT_CROP\n            if(tc.y>1.0 || tc.y<0.0 || tc.x>1.0 || tc.x<0.0) colNew.rgb=base.rgb;//vec3(0.0);\n        #endif\n    #endif\n\n\n\n    blendRGBA.rgb=mix( colNew, base ,1.0-blendRGBA.a*am);\n    blendRGBA.a=1.0;\n\n    outColor= blendRGBA;\n\n}",drawimage_vert:"IN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\n\nUNI mat4 projMatrix;\nUNI mat4 mvMatrix;\n\nUNI float posX;\nUNI float posY;\nUNI float scaleX;\nUNI float scaleY;\nUNI float rotate;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nOUT mat3 transform;\n\nvoid main()\n{\n   texCoord=attrTexCoord;\n   norm=attrVertNormal;\n\n   #ifdef TEX_TRANSFORM\n        vec3 coordinates=vec3(attrTexCoord.x, attrTexCoord.y,1.0);\n        float angle = radians( rotate );\n        vec2 scale= vec2(scaleX,scaleY);\n        vec2 translate= vec2(posX,posY);\n\n        transform = mat3(   scale.x * cos( angle ), scale.x * sin( angle ), 0.0,\n            - scale.y * sin( angle ), scale.y * cos( angle ), 0.0,\n            - 0.5 * scale.x * cos( angle ) + 0.5 * scale.y * sin( angle ) - 0.5 * translate.x*2.0 + 0.5,  - 0.5 * scale.x * sin( angle ) - 0.5 * scale.y * cos( angle ) - 0.5 * translate.y*2.0 + 0.5, 1.0);\n   #endif\n\n   gl_Position = projMatrix * mvMatrix * vec4(vPosition,  1.0);\n}\n"};var t=n.inTrigger("render");var a=CGL.TextureEffect.AddBlendSelect(n,"blendMode");var r=n.inValueSlider("amount",1);var o=n.inTexture("image");var i=n.inValueBool("removeAlphaSrc",false);var s=n.inTexture("imageAlpha");var l=n.inValueSelect("alphaSrc",["alpha channel","luminance","luminance inv"]);var c=n.inValueBool("invert alpha channel");const u=n.inValueBool("Aspect Ratio",false);const _=n.inValueSelect("Stretch Axis",["X","Y"],"X");const d=n.inValueSlider("Position",0);const p=n.inValueBool("Crop",false);var g=n.outTrigger("trigger");a.set("normal");var f=n.patch.cgl;var m=new CGL.Shader(f,"drawimage");s.onLinkChanged=v;n.setPortGroup("Mask",[s,l,c]);n.setPortGroup("Aspect Ratio",[u,d,p,_]);i.onChange=T;function v(){if(s.isLinked()){i.setUiAttribs({greyout:true});l.setUiAttribs({greyout:false});c.setUiAttribs({greyout:false})}else{i.setUiAttribs({greyout:false});l.setUiAttribs({greyout:true});c.setUiAttribs({greyout:true})}}n.toWorkPortsNeedToBeLinked(o);m.setSource(e.drawimage_vert,e.drawimage_frag);var h=new CGL.Uniform(m,"t","tex",0);var b=new CGL.Uniform(m,"t","image",1);var x=new CGL.Uniform(m,"t","imageAlpha",2);const O=new CGL.Uniform(m,"f","aspectTex",1);const I=new CGL.Uniform(m,"f","aspectPos",d);c.onChange=function(){if(c.get())m.define("INVERT_ALPHA");else m.removeDefine("INVERT_ALPHA")};u.onChange=y;p.onChange=y;_.onChange=y;function y(){m.removeDefine("ASPECT_AXIS_X");m.removeDefine("ASPECT_AXIS_Y");if(u.get()){m.define("ASPECT_RATIO");if(p.get())m.define("ASPECT_CROP");else m.removeDefine("ASPECT_CROP");if(_.get()=="X")m.define("ASPECT_AXIS_X");if(_.get()=="Y")m.define("ASPECT_AXIS_Y");d.setUiAttribs({greyout:false});p.setUiAttribs({greyout:false});_.setUiAttribs({greyout:false})}else{m.removeDefine("ASPECT_RATIO");if(p.get())m.define("ASPECT_CROP");else m.removeDefine("ASPECT_CROP");if(_.get()=="X")m.define("ASPECT_AXIS_X");if(_.get()=="Y")m.define("ASPECT_AXIS_Y");d.setUiAttribs({greyout:true});p.setUiAttribs({greyout:true});_.setUiAttribs({greyout:true})}}function T(){if(i.get())m.define("REMOVE_ALPHA_SRC");else m.removeDefine("REMOVE_ALPHA_SRC")}l.onChange=function(){m.toggleDefine("ALPHA_FROM_LUMINANCE",l.get()=="luminance");m.toggleDefine("ALPHA_FROM_INV_UMINANCE",l.get()=="luminance_inv")};l.set("alpha channel");{var A=n.inValueBool("flip x");var S=n.inValueBool("flip y");A.onChange=function(){if(A.get())m.define("TEX_FLIP_X");else m.removeDefine("TEX_FLIP_X")};S.onChange=function(){if(S.get())m.define("TEX_FLIP_Y");else m.removeDefine("TEX_FLIP_Y")}}{var C=n.inValueBool("Transform");var E=n.inValueSlider("Scale X",1);var M=n.inValueSlider("Scale Y",1);var N=n.inValue("Position X",0);var L=n.inValue("Position Y",0);var w=n.inValue("Rotation",0);var P=n.inValueBool("Clip Repeat",false);P.onChange=D;function D(){if(P.get())m.define("CLIP_REPEAT");else m.removeDefine("CLIP_REPEAT")}var R=new CGL.Uniform(m,"f","scaleX",E);var U=new CGL.Uniform(m,"f","scaleY",M);var j=new CGL.Uniform(m,"f","posX",N);var G=new CGL.Uniform(m,"f","posY",L);var V=new CGL.Uniform(m,"f","rotate",w);C.onChange=k}function k(){m.toggleDefine("TEX_TRANSFORM",C.get());if(C.get()){E.setUiAttribs({greyout:false});M.setUiAttribs({greyout:false});N.setUiAttribs({greyout:false});L.setUiAttribs({greyout:false});w.setUiAttribs({greyout:false})}else{E.setUiAttribs({greyout:true});M.setUiAttribs({greyout:true});N.setUiAttribs({greyout:true});L.setUiAttribs({greyout:true});w.setUiAttribs({greyout:true})}}CGL.TextureEffect.setupBlending(n,m,a,r);var B=new CGL.Uniform(m,"f","amount",r);s.onChange=function(){if(s.get()&&s.get().tex){m.define("HAS_TEXTUREALPHA")}else{m.removeDefine("HAS_TEXTUREALPHA")}};function z(){if(!CGL.TextureEffect.checkOpInEffect(n))return;var e=o.get();if(e&&e.tex&&r.get()>0){f.pushShader(m);f.currentTextureEffect.bind();const t=f.currentTextureEffect.getCurrentSourceTexture();f.setTexture(0,t.tex);O.setValue(1/(e.height/e.width*t.width/t.height));f.setTexture(1,e.tex);if(s.get()&&s.get().tex){f.setTexture(2,s.get().tex)}f.currentTextureEffect.finish();f.popShader()}g.trigger()}t.onTriggered=z;k();T();v();y()};Ops.Gl.TextureEffects.DrawImage_v2.prototype=new CABLES.Op;CABLES.OPS["f94b5136-61fd-4558-8348-e7c8db5a6348"]={f:Ops.Gl.TextureEffects.DrawImage_v2,objName:"Ops.Gl.TextureEffects.DrawImage_v2"};Ops.Gl.Shader.BasicMaterial_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={basicmaterial_frag:"{{MODULES_HEAD}}\n\nIN vec2 texCoord;\nUNI vec4 color;\n// UNI float r;\n// UNI float g;\n// UNI float b;\n// UNI float a;\n\n#ifdef HAS_TEXTURES\n    IN vec2 texCoordOrig;\n    #ifdef HAS_TEXTURE_DIFFUSE\n        UNI sampler2D tex;\n    #endif\n    #ifdef HAS_TEXTURE_OPACITY\n        UNI sampler2D texOpacity;\n   #endif\n#endif\n\nvoid main()\n{\n    {{MODULE_BEGIN_FRAG}}\n    vec4 col=color;\n\n    #ifdef HAS_TEXTURES\n        // vec2 uv=vec2(texCoord.s,1.0-texCoord.t);\n        vec2 uv=texCoord;\n\n        #ifdef HAS_TEXTURE_DIFFUSE\n            col=texture(tex,uv);\n\n            #ifdef COLORIZE_TEXTURE\n                col.r*=color.r;\n                col.g*=color.g;\n                col.b*=color.b;\n            #endif\n        #endif\n        col.a*=color.a;\n        #ifdef HAS_TEXTURE_OPACITY\n            #ifdef TRANSFORMALPHATEXCOORDS\n                // uv=vec2(texCoordOrig.s,1.0-texCoordOrig.t);\n                uv=texCoordOrig;\n            #endif\n            #ifdef ALPHA_MASK_ALPHA\n                col.a*=texture(texOpacity,uv).a;\n            #endif\n            #ifdef ALPHA_MASK_LUMI\n                col.a*=dot(vec3(0.2126,0.7152,0.0722), texture(texOpacity,uv).rgb);\n            #endif\n            #ifdef ALPHA_MASK_R\n                col.a*=texture(texOpacity,uv).r;\n            #endif\n            #ifdef ALPHA_MASK_G\n                col.a*=texture(texOpacity,uv).g;\n            #endif\n            #ifdef ALPHA_MASK_B\n                col.a*=texture(texOpacity,uv).b;\n            #endif\n            // #endif\n        #endif\n    #endif\n\n    {{MODULE_COLOR}}\n\n    #ifdef DISCARDTRANS\n        if(col.a<0.2) discard;\n    #endif\n\n    outColor = col;\n}\n",basicmaterial_vert:"IN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN float attrVertIndex;\n\n{{MODULES_HEAD}}\n\nOUT vec3 norm;\nOUT vec2 texCoord;\nOUT vec2 texCoordOrig;\n\nUNI mat4 projMatrix;\nUNI mat4 modelMatrix;\nUNI mat4 viewMatrix;\n\n#ifdef HAS_TEXTURES\n    UNI float diffuseRepeatX;\n    UNI float diffuseRepeatY;\n    UNI float texOffsetX;\n    UNI float texOffsetY;\n#endif\n\nvoid main()\n{\n    mat4 mMatrix=modelMatrix;\n    mat4 mvMatrix;\n\n    norm=attrVertNormal;\n    texCoordOrig=vec2(attrTexCoord.x,1.0-attrTexCoord.y);\n    texCoord=vec2(attrTexCoord.x,1.0-attrTexCoord.y);\n    #ifdef HAS_TEXTURES\n        texCoord.x=texCoord.x*diffuseRepeatX+texOffsetX;\n        texCoord.y=texCoord.y*diffuseRepeatY+texOffsetY;\n    #endif\n\n    vec4 pos = vec4(vPosition, 1.0);\n\n    #ifdef BILLBOARD\n       vec3 position=vPosition;\n       mvMatrix=viewMatrix*modelMatrix;\n\n       gl_Position = projMatrix * mvMatrix * vec4((\n           position.x * vec3(\n               mvMatrix[0][0],\n               mvMatrix[1][0],\n               mvMatrix[2][0] ) +\n           position.y * vec3(\n               mvMatrix[0][1],\n               mvMatrix[1][1],\n               mvMatrix[2][1]) ), 1.0);\n    #endif\n\n    {{MODULE_VERTEX_POSITION}}\n\n    #ifndef BILLBOARD\n        mvMatrix=viewMatrix * mMatrix;\n    #endif\n\n\n    #ifndef BILLBOARD\n        // gl_Position = projMatrix * viewMatrix * modelMatrix * pos;\n        gl_Position = projMatrix * mvMatrix * pos;\n    #endif\n}\n"};const n=e.inTrigger("render");const a=e.outTrigger("trigger");const r=e.outObject("shader");r.ignoreValueSerialize=true;const o=e.patch.cgl;e.toWorkPortsNeedToBeLinked(n);const i=new CGL.Shader(o,"basicmaterialnew");i.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]);i.setSource(t.basicmaterial_vert,t.basicmaterial_frag);r.set(i);n.onTriggered=s;e.preRender=function(){i.bind();s()};function s(){if(!i)return;o.pushShader(i);i.popTextures();if(g&&p.get())i.pushTexture(g,p.get().tex);if(h&&v.get())i.pushTexture(h,v.get().tex);a.trigger();o.popShader()}const l=e.inValueSlider("r",Math.random());const c=e.inValueSlider("g",Math.random());const u=e.inValueSlider("b",Math.random());const _=e.inValueSlider("a",1);l.setUiAttribs({colorPick:true});const d=new CGL.Uniform(i,"4f","color",l,c,u,_);e.setPortGroup("Color",[l,c,u,_]);var p=e.inTexture("texture");var g=null;p.onChange=f;function f(){if(p.get()){if(!i.hasDefine("HAS_TEXTURE_DIFFUSE"))i.define("HAS_TEXTURE_DIFFUSE");if(!g)g=new CGL.Uniform(i,"t","texDiffuse",0);y.setUiAttribs({greyout:false});T.setUiAttribs({greyout:false});A.setUiAttribs({greyout:false});S.setUiAttribs({greyout:false});m.setUiAttribs({greyout:false})}else{i.removeUniform("texDiffuse");i.removeDefine("HAS_TEXTURE_DIFFUSE");g=null;y.setUiAttribs({greyout:true});T.setUiAttribs({greyout:true});A.setUiAttribs({greyout:true});S.setUiAttribs({greyout:true});m.setUiAttribs({greyout:true})}}const m=e.inValueBool("colorizeTexture",false);e.setPortGroup("Color Texture",[p,m]);var v=e.inTexture("textureOpacity");var h=null;e.alphaMaskSource=e.inSwitch("Alpha Mask Source",["Luminance","R","G","B","A"],"Luminance");e.alphaMaskSource.onChange=b;e.alphaMaskSource.setUiAttribs({greyout:true});function b(){if(e.alphaMaskSource.get()=="A")i.define("ALPHA_MASK_ALPHA");else i.removeDefine("ALPHA_MASK_ALPHA");if(e.alphaMaskSource.get()=="Luminance")i.define("ALPHA_MASK_LUMI");else i.removeDefine("ALPHA_MASK_LUMI");if(e.alphaMaskSource.get()=="R")i.define("ALPHA_MASK_R");else i.removeDefine("ALPHA_MASK_R");if(e.alphaMaskSource.get()=="G")i.define("ALPHA_MASK_G");else i.removeDefine("ALPHA_MASK_G");if(e.alphaMaskSource.get()=="B")i.define("ALPHA_MASK_B");else i.removeDefine("ALPHA_MASK_B")}v.onChange=x;function x(){if(v.get()){if(h!==null)return;i.removeUniform("texOpacity");i.define("HAS_TEXTURE_OPACITY");if(!h)h=new CGL.Uniform(i,"t","texOpacity",1);e.alphaMaskSource.setUiAttribs({greyout:false});I.setUiAttribs({greyout:false});O.setUiAttribs({greyout:false})}else{i.removeUniform("texOpacity");i.removeDefine("HAS_TEXTURE_OPACITY");h=null;e.alphaMaskSource.setUiAttribs({greyout:true});I.setUiAttribs({greyout:true});O.setUiAttribs({greyout:true})}b()}var O=e.inValueBool("Opacity TexCoords Transform",false);const I=e.inValueBool("Discard Transparent Pixels");I.onChange=function(){if(I.get())i.define("DISCARDTRANS");else i.removeDefine("DISCARDTRANS")};O.onChange=function(){if(O.get())i.define("TRANSFORMALPHATEXCOORDS");else i.removeDefine("TRANSFORMALPHATEXCOORDS")};e.setPortGroup("Opacity",[v,e.alphaMaskSource,I,O]);m.onChange=function(){if(m.get())i.define("COLORIZE_TEXTURE");else i.removeDefine("COLORIZE_TEXTURE")};const y=e.inValue("diffuseRepeatX",1);const T=e.inValue("diffuseRepeatY",1);const A=e.inValue("Tex Offset X",0);const S=e.inValue("Tex Offset Y",0);const C=new CGL.Uniform(i,"f","diffuseRepeatX",y);const E=new CGL.Uniform(i,"f","diffuseRepeatY",T);const M=new CGL.Uniform(i,"f","texOffsetX",A);const N=new CGL.Uniform(i,"f","texOffsetY",S);e.setPortGroup("Texture Transform",[y,T,A,S]);const L=e.inValueBool("billboard",false);L.onChange=function(){if(L.get())i.define("BILLBOARD");else i.removeDefine("BILLBOARD")};x();f()};Ops.Gl.Shader.BasicMaterial_v2.prototype=new CABLES.Op;CABLES.OPS["51f2207b-daaa-447f-bdbe-87fdd72f0c40"]={f:Ops.Gl.Shader.BasicMaterial_v2,objName:"Ops.Gl.Shader.BasicMaterial_v2"};Ops.Gl.Meshes.Circle=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("render"),N=e.inValue("radius",.5),L=e.inValueSlider("innerRadius",0),w=e.inValueInt("segments",40),P=e.inValueSlider("percent",1),D=e.inValue("steps",0),R=e.inValueBool("invertSteps",false),U=e.inSwitch("mapping",["flat","round"]),j=e.inValueBool("Spline",false),a=e.inValueBool("Draw",true),r=e.outTrigger("trigger"),G=e.outObject("geometry",null,"geometry");e.setPortGroup("Size",[N,L]);e.setPortGroup("Display",[P,D,R]);U.set("flat");U.onChange=w.onChange=N.onChange=L.onChange=P.onChange=D.onChange=R.onChange=j.onChange=u;G.ignoreValueSerialize=true;const V=e.patch.cgl;let k=new CGL.Geometry("circle");let B=null;const o=-1;let i=0;let s=null;let z=true;n.onTriggered=l;e.preRender=()=>{l()};function l(){if(!CGL.TextureEffect.checkOpNotInTextureEffect(e))return;if(z)c();s=V.getShader();if(!s)return;i=s.glPrimitive;if(j.get())s.glPrimitive=V.gl.LINE_STRIP;if(a.get())B.render(s);r.trigger();s.glPrimitive=i}function c(){const n=Math.max(3,Math.floor(w.get()));k.clear();const t=[];const a=[];const r=[];const o=[];const i=[];let s=0,l=0;let c=0,u=0;let _=0,d=0;let p=0,g=0;let f=0,m=0;let v=0,h=0;let b=0,x=0;let O=0,I=0;const y=Math.max(0,P.get());const T=[];if(j.get()){let e=0;let t=0;const A=[];for(s=0;s<=n*y;s++){l=360/n*s*CGL.DEG2RAD;O=Math.cos(l)*N.get();I=Math.sin(l)*N.get();x=.5;if(s>0){T.push(e);T.push(t);T.push(0);b=1-(s-1)/n;A.push(b,x)}T.push(O);T.push(I);T.push(0);e=O;t=I}k.setPointVertices(T)}else if(L.get()<=0){for(s=0;s<=n*y;s++){l=360/n*s*CGL.DEG2RAD;O=Math.cos(l)*N.get();I=Math.sin(l)*N.get();if(U.get()=="flat"){b=(Math.cos(l)+1)/2;x=1-(Math.sin(l)+1)/2;v=.5;h=.5}else if(U.get()=="round"){b=1-s/n;x=0;v=b;h=1}t.push([O,I,0],[c,u,0],[0,0,0]);a.push(b,x,_,d,v,h);r.push(0,0,1,0,0,1,0,0,1);o.push(1,0,0,1,0,0,1,0,0);i.push(0,1,0,0,1,0,0,1,0);_=b;d=x;c=O;u=I}k=CGL.Geometry.buildFromFaces(t,"circle");k.vertexNormals=r;k.tangents=o;k.biTangents=i;k.texCoords=a}else{let e=0;const S=n*y;const C=0;for(s=0;s<=S;s++){e++;l=360/n*s*CGL.DEG2RAD;O=Math.cos(l)*N.get();I=Math.sin(l)*N.get();const E=Math.cos(l)*L.get()*N.get();const M=Math.sin(l)*L.get()*N.get();if(U.get()=="round"){b=1-s/n;x=0;v=b;h=1}if(D.get()===0||e%parseInt(D.get(),10)===0&&!R.get()||e%parseInt(D.get(),10)!==0&&R.get()){t.push([O,I,0],[c,u,0],[E,M,0]);t.push([E,M,0],[c,u,0],[p,g,0]);a.push(b,0,_,0,v,1,b,1,_,0,f,1);r.push(0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1);o.push(1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0);i.push(0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0)}f=v;m=h;_=b;d=x;c=O;u=I;p=E;g=M}k=CGL.Geometry.buildFromFaces(t,"circle");k.vertexNormals=r;k.tangents=o;k.biTangents=i;if(U.get()=="flat")k.mapTexCoords2d();else k.texCoords=a}G.set(null);G.set(k);if(k.vertices.length==0)return;if(B)B.dispose();B=null;B=new CGL.Mesh(V,k);z=false}function u(){z=true}e.onDelete=function(){if(B)B.dispose()}};Ops.Gl.Meshes.Circle.prototype=new CABLES.Op;CABLES.OPS["4db917cc-2cef-43f4-83d5-38c4572fe943"]={f:Ops.Gl.Meshes.Circle,objName:"Ops.Gl.Meshes.Circle"};Ops.Extension.ReactionDiffusion.ReactionDiffusionSystem=function(){CABLES.Op.apply(this,arguments);const e=this;const t={rds_frag:"IN vec2 texCoord;\n\nUNI float screenWidth;\nUNI float screenHeight;\n\nUNI sampler2D verttexture;\n\nUNI float f;\nUNI float k;\nUNI float dt;\nUNI float dA;\nUNI float dB;\nUNI float factor;\n\nvec2 laplace(sampler2D texSource, vec2 texOffset) {\n    vec2 tc0 = texCoord + vec2(-texOffset.s, -texOffset.t);\n    vec2 tc1 = texCoord + vec2(         0.0, -texOffset.t);\n    vec2 tc2 = texCoord + vec2(+texOffset.s, -texOffset.t);\n    vec2 tc3 = texCoord + vec2(-texOffset.s,          0.0);\n    vec2 tc4 = texCoord + vec2(         0.0,          0.0);\n    vec2 tc5 = texCoord + vec2(+texOffset.s,          0.0);\n    vec2 tc6 = texCoord + vec2(-texOffset.s, +texOffset.t);\n    vec2 tc7 = texCoord + vec2(         0.0, +texOffset.t);\n    vec2 tc8 = texCoord + vec2(+texOffset.s, +texOffset.t);\n\n    vec4 col0 = texture2D(texSource, tc0);\n    vec4 col1 = texture2D(texSource, tc1);\n    vec4 col2 = texture2D(texSource, tc2);\n    vec4 col3 = texture2D(texSource, tc3);\n    vec4 col4 = texture2D(texSource, tc4);\n    vec4 col5 = texture2D(texSource, tc5);\n    vec4 col6 = texture2D(texSource, tc6);\n    vec4 col7 = texture2D(texSource, tc7);\n    vec4 col8 = texture2D(texSource, tc8);\n\n    vec4 lapl = ( .05 * col0 + .2 * col1 + .05 * col2 +\n        .2 * col3  - 1.0 * col4 + .2 * col5 +\n        .05 * col6 + .2 * col7 + .05 * col8);\n\n    return lapl.rg;\n}\n\nvoid main() {\n    vec2 texOff = vec2(1.0/screenWidth, 1.0/screenHeight);\n\n\n    vec2 uv = texture2D(verttexture, texCoord).rg;\n\n\n    vec2 lapl = laplace(verttexture, texOff.st);\n\n    float du = dA*lapl.r - uv.r*uv.g*uv.g + f*(1.0 - uv.r);\n    float dv = dB*lapl.g + uv.r*uv.g*uv.g - (f+k)*uv.g;\n\n    vec2 dst = uv + dt*vec2(du, dv);\n\n\n    outColor = vec4(dst.r, dst.g, 0.0, 1.0);\n}\n\n\n",rds_vert:"IN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN float attrVertIndex;\nOUT vec2 texCoord;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\nUNI int flipTexture;\n\nvoid main()\n{\n   texCoord=attrTexCoord;\n   vec4 pos=vec4(vPosition,  1.0);\n   mat4 mMatrix=modelMatrix;\n\n   gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"};const n=e.inTrigger("render");const a=e.inTriggerButton("reset");const r=e.outTrigger("trigger");const o=e.outTrigger("draw");const i=e.outTexture("Texture");const s=e.inValueBool("Use Viewport Size",true);const l=e.inValueInt("Width",512);const c=e.inValueInt("Height",512);s.onChange=D;l.onChange=c.onChange=R;e.setPortGroup("Texture Size",[s,l,c]);const u=e.inValueSlider("speed",4);const _=e.inValueSelect("RD Mode",["Default","Mitosis","Coral","Worms","Custom"],"Default");e.setPortGroup("Reaction Diffusion",[u,_]);const d={Default:{feed:.055,kill:.062,delta:1,ratioA:1,ratioB:.5},Mitosis:{feed:.0367,kill:.0649,delta:1,ratioA:1,ratioB:.43},Coral:{feed:.07,kill:.062,delta:1,ratioA:1,ratioB:.475},Worms:{feed:.042,kill:.062,delta:1,ratioA:1,ratioB:.56}};const p=e.inValueSlider("feed");const g=e.inValueSlider("kill");const f=e.inValueSlider("delta");const m=e.inValueSlider("Ratio A");const v=e.inValueSlider("Ratio B");_.onChange=P;e.setPortGroup("Custom values",[p,g,f,m,v]);const h=e.patch.cgl;let b=[0,0,0,0];let x=null;let O=true;let I=null;let y=CGL.MESHES.getSimpleRect(h,"shader2texture rect");const T=new CGL.Shader(h,"reactiondiffusion");T.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]);T.setSource(t.rds_vert,t.rds_frag);const A=new CGL.Uniform(T,"f","f",p);const S=new CGL.Uniform(T,"f","k",g);const C=new CGL.Uniform(T,"f","dt",f);const E=new CGL.Uniform(T,"f","dA",m);const M=new CGL.Uniform(T,"f","dB",v);const N=new CGL.Uniform(T,"i","flipTexture",0);const L=new CGL.Uniform(T,"f","screenWidth",l);const w=new CGL.Uniform(T,"f","screenHeight",c);D();P();n.onTriggered=G;a.onTriggered=R;function P(){let e=d[_.get()];if(e===undefined){p.setUiAttribs({greyout:false});g.setUiAttribs({greyout:false});f.setUiAttribs({greyout:false});m.setUiAttribs({greyout:false});v.setUiAttribs({greyout:false})}else{p.setUiAttribs({greyout:true});g.setUiAttribs({greyout:true});f.setUiAttribs({greyout:true});m.setUiAttribs({greyout:true});v.setUiAttribs({greyout:true});p.set(e.feed);g.set(e.kill);f.set(e.delta);m.set(e.ratioA);v.set(e.ratioB)}}function D(){if(s.get()){l.setUiAttribs({greyout:true});c.setUiAttribs({greyout:true})}else{l.setUiAttribs({greyout:false});c.setUiAttribs({greyout:false})}R()}function R(){O=true}function U(){O=false;if(x)x.delete();x=null;let e=l.get();let t=c.get();let n=CGL.Texture.FILTER_LINEAR;let a=CGL.Texture.WRAP_CLAMP_TO_EDGE;if(s.get()){e=h.getViewPort()[2];t=h.getViewPort()[3];l.set(e);c.set(t)}L.set(e);w.set(t);if(h.glVersion>=2){x=new CGL.Framebuffer2(h,e,t,{isFloatingPointTexture:true,multisampling:false,wrap:a,filter:n,depth:false,multisamplingSamples:0,clear:true})}else{x=new CGL.Framebuffer(h,l.get(),c.get(),{isFloatingPointTexture:true,filter:n,wrap:a})}}function j(e,t){x.renderStart(h);h.pushPMatrix();mat4.identity(h.pMatrix);h.pushViewMatrix();mat4.identity(h.vMatrix);h.pushModelMatrix();mat4.identity(h.mMatrix);h.setTexture(0,e);y.render(T);h.popPMatrix();h.popModelMatrix();h.popViewMatrix();if(t===0)o.trigger();x.renderEnd(h);return x.getTextureColor()}function G(){if(!T)return;let e=h.getViewPort();if(!x||O)U();if(s.get()&&x&&(e[2]!=x.getTextureColor().width||e[3]!=x.getTextureColor().height)){U()}b[0]=e[0];b[1]=e[1];b[2]=e[2];b[3]=e[3];h.pushShader(T);let t,n=x.getTextureColor();for(let e=0;e<u.get();e++){t=j(n.tex,e);n=t}h.popShader();h.gl.viewport(b[0],b[1],b[2],b[3]);i.set(t);r.trigger()}};Ops.Extension.ReactionDiffusion.ReactionDiffusionSystem.prototype=new CABLES.Op;CABLES.OPS["a0e8f79c-115c-489f-b990-5e204779c8c6"]={f:Ops.Extension.ReactionDiffusion.ReactionDiffusionSystem,objName:"Ops.Extension.ReactionDiffusion.ReactionDiffusionSystem"};Ops.WebAudio.AudioAnalyzer=function(){CABLES.Op.apply(this,arguments);const n=this;const e={};const t=n.addInPort(new CABLES.Port(n,"refresh",CABLES.OP_PORT_TYPE_FUNCTION));const a=CABLES.WEBAUDIO.createAudioContext(n);const r=n.inSwitch("FFT size",[64,128,256,512,1024],256);const o=a.createAnalyser();o.smoothingTimeConstant=.3;o.fftSize=256;const i=CABLES.WEBAUDIO.createAudioInPort(n,"Audio In",o);const s=n.inValueSelect("Data",["Frequency","Time Domain"],"Frequency");const l=n.outTrigger("Next");const c=CABLES.WEBAUDIO.createAudioOutPort(n,"Audio Out",o);const u=n.addOutPort(new CABLES.Port(n,"average volume",CABLES.OP_PORT_TYPE_VALUE));const _=n.addOutPort(new CABLES.Port(n,"fft",CABLES.OP_PORT_TYPE_ARRAY));let d=o.frequencyBinCount;let p=new Uint8Array(d);let g=true;const f=null;r.onChange=function(){o.fftSize=r.get()};s.onChange=function(){if(s.get()=="Frequency")g=true;if(s.get()=="Time Domain")g=false};t.onTriggered=function(){o.minDecibels=-90;o.maxDecibels=0;if(d!=o.frequencyBinCount){d=o.frequencyBinCount;p=new Uint8Array(d)}if(!p){return}let t=0;for(let e=0;e<p.length;e++)t+=p[e];const e=t/p.length;u.set(e/128);try{if(g)o.getByteFrequencyData(p);else o.getByteTimeDomainData(p)}catch(e){n.log(e)}_.set(null);_.set(p);l.trigger()}};Ops.WebAudio.AudioAnalyzer.prototype=new CABLES.Op;CABLES.OPS["22523fae-a623-401d-b952-a57c26de4b4e"]={f:Ops.WebAudio.AudioAnalyzer,objName:"Ops.WebAudio.AudioAnalyzer"};Ops.WebAudio.BiquadFilter=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};this.name="BiquadFilter";var n=CABLES.WEBAUDIO.createAudioContext(e);var a=10;var r=n.sampleRate/2;var o="allpass";var i=n.createBiquadFilter();var s=CABLES.WEBAUDIO.createAudioInPort(e,"Audio In",i);var l=CABLES.WEBAUDIO.createAudioOutPort(e,"Audio Out",i);var c=e.inValueSelect("type",["allpass","lowpass","highpass","bandpass","lowshelf","highshelf","peaking","notch"],"allpass");var u=e.inFloat("frequency",1e3);var _=e.inFloatSlider("detune",0);var d=e.inFloatSlider("q",0);var p=e.inFloatSlider("gain",.5);var g=function(){i.type=c.get()};var f=function(){var e=u.get();if(e&&e>=a&&e<=r){i.frequency.setValueAtTime(u.get(),window.audioContext.currentTime)}};var m=function(){i.detune.setValueAtTime(_.get(),window.audioContext.currentTime)};var v=function(){i.Q.setValueAtTime(d.get(),window.audioContext.currentTime)};var h=function(){i.gain.setValueAtTime(p.get(),window.audioContext.currentTime)};c.onChange=g;u.onChange=f;_.onChange=m;d.onChange=v;p.onChange=h;g()};Ops.WebAudio.BiquadFilter.prototype=new CABLES.Op;CABLES.OPS["3e28f86a-4f74-49a2-a1a6-f8943c00352d"]={f:Ops.WebAudio.BiquadFilter,objName:"Ops.WebAudio.BiquadFilter"};Ops.WebAudio.FFTAreaAverage=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTriggerButton("refresh"),o=e.inArray("FFT Array"),i=e.inValueSlider("x"),s=e.inValueSlider("y"),l=e.inValueSlider("width",.2),c=e.inValueSlider("height",.2),u=e.inValueBool("Create Texture",true),_=e.outTexture("texture_out"),d=e.outValue("value");const p=e.patch.cgl;let a=[];let r=0;let g=128;const f=document.createElement("canvas");f.id="fft_"+CABLES.uuid();f.width=f.height=g;f.style.display="none";let m=document.getElementsByTagName("body")[0];m.appendChild(f);const v=f.getContext("2d");let h=0;let b=0;let x=20;let O=20;let I=0;n.onTriggered=function(){let n=o.get();if(!n)return;let e=n.length;const t=u.get();if(t){v.beginPath();v.fillStyle="#000";v.strokeStyle="#ff0";v.fillRect(0,0,f.width,f.height);v.fillStyle="#888";for(let e=0;e<n.length;e++)v.fillRect(e,g-n[e],1,n[e])}h=i.get()*f.width;b=s.get()*f.height;x=l.get()*g/2;O=c.get()*g/2;if(t)v.rect(h,b,x,O);if(t)v.stroke();let a=0;let r=0;for(let t=h;t<h+x;t++)for(let e=b;e<b+O;e++)if(n[Math.round(t)]>g-e)r++;if(I!=I)I=0;I+=r/(x*O);I/=2;d.set(I);if(t){v.fillStyle="#ff0";v.fillRect(0,0,I*f.width,5);if(_.get())_.get().initTexture(f,CGL.Texture.FILTER_NEAREST);else _.set(new CGL.Texture.createFromImage(p,f,{filter:CGL.Texture.FILTER_NEAREST,name:"fft area texture"}))}}};Ops.WebAudio.FFTAreaAverage.prototype=new CABLES.Op;CABLES.OPS["ed633fe4-3200-4890-8d9e-ccd1ea478c74"]={f:Ops.WebAudio.FFTAreaAverage,objName:"Ops.WebAudio.FFTAreaAverage"};Ops.WebAudio.AudioBufferPlayer_v2=function(){CABLES.Op.apply(this,arguments);const n=this;const e={};const a=n.inObject("Audio Buffer",null,"audioBuffer");const r=n.inBool("Start / Stop",false);const o=n.inBool("Loop",false);const t=n.inTriggerButton("Restart");const i=n.inFloat("Offset",0);const s=n.inFloat("Playback Rate",1);const l=n.inFloat("Detune",0);n.setPortGroup("Playback Controls",[r,o,t]);n.setPortGroup("Time Controls",[i]);n.setPortGroup("Miscellaneous",[s,l]);const c=n.outObject("Audio Out",null,"audioNode");const u=n.outBool("Is Playing",false);const _=n.outBool("Loading",false);let d=null;let p=false;let g=false;let f=null;let m=null;let v=false;const h=CABLES.WEBAUDIO.createAudioContext(n);const b=h.createGain();if(!a.isLinked()){n.setUiError("inputNotConnected","To be able to play back sound, you need to connect an AudioBuffer to this op.",0)}else{n.setUiError("inputNotConnected",null)}a.onLinkChanged=()=>{if(!a.isLinked()){n.setUiError("inputNotConnected","To be able to play back sound, you need to connect an AudioBuffer to this op.",0)}else{n.setUiError("inputNotConnected",null)}};if(!c.isLinked()){n.setUiError("outputNotConnected","To be able to hear sound playing, you need to connect this op to an Output op.",0)}else{n.setUiError("outputNotConnected",null)}c.onLinkChanged=()=>{if(!c.isLinked()){n.setUiError("outputNotConnected","To be able to hear sound playing, you need to connect this op to an Output op.",0)}else{n.setUiError("outputNotConnected",null)}};a.onChange=function(){if(a.get())y();else{if(v){v=false;_.set(v)}if(p){E(0);d.buffer=null;d=null}}};r.onChange=function(){if(!a.get())return;if(!d){if(!v)y()}if(r.get()){const e=0;S(e)}else{const t=0;E(t)}};o.onChange=function(){if(d){d.loop=!!o.get()}};l.onChange=x;function x(){if(!d)return;const e=l.get()||0;if(d.detune){d.detune.setValueAtTime(e,h.currentTime)}}s.onChange=O;function O(){if(!d)return;const e=s.get()||0;if(e>=d.playbackRate.minValue&&e<=d.playbackRate.maxValue){d.playbackRate.setValueAtTime(e,h.currentTime)}}let I=false;t.onTriggered=function(){if(!d)return;if(!a.get())return;else{if(!(a.get()instanceof AudioBuffer))return}if(r.get()){if(p){I=true;E(0)}else{S(0)}}};function y(e=false){if(v)return;if(!(a.get()instanceof AudioBuffer))return;v=true;_.set(v);if(d){d.onended=null;if(d.buffer){E(0);d.disconnect(b);d.buffer=null}d=null}d=h.createBufferSource();const t=a.get();if(!t){v=false;_.set(v);return}d.buffer=t;d.onended=M;d.loop=o.get();d.connect(b);O();x();c.set(b);v=false;_.set(v);if(I){S(0);I=false;return}if(r.get()&&!e){S(0)}}let T=false;let A=null;i.onChange=()=>{if(i.get()>=0)n.setUiError("offsetNegative",null);else{n.setUiError("offsetNegative","Offset cannot be negative. Setting to 0.",1)}if(d){if(d.buffer){if(i.get()>d.buffer.duration){n.setUiError("offsetTooLong","Your offset value is higher than the total time of your audio file. Please decrease the duration to be able to hear sound when playing back your buffer.",1)}else{n.setUiError("offsetTooLong",null)}}}};function S(t){try{if(d){let e=Math.max(0,i.get());d.start(t,e);p=true;g=false;u.set(true)}else{n.log("start() but no src...")}}catch(e){n.log("Error on start: ",e.message);u.set(false);p=false}}function C(){let e=!o.get();y(e)}function E(e){try{if(d){d.stop();if(!I)C()}p=false;u.set(false)}catch(e){n.setUiError(e);u.set(false)}}function M(){if(o.get()){p=true;g=false}else{p=false;g=true}u.set(p);C()}};Ops.WebAudio.AudioBufferPlayer_v2.prototype=new CABLES.Op;CABLES.OPS["3abd0dbb-eeee-4c65-ae31-b8bc2345e2d5"]={f:Ops.WebAudio.AudioBufferPlayer_v2,objName:"Ops.WebAudio.AudioBufferPlayer_v2"};Ops.WebAudio.AudioBuffer_v2=function(){CABLES.Op.apply(this,arguments);const a=this;const e={};const r=a.patch.cgl;const t=CABLES.WEBAUDIO.createAudioContext(a),n=a.inUrl("URL","audio"),o=a.inBool("Create Loading Task",true),i=a.outObject("Audio Buffer",null,"audioBuffer"),s=a.outBoolNum("Finished Loading",false),l=a.outNumber("Sample Rate",0),c=a.outNumber("Length",0),u=a.outNumber("Duration",0),_=a.outNumber("Number of Channels",0),d=a.outBool("isLoading",0);let p=null;let g=false;let f=null;let m=null;let v=false;let h=false;let b=false;let x=new FileReader;let O=null;let I=0;if(!i.isLinked()){a.setUiError("notConnected","To play back sound, connect this op to a playback operator such as SamplePlayer or AudioBufferPlayer.",0)}else{a.setUiError("notConnected",null)}i.onLinkChanged=()=>{if(i.isLinked()){a.setUiError("notConnected",null)}else{a.setUiError("notConnected","To play back sound, connect this op to a playback operator such as SamplePlayer or AudioBufferPlayer.",0)}};function y(t,e){f=t;g=true;d.set(g);if(!e){const n=t.substr(t.lastIndexOf(".")+1);if(n==="wav"){a.setUiError("wavFormat","You are using a .wav file. Make sure the .wav file is 16 bit to be supported by all browsers. Safari does not support 24 bit .wav files.",1)}else{a.setUiError("wavFormat",null)}CABLES.WEBAUDIO.loadAudioFile(a.patch,t,S,C,o.get())}else{let e=T(t);if(e.type==="audio/wav"){a.setUiError("wavFormat","You are using a .wav file. Make sure the .wav file is 16 bit to be supported by all browsers. Safari does not support 24 bit .wav files.",1)}else{a.setUiError("wavFormat",null)}if(o.get()){I=r.patch.loading.start("audiobuffer from data-url "+a.id,"");if(r.patch.isEditorMode())gui.jobs().start({id:"loadaudio"+I,title:" loading audio data url ("+a.id+")"})}x.readAsArrayBuffer(e)}}function T(e){let t=atob(e.split(",")[1]);let n=e.split(",")[0].split(":")[1].split(";")[0];let a=new ArrayBuffer(t.length);let r=new Uint8Array(a);for(let e=0;e<t.length;e++){r[e]=t.charCodeAt(e)}let o=new Blob([a],{type:n});return o}n.onChange=function(){if(n.get()){h=String(n.get()).indexOf("data:")==0;if(g){b=String(n.get()).indexOf("data:")==0;const t=b?n.get():a.patch.getFilePath(n.get());if(t!==f){m=t}else{m=null}v=false;return}E();const e=h?n.get():a.patch.getFilePath(n.get());y(e,h)}else{if(g){v=true;return}E();a.setUiError("wavFormat",null);a.setUiError("failedLoading",null)}};x.onloadend=()=>{O=x.result;r.patch.loading.finished(I);if(r.patch.isEditorMode())gui.jobs().finish("loadaudio"+I);A()};function A(){if(O)t.decodeAudioData(O,S,C)}function S(e){g=false;d.set(g);if(v){E();v=false;return}if(m){y(m,b);m=null}else{p=e;c.set(e.length);u.set(e.duration);_.set(e.numberOfChannels);l.set(e.sampleRate);i.set(e);a.setUiError("failedLoading",null);s.set(true);h=false;b=false}}function C(e){a.logError("Error: Loading audio file failed: ",e);a.setUiError("failedLoading","The audio file could not be loaded. Make sure the right file URL is used.",2);g=false;E();d.set(g);p=null;if(m){y(m,b);m=null}}function E(){c.set(0);u.set(0);_.set(0);l.set(0);i.set(null);s.set(false)}};Ops.WebAudio.AudioBuffer_v2.prototype=new CABLES.Op;CABLES.OPS["5f1d6a2f-1c04-4744-b0fb-910825beceee"]={f:Ops.WebAudio.AudioBuffer_v2,objName:"Ops.WebAudio.AudioBuffer_v2"};Ops.Anim.Smooth=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("Update"),a=e.inBool("Separate inc/dec",false),r=e.inValue("Value"),o=e.outTrigger("Next"),i=e.inValue("Inc factor",4),s=e.inValue("Dec factor",4),l=e.outNumber("Result",0);let c=0;let u=0;let _=0;let d=0;e.toWorkPortsNeedToBeLinked(n);let p;let g;let f=4;let m=true;let v=0;const h=0;const b=1;x();O();a.setUiAttribs({hidePort:true});i.onChange=s.onChange=O;a.onChange=x;I();function x(){const e=a.get();if(!e)v=h;else v=b;if(v==h){s.setUiAttribs({greyout:true});i.setUiAttribs({title:"Inc/Dec factor"})}else if(v==b){s.setUiAttribs({greyout:false});i.setUiAttribs({title:"Inc factor"})}O();I()}function O(){if(v==h){p=i.get();g=i.get()}else if(v==b){p=i.get();g=s.get()}if(p<=.2||p!=p)p=.2;if(g<=.2||g!=g)g=.2}r.onChange=function(){m=false;let e=u;u=r.get()};i.onChange=function(){O()};function I(){let e=1;if(performance.now()-d>500||d===0)c=r.get()||0;else e=(performance.now()-d)/(performance.now()-d);d=performance.now();if(c!=c)c=0;if(f<=0)f=1e-4;const t=u-c;if(t>=0)c+=t/(g*e);else c+=t/(p*e);if(Math.abs(t)<1e-5)c=u;if(f!=f)c=0;if(c!=c||c==-Infinity||c==Infinity)c=r.get();if(_!=c){l.set(c);_=c}if(c==u&&!m){m=true;l.set(c)}o.trigger()}n.onTriggered=function(){I()}};Ops.Anim.Smooth.prototype=new CABLES.Op;CABLES.OPS["5677b5b5-753a-4fbf-9e91-64c81ec68a2f"]={f:Ops.Anim.Smooth,objName:"Ops.Anim.Smooth"};Ops.Math.MapRange=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const d=e.inValueFloat("value",0),p=e.inValueFloat("old min",0),g=e.inValueFloat("old max",1),f=e.inValueFloat("new min",-1),m=e.inValueFloat("new max",1),n=e.inValueSelect("Easing",["Linear","Smoothstep","Smootherstep"],"Linear"),v=e.outNumber("result",0);e.setPortGroup("Input Range",[p,g]);e.setPortGroup("Output Range",[f,m]);let h=0;let b=0;d.onChange=p.onChange=g.onChange=f.onChange=m.onChange=a;a();n.onChange=function(){if(n.get()=="Smoothstep")h=1;else if(n.get()=="Smootherstep")h=2;else h=0};function a(){const e=f.get();const t=m.get();const n=p.get();const a=g.get();let r=d.get();if(r>=Math.max(a,n)){v.set(t);return}else if(r<=Math.min(a,n)){v.set(e);return}let o=false;const i=Math.min(n,a);const s=Math.max(n,a);if(i!=n)o=true;let l=false;const c=Math.min(e,t);const u=Math.max(e,t);if(c!=e)l=true;let _=0;if(o)_=(s-r)*(u-c)/(s-i);else _=(r-i)*(u-c)/(s-i);if(l)b=u-_;else b=_+c;if(h===0){v.set(b)}else if(h==1){r=Math.max(0,Math.min(1,(b-e)/(t-e)));v.set(e+r*r*(3-2*r)*(t-e))}else if(h==2){r=Math.max(0,Math.min(1,(b-e)/(t-e)));v.set(e+r*r*r*(r*(r*6-15)+10)*(t-e))}}};Ops.Math.MapRange.prototype=new CABLES.Op;CABLES.OPS["2617b407-60a0-4ff6-b4a7-18136cfa7817"]={f:Ops.Math.MapRange,objName:"Ops.Math.MapRange"};Ops.Gl.ClearColor=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("render"),a=e.outTrigger("trigger"),r=e.inFloatSlider("r",.1),o=e.inFloatSlider("g",.1),i=e.inFloatSlider("b",.1),s=e.inFloatSlider("a",1);r.setUiAttribs({colorPick:true});const l=e.patch.cgl;n.onTriggered=function(){l.gl.clearColor(r.get(),o.get(),i.get(),s.get());l.gl.clear(l.gl.COLOR_BUFFER_BIT|l.gl.DEPTH_BUFFER_BIT);a.trigger()}};Ops.Gl.ClearColor.prototype=new CABLES.Op;CABLES.OPS["19b441eb-9f63-4f35-ba08-b87841517c4d"]={f:Ops.Gl.ClearColor,objName:"Ops.Gl.ClearColor"};Ops.Gl.Meshes.Sphere_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const O=Math.PI*2,I=e.patch.cgl,n=e.inTrigger("render"),y=e.inValue("radius",.5),T=e.inValue("stacks",32),A=e.inValue("slices",32),S=e.inValueSlider("Filloffset",1),a=e.inValueBool("Render",true),r=e.outTrigger("trigger"),C=e.outObject("geometry",null,"geometry"),E=vec3.fromValues(0,1,0),M=vec3.fromValues(1,0,0);let N=new CGL.Geometry("Sphere"),L=vec3.create(),w=vec3.create(),P=true,D;function o(){const e=Math.ceil(Math.max(T.get(),2)),t=Math.ceil(Math.max(A.get(),3)),n=Math.min(Math.max(S.get()*e,1),e),a=y.get();let r=[],o=[],i=[],s=[],l=[],c=[],u,_,d,p,g,f,m,v,h,b,x;for(b=m=0;b<e+1;b++){h=(b/e-.5)*Math.PI;_=Math.sin(h);f=Math.cos(h);for(x=t;x>=0;x--){v=x/t*O;u=Math.cos(v)*f;d=Math.sin(v)*f;r.push(u*a,_*a,d*a);o.push(x/t,b/(e+1));p=Math.sqrt(u*u+_*_+d*d);i.push(L[0]=u/p,L[1]=_/p,L[2]=d/p);if(_==p)g=M;else g=E;vec3.cross(w,L,g);vec3.normalize(w,w);Array.prototype.push.apply(s,w);vec3.cross(w,w,L);Array.prototype.push.apply(l,w)}if(b==0||b>n)continue;for(x=0;x<t;x++,m++){c.push(m,m+1,m+t+1,m+1,m+t+2,m+t+1)}m++}N.clear();N.vertices=r;N.texCoords=o;N.vertexNormals=i;N.tangents=s;N.biTangents=l;N.verticesIndices=c;C.set(null);C.set(N);if(!D)D=new CGL.Mesh(I,N);else D.setGeom(N);P=false}n.onTriggered=function(){if(P)o();if(a.get())D.render(I.getShader());r.trigger()};T.onChange=A.onChange=S.onChange=y.onChange=function(){P=true};e.onDelete=function(){if(D)D.dispose()}};Ops.Gl.Meshes.Sphere_v2.prototype=new CABLES.Op;CABLES.OPS["450b4d68-2278-4d9f-9849-0abdfa37ef69"]={f:Ops.Gl.Meshes.Sphere_v2,objName:"Ops.Gl.Meshes.Sphere_v2"};Ops.Devices.Mouse.Mouse_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueBool("Active",true),a=e.inValueBool("relative"),r=e.inValueBool("normalize"),o=e.inValueBool("flip y",true),i=e.inValueSelect("Area",["Canvas","Document","Parent Element"],"Canvas"),s=e.inBool("right click prevent default",true),l=e.inValueBool("Touch support",true),c=e.inValueBool("smooth"),u=e.inValueFloat("smoothSpeed",20),_=e.inValueFloat("multiply",1),d=e.outNumber("x",0),p=e.outNumber("y",0),g=e.outBoolNum("button down"),f=e.outTrigger("click"),m=e.outTrigger("Button Up"),v=e.outTrigger("click right"),h=e.outBoolNum("mouseOver"),b=e.outNumber("button");e.setPortGroup("Behavior",[a,r,o,i,s,l]);e.setPortGroup("Smoothing",[c,u,_]);let x=0;const O=e.patch.cgl;let I=null;function y(n,a){if(r.get()){let e=O.canvas.width/O.pixelDensity;let t=O.canvas.height/O.pixelDensity;if(I==document.body){e=I.clientWidth/O.pixelDensity;t=I.clientHeight/O.pixelDensity}d.set(((n||0)/e*2-1)*_.get());p.set(((a||0)/t*2-1)*_.get())}else{d.set((n||0)*_.get());p.set((a||0)*_.get())}}c.onChange=function(){if(c.get())x=setInterval(R,5);else if(x)clearTimeout(x)};let T,A;let S=0,C=0;r.onChange=function(){E=0;M=0;y(E,M)};let E=O.canvas.width/2;let M=O.canvas.height/2;S=E;C=M;d.set(E);p.set(M);let N=0;let L=0;let w=0;let P=0;q();i.onChange=q;let D=0;function R(){D=u.get();if(D<=0)D=.01;const e=Math.abs(E-S);const t=Math.round(e/D,0);S=S<E?S+t:S-t;const n=Math.abs(M-C);const a=Math.round(n/D,0);C=C<M?C+a:C-a;y(S,C)}function U(e){g.set(false);h.set(true);D=u.get()}function j(e){b.set(e.which);g.set(true)}function G(e){b.set(0);g.set(false);m.trigger()}function V(e){v.trigger();if(s.get())e.preventDefault()}function k(e){f.trigger()}function B(e){N=0;L=0;D=100;h.set(false);g.set(false)}a.onChange=function(){w=0;P=0};function z(e){if(!a.get()){if(i.get()!="Document"){w=e.offsetX;P=e.offsetY}else{w=e.clientX;P=e.clientY}if(c.get()){E=w;if(o.get())M=I.clientHeight-P;else M=P}else{if(o.get())y(w,I.clientHeight-P);else y(w,P)}}else{if(N!=0&&L!=0){w=e.offsetX-N;P=e.offsetY-L}else{}N=e.offsetX;L=e.offsetY;E+=w;M+=P;if(M>460)M=460}}function F(e){h.set(true);z(e)}function X(e){if(event.touches&&event.touches.length>0)z(e.touches[0])}function H(e){g.set(true);if(e.touches&&e.touches.length>0)j(e.touches[0])}function Y(e){g.set(false);G()}l.onChange=function(){W();q()};function W(){if(!I)return;I.removeEventListener("touchend",Y);I.removeEventListener("touchstart",H);I.removeEventListener("touchmove",X);I.removeEventListener("click",k);I.removeEventListener("mousemove",F);I.removeEventListener("mouseleave",B);I.removeEventListener("mousedown",j);I.removeEventListener("mouseup",G);I.removeEventListener("mouseenter",U);I.removeEventListener("contextmenu",V);I=null}function q(){if(I||!n.get())W();if(!n.get())return;I=O.canvas;if(i.get()=="Document")I=document.body;if(i.get()=="Parent Element")I=O.canvas.parentElement;if(l.get()){I.addEventListener("touchend",Y);I.addEventListener("touchstart",H);I.addEventListener("touchmove",X)}I.addEventListener("mousemove",F);I.addEventListener("mouseleave",B);I.addEventListener("mousedown",j);I.addEventListener("mouseup",G);I.addEventListener("mouseenter",U);I.addEventListener("contextmenu",V);I.addEventListener("click",k)}n.onChange=function(){if(I)W();if(n.get())q()};e.onDelete=function(){W()};q()};Ops.Devices.Mouse.Mouse_v2.prototype=new CABLES.Op;CABLES.OPS["9fa3fc46-3147-4e3a-8ee8-a93ea9e8786e"]={f:Ops.Devices.Mouse.Mouse_v2,objName:"Ops.Devices.Mouse.Mouse_v2"};Ops.Gl.Shader.BasicMaterial_v3=function(){CABLES.Op.apply(this,arguments);const e=this;const t={basicmaterial_frag:"{{MODULES_HEAD}}\n\nIN vec2 texCoord;\n\n#ifdef VERTEX_COLORS\nIN vec4 vertCol;\n#endif\n\n#ifdef HAS_TEXTURES\n    IN vec2 texCoordOrig;\n    #ifdef HAS_TEXTURE_DIFFUSE\n        UNI sampler2D tex;\n    #endif\n    #ifdef HAS_TEXTURE_OPACITY\n        UNI sampler2D texOpacity;\n   #endif\n#endif\n\nvoid main()\n{\n    {{MODULE_BEGIN_FRAG}}\n    vec4 col=color;\n\n\n    #ifdef HAS_TEXTURES\n        vec2 uv=texCoord;\n\n        #ifdef CROP_TEXCOORDS\n            if(uv.x<0.0 || uv.x>1.0 || uv.y<0.0 || uv.y>1.0) discard;\n        #endif\n\n        #ifdef HAS_TEXTURE_DIFFUSE\n            col=texture(tex,uv);\n\n            #ifdef COLORIZE_TEXTURE\n                col.r*=color.r;\n                col.g*=color.g;\n                col.b*=color.b;\n            #endif\n        #endif\n        col.a*=color.a;\n        #ifdef HAS_TEXTURE_OPACITY\n            #ifdef TRANSFORMALPHATEXCOORDS\n                uv=texCoordOrig;\n            #endif\n            #ifdef ALPHA_MASK_IALPHA\n                col.a*=1.0-texture(texOpacity,uv).a;\n            #endif\n            #ifdef ALPHA_MASK_ALPHA\n                col.a*=texture(texOpacity,uv).a;\n            #endif\n            #ifdef ALPHA_MASK_LUMI\n                col.a*=dot(vec3(0.2126,0.7152,0.0722), texture(texOpacity,uv).rgb);\n            #endif\n            #ifdef ALPHA_MASK_R\n                col.a*=texture(texOpacity,uv).r;\n            #endif\n            #ifdef ALPHA_MASK_G\n                col.a*=texture(texOpacity,uv).g;\n            #endif\n            #ifdef ALPHA_MASK_B\n                col.a*=texture(texOpacity,uv).b;\n            #endif\n            // #endif\n        #endif\n    #endif\n\n    {{MODULE_COLOR}}\n\n    #ifdef DISCARDTRANS\n        if(col.a<0.2) discard;\n    #endif\n\n    #ifdef VERTEX_COLORS\n        col*=vertCol;\n    #endif\n\n    outColor = col;\n}\n",basicmaterial_vert:"\n{{MODULES_HEAD}}\n\n// OUT vec3 norm;\nOUT vec2 texCoord;\nOUT vec2 texCoordOrig;\n\nUNI mat4 projMatrix;\nUNI mat4 modelMatrix;\nUNI mat4 viewMatrix;\n\n#ifdef HAS_TEXTURES\n    UNI float diffuseRepeatX;\n    UNI float diffuseRepeatY;\n    UNI float texOffsetX;\n    UNI float texOffsetY;\n#endif\n\n#ifdef VERTEX_COLORS\n    in vec4 attrVertColor;\n    out vec4 vertCol;\n\n#endif\n\n\nvoid main()\n{\n    mat4 mMatrix=modelMatrix;\n    mat4 mvMatrix;\n\n    norm=attrVertNormal;\n    texCoordOrig=attrTexCoord;\n    texCoord=attrTexCoord;\n    #ifdef HAS_TEXTURES\n        texCoord.x=texCoord.x*diffuseRepeatX+texOffsetX;\n        texCoord.y=(1.0-texCoord.y)*diffuseRepeatY+texOffsetY;\n    #endif\n\n    #ifdef VERTEX_COLORS\n        vertCol=attrVertColor;\n    #endif\n\n    vec4 pos = vec4(vPosition, 1.0);\n\n    #ifdef BILLBOARD\n       vec3 position=vPosition;\n       mvMatrix=viewMatrix*modelMatrix;\n\n       gl_Position = projMatrix * mvMatrix * vec4((\n           position.x * vec3(\n               mvMatrix[0][0],\n               mvMatrix[1][0],\n               mvMatrix[2][0] ) +\n           position.y * vec3(\n               mvMatrix[0][1],\n               mvMatrix[1][1],\n               mvMatrix[2][1]) ), 1.0);\n    #endif\n\n    {{MODULE_VERTEX_POSITION}}\n\n    #ifndef BILLBOARD\n        mvMatrix=viewMatrix * mMatrix;\n    #endif\n\n\n    #ifndef BILLBOARD\n        // gl_Position = projMatrix * viewMatrix * modelMatrix * pos;\n        gl_Position = projMatrix * mvMatrix * pos;\n    #endif\n}\n"};const n=e.inTrigger("render");const a=e.outTrigger("trigger");const r=e.outObject("shader",null,"shader");r.ignoreValueSerialize=true;e.toWorkPortsNeedToBeLinked(n);const o=e.patch.cgl;const i=new CGL.Shader(o,"basicmaterialnew");i.addAttribute({type:"vec3",name:"vPosition"});i.addAttribute({type:"vec2",name:"attrTexCoord"});i.addAttribute({type:"vec3",name:"attrVertNormal",nameFrag:"norm"});i.addAttribute({type:"float",name:"attrVertIndex"});i.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]);i.setSource(t.basicmaterial_vert,t.basicmaterial_frag);r.set(i);n.onTriggered=C;const s=e.inValueSlider("r",Math.random());const l=e.inValueSlider("g",Math.random());const c=e.inValueSlider("b",Math.random());const u=e.inValueSlider("a",1);s.setUiAttribs({colorPick:true});const _=i.addUniformFrag("4f","color",s,l,c,u);i.uniformColorDiffuse=_;const d=e.inTexture("texture");let p=null;d.onChange=M;const g=e.inValueBool("colorizeTexture",false);const f=e.inValueBool("Vertex Colors",false);const m=e.inTexture("textureOpacity");let v=null;const h=e.inSwitch("Alpha Mask Source",["Luminance","R","G","B","A","1-A"],"Luminance");h.setUiAttribs({greyout:true});m.onChange=E;const b=e.inValueBool("Opacity TexCoords Transform",false);const x=e.inValueBool("Discard Transparent Pixels");const O=e.inValue("diffuseRepeatX",1),I=e.inValue("diffuseRepeatY",1),y=e.inValue("Tex Offset X",0),T=e.inValue("Tex Offset Y",0),A=e.inBool("Crop TexCoords",false);i.addUniformFrag("f","diffuseRepeatX",O);i.addUniformFrag("f","diffuseRepeatY",I);i.addUniformFrag("f","texOffsetX",y);i.addUniformFrag("f","texOffsetY",T);const S=e.inValueBool("billboard",false);h.onChange=S.onChange=x.onChange=b.onChange=A.onChange=f.onChange=g.onChange=N;e.setPortGroup("Color",[s,l,c,u]);e.setPortGroup("Color Texture",[d,f,g]);e.setPortGroup("Opacity",[m,h,x,b]);e.setPortGroup("Texture Transform",[O,I,y,T,A]);E();M();e.preRender=function(){i.bind();C()};function C(){if(!i)return;o.pushShader(i);i.popTextures();if(p&&d.get())i.pushTexture(p,d.get());if(v&&m.get())i.pushTexture(v,m.get());a.trigger();o.popShader()}function E(){if(m.get()){if(v!==null)return;i.removeUniform("texOpacity");i.define("HAS_TEXTURE_OPACITY");if(!v)v=new CGL.Uniform(i,"t","texOpacity");h.setUiAttribs({greyout:false});b.setUiAttribs({greyout:false})}else{i.removeUniform("texOpacity");i.removeDefine("HAS_TEXTURE_OPACITY");v=null;h.setUiAttribs({greyout:true});b.setUiAttribs({greyout:true})}N()}function M(){if(d.get()){if(!i.hasDefine("HAS_TEXTURE_DIFFUSE"))i.define("HAS_TEXTURE_DIFFUSE");if(!p)p=new CGL.Uniform(i,"t","texDiffuse");O.setUiAttribs({greyout:false});I.setUiAttribs({greyout:false});y.setUiAttribs({greyout:false});T.setUiAttribs({greyout:false});g.setUiAttribs({greyout:false})}else{i.removeUniform("texDiffuse");i.removeDefine("HAS_TEXTURE_DIFFUSE");p=null;O.setUiAttribs({greyout:true});I.setUiAttribs({greyout:true});y.setUiAttribs({greyout:true});T.setUiAttribs({greyout:true});g.setUiAttribs({greyout:true})}}function N(){i.toggleDefine("VERTEX_COLORS",f.get());i.toggleDefine("CROP_TEXCOORDS",A.get());i.toggleDefine("COLORIZE_TEXTURE",g.get());i.toggleDefine("TRANSFORMALPHATEXCOORDS",b.get());i.toggleDefine("DISCARDTRANS",x.get());i.toggleDefine("BILLBOARD",S.get());i.toggleDefine("ALPHA_MASK_ALPHA",h.get()=="A");i.toggleDefine("ALPHA_MASK_IALPHA",h.get()=="1-A");i.toggleDefine("ALPHA_MASK_LUMI",h.get()=="Luminance");i.toggleDefine("ALPHA_MASK_R",h.get()=="R");i.toggleDefine("ALPHA_MASK_G",h.get()=="G");i.toggleDefine("ALPHA_MASK_B",h.get()=="B")}};Ops.Gl.Shader.BasicMaterial_v3.prototype=new CABLES.Op;CABLES.OPS["ec55d252-3843-41b1-b731-0482dbd9e72b"]={f:Ops.Gl.Shader.BasicMaterial_v3,objName:"Ops.Gl.Shader.BasicMaterial_v3"};Ops.Gl.Texture_v2=function(){CABLES.Op.apply(this,arguments);const r=this;const e={};const o=r.inUrl("File",[".jpg",".png",".webp",".jpeg",".avif"]),t=r.inSwitch("Filter",["nearest","linear","mipmap"]),n=r.inValueSelect("Wrap",["repeat","mirrored repeat","clamp to edge"],"clamp to edge"),a=r.inSwitch("Anisotropic",[0,1,2,4,8,16],0),i=r.inValueBool("Flip",false),s=r.inValueBool("Pre Multiplied Alpha",false),l=r.inValueBool("Active",true),c=r.inBool("Save Memory",true),u=r.outTexture("Texture"),_=r.outNumber("Width"),d=r.outNumber("Height"),p=r.outNumber("Aspect Ratio"),g=r.outNumber("Loaded",false),f=r.outNumber("Loading",false);r.setPortGroup("Size",[_,d]);s.setUiAttribs({hidePort:true});r.toWorkPortsNeedToBeLinked(u);const m=r.patch.cgl;let v=null;let h=null;let b=null;let x=CGL.Texture.FILTER_MIPMAP;let O=CGL.Texture.WRAP_REPEAT;let I=0;let y=0;o.onChange=i.onChange=function(){A()};a.onChange=t.onChange=C;n.onChange=E;s.onChange=function(){A()};t.set("mipmap");n.set("repeat");u.set(CGL.Texture.getEmptyTexture(m));l.onChange=function(){if(l.get()){if(v!=o.get()||!b)A();else u.set(b)}else{u.set(CGL.Texture.getEmptyTexture(m));_.set(CGL.Texture.getEmptyTexture(m).width);d.set(CGL.Texture.getEmptyTexture(m).height);if(b)b.delete();b=null}};const T=function(){const e=CGL.Texture.getTempTexture(m);u.set(e)};function A(e){clearTimeout(y);y=setTimeout(function(){S(e)},30)}function S(e){if(!l.get())return;if(!h)h=m.patch.loading.start("textureOp",o.get());let t=r.patch.getFilePath(String(o.get()));if(e)t+="?rnd="+CABLES.uuid();if(String(o.get()).indexOf("data:")==0)t=o.get();let n=false;if(v!=o.get())n=true;v=o.get();if(o.get()&&o.get().length>1){g.set(false);f.set(true);const a=o.get();r.setUiAttrib({extendTitle:CABLES.basename(t)});if(n)r.refreshParams();m.patch.loading.addAssetLoadingTask(()=>{r.setUiError("urlerror",null);CGL.Texture.load(m,t,function(e,t){if(o.get()!=a){m.patch.loading.finished(h);h=null;return}if(e){T();r.setUiError("urlerror",'could not load texture: "'+o.get()+'"',2);m.patch.loading.finished(h);return}u.set(t);_.set(t.width);d.set(t.height);p.set(t.width/t.height);if(b)b.delete();b=t;u.set(null);u.set(b);f.set(false);g.set(true);if(c.get())b.image=null;m.patch.loading.finished(h)},{anisotropic:I,wrap:O,flip:i.get(),unpackAlpha:s.get(),filter:x})})}else{m.patch.loading.finished(h);T()}}function C(){if(t.get()=="nearest")x=CGL.Texture.FILTER_NEAREST;else if(t.get()=="linear")x=CGL.Texture.FILTER_LINEAR;else if(t.get()=="mipmap")x=CGL.Texture.FILTER_MIPMAP;else if(t.get()=="Anisotropic")x=CGL.Texture.FILTER_ANISOTROPIC;I=parseFloat(a.get());A()}function E(){if(n.get()=="repeat")O=CGL.Texture.WRAP_REPEAT;if(n.get()=="mirrored repeat")O=CGL.Texture.WRAP_MIRRORED_REPEAT;if(n.get()=="clamp to edge")O=CGL.Texture.WRAP_CLAMP_TO_EDGE;A()}r.onFileChanged=function(e){if(o.get()&&o.get().indexOf(e)>-1){u.set(CGL.Texture.getEmptyTexture(r.patch.cgl));u.set(CGL.Texture.getTempTexture(m));S(true)}}};Ops.Gl.Texture_v2.prototype=new CABLES.Op;CABLES.OPS["790f3702-9833-464e-8e37-6f0f813f7e16"]={f:Ops.Gl.Texture_v2,objName:"Ops.Gl.Texture_v2"};Ops.Gl.ForceCanvasSize=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("Trigger"),l=e.inBool("Active",true),a=e.inSwitch("Force",["Resolution","Aspect Ratio"],"Resolution"),c=e.inBool("Center In Parent",true),u=e.inBool("Scale to fit Parent",false),_=e.inInt("Set Width",300),d=e.inInt("Set Height",200),r=e.inDropDown("Aspect Ratio",["Custom","21:9","2:1","16:9","16:10","4:3","1:1","9:16","1:2","iPhoneXr Vert"],"16:9"),p=e.inFloat("Ratio",0),o=e.inDropDown("Fill Parent",["Auto","Width","Height","Both"],"Auto"),g=e.outTrigger("Next"),f=e.outNumber("Width"),m=e.outNumber("Height"),v=e.outNumber("Margin Left"),h=e.outNumber("Margin Top");e.setPortGroup("Size",[_,d]);e.setPortGroup("Proportions",[p,o,r]);let b=0;const i=0;const x=1;const O=2;const I=3;const y=4;o.onChange=S;a.onChange=s;c.onChange=n.onLinkChanged=C;r.onChange=A;const T=e.patch.cgl;if(window.getComputedStyle(T.canvas).position==="absolute"){T.canvas.style.position="initial";e.warn("[cables forceCanvasSize] - canvas was positioned absolute, not compatible with Ops.Gl.ForceCanvasSize")}S();function s(){if(a.get()=="Aspect Ratio"){p.set(100);A()}S()}function A(){const e=r.get();if(e=="Custom")return;else if(e=="16:9")p.set(16/9);else if(e=="4:3")p.set(4/3);else if(e=="16:10")p.set(16/10);else if(e=="21:9")p.set(21/9);else if(e=="2:1")p.set(2);else if(e=="1:1")p.set(1);else if(e=="9:16")p.set(9/16);else if(e=="1:2")p.set(.5);else if(e=="iPhoneXr Vert")p.set(9/19.5)}p.onChange=()=>{C()};l.onChange=function(){if(!l.get())C()};function S(){const e=a.get()=="Resolution";_.setUiAttribs({greyout:!e});d.setUiAttribs({greyout:!e});r.setUiAttribs({greyout:e});o.setUiAttribs({greyout:e});p.setUiAttribs({greyout:e});b=0;if(!e){const t=o.get();if(t=="Width")b=x;else if(t=="Height")b=O;else if(t=="Both")b=I;else if(t=="Auto")b=y}}function C(){T.canvas.style["margin-top"]="";T.canvas.style["margin-left"]="";v.set(0);h.set(0);const e=T.canvas.parentNode.getBoundingClientRect();T.setSize(e.width,e.height)}n.onTriggered=function(){if(!l.get())return g.trigger();let e=_.get();let t=d.get();let n=T.canvas.parentNode.getBoundingClientRect();if(n.height==0){T.canvas.parentNode.style.height="100%";n=T.canvas.parentNode.getBoundingClientRect()}if(n.width==0){T.canvas.parentNode.style.width="100%";n=T.canvas.parentNode.getBoundingClientRect()}if(b==x){e=n.width;t=e*1/p.get()}else if(b==O){t=n.height;e=t*p.get()}else if(b==y){const a=n;t=a.height;e=t*p.get();if(e>a.width){e=a.width;t=e*1/p.get()}}else if(b==I){const a=n;t=a.height;e=t*p.get();if(e<a.width){e=a.width;t=e*1/p.get()}}e=Math.ceil(e);t=Math.ceil(t);if(c.get()){const a=n;const r=(a.height-t)/2;const o=(a.width-e)/2;v.set(o);h.set(r);T.canvas.style["margin-top"]=r+"px";T.canvas.style["margin-left"]=o+"px"}else{T.canvas.style["margin-top"]="0";T.canvas.style["margin-left"]="0";v.set(0);h.set(0)}if(u.get()){const a=n;const i=a.width/_.get();const s=a.height/d.get();T.canvas.style.transform="scale("+Math.min(i,s)+")"}else{T.canvas.style.transform="scale(1)"}if(T.canvas.width/T.pixelDensity!=e||T.canvas.height/T.pixelDensity!=t){f.set(e);m.set(t);T.setSize(e,t)}g.trigger()}};Ops.Gl.ForceCanvasSize.prototype=new CABLES.Op;CABLES.OPS["a8b3380e-cd4a-4000-9ee9-1c65a11027dd"]={f:Ops.Gl.ForceCanvasSize,objName:"Ops.Gl.ForceCanvasSize"};Ops.Trigger.TriggerOnce=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTriggerButton("Exec"),a=e.inTriggerButton("Reset"),r=e.outTrigger("Next"),o=e.outBoolNum("Was Triggered");let i=false;e.toWorkPortsNeedToBeLinked(n);a.onTriggered=function(){i=false;o.set(i)};n.onTriggered=function(){if(i)return;i=true;r.trigger();o.set(i)}};Ops.Trigger.TriggerOnce.prototype=new CABLES.Op;CABLES.OPS["cf3544e4-e392-432b-89fd-fcfb5c974388"]={f:Ops.Trigger.TriggerOnce,objName:"Ops.Trigger.TriggerOnce"};Ops.Gl.Meshes.MeshInstancerFromTexture_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={instancer_body_frag:"#ifdef USE_TEX_COLOR\n    #ifdef BLEND_MODE_MULTIPLY\n        col.rgb *= frag_instColor.rgb;\n        col.a *= frag_instColor.a;\n    #endif\n\n    #ifdef BLEND_MODE_ADD\n        col.rgb += frag_instColor.rgb;\n        col.a += frag_instColor.a;\n    #endif\n\n    #ifdef BLEND_MODE_NONE\n        col.rgb = frag_instColor.rgb;\n        col.a = frag_instColor.a;\n    #endif\n#endif\n",instancer_body_vert:"float tx=mod(instanceIndex,(MOD_texSizeX))/MOD_texSizeX+(1.0/MOD_texSizeX*0.5);\nfloat ty=float(int((instanceIndex/(MOD_texSizeX))))/MOD_texSizeY+(1.0/MOD_texSizeY*0.5);\n\nvec3 MOD_texPos=texture(MOD_texTrans,vec2(tx,ty)).rgb*MOD_mulRGB;\nmat4 texInstMat;\nvec3 scale=vec3(1.0);\n\n#ifdef USE_TEX_SCALE\n    scale*=texture(MOD_texScale,vec2(tx,ty)).rgb;\n#endif\n\ntexInstMat[0][0]=\ntexInstMat[1][1]=\ntexInstMat[2][2]=\ntexInstMat[3][3]=1.0;\n\n#ifdef USE_TEX_ROT\n    vec3 MOD_texRota=texture(MOD_texRot,vec2(tx,ty)).rgb;\n    texInstMat*=rotationMatrix(vec3(1.0,0.0,0.0),MOD_texRota.r*PI*2.0);\n    texInstMat*=rotationMatrix(vec3(0.0,1.0,0.0),MOD_texRota.g*PI*2.0);\n    texInstMat*=rotationMatrix(vec3(0.0,0.0,1.0),MOD_texRota.b*PI*2.0);\n#endif\n\ntexInstMat[3][0]=MOD_texPos.x;\ntexInstMat[3][1]=MOD_texPos.y;\ntexInstMat[3][2]=MOD_texPos.z;\n\nmat4 scalem;\nscalem[0][0]=MOD_scale*scale.x;\nscalem[1][1]=MOD_scale*scale.y;\nscalem[2][2]=MOD_scale*scale.z;\nscalem[3][3]=1.0;\ntexInstMat*=scalem;\n\nmMatrix*=texInstMat;\n\n#ifdef USE_TEX_COLOR\n\n    vec4 instColor=texture(MOD_texColor,vec2(tx,ty));\n\n    frag_instColor=instColor;\n#endif\n\n#ifdef USE_TEX_TC\n    vec4 instTexCoords=texture(MOD_texCoords,vec2(tx,ty));\n\n    texCoord=(texCoord*instTexCoords.zw)+instTexCoords.xy;\n#endif\n\n\n\n\n",instancer_head_frag:"IN vec4 frag_instColor;\n",instancer_head_vert:"IN mat4 instMat;\nIN vec4 instColor;\nIN float instanceIndex;\nOUT mat4 instModelMat;\nOUT vec4 frag_instColor;\n\n#define INSTANCING\n#define PI 3.14159265358\n\nmat3 ntorot(vec3 r)\n{\n    float cx = cos(radians(r.x));\n    float sx = sin(radians(r.x));\n    float cy = cos(radians(r.y));\n    float sy = sin(radians(r.y));\n    float cz = cos(radians(r.z));\n    float sz = sin(radians(r.z));\n\n    return mat3(cy * cz, \tcx * sz + sx * sy * cz, \tsx * sz - cx * sy * cz,\n    \t\t\t-cy * sz,\tcx * cz - sx * sy * sz,\t\tsx * cz + cx * sy * sz,\n    \t\t\tsy,\t\t\t-sx * cy,\t\t\t\t\tcx * cy);\n}\n\nmat4 rotationMatrix(vec3 axis, float angle)\n{\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n\n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n\n// vec4 MOD_rot(vec4 pos, vec3 rot, mat4 modelMatrix)\n// {\n//     // pos=pos*rotationX(rot.x)*rotationY(rot.y)*rotationZ(rot.z);\n//     pos.xyz*=ntorot( (rot-0.5) * 3.14*2.0 );\n\n//     return pos;\n// }\n"};const n=e.inTrigger("exe"),a=e.inObject("Geometry",null,"geometry"),r=e.inInt("Num Instances",1e3),o=e.inTexture("Position Texture",null,"texture"),i=e.inTexture("Rotation Texture",null,"texture"),s=e.inTexture("Scale Texture",null,"texture"),l=e.inTexture("Color Texture",null,"texture"),c=e.inTexture("TexCoord Texture",null,"texture"),u=e.inSwitch("Color Texture Blendmode",["Multiply","Add","Normal"],"Multiply"),_=e.inValue("Scale",1),d=e.inValue("Multiply Pos X",1),p=e.inValue("Multiply Pos Y",1),g=e.inValue("Multiply Pos Z",1),f=e.outTrigger("Trigger Out"),m=e.outNumber("Num");e.toWorkPortsNeedToBeLinked(a);e.toWorkPortsNeedToBeLinked(n);a.ignoreValueSerialize=true;const v=e.patch.cgl;const h=mat4.create();let b=null,x=true,O=0,I=true;const y=new CGL.ShaderModifier(v,e.name);y.addModule({name:"MODULE_VERTEX_POSITION",title:e.name,priority:-2,srcHeadVert:t.instancer_head_vert,srcBodyVert:t.instancer_body_vert});y.addModule({name:"MODULE_COLOR",priority:-2,title:e.name,srcHeadFrag:t.instancer_head_frag,srcBodyFrag:t.instancer_body_frag});y.addUniformVert("f","MOD_scale",_);y.addUniformVert("t","MOD_texTrans");y.addUniformVert("t","MOD_texRot");y.addUniformVert("t","MOD_texScale");y.addUniformVert("t","MOD_texCoords");y.addUniformVert("t","MOD_texColor");y.addUniformVert("f","MOD_texSizeX",0);y.addUniformVert("f","MOD_texSizeY",0);y.addUniformVert("3f","MOD_mulRGB",d,p,g);u.onChange=o.onChange=s.onChange=l.onChange=c.onChange=i.onChange=A;n.onTriggered=E;n.onLinkChanged=function(){if(!n.isLinked())S()};r.onChange=function(){I=true;x=true};function T(){I=true;x=true}function A(){y.toggleDefine("BLEND_MODE_MULTIPLY",u.get()==="Multiply");y.toggleDefine("BLEND_MODE_ADD",u.get()==="Add");y.toggleDefine("BLEND_MODE_NONE",u.get()==="Normal");y.toggleDefine("USE_TEX_ROT",i.get());y.toggleDefine("USE_TEX_SCALE",s.get());y.toggleDefine("USE_TEX_COLOR",l.get());y.toggleDefine("USE_TEX_TC",c.get())}a.onChange=function(){if(b)b.dispose();if(!a.get()||!a.get().vertices){b=null;return}b=new CGL.Mesh(v,a.get());T()};function S(){}function C(){if(!b)return;O=Math.max(0,Math.floor(r.get()));b.numInstances=O;x=false}function E(){if(!b)return;if(x)C();if(!o.get())return;if(o.get())y.pushTexture("MOD_texTrans",o.get().tex);if(i.get())y.pushTexture("MOD_texRot",i.get().tex);if(s.get())y.pushTexture("MOD_texScale",s.get().tex);if(l.get())y.pushTexture("MOD_texColor",l.get().tex);if(c.get())y.pushTexture("MOD_texCoords",c.get().tex);y.bind();y.setUniformValue("MOD_texSizeX",o.get().width);y.setUniformValue("MOD_texSizeY",o.get().height);m.set(b.numInstances);if(b.numInstances>0)b.render(v.getShader());f.trigger();y.unbind()}};Ops.Gl.Meshes.MeshInstancerFromTexture_v2.prototype=new CABLES.Op;CABLES.OPS["10771b66-4b63-4f47-b050-3b9c44cb2780"]={f:Ops.Gl.Meshes.MeshInstancerFromTexture_v2,objName:"Ops.Gl.Meshes.MeshInstancerFromTexture_v2"};Ops.Gl.Matrix.Translate=function(){CABLES.Op.apply(this,arguments);const t=this;const e={};const n=t.inTrigger("render");const a=t.outTrigger("trigger");const r=t.inValue("x");const o=t.inValue("y");const i=t.inValue("z");let s=vec3.create();n.onTriggered=function(){const e=t.patch.cg;vec3.set(s,r.get(),o.get(),i.get());e.pushModelMatrix();mat4.translate(e.mMatrix,e.mMatrix,s);a.trigger();e.popModelMatrix()}};Ops.Gl.Matrix.Translate.prototype=new CABLES.Op;CABLES.OPS["1f89ba0e-e7eb-46d7-8c66-7814b7c528b9"]={f:Ops.Gl.Matrix.Translate,objName:"Ops.Gl.Matrix.Translate"};Ops.Gl.TextureEffects.Plasma_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={plasma_frag:"#define PI 3.1415926535897932384626433832795\n\nIN vec2 texCoord;\n\nUNI sampler2D tex;\nUNI vec2 size;\nUNI vec2 pos;\nUNI float mul;\nUNI float amount;\nUNI float time;\nUNI float aspect;\n\n#ifdef HAS_TEX_OFFSETMAP\n    UNI sampler2D texOffsetZ;\n    UNI float offMul;\n#endif\n\n#ifdef HAS_TEX_MASK\n    UNI sampler2D texMask;\n#endif\n\n\n{{CGL.BLENDMODES3}}\n\nvoid main()\n{\n    float v = 0.0;\n\n    vec2 s=size;\n    #ifdef FIXASPECT\n        s.y=size.x/aspect;\n    #endif\n\n    vec2 c = texCoord * s - s/2.0;\n\n    c+=pos;\n\n    vec3 offset;\n    #ifdef HAS_TEX_OFFSETMAP\n        vec4 offMap=texture(texOffsetZ,texCoord);\n\n        #ifdef OFFSET_X_R\n            offset.x=offMap.r;\n        #endif\n        #ifdef OFFSET_X_G\n            offset.x=offMap.g;\n        #endif\n        #ifdef OFFSET_X_B\n            offset.x=offMap.b;\n        #endif\n\n        #ifdef OFFSET_Y_R\n            offset.y=offMap.r;\n        #endif\n        #ifdef OFFSET_Y_G\n            offset.y=offMap.g;\n        #endif\n        #ifdef OFFSET_Y_B\n            offset.y=offMap.b;\n        #endif\n\n        #ifdef OFFSET_Z_R\n            offset.z=offMap.r;\n        #endif\n        #ifdef OFFSET_Z_G\n            offset.z=offMap.g;\n        #endif\n        #ifdef OFFSET_Z_B\n            offset.z=offMap.b;\n        #endif\n        offset*=offMul;\n    #endif\n\n    c+=offset.xy;\n    float t=time+offset.z;\n\n    v += sin((c.x+t));\n    v += sin((c.y+t)/2.0);\n    v += sin((c.x+c.y+t)/2.0);\n    c += size/2.0 * vec2(sin(t/3.0), cos(t/2.0));\n\n    v += sin(sqrt(c.x*c.x+c.y*c.y+1.0)+t);\n    v = v/2.0;\n\n    vec3 newColor = vec3(sin(PI*v*mul/4.0), sin(PI*v*mul), cos(PI*v*mul))*.5 + .5;\n    vec4 base=texture(tex,texCoord);\n\n    #ifndef GREY\n       vec4 col=vec4( _blend(base.rgb,newColor) ,1.0);\n    #endif\n    #ifdef GREY\n       vec4 col=vec4( _blend(base.rgb,vec3(newColor.g)) ,1.0);\n    #endif\n\n    float str=1.0;\n    #ifdef HAS_TEX_MASK\n        str=texture(texMask,texCoord).r;\n    #endif\n\n    outColor=cgl_blendPixel(base,col,amount*str);\n}\n\n"};const n=e.inTrigger("render"),a=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),r=CGL.TextureEffect.AddBlendAlphaMask(e),o=e.inValueSlider("Amount",1),i=e.inValue("Width",20),s=e.inValue("Height",20),l=e.inBool("Aspect",true),c=e.inValue("Mul",1),u=e.inValue("X",0),_=e.inValue("Y",0),d=e.inValue("Time",1),p=e.inValueBool("Greyscale",true),g=e.inTexture("Offset"),f=e.inFloat("Offset Multiply",1),m=e.inSwitch("Offset X",["None","R","G","B"],"None"),v=e.inSwitch("Offset Y",["None","R","G","B"],"None"),h=e.inSwitch("Offset Time",["None","R","G","B"],"R"),b=e.inTexture("Mask"),x=e.outTrigger("trigger");e.setPortGroup("Offset Map",[g,h,v,m,f]);const O=e.patch.cgl;const I=new CGL.Shader(O,e.name);I.setSource(I.getDefaultVertexShader(),t.plasma_frag);CGL.TextureEffect.setupBlending(e,I,a,o,r);const y=new CGL.Uniform(I,"2f","pos",u,_),T=new CGL.Uniform(I,"2f","size",i,s),A=new CGL.Uniform(I,"f","time",d),S=new CGL.Uniform(I,"f","mul",c),C=new CGL.Uniform(I,"f","aspect",1),E=new CGL.Uniform(I,"f","offMul",f),M=new CGL.Uniform(I,"t","tex",0),N=new CGL.Uniform(I,"t","texOffsetZ",1),L=new CGL.Uniform(I,"t","texMask",2),w=new CGL.Uniform(I,"f","amount",o);m.onChange=l.onChange=v.onChange=h.onChange=b.onChange=p.onChange=g.onLinkChanged=P;P();function P(){I.toggleDefine("GREY",p.get());I.toggleDefine("HAS_TEX_OFFSETMAP",g.isLinked());I.toggleDefine("HAS_TEX_MASK",b.isLinked());I.toggleDefine("OFFSET_X_R",m.get()=="R");I.toggleDefine("OFFSET_X_G",m.get()=="G");I.toggleDefine("OFFSET_X_B",m.get()=="B");I.toggleDefine("OFFSET_Y_R",v.get()=="R");I.toggleDefine("OFFSET_Y_G",v.get()=="G");I.toggleDefine("OFFSET_Y_B",v.get()=="B");I.toggleDefine("OFFSET_Z_R",h.get()=="R");I.toggleDefine("OFFSET_Z_G",h.get()=="G");I.toggleDefine("OFFSET_Z_B",h.get()=="B");m.setUiAttribs({greyout:!g.isLinked()});v.setUiAttribs({greyout:!g.isLinked()});h.setUiAttribs({greyout:!g.isLinked()});f.setUiAttribs({greyout:!g.isLinked()});s.setUiAttribs({greyout:l.get()});I.toggleDefine("FIXASPECT",l.get())}n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e,3))return;O.pushShader(I);O.currentTextureEffect.bind();if(l.get())C.setValue(O.currentTextureEffect.aspectRatio);else C.setValue(1);O.setTexture(0,O.currentTextureEffect.getCurrentSourceTexture().tex);if(g.get())O.setTexture(1,g.get().tex);if(b.get())O.setTexture(2,b.get().tex);O.currentTextureEffect.finish();O.popShader();x.trigger()}};Ops.Gl.TextureEffects.Plasma_v2.prototype=new CABLES.Op;CABLES.OPS["89b3bf34-a9a8-4dcf-a304-9dee597fcf48"]={f:Ops.Gl.TextureEffects.Plasma_v2,objName:"Ops.Gl.TextureEffects.Plasma_v2"};Ops.User.olixaf.CircleTransform=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inTrigger("render"),i=e.inValueInt("segments",40),s=e.inValueFloat("radius",1),l=e.inValueSlider("percent",1),c=e.inBool("Absolute",true),u=e.inBool("Flip",false),a=e.inValueBool("Rotate"),r=e.outTrigger("trigger"),o=e.outNumber("index");const _=e.patch.cgl;i.set(40);s.set(1);l.set(1);const d=[];u.onChange=c.onChange=i.onChange=s.onChange=l.onChange=f;let p=true;n.onTriggered=g;function g(){if(p)m();const t=a.get();const n=l.get();for(let e=0;e<d.length;e++){_.pushModelMatrix();mat4.translate(_.mMatrix,_.mMatrix,d[e]);if(t)mat4.rotateZ(_.mMatrix,_.mMatrix,e/d.length*n*CGL.DEG2RAD*-360);o.set(e);r.trigger();_.popModelMatrix()}}function f(){p=true}function m(){d.length=0;let e=0,t=0;let n=i.get();if(n<1)n=1;let a=Math.round(n*l.get());let r=360/Math.round(n);if(!c.get()){a=n;r=360/Math.round(n)*l.get()}const o=u.get();for(e=0;e<a;e++){if(o)t=(360-r*e)*CGL.DEG2RAD;else t=r*e*CGL.DEG2RAD;d.push([Math.sin(t)*s.get(),Math.cos(t)*s.get(),0])}p=false}};Ops.User.olixaf.CircleTransform.prototype=new CABLES.Op;CABLES.OPS["5d38bb56-2d94-4dc1-935f-5aaba50a1281"]={f:Ops.User.olixaf.CircleTransform,objName:"Ops.User.olixaf.CircleTransform"};Ops.Gl.ShaderEffects.TextureProjection_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={maptexture_frag:"IN vec2 MOD_tc;\n\n#ifdef MOD_MAP_TRIPLANAR\n    IN vec2 MOD_tc1;\n    IN vec2 MOD_tc2;\n    IN vec3 MOD_blendingTri;\n#endif\n\n\n{{CGL.BLENDMODES3}}",maptexture_vert:"vec3 MOD_pos;\n\n#ifndef MOD_WORLDSPACE\n   MOD_pos=(vec4(vPosition,1.0)*1.0/MOD_scale).xyz;\n#endif\n#ifdef MOD_WORLDSPACE\n   MOD_pos=(mMatrix*pos).xyz*1.0/MOD_scale;\n#endif\n\nMOD_pos=(vec4(MOD_pos,1.0)*MOD_rotationX(MOD_rotX*MOD_DEG2RAD)).xyz;\nMOD_pos=(vec4(MOD_pos,1.0)*MOD_rotationY(MOD_rotY*MOD_DEG2RAD)).xyz;\nMOD_pos=(vec4(MOD_pos,1.0)*MOD_rotationZ(MOD_rotZ*MOD_DEG2RAD)).xyz;\n\n#ifdef MOD_MAP_XY\n    MOD_tc=MOD_pos.xy;\n#endif\n#ifdef MOD_MAP_XZ\n    MOD_tc=MOD_pos.xz;\n#endif\n#ifdef MOD_MAP_YZ\n    MOD_tc=MOD_pos.yz;\n#endif\n\nMOD_tc.xy+=vec2(0.5,0.5);\nMOD_tc.xy+=MOD_offset;\n\n\n#ifdef MOD_TARGET_POINTSIZE\n\n    gl_PointSize+=texture(MOD_tex,MOD_tc).x*MOD_amount;\n\n#endif\n\n\n#ifdef MOD_MAP_TRIPLANAR\n    mapTriplanar((mMatrix*vec4(attrVertNormal,1.0)).xyz,MOD_pos);\n#endif\n\n",maptexture_body_frag:"#ifndef MOD_TARGET_POINTSIZE\n\n\n    vec4 MOD_color;\n\n    #ifdef MOD_MAP_TRIPLANAR\n        vec4 xaxis = texture( MOD_tex, MOD_tc);\n        vec4 yaxis = texture( MOD_tex, MOD_tc1);\n        vec4 zaxis = texture( MOD_tex, MOD_tc2);\n        MOD_color = xaxis *MOD_blendingTri.x + yaxis *MOD_blendingTri.y + zaxis *MOD_blendingTri.z;\n        MOD_color.a=1.0;\n    #endif\n\n\n    vec2 MOD_ntc=MOD_tc;\n\n    #ifdef MOD_MAP_SCREEN\n        MOD_ntc=(vec2(gl_FragCoord.x,gl_FragCoord.y)/vec2(MOD_viewPortW,MOD_viewPortH));\n\n        MOD_ntc-=vec2(0.5,0.5);\n        MOD_ntc*=1.0/MOD_scale;\n        MOD_ntc+=vec2(0.5,0.5);\n        MOD_ntc-=MOD_offset;\n    #endif\n\n    #ifdef MOD_MAP_TEXCOORD\n        MOD_ntc=texCoord;\n    #endif\n\n    #ifdef MOD_MAP_TEXCOORD1\n        MOD_ntc=texCoord1;\n    #endif\n\n    #ifdef MOD_MAP_TEXCOORD2\n        MOD_ntc=texCoord2;\n    #endif\n\n\n    #ifdef MOD_DISCARD\n    if(MOD_ntc.x>0.0 && MOD_ntc.x<1.0 && MOD_ntc.y>0.0 && MOD_ntc.y<1.0)\n    {\n    #endif\n\n        #ifndef MOD_MAP_TRIPLANAR\n            MOD_color=texture(MOD_tex,MOD_ntc);\n        #endif\n\n        #ifdef MOD_USE_IMGALPHA\n            col.a=MOD_color.a;\n        #endif\n\n        #ifdef MOD_TARGET_COLOR\n        col=cgl_blendPixel(col,MOD_color,MOD_amount*col.a);\n        #endif\n        #ifdef MOD_TARGET_ALPHA\n        col.a=1.0-MOD_color.r*MOD_amount;\n        #endif\n\n    #ifdef MOD_DISCARD\n    }\n\n    #endif\n#endif\n",maptexture_body_vert:"OUT vec2 MOD_tc;\n\nconst float MOD_DEG2RAD = 0.017453292519943;\n\n#ifdef MOD_MAP_TRIPLANAR\n\n    OUT vec2 MOD_tc1;\n    OUT vec2 MOD_tc2;\n    OUT vec3 MOD_blendingTri;\n\n    void mapTriplanar(vec3 wNorm,vec3 pos)\n    {\n        vec3 blending = abs( wNorm );\n        blending = normalize(max(blending, 0.1));\n        float b = (blending.x + blending.y + blending.z);\n        blending /= vec3(b);\n        MOD_blendingTri=blending;\n\n        MOD_tc = pos.yz;\n        MOD_tc1 = pos.xz;\n        MOD_tc2 = pos.xy;\n    }\n\n#endif\n\nmat4 MOD_rotationX( in float angle ) {\n\treturn mat4(\t1.0,\t\t0,\t\t\t0,\t\t\t0,\n\t\t\t \t\t0, \tcos(angle),\t-sin(angle),\t\t0,\n\t\t\t\t\t0, \tsin(angle),\t cos(angle),\t\t0,\n\t\t\t\t\t0, \t\t\t0,\t\t\t  0, \t\t1);\n}\n\nmat4 MOD_rotationY( in float angle ) {\n\treturn mat4(\tcos(angle),\t\t0,\t\tsin(angle),\t0,\n\t\t\t \t\t\t\t0,\t\t1.0,\t\t\t 0,\t0,\n\t\t\t\t\t-sin(angle),\t0,\t\tcos(angle),\t0,\n\t\t\t\t\t\t\t0, \t\t0,\t\t\t\t0,\t1);\n}\n\nmat4 MOD_rotationZ( in float angle ) {\n\treturn mat4(\tcos(angle),\t\t-sin(angle),\t0,\t0,\n\t\t\t \t\tsin(angle),\t\tcos(angle),\t\t0,\t0,\n\t\t\t\t\t\t\t0,\t\t\t\t0,\t\t1,\t0,\n\t\t\t\t\t\t\t0,\t\t\t\t0,\t\t0,\t1);\n}\n"};const n=e.inTrigger("render"),a=e.outTrigger("trigger"),r=e.inTexture("Texture"),o=e.inValue("Scale",10),i=e.inSwitch("Target",["Color","Pointsize","Alpha"],"Color"),s=CGL.TextureEffect.AddBlendSelect(e,"blendMode"),l=e.inValueSlider("Amount",.3),c=e.inBool("Use Texture Alpha",false),u=e.inFloat("Pos X",0),_=e.inFloat("Pos Y",0),d=e.inFloat("Rot X",0),p=e.inFloat("Rot Y",0),g=e.inFloat("Rot Z",0),f=e.inValueSelect("Mapping",["Triplanar","XY","XZ","YZ","Screen","TexCoords 1","TexCoords 2","TexCoords 3"],"XY"),m=e.inValueBool("Discard"),v=e.inValueBool("WorldSpace");const h=e.patch.cgl;c.onChange=i.onChange=s.onChange=m.onChange=v.onChange=f.onChange=y;e.setPortGroup("Rotation",[d,p,g]);e.setPortGroup("Position",[u,_]);const b=new CGL.ShaderModifier(h,e.name);b.addModule({title:e.name,name:"MODULE_VERTEX_POSITION",srcHeadVert:t.maptexture_body_vert,srcBodyVert:t.maptexture_vert,attributes:[{type:"vec2",name:"attrTexCoord1",nameFrag:"texCoord1"},{type:"vec2",name:"attrTexCoord2",nameFrag:"texCoord2"}]});let x=t.maptexture_frag;x=x.replace("{{BLENDCODE}}",CGL.TextureEffect.getBlendCode(3));b.addModule({title:e.name,name:"MODULE_COLOR",srcHeadFrag:x,srcBodyFrag:t.maptexture_body_frag});b.addUniformBoth("f","MOD_rotX",d);b.addUniformBoth("f","MOD_rotY",p);b.addUniformBoth("f","MOD_rotZ",g);b.addUniformBoth("t","MOD_tex");b.addUniformBoth("f","MOD_scale",o);b.addUniformBoth("f","MOD_amount",l);b.addUniformBoth("2f","MOD_offset",u,_);const O=b.addUniformFrag("f","MOD_viewPortW");const I=b.addUniformFrag("f","MOD_viewPortH");CGL.TextureEffect.setupBlending(e,b,s,l);y();function y(){b.toggleDefine("MOD_USE_IMGALPHA",c.get());b.toggleDefine("MOD_WORLDSPACE",v.get());b.toggleDefine("MOD_MAP_XY",f.get()=="XY");b.toggleDefine("MOD_MAP_XZ",f.get()=="XZ");b.toggleDefine("MOD_MAP_YZ",f.get()=="YZ");b.toggleDefine("MOD_MAP_TEXCOORD",f.get()=="TexCoords 1");b.toggleDefine("MOD_MAP_TEXCOORD1",f.get()=="TexCoords 2");b.toggleDefine("MOD_MAP_TEXCOORD2",f.get()=="TexCoords 3");b.toggleDefine("MOD_MAP_SCREEN",f.get()=="Screen");b.toggleDefine("MOD_MAP_TRIPLANAR",f.get()=="Triplanar");b.toggleDefine("MOD_DISCARD",m.get());b.toggleDefine("MOD_BLEND_NORMAL",s.get()=="Normal");b.toggleDefine("MOD_BLEND_ADD",s.get()=="Add");b.toggleDefine("MOD_BLEND_MUL",s.get()=="Mul");b.toggleDefine("MOD_BLEND_MUL",s.get()=="Mul");b.toggleDefine("MOD_TARGET_ALPHA",i.get()=="Alpha");b.toggleDefine("MOD_TARGET_COLOR",i.get()=="Color");b.toggleDefine("MOD_TARGET_POINTSIZE",i.get()=="Pointsize")}n.onTriggered=function(){const e=h.getViewPort();b.setUniformValue("MOD_viewPortW",e[2]);b.setUniformValue("MOD_viewPortH",e[3]);b.bind();let t=r.get();if(!t)t=CGL.Texture.getEmptyTexture(h).tex;else t=t.tex;b.pushTexture("MOD_tex",t);a.trigger();b.unbind()}};Ops.Gl.ShaderEffects.TextureProjection_v2.prototype=new CABLES.Op;CABLES.OPS["9be647c2-7afd-40ed-b669-9826ea6a50ca"]={f:Ops.Gl.ShaderEffects.TextureProjection_v2,objName:"Ops.Gl.ShaderEffects.TextureProjection_v2"};Ops.Gl.ShaderEffects.AreaTranslateFBMNoise=function(){CABLES.Op.apply(this,arguments);const e=this;const t={areascale_vert:"UNI bool MOD_smooth;\nUNI float MOD_x,MOD_y,MOD_z;\nUNI float MOD_tx,MOD_ty,MOD_tz;\nUNI float MOD_strength;\nUNI float MOD_size;\nUNI float MOD_noiseScale;\n\n\n\n\nfloat MOD_mod289(float x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 MOD_mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 MOD_perm(vec4 x){return MOD_mod289(((x * 34.0) + 1.0) * x);}\n\nfloat MOD_noise(vec3 p){\n    vec3 a = floor(p);\n    vec3 d = p - a;\n    d = d * d * (3.0 - 2.0 * d);\n\n    vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n    vec4 k1 = MOD_perm(b.xyxy);\n    vec4 k2 = MOD_perm(k1.xyxy + b.zzww);\n\n    vec4 c = k2 + a.zzzz;\n    vec4 k3 = MOD_perm(c);\n    vec4 k4 = MOD_perm(c + 1.0);\n\n    vec4 o1 = fract(k3 * (1.0 / 41.0));\n    vec4 o2 = fract(k4 * (1.0 / 41.0));\n\n    vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n    vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\n    return o4.y * d.y + o4.x * (1.0 - d.y);\n}\n\n\n\nfloat MOD_fbm(vec3 x)\n{\n    const int NUM_OCTAVES=8;\n    float time=0.0;\n\n\tfloat v = 0.0;\n\tfloat a = 0.5;\n\tvec3 shift = vec3(100.0+time);\n\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\tv += a * MOD_noise(x);\n\t\tx = x * 2.0 + shift;\n\t\ta *= 0.5;\n\t}\n\treturn v;\n}\n\n\n\nmat4 MOD_rotation3d(vec3 axis, float angle) {\n  axis = normalize(axis);\n  float s = sin(angle);\n  float c = cos(angle);\n  float oc = 1.0 - c;\n\n  return mat4(\n\t\toc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n        oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n        oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n\t\t0.0,                                0.0,                                0.0,                                1.0\n\t);\n}\n\n\nmat4 MOD_translate(mat4 mat)\n{\n    vec3 forcePos=vec3(MOD_x,MOD_y,MOD_z);\n    vec3 noisePos=vec3(MOD_tx,MOD_ty,MOD_tz);\n    vec3 worldPos=vec3(mat[3][0],mat[3][1],mat[3][2]);\n    // vec3 worldPosInst=vec3(instMat[3][0],instMat[3][1],instMat[3][2]);\n\n    vec3 vecToOrigin=worldPos-forcePos;\n    float dist=abs(length(vecToOrigin));\n    float distAlpha = (MOD_size - dist) ;\n\n    if(MOD_smooth) distAlpha=smoothstep(0.0,MOD_size,distAlpha);\n    else\n    {\n        if(distAlpha>0.0) distAlpha=1.0;\n        else distAlpha=0.0;\n    }\n\n    distAlpha*=MOD_strength;\n\n    vec3 tr=vec3(distAlpha);\n\n    float nois=(MOD_fbm(MOD_noiseScale*(worldPos+noisePos))-0.5);\n    float nois2=(MOD_fbm(MOD_noiseScale*(worldPos+noisePos*5.711))-0.5);\n    float nois3=(MOD_fbm(MOD_noiseScale*(worldPos+noisePos*2.0))-0.5);\n    // tr=nois*tr;\n\n\n    #ifdef MOD_DO_ROTATE\n        if(distAlpha>0.0) mat*=MOD_rotation3d( vec3(distAlpha)*vec3(nois,nois2,nois3), MOD_strength/57.297);\n    #endif\n\n    #ifdef MOD_DO_TRANSLATE\n        mat[3][0] += nois*distAlpha;\n        mat[3][1] += nois2*distAlpha;\n        mat[3][2] += nois3*distAlpha;\n    #endif\n\n    return mat;\n}\n"};const n=e.inTrigger("render"),a=e.outTrigger("trigger"),r=e.inSwitch("Mode",["Rotate","Translate"],"Translate"),o=e.inValue("Size",1),i=e.inValue("Strength",1),s=e.inValueBool("Smooth",true),l=e.inValue("x"),c=e.inValue("y"),u=e.inValue("z"),_=e.inValue("Noise Scale",.5),d=e.inValue("Noise X"),p=e.inValue("Noise Y"),g=e.inValue("Noise Z");const f=e.patch.cgl;e.setPortGroup("Noise",[_,d,p,g]);e.setPortGroup("Area Position",[l,c,u]);let m=true;let v=null;let h=null;let b={};let x=t.areascale_vert;let O=null;let I="".endl()+"mMatrix=MOD_translate(mMatrix);".endl();n.onLinkChanged=y;r.onChange=T;function y(){if(h&&O)h.removeModule(O);h=null}function T(){if(!h)return;h.toggleDefine(O.prefix+"DO_ROTATE",r.get()=="Rotate");h.toggleDefine(O.prefix+"DO_TRANSLATE",r.get()=="Translate")}n.onTriggered=function(){if(!f.getShader()){a.trigger();return}if(CABLES.UI){if(e.isCurrentUiOp())gui.setTransformGizmo({posX:l,posY:c,posZ:u});if(f.shouldDrawHelpers(e)){f.pushModelMatrix();mat4.translate(f.mMatrix,f.mMatrix,[l.get(),c.get(),u.get()]);CABLES.GL_MARKER.drawSphere(e,o.get());f.popModelMatrix()}}if(f.getShader()!=h){if(h)y();h=f.getShader();O=h.addModule({title:e.objName,name:"MODULE_VERTEX_POSITION",srcHeadVert:x,srcBodyVert:I});T();b.inSizeUniform=new CGL.Uniform(h,"f",O.prefix+"size",o);b.inStrengthUniform=new CGL.Uniform(h,"f",O.prefix+"strength",i);b.inSmoothUniform=new CGL.Uniform(h,"f",O.prefix+"smooth",s);b.inNoiseScaleUniform=new CGL.Uniform(h,"f",O.prefix+"noiseScale",_);b.xUniform=new CGL.Uniform(h,"f",O.prefix+"x",l);b.yUniform=new CGL.Uniform(h,"f",O.prefix+"y",c);b.zUniform=new CGL.Uniform(h,"f",O.prefix+"z",u);b.txUniform=new CGL.Uniform(h,"f",O.prefix+"tx",d);b.tyUniform=new CGL.Uniform(h,"f",O.prefix+"ty",p);b.tzUniform=new CGL.Uniform(h,"f",O.prefix+"tz",g)}if(!h)return;a.trigger()}};Ops.Gl.ShaderEffects.AreaTranslateFBMNoise.prototype=new CABLES.Op;CABLES.OPS["e755e88e-a2a7-4db2-84b3-0e76c423bdb6"]={f:Ops.Gl.ShaderEffects.AreaTranslateFBMNoise,objName:"Ops.Gl.ShaderEffects.AreaTranslateFBMNoise"};Ops.Gl.TextureEffects.FastBlur_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={blur_frag:"\nUNI sampler2D tex;\n#ifdef USE_MASK\n    UNI sampler2D texMask;\n#endif\nUNI float amount;\nUNI float pass;\n\nIN vec2 texCoord;\n\nUNI float dirX;\nUNI float dirY;\nUNI float width;\nUNI float height;\n\nIN vec2 coord0;\nIN vec2 coord1;\nIN vec2 coord2;\nIN vec2 coord3;\nIN vec2 coord4;\nIN vec2 coord5;\nIN vec2 coord6;\n\n#ifdef HAS_MASK\n    UNI sampler2D imageMask;\n#endif\n\nvoid main()\n{\n    vec4 color = vec4(0.0);\n\n    #ifdef USE_MASK\n        #ifdef MASK_INVERT\n            if(texture(texMask,texCoord).r<0.5)\n            {\n                outColor= texture(tex, texCoord);\n                return;\n            }\n        #endif\n\n        #ifndef MASK_INVERT\n            if(texture(texMask,texCoord).r>0.5)\n            {\n                outColor= texture(tex, texCoord);\n                return;\n            }\n        #endif\n    #endif\n\n    color += texture(tex, coord0) * 0.06927096443792478;\n    color += texture(tex, coord1) * 0.1383328848652136;\n    color += texture(tex, coord2) * 0.21920904690397863;\n    color += texture(tex, coord3) * 0.14637421;\n    color += texture(tex, coord4) * 0.21920904690397863;\n    color += texture(tex, coord5) * 0.1383328848652136;\n    color += texture(tex, coord6) * 0.06927096443795711;\n\n    outColor= color;\n}",blur_vert:"\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 mvMatrix;\nUNI mat4 modelMatrix;\n\nUNI float pass;\nUNI float dirX;\nUNI float dirY;\nUNI float width;\nUNI float height;\n\nOUT vec2 coord0;\nOUT vec2 coord1;\nOUT vec2 coord2;\nOUT vec2 coord3;\nOUT vec2 coord4;\nOUT vec2 coord5;\nOUT vec2 coord6;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    {{MODULE_VERTEX_POSITION}}\n\n    vec2 dir=vec2(dirX,dirY);\n    vec2 res=vec2( (1.) / width , (1.) / height )*dir;\n\n    coord3= attrTexCoord;\n\n    coord0= attrTexCoord + (-3.0368997744118595 * res);\n    coord1= attrTexCoord + (-2.089778445362373 * res);\n    coord2= attrTexCoord + (-1.2004366090034069 * res);\n    coord4= attrTexCoord + (1.2004366090034069 * res);\n    coord5= attrTexCoord + (2.089778445362373* res);\n    coord6= attrTexCoord + (3.0368997744118595 * res);\n\n    #ifdef CLAMP\n        coord0=clamp(coord0,0.0,1.0);\n        coord1=clamp(coord1,0.0,1.0);\n        coord2=clamp(coord2,0.0,1.0);\n        coord3=clamp(coord3,0.0,1.0);\n        coord4=clamp(coord4,0.0,1.0);\n        coord5=clamp(coord5,0.0,1.0);\n        coord6=clamp(coord6,0.0,1.0);\n    #endif\n\n    gl_Position = projMatrix * mvMatrix * pos;\n}\n"};const n=e.inTrigger("render"),a=e.outTrigger("trigger"),r=e.inFloat("Passes",3),o=e.inBool("Clamp",false),i=e.inDropDown("direction",["both","vertical","horizontal"],"both"),s=e.inTexture("Mask"),l=e.inBool("Mask Invert",false);const c=e.patch.cgl;const u=new CGL.Shader(c,"fastblur");e.setPortGroup("Mask",[s,l]);u.setSource(t.blur_vert,t.blur_frag);const _=new CGL.Uniform(u,"t","tex",0),d=new CGL.Uniform(u,"f","dirX",0),p=new CGL.Uniform(u,"f","dirY",0),g=new CGL.Uniform(u,"f","width",0),f=new CGL.Uniform(u,"f","height",0),m=new CGL.Uniform(u,"f","pass",0),v=new CGL.Uniform(u,"f","amount",r.get()),h=new CGL.Uniform(u,"t","texMask",1);r.onChange=()=>{v.setValue(r.get())};let b=0;i.onChange=()=>{if(i.get()=="both")b=0;if(i.get()=="horizontal")b=1;if(i.get()=="vertical")b=2};o.onChange=()=>{u.toggleDefine("CLAMP",o.get())};l.onChange=s.onChange=x;x();function x(){u.toggleDefine("USE_MASK",s.isLinked());u.toggleDefine("MASK_INVERT",l.get());l.setUiAttribs({greyout:!s.isLinked()})}n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e,3))return;g.setValue(c.currentTextureEffect.getCurrentSourceTexture().width);f.setValue(c.currentTextureEffect.getCurrentSourceTexture().height);const t=r.get();if(s.get())c.setTexture(1,s.get().tex);for(let e=0;e<t;e++){c.pushShader(u);m.setValue(e/t);if(b===0||b==2){c.currentTextureEffect.bind();c.setTexture(0,c.currentTextureEffect.getCurrentSourceTexture().tex);d.setValue(0);p.setValue(1+e*e);c.currentTextureEffect.finish()}if(b===0||b==1){c.currentTextureEffect.bind();c.setTexture(0,c.currentTextureEffect.getCurrentSourceTexture().tex);d.setValue(1+e*e);p.setValue(0);c.currentTextureEffect.finish()}c.popShader()}a.trigger()}};Ops.Gl.TextureEffects.FastBlur_v2.prototype=new CABLES.Op;CABLES.OPS["61ed277f-d096-43b2-9de8-dc87fb3a9169"]={f:Ops.Gl.TextureEffects.FastBlur_v2,objName:"Ops.Gl.TextureEffects.FastBlur_v2"};Ops.Gl.TextureEffects.Wobble_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={wobble_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI sampler2D texMask;\nUNI float time;\nUNI float speedX;\nUNI float speedY;\nUNI float repeatX;\nUNI float repeatY;\nUNI float mul;\n\n{{CGL.LUMINANCE}}\n\nvoid main()\n{\n    float mult=1.0;\n    #ifdef HAS_MASK\n        #ifdef MASK_SRC_R\n            mult*=texture(texMask,texCoord).r;\n        #endif\n        #ifdef MASK_SRC_G\n            mult*=texture(texMask,texCoord).g;\n        #endif\n        #ifdef MASK_SRC_B\n            mult*=texture(texMask,texCoord).b;\n        #endif\n        #ifdef MASK_SRC_A\n            mult*=texture(texMask,texCoord).a;\n        #endif\n        #ifdef MASK_SRC_LUM\n            mult*=cgl_luminance(texture(texMask,texCoord).rgb);\n        #endif\n        #ifdef MASK_INV\n            mult=1.0-mult;\n        #endif\n    #endif\n\n    mult*=mul;\n\n    vec2 tc = texCoord + cos( (time*vec2(speedX, speedY) + vec2(texCoord.s*repeatX,texCoord.t*repeatY)))*mult;\n    vec4 col=texture(tex,tc);\n\n    outColor= col;\n}"};const n=e.inTrigger("Render"),a=e.inValue("time",0),r=e.inValue("SpeedX",4),o=e.inValue("SpeedY",8),i=e.inValue("RepeatX",11),s=e.inValue("RepeatY",11),l=e.inValue("Multiply",.01),c=e.inTexture("Amount Map"),u=e.inSwitch("Source Amount Map",["R","G","B","A","Lum"],"R"),_=e.inBool("Invert Amount Map",false),d=e.outTrigger("Trigger");e.setPortGroup("Amount Map",[c,u,_]);const p=e.patch.cgl;const g=new CGL.Shader(p,e.name);g.setSource(g.getDefaultVertexShader(),t.wobble_frag);const f=new CGL.Uniform(g,"t","tex",0),m=new CGL.Uniform(g,"f","time",a),v=new CGL.Uniform(g,"f","speedX",r),h=new CGL.Uniform(g,"f","speedY",o),b=new CGL.Uniform(g,"f","repeatX",i),x=new CGL.Uniform(g,"f","repeatY",s),O=new CGL.Uniform(g,"f","mul",l),I=new CGL.Uniform(g,"t","texMask",1);c.onChange=u.onChange=_.onChange=()=>{g.toggleDefine("HAS_MASK",c.isLinked());g.toggleDefine("MASK_SRC_R",u.get()=="R");g.toggleDefine("MASK_SRC_G",u.get()=="G");g.toggleDefine("MASK_SRC_B",u.get()=="B");g.toggleDefine("MASK_SRC_A",u.get()=="A");g.toggleDefine("MASK_SRC_LUM",u.get()=="Lum");g.toggleDefine("MASK_INV",_.get());u.setUiAttribs({greyout:!c.isLinked()});_.setUiAttribs({greyout:!c.isLinked()})};n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;p.pushShader(g);p.currentTextureEffect.bind();p.setTexture(0,p.currentTextureEffect.getCurrentSourceTexture().tex);if(c.get())p.setTexture(1,c.get().tex);p.currentTextureEffect.finish();p.popShader();d.trigger()}};Ops.Gl.TextureEffects.Wobble_v2.prototype=new CABLES.Op;CABLES.OPS["04a8a8bc-feb9-4791-8724-ee24bbb150db"]={f:Ops.Gl.TextureEffects.Wobble_v2,objName:"Ops.Gl.TextureEffects.Wobble_v2"};Ops.Gl.TextureEffects.ZoomBlur_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={zoomblur_frag:"UNI sampler2D tex;\nUNI float x;\nUNI float y;\nUNI float strength;\nIN vec2 texCoord;\n\n#ifdef HAS_MASK\n    UNI sampler2D texMask;\n#endif\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\n#ifdef MASK_SRC_LUM\n    {{CGL.LUMINANCE}}\n#endif\n\nvoid main()\n{\n    float total = 0.0;\n    vec4 color = vec4(0.0);\n    vec2 center=vec2(x,y);\n    center=(center/2.0)+0.5;\n\n    vec2 texSize=vec2(1.0,1.0);\n    vec2 toCenter = center - texCoord * texSize;\n\n    /* randomize the lookup values to hide the fixed number of samples */\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    float am = strength;\n\n    #ifdef HAS_MASK\n\n        float mul=1.0;\n        #ifdef MASK_SRC_R\n            mul=texture(texMask,texCoord).r;\n        #endif\n        #ifdef MASK_SRC_G\n            mul=texture(texMask,texCoord).g;\n        #endif\n        #ifdef MASK_SRC_B\n            mul=texture(texMask,texCoord).b;\n        #endif\n        #ifdef MASK_SRC_A\n            mul=texture(texMask,texCoord).a;\n        #endif\n        #ifdef MASK_SRC_LUM\n            mul=cgl_luminance(texture(texMask,texCoord).rgb);\n        #endif\n\n        #ifdef MASK_INV\n            mul=1.0-mul;\n        #endif\n\n        am=am*mul;\n\n        if(am<=0.02)\n        {\n            outColor=texture(tex, texCoord);\n            return;\n        }\n    #endif\n\n    for (float t = 0.0; t <= 40.0; t++)\n    {\n        float percent = (t + offset) / 40.0;\n        float weight = 4.0 * (percent - percent * percent);\n        vec4 smpl = texture(tex, texCoord + toCenter * percent * am / texSize);\n\n        smpl.rgb *= smpl.a;\n\n        color += smpl * weight;\n        total += weight;\n    }\n\n    outColor = color / total;\n}"};const n=e.inTrigger("render"),a=e.inValueSlider("Strength",.5),r=e.inValue("X",0),o=e.inValue("Y",0),i=e.inTexture("Strength Map"),s=e.inSwitch("Source Strength Map",["R","G","B","A","Lum"],"R"),l=e.inBool("Invert Strength Map",false),c=e.outTrigger("trigger");e.setPortGroup("Strengh Map",[i,s,l]);const u=e.patch.cgl;const _=new CGL.Shader(u,"zoomblur");_.setSource(_.getDefaultVertexShader(),t.zoomblur_frag);const d=new CGL.Uniform(_,"t","tex",0),p=new CGL.Uniform(_,"t","texMask",1),g=new CGL.Uniform(_,"f","x",r),f=new CGL.Uniform(_,"f","y",o),m=new CGL.Uniform(_,"f","strength",a);s.onChange=l.onChange=i.onChange=v;v();function v(){_.toggleDefine("HAS_MASK",i.isLinked());_.toggleDefine("MASK_SRC_R",s.get()=="R");_.toggleDefine("MASK_SRC_G",s.get()=="G");_.toggleDefine("MASK_SRC_B",s.get()=="B");_.toggleDefine("MASK_SRC_A",s.get()=="A");_.toggleDefine("MASK_SRC_LUM",s.get()=="Lum");_.toggleDefine("MASK_INV",l.get());s.setUiAttribs({greyout:!i.isLinked()});l.setUiAttribs({greyout:!i.isLinked()})}n.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e,3))return;if(a.get()>0){u.pushShader(_);u.currentTextureEffect.bind();u.setTexture(0,u.currentTextureEffect.getCurrentSourceTexture().tex);if(i.get()&&i.get().tex)u.setTexture(1,i.get().tex);u.currentTextureEffect.finish();u.popShader()}c.trigger()}};Ops.Gl.TextureEffects.ZoomBlur_v2.prototype=new CABLES.Op;CABLES.OPS["b720a2f5-5501-48ef-90de-94a280ba6fbd"]={f:Ops.Gl.TextureEffects.ZoomBlur_v2,objName:"Ops.Gl.TextureEffects.ZoomBlur_v2"};Ops.Devices.Keyboard.KeyPress_v2=function(){CABLES.Op.apply(this,arguments);const n=this;const e={};const t=n.inValueSelect("Area",["Canvas","Document","Parent Element"],"Canvas");const a=n.inBool("Prevent Default",false);const r=n.inBool("Enabled",true);const o=n.outTrigger("On Press");const i=n.outNumber("Key Code");const s=n.outString("Key");const l=n.patch.cgl;let c=null;t.onChange=r.onChange=()=>{if(r.get()){_()}else{d()}};n.onDelete=()=>{d()};function u(e){const t=CABLES.keyCodeToName(e.keyCode);n.setUiAttribs({extendTitle:t});s.set(t);i.set(e.keyCode);o.trigger();if(a.get())e.preventDefault()}function _(){if(c)d();c=l.canvas;if(t.get()==="Document")c=document.body;if(t.get()==="Parent Element")c=l.canvas.parentElement;c.addEventListener("keydown",u)}function d(){if(!c)return;c.removeEventListener("keydown",u);c=null}_()};Ops.Devices.Keyboard.KeyPress_v2.prototype=new CABLES.Op;CABLES.OPS["1c3fb776-fe52-4f4b-84a9-832e5a57f0fd"]={f:Ops.Devices.Keyboard.KeyPress_v2,objName:"Ops.Devices.Keyboard.KeyPress_v2"};window.addEventListener("load",function(e){CABLES.jsLoaded=new Event("CABLES.jsLoaded");document.dispatchEvent(CABLES.jsLoaded)});(function e(t,n){if(typeof exports==="object"&&typeof module==="object")module.exports=n();else if(typeof define==="function"&&define.amd)define([],n);else if(typeof exports==="object")exports["ColorRick"]=n();else t["ColorRick"]=n()})(self,function(){return(()=>{var __webpack_modules__={"./index.js":(module,__unused_webpack_exports,__webpack_require__)=>{eval('\n// window.chroma = require("chroma-js");\nconst chroma = __webpack_require__(/*! chroma-js */ "./node_modules/chroma-js/chroma.js");\n// import chroma from "chroma-js";\n\n\nclass ColorRick\n{\n    constructor(options)\n    {\n        this._elements=[];\n\n        this.options=options;\n\n        this._areaWidth=256;\n        this._areaHeight=150;\n\n        this._elContainer = document.createElement("div");\n        this._elContainer.classList.add("colorRick_dialog");\n        document.body.appendChild(this._elContainer);\n        this._elements.push(this._elContainer);\n\n        this._elContainer.style.setProperty(\'--width\', this._areaWidth + "px");\n        this._elContainer.style.setProperty(\'--height\', this._areaHeight + "px");\n\n\n        this._elArea = document.createElement("div");\n        this._elArea.classList.add("colorRick_area");\n        this._elContainer.appendChild(this._elArea);\n        this._elements.push(this._elArea);\n\n        this._elAreaCursor = document.createElement("div");\n        this._elAreaCursor.classList.add("colorRick_cursor");\n        this._elArea.appendChild(this._elAreaCursor);\n        this._elements.push(this._elAreaCursor);\n\n        this._elBrightness = document.createElement("div");\n        this._elBrightness.classList.add("colorRick_brightness");\n        this._elArea.appendChild(this._elBrightness);\n        this._elements.push(this._elBrightness);\n\n\n        this._elHue = document.createElement("div");\n        this._elHue.classList.add("colorRick_hue");\n        this._elContainer.appendChild(this._elHue);\n        this._elements.push(this._elHue);\n\n        this._elHueCursor = document.createElement("div");\n        this._elHueCursor.classList.add("colorRick_cursor_hue");\n        this._elHue.appendChild(this._elHueCursor);\n        this._elements.push(this._elHueCursor);\n\n        this._elColorBox = document.createElement("div");\n        this._elColorBox.classList.add("colorRick_preview");\n        this._elContainer.appendChild(this._elColorBox);\n        this._elements.push(this._elColorBox);\n\n        this._elColorBoxOrig = document.createElement("div");\n        this._elColorBoxOrig.classList.add("colorRick_preview");\n        this._elColorBoxOrig.classList.add("colorRick_preview_orig");\n        this._elContainer.appendChild(this._elColorBoxOrig);\n        this._elements.push(this._elColorBoxOrig);\n\n        this._elInputContainer = document.createElement("div");\n        this._elInputContainer.classList.add("colorRick_inputcontainer");\n        this._elContainer.appendChild(this._elInputContainer);\n        this._elements.push(this._elInputContainer);\n\n        const inputs=\n            "<table>"+\n                "<tr>"+\n                    "<td>"+\n                        "HEX"+\n                    "</td>"+\n                    "<td class=\\"right\\">"+\n                        "<input id=\\"colorRick_input_hex\\" class=\\"colorRick_input colorRick_input_hex\\" />"+\n                    "</td>"+\n                "</tr>"+\n                "<tr>"+\n                    "<td>"+\n                        "RGB"+\n                    "</td>"+\n                    "<td class=\\"right\\">"+\n                        "<input id=\\"colorRick_input_r\\" class=\\"colorRick_input colorRick_input_small\\" />"+\n                        "<input id=\\"colorRick_input_g\\" class=\\"colorRick_input colorRick_input_small\\" />"+\n                        "<input id=\\"colorRick_input_b\\" class=\\"colorRick_input colorRick_input_small\\" />"+\n                    "</td>"+\n                "</tr>"+\n                "<tr>"+\n                    "<td>"+\n                        "HSV"+\n                    "</td>"+\n                    "<td class=\\"right\\">"+\n                        "<input id=\\"colorRick_input_h\\" class=\\"colorRick_input colorRick_input_small\\" />"+\n                        "<input id=\\"colorRick_input_s\\" class=\\"colorRick_input colorRick_input_small\\" />"+\n                        "<input id=\\"colorRick_input_v\\" class=\\"colorRick_input colorRick_input_small\\" />"+\n                    "</td>"+\n                "</tr>"+\n            "</table>";\n\n\n        this._elInputContainer.innerHTML=inputs;\n\n        this._inputHex=document.getElementById("colorRick_input_hex");\n\n        this._inputR=document.getElementById("colorRick_input_r");\n        this._inputG=document.getElementById("colorRick_input_g");\n        this._inputB=document.getElementById("colorRick_input_b");\n\n        this._inputH=document.getElementById("colorRick_input_h");\n        this._inputS=document.getElementById("colorRick_input_s");\n        this._inputV=document.getElementById("colorRick_input_v");\n\n        this._elements.push(this._inputHex);\n        this._elements.push(this._inputR,this._inputG,this._inputB);\n        this._elements.push(this._inputH,this._inputS,this._inputV);\n        \n\n        this._color=chroma("white");\n\n\n        if(this.options.color)\n        {\n            this.setColor(this.options.color);\n        }\n\n        this._elColorBoxOrig.style.backgroundColor=this._color.hex();\n\n        this.updateColorField();\n\n\n\n        this._inputR.addEventListener("input",(e)=>\n        {\n            this._setColorFromRgbInputs();\n        });\n\n        this._inputG.addEventListener("input",(e)=>\n        {\n            this._setColorFromRgbInputs();\n        });\n\n        this._inputB.addEventListener("input",(e)=>\n        {\n            this._setColorFromRgbInputs();\n        });\n\n\n        this._inputH.addEventListener("input",(e)=>\n        {\n            this._setColorFromHsvInputs();\n        });\n\n        this._inputS.addEventListener("input",(e)=>\n        {\n            this._setColorFromHsvInputs();\n        });\n\n        this._inputV.addEventListener("input",(e)=>\n        {\n            this._setColorFromHsvInputs();\n        });\n\n\n\n\n        this._inputHex.addEventListener("input",(e)=>\n        {\n            if(this.validateHexInput()) this.setColor(this.validateHexInput())\n        });\n\n        this._inputHex.addEventListener("blur",(e)=>\n        {\n            if(!this.validateHexInput()) \n            {\n                this._inputHex.classList.remove("colorRick_invalid");\n                this._inputHex.value=this._color.hex();\n            }\n\n        });\n\n        this._elHue.addEventListener("pointerdown",this._onHueMouse.bind(this));\n        this._elHue.addEventListener("pointermove",this._onHueMouse.bind(this));\n\n        this._elHue.addEventListener("wheel",(e)=>\n        {\n            const speed=0.2;\n            \n            if(e.deltaY>0)this._hue-=speed;\n            else this._hue+=speed;\n            this._inputH.value=this._hue;\n\n            this._setColorFromHsvInputs();\n            \n            e.preventDefault();\n        });\n\n        if(this.options.ele)\n        {\n            const r=this.options.ele.getBoundingClientRect();\n\n            const padding=30;\n            const containerSize=this._elContainer.getBoundingClientRect();\n            const leftAligned=(r.x+padding)>window.innerWidth-containerSize.width;\n\n            if(!leftAligned) this._elContainer.style.left=(r.x+padding)+"px";\n            else this._elContainer.style.left=(r.x-containerSize.width)+"px";\n            \n            if(r.y+containerSize.height>window.innerHeight) this._elContainer.style.top=(window.innerHeight-containerSize.height-10)+"px";\n            else this._elContainer.style.top=(r.y)+"px";\n        }\n\n        this._elHue.addEventListener("pointerdown",(e)=> { this._elHue.setPointerCapture(e.pointerId); });\n        this._elHue.addEventListener("pointerup",(e)=> { this._elHue.releasePointerCapture(e.pointerId); });\n\n        this._elArea.addEventListener("pointerdown",this._onAreaMouse.bind(this));\n        this._elArea.addEventListener("pointermove",this._onAreaMouse.bind(this));\n        this._elArea.addEventListener("wheel",(e)=>\n        {\n            const speed=0.001;\n            \n            if(e.deltaY>0)this._hueV-=speed;\n            else this._hueV+=speed;\n\n            this._inputV.value=this._hueV;\n\n            this.updateColorField();\n            e.preventDefault();\n        });\n        this._elArea.addEventListener("pointerdown",(e)=> { this._elArea.setPointerCapture(e.pointerId); });\n        this._elArea.addEventListener("pointerup",(e)=> { this._elArea.releasePointerCapture(e.pointerId); });\n\n        document.addEventListener("pointerdown",this._clickOutside.bind(this));\n\n        this._elColorBoxOrig.addEventListener("click",()=>{\n            this.setColor(this._elColorBoxOrig.style.backgroundColor);\n        });\n    }\n\n    _clickOutside(e)\n    {\n        if(this._elContainer.contains(e.target)) return true;\n\n        this.close();\n    }\n\n    validateHexInput()\n    {\n        let v=this._inputHex.value;\n        if(v.indexOf("#")==-1) v="#"+v;\n        const valid=v.length==7;\n\n        if(valid) \n        {\n            this._inputHex.classList.remove("colorRick_invalid");\n            return v;\n        }\n        else this._inputHex.classList.add("colorRick_invalid");\n    }\n\n    setHsvInputs(h,s,v)\n    {\n\n        if(parseFloat(h)!=parseFloat(h))\n        {\n            console.log(" NOT A NUMBER")\n            console.log(new Error().stack)\n        }\n        this._inputH.value=parseFloat(h)||0;\n        this._inputS.value=parseFloat(s)||0;\n        this._inputV.value=parseFloat(v)||0;\n    }\n\n    _setColorFromHsvInputs()\n    {\n        this._hue=this._inputH.value||0;\n        this._hueS=this._inputS.value;\n        this._hueV=this._inputV.value;\n\n        this.updateColorField();\n    }\n\n    _setColorFromRgbInputs()\n    {\n        this.setColor([parseInt(this._inputR.value),parseInt(this._inputG.value),parseInt(this._inputB.value)]);\n    }\n\n    setColor(c)\n    {\n        this._color=chroma(c);\n        this._hue=this._color.hsv()[0];\n        this._hueS=this._color.hsv()[1];\n        this._hueV=this._color.hsv()[2];\n\n        this.setHsvInputs(this._color.hsv()[0], this._inputS.value=this._color.hsv()[1], this._inputV.value=this._color.hsv()[2]);\n\n        this.updateColorField();\n    }\n\n    updateCursors()\n    {\n        if(this._color.luminance()>0.55)this._elAreaCursor.style.backgroundColor="black";\n        else this._elAreaCursor.style.backgroundColor="white";\n\n        this._elHueCursor.style.top=(this._areaHeight-(this._hue/360*this._areaHeight))+"px";\n        this._elAreaCursor.style.marginLeft=(this._color.hsv()[1]*this._areaWidth-3)+"px";\n        this._elAreaCursor.style.marginTop=(this._areaHeight-(this._color.hsv()[2]*this._areaHeight)-3)+"px";\n    }\n\n    validateHSV()\n    {\n\n    }\n\n    updateColorField()\n    {\n        if(this._hue!=this._hue)this._hue=0;\n        if(this._hue<0)this._hue=0;\n        if(this._hue>360)this._hue=360;\n\n        if(this._hueV!=this._hueV)this._hueV=0.0001;\n        if(this._hueV<0)this._hueV=0.0001;\n        if(this._hueV>1)this._hueV=1;\n\n        if(this._hueS!=this._hueS)this._hueS=0.0001;\n        if(this._hueS<0)this._hueS=0.0001;\n        if(this._hueS>1)this._hueS=1;\n\n        this._color=chroma(this._hue%360, this._hueS, this._hueV, \'hsv\');\n\n        if(this.options.onChange && this._currentHex!=this._color.hex())this.options.onChange(this._color);\n        this._currentHex=this._color.hex();\n\n        const rgb_bgcol=chroma(this._hue%360, 1,1, \'hsv\').rgb();\n        this._elArea.style.background="linear-gradient(to right, rgb(255, 255, 255), rgb("+rgb_bgcol[0]+", "+rgb_bgcol[1]+", "+rgb_bgcol[2]+"))"\n\n        this._elColorBox.style.backgroundColor=this._color.hex();\n        this._inputHex.value=this._color.hex();\n\n        this._inputR.value=this._color.rgb()[0];\n        this._inputG.value=this._color.rgb()[1];\n        this._inputB.value=this._color.rgb()[2];\n\n        this.updateCursors();\n    }\n\n    close()\n    {\n        document.removeEventListener("pointerdown",this._clickOutside.bind(this));\n\n        for(let i=0;i<this._elements.length;i++) this._elements[i].remove();\n    }\n\n    _onHueMouse(e)\n    {\n        if(e.buttons==1)\n        {\n            const y=Math.min(this._areaHeight,Math.max(0,e.offsetY));\n\n            this._hue=(1.0-(y/this._areaHeight))*360;\n\n            this.setHsvInputs(this._hue,this._hueS,this._hueV);\n\n            this.updateColorField();\n        }\n    }\n\n    _onAreaMouse(e)\n    {\n        if(e.buttons==1)\n        {\n            const x=Math.min(this._areaWidth,Math.max(0,e.offsetX));\n            const y=Math.min(this._areaHeight,Math.max(0,e.offsetY));\n            \n            this._hueV=1.0-(y/this._areaHeight);\n            this._hueS=(x/this._areaWidth);\n\n            this._inputS.value=this._hueS;\n            this._inputV.value=this._hueV;\n            this._setColorFromHsvInputs();\n            \n        }\n    }\n};\n\nmodule.exports=ColorRick;\n\n\n\n//# sourceURL=webpack://ColorRick/./index.js?')},"./node_modules/chroma-js/chroma.js":function(module){eval("/**\n * chroma.js - JavaScript library for color conversions\n *\n * Copyright (c) 2011-2019, Gregor Aisch\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n * list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n * this list of conditions and the following disclaimer in the documentation\n * and/or other materials provided with the distribution.\n *\n * 3. The name Gregor Aisch may not be used to endorse or promote products\n * derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * -------------------------------------------------------\n *\n * chroma.js includes colors from colorbrewer2.org, which are released under\n * the following license:\n *\n * Copyright (c) 2002 Cynthia Brewer, Mark Harrower,\n * and The Pennsylvania State University.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,\n * either express or implied. See the License for the specific\n * language governing permissions and limitations under the License.\n *\n * ------------------------------------------------------\n *\n * Named colors are taken from X11 Color Names.\n * http://www.w3.org/TR/css3-color/#svg-color\n *\n * @preserve\n */\n\n(function (global, factory) {\n     true ? module.exports = factory() :\n    0;\n}(this, (function () { 'use strict';\n\n    var limit = function (x, min, max) {\n        if ( min === void 0 ) min=0;\n        if ( max === void 0 ) max=1;\n\n        return x < min ? min : x > max ? max : x;\n    };\n\n    var clip_rgb = function (rgb) {\n        rgb._clipped = false;\n        rgb._unclipped = rgb.slice(0);\n        for (var i=0; i<=3; i++) {\n            if (i < 3) {\n                if (rgb[i] < 0 || rgb[i] > 255) { rgb._clipped = true; }\n                rgb[i] = limit(rgb[i], 0, 255);\n            } else if (i === 3) {\n                rgb[i] = limit(rgb[i], 0, 1);\n            }\n        }\n        return rgb;\n    };\n\n    // ported from jQuery's $.type\n    var classToType = {};\n    for (var i = 0, list = ['Boolean', 'Number', 'String', 'Function', 'Array', 'Date', 'RegExp', 'Undefined', 'Null']; i < list.length; i += 1) {\n        var name = list[i];\n\n        classToType[(\"[object \" + name + \"]\")] = name.toLowerCase();\n    }\n    var type = function(obj) {\n        return classToType[Object.prototype.toString.call(obj)] || \"object\";\n    };\n\n    var unpack = function (args, keyOrder) {\n        if ( keyOrder === void 0 ) keyOrder=null;\n\n    \t// if called with more than 3 arguments, we return the arguments\n        if (args.length >= 3) { return Array.prototype.slice.call(args); }\n        // with less than 3 args we check if first arg is object\n        // and use the keyOrder string to extract and sort properties\n    \tif (type(args[0]) == 'object' && keyOrder) {\n    \t\treturn keyOrder.split('')\n    \t\t\t.filter(function (k) { return args[0][k] !== undefined; })\n    \t\t\t.map(function (k) { return args[0][k]; });\n    \t}\n    \t// otherwise we just return the first argument\n    \t// (which we suppose is an array of args)\n        return args[0];\n    };\n\n    var last = function (args) {\n        if (args.length < 2) { return null; }\n        var l = args.length-1;\n        if (type(args[l]) == 'string') { return args[l].toLowerCase(); }\n        return null;\n    };\n\n    var PI = Math.PI;\n\n    var utils = {\n    \tclip_rgb: clip_rgb,\n    \tlimit: limit,\n    \ttype: type,\n    \tunpack: unpack,\n    \tlast: last,\n    \tPI: PI,\n    \tTWOPI: PI*2,\n    \tPITHIRD: PI/3,\n    \tDEG2RAD: PI / 180,\n    \tRAD2DEG: 180 / PI\n    };\n\n    var input = {\n    \tformat: {},\n    \tautodetect: []\n    };\n\n    var last$1 = utils.last;\n    var clip_rgb$1 = utils.clip_rgb;\n    var type$1 = utils.type;\n\n\n    var Color = function Color() {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var me = this;\n        if (type$1(args[0]) === 'object' &&\n            args[0].constructor &&\n            args[0].constructor === this.constructor) {\n            // the argument is already a Color instance\n            return args[0];\n        }\n\n        // last argument could be the mode\n        var mode = last$1(args);\n        var autodetect = false;\n\n        if (!mode) {\n            autodetect = true;\n            if (!input.sorted) {\n                input.autodetect = input.autodetect.sort(function (a,b) { return b.p - a.p; });\n                input.sorted = true;\n            }\n            // auto-detect format\n            for (var i = 0, list = input.autodetect; i < list.length; i += 1) {\n                var chk = list[i];\n\n                mode = chk.test.apply(chk, args);\n                if (mode) { break; }\n            }\n        }\n\n        if (input.format[mode]) {\n            var rgb = input.format[mode].apply(null, autodetect ? args : args.slice(0,-1));\n            me._rgb = clip_rgb$1(rgb);\n        } else {\n            throw new Error('unknown format: '+args);\n        }\n\n        // add alpha channel\n        if (me._rgb.length === 3) { me._rgb.push(1); }\n    };\n\n    Color.prototype.toString = function toString () {\n        if (type$1(this.hex) == 'function') { return this.hex(); }\n        return (\"[\" + (this._rgb.join(',')) + \"]\");\n    };\n\n    var Color_1 = Color;\n\n    var chroma = function () {\n    \tvar args = [], len = arguments.length;\n    \twhile ( len-- ) args[ len ] = arguments[ len ];\n\n    \treturn new (Function.prototype.bind.apply( chroma.Color, [ null ].concat( args) ));\n    };\n\n    chroma.Color = Color_1;\n    chroma.version = '2.1.2';\n\n    var chroma_1 = chroma;\n\n    var unpack$1 = utils.unpack;\n    var max = Math.max;\n\n    var rgb2cmyk = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$1(args, 'rgb');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        r = r / 255;\n        g = g / 255;\n        b = b / 255;\n        var k = 1 - max(r,max(g,b));\n        var f = k < 1 ? 1 / (1-k) : 0;\n        var c = (1-r-k) * f;\n        var m = (1-g-k) * f;\n        var y = (1-b-k) * f;\n        return [c,m,y,k];\n    };\n\n    var rgb2cmyk_1 = rgb2cmyk;\n\n    var unpack$2 = utils.unpack;\n\n    var cmyk2rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        args = unpack$2(args, 'cmyk');\n        var c = args[0];\n        var m = args[1];\n        var y = args[2];\n        var k = args[3];\n        var alpha = args.length > 4 ? args[4] : 1;\n        if (k === 1) { return [0,0,0,alpha]; }\n        return [\n            c >= 1 ? 0 : 255 * (1-c) * (1-k), // r\n            m >= 1 ? 0 : 255 * (1-m) * (1-k), // g\n            y >= 1 ? 0 : 255 * (1-y) * (1-k), // b\n            alpha\n        ];\n    };\n\n    var cmyk2rgb_1 = cmyk2rgb;\n\n    var unpack$3 = utils.unpack;\n    var type$2 = utils.type;\n\n\n\n    Color_1.prototype.cmyk = function() {\n        return rgb2cmyk_1(this._rgb);\n    };\n\n    chroma_1.cmyk = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['cmyk']) ));\n    };\n\n    input.format.cmyk = cmyk2rgb_1;\n\n    input.autodetect.push({\n        p: 2,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$3(args, 'cmyk');\n            if (type$2(args) === 'array' && args.length === 4) {\n                return 'cmyk';\n            }\n        }\n    });\n\n    var unpack$4 = utils.unpack;\n    var last$2 = utils.last;\n    var rnd = function (a) { return Math.round(a*100)/100; };\n\n    /*\n     * supported arguments:\n     * - hsl2css(h,s,l)\n     * - hsl2css(h,s,l,a)\n     * - hsl2css([h,s,l], mode)\n     * - hsl2css([h,s,l,a], mode)\n     * - hsl2css({h,s,l,a}, mode)\n     */\n    var hsl2css = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var hsla = unpack$4(args, 'hsla');\n        var mode = last$2(args) || 'lsa';\n        hsla[0] = rnd(hsla[0] || 0);\n        hsla[1] = rnd(hsla[1]*100) + '%';\n        hsla[2] = rnd(hsla[2]*100) + '%';\n        if (mode === 'hsla' || (hsla.length > 3 && hsla[3]<1)) {\n            hsla[3] = hsla.length > 3 ? hsla[3] : 1;\n            mode = 'hsla';\n        } else {\n            hsla.length = 3;\n        }\n        return (mode + \"(\" + (hsla.join(',')) + \")\");\n    };\n\n    var hsl2css_1 = hsl2css;\n\n    var unpack$5 = utils.unpack;\n\n    /*\n     * supported arguments:\n     * - rgb2hsl(r,g,b)\n     * - rgb2hsl(r,g,b,a)\n     * - rgb2hsl([r,g,b])\n     * - rgb2hsl([r,g,b,a])\n     * - rgb2hsl({r,g,b,a})\n     */\n    var rgb2hsl = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        args = unpack$5(args, 'rgba');\n        var r = args[0];\n        var g = args[1];\n        var b = args[2];\n\n        r /= 255;\n        g /= 255;\n        b /= 255;\n\n        var min = Math.min(r, g, b);\n        var max = Math.max(r, g, b);\n\n        var l = (max + min) / 2;\n        var s, h;\n\n        if (max === min){\n            s = 0;\n            h = Number.NaN;\n        } else {\n            s = l < 0.5 ? (max - min) / (max + min) : (max - min) / (2 - max - min);\n        }\n\n        if (r == max) { h = (g - b) / (max - min); }\n        else if (g == max) { h = 2 + (b - r) / (max - min); }\n        else if (b == max) { h = 4 + (r - g) / (max - min); }\n\n        h *= 60;\n        if (h < 0) { h += 360; }\n        if (args.length>3 && args[3]!==undefined) { return [h,s,l,args[3]]; }\n        return [h,s,l];\n    };\n\n    var rgb2hsl_1 = rgb2hsl;\n\n    var unpack$6 = utils.unpack;\n    var last$3 = utils.last;\n\n\n    var round = Math.round;\n\n    /*\n     * supported arguments:\n     * - rgb2css(r,g,b)\n     * - rgb2css(r,g,b,a)\n     * - rgb2css([r,g,b], mode)\n     * - rgb2css([r,g,b,a], mode)\n     * - rgb2css({r,g,b,a}, mode)\n     */\n    var rgb2css = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var rgba = unpack$6(args, 'rgba');\n        var mode = last$3(args) || 'rgb';\n        if (mode.substr(0,3) == 'hsl') {\n            return hsl2css_1(rgb2hsl_1(rgba), mode);\n        }\n        rgba[0] = round(rgba[0]);\n        rgba[1] = round(rgba[1]);\n        rgba[2] = round(rgba[2]);\n        if (mode === 'rgba' || (rgba.length > 3 && rgba[3]<1)) {\n            rgba[3] = rgba.length > 3 ? rgba[3] : 1;\n            mode = 'rgba';\n        }\n        return (mode + \"(\" + (rgba.slice(0,mode==='rgb'?3:4).join(',')) + \")\");\n    };\n\n    var rgb2css_1 = rgb2css;\n\n    var unpack$7 = utils.unpack;\n    var round$1 = Math.round;\n\n    var hsl2rgb = function () {\n        var assign;\n\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n        args = unpack$7(args, 'hsl');\n        var h = args[0];\n        var s = args[1];\n        var l = args[2];\n        var r,g,b;\n        if (s === 0) {\n            r = g = b = l*255;\n        } else {\n            var t3 = [0,0,0];\n            var c = [0,0,0];\n            var t2 = l < 0.5 ? l * (1+s) : l+s-l*s;\n            var t1 = 2 * l - t2;\n            var h_ = h / 360;\n            t3[0] = h_ + 1/3;\n            t3[1] = h_;\n            t3[2] = h_ - 1/3;\n            for (var i=0; i<3; i++) {\n                if (t3[i] < 0) { t3[i] += 1; }\n                if (t3[i] > 1) { t3[i] -= 1; }\n                if (6 * t3[i] < 1)\n                    { c[i] = t1 + (t2 - t1) * 6 * t3[i]; }\n                else if (2 * t3[i] < 1)\n                    { c[i] = t2; }\n                else if (3 * t3[i] < 2)\n                    { c[i] = t1 + (t2 - t1) * ((2 / 3) - t3[i]) * 6; }\n                else\n                    { c[i] = t1; }\n            }\n            (assign = [round$1(c[0]*255),round$1(c[1]*255),round$1(c[2]*255)], r = assign[0], g = assign[1], b = assign[2]);\n        }\n        if (args.length > 3) {\n            // keep alpha channel\n            return [r,g,b,args[3]];\n        }\n        return [r,g,b,1];\n    };\n\n    var hsl2rgb_1 = hsl2rgb;\n\n    var RE_RGB = /^rgb\\(\\s*(-?\\d+),\\s*(-?\\d+)\\s*,\\s*(-?\\d+)\\s*\\)$/;\n    var RE_RGBA = /^rgba\\(\\s*(-?\\d+),\\s*(-?\\d+)\\s*,\\s*(-?\\d+)\\s*,\\s*([01]|[01]?\\.\\d+)\\)$/;\n    var RE_RGB_PCT = /^rgb\\(\\s*(-?\\d+(?:\\.\\d+)?)%,\\s*(-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(-?\\d+(?:\\.\\d+)?)%\\s*\\)$/;\n    var RE_RGBA_PCT = /^rgba\\(\\s*(-?\\d+(?:\\.\\d+)?)%,\\s*(-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(-?\\d+(?:\\.\\d+)?)%\\s*,\\s*([01]|[01]?\\.\\d+)\\)$/;\n    var RE_HSL = /^hsl\\(\\s*(-?\\d+(?:\\.\\d+)?),\\s*(-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(-?\\d+(?:\\.\\d+)?)%\\s*\\)$/;\n    var RE_HSLA = /^hsla\\(\\s*(-?\\d+(?:\\.\\d+)?),\\s*(-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(-?\\d+(?:\\.\\d+)?)%\\s*,\\s*([01]|[01]?\\.\\d+)\\)$/;\n\n    var round$2 = Math.round;\n\n    var css2rgb = function (css) {\n        css = css.toLowerCase().trim();\n        var m;\n\n        if (input.format.named) {\n            try {\n                return input.format.named(css);\n            } catch (e) {\n                // eslint-disable-next-line\n            }\n        }\n\n        // rgb(250,20,0)\n        if ((m = css.match(RE_RGB))) {\n            var rgb = m.slice(1,4);\n            for (var i=0; i<3; i++) {\n                rgb[i] = +rgb[i];\n            }\n            rgb[3] = 1;  // default alpha\n            return rgb;\n        }\n\n        // rgba(250,20,0,0.4)\n        if ((m = css.match(RE_RGBA))) {\n            var rgb$1 = m.slice(1,5);\n            for (var i$1=0; i$1<4; i$1++) {\n                rgb$1[i$1] = +rgb$1[i$1];\n            }\n            return rgb$1;\n        }\n\n        // rgb(100%,0%,0%)\n        if ((m = css.match(RE_RGB_PCT))) {\n            var rgb$2 = m.slice(1,4);\n            for (var i$2=0; i$2<3; i$2++) {\n                rgb$2[i$2] = round$2(rgb$2[i$2] * 2.55);\n            }\n            rgb$2[3] = 1;  // default alpha\n            return rgb$2;\n        }\n\n        // rgba(100%,0%,0%,0.4)\n        if ((m = css.match(RE_RGBA_PCT))) {\n            var rgb$3 = m.slice(1,5);\n            for (var i$3=0; i$3<3; i$3++) {\n                rgb$3[i$3] = round$2(rgb$3[i$3] * 2.55);\n            }\n            rgb$3[3] = +rgb$3[3];\n            return rgb$3;\n        }\n\n        // hsl(0,100%,50%)\n        if ((m = css.match(RE_HSL))) {\n            var hsl = m.slice(1,4);\n            hsl[1] *= 0.01;\n            hsl[2] *= 0.01;\n            var rgb$4 = hsl2rgb_1(hsl);\n            rgb$4[3] = 1;\n            return rgb$4;\n        }\n\n        // hsla(0,100%,50%,0.5)\n        if ((m = css.match(RE_HSLA))) {\n            var hsl$1 = m.slice(1,4);\n            hsl$1[1] *= 0.01;\n            hsl$1[2] *= 0.01;\n            var rgb$5 = hsl2rgb_1(hsl$1);\n            rgb$5[3] = +m[4];  // default alpha = 1\n            return rgb$5;\n        }\n    };\n\n    css2rgb.test = function (s) {\n        return RE_RGB.test(s) ||\n            RE_RGBA.test(s) ||\n            RE_RGB_PCT.test(s) ||\n            RE_RGBA_PCT.test(s) ||\n            RE_HSL.test(s) ||\n            RE_HSLA.test(s);\n    };\n\n    var css2rgb_1 = css2rgb;\n\n    var type$3 = utils.type;\n\n\n\n\n    Color_1.prototype.css = function(mode) {\n        return rgb2css_1(this._rgb, mode);\n    };\n\n    chroma_1.css = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['css']) ));\n    };\n\n    input.format.css = css2rgb_1;\n\n    input.autodetect.push({\n        p: 5,\n        test: function (h) {\n            var rest = [], len = arguments.length - 1;\n            while ( len-- > 0 ) rest[ len ] = arguments[ len + 1 ];\n\n            if (!rest.length && type$3(h) === 'string' && css2rgb_1.test(h)) {\n                return 'css';\n            }\n        }\n    });\n\n    var unpack$8 = utils.unpack;\n\n    input.format.gl = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var rgb = unpack$8(args, 'rgba');\n        rgb[0] *= 255;\n        rgb[1] *= 255;\n        rgb[2] *= 255;\n        return rgb;\n    };\n\n    chroma_1.gl = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['gl']) ));\n    };\n\n    Color_1.prototype.gl = function() {\n        var rgb = this._rgb;\n        return [rgb[0]/255, rgb[1]/255, rgb[2]/255, rgb[3]];\n    };\n\n    var unpack$9 = utils.unpack;\n\n    var rgb2hcg = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$9(args, 'rgb');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        var min = Math.min(r, g, b);\n        var max = Math.max(r, g, b);\n        var delta = max - min;\n        var c = delta * 100 / 255;\n        var _g = min / (255 - delta) * 100;\n        var h;\n        if (delta === 0) {\n            h = Number.NaN;\n        } else {\n            if (r === max) { h = (g - b) / delta; }\n            if (g === max) { h = 2+(b - r) / delta; }\n            if (b === max) { h = 4+(r - g) / delta; }\n            h *= 60;\n            if (h < 0) { h += 360; }\n        }\n        return [h, c, _g];\n    };\n\n    var rgb2hcg_1 = rgb2hcg;\n\n    var unpack$a = utils.unpack;\n    var floor = Math.floor;\n\n    /*\n     * this is basically just HSV with some minor tweaks\n     *\n     * hue.. [0..360]\n     * chroma .. [0..1]\n     * grayness .. [0..1]\n     */\n\n    var hcg2rgb = function () {\n        var assign, assign$1, assign$2, assign$3, assign$4, assign$5;\n\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n        args = unpack$a(args, 'hcg');\n        var h = args[0];\n        var c = args[1];\n        var _g = args[2];\n        var r,g,b;\n        _g = _g * 255;\n        var _c = c * 255;\n        if (c === 0) {\n            r = g = b = _g;\n        } else {\n            if (h === 360) { h = 0; }\n            if (h > 360) { h -= 360; }\n            if (h < 0) { h += 360; }\n            h /= 60;\n            var i = floor(h);\n            var f = h - i;\n            var p = _g * (1 - c);\n            var q = p + _c * (1 - f);\n            var t = p + _c * f;\n            var v = p + _c;\n            switch (i) {\n                case 0: (assign = [v, t, p], r = assign[0], g = assign[1], b = assign[2]); break\n                case 1: (assign$1 = [q, v, p], r = assign$1[0], g = assign$1[1], b = assign$1[2]); break\n                case 2: (assign$2 = [p, v, t], r = assign$2[0], g = assign$2[1], b = assign$2[2]); break\n                case 3: (assign$3 = [p, q, v], r = assign$3[0], g = assign$3[1], b = assign$3[2]); break\n                case 4: (assign$4 = [t, p, v], r = assign$4[0], g = assign$4[1], b = assign$4[2]); break\n                case 5: (assign$5 = [v, p, q], r = assign$5[0], g = assign$5[1], b = assign$5[2]); break\n            }\n        }\n        return [r, g, b, args.length > 3 ? args[3] : 1];\n    };\n\n    var hcg2rgb_1 = hcg2rgb;\n\n    var unpack$b = utils.unpack;\n    var type$4 = utils.type;\n\n\n\n\n\n\n    Color_1.prototype.hcg = function() {\n        return rgb2hcg_1(this._rgb);\n    };\n\n    chroma_1.hcg = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['hcg']) ));\n    };\n\n    input.format.hcg = hcg2rgb_1;\n\n    input.autodetect.push({\n        p: 1,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$b(args, 'hcg');\n            if (type$4(args) === 'array' && args.length === 3) {\n                return 'hcg';\n            }\n        }\n    });\n\n    var unpack$c = utils.unpack;\n    var last$4 = utils.last;\n    var round$3 = Math.round;\n\n    var rgb2hex = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$c(args, 'rgba');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        var a = ref[3];\n        var mode = last$4(args) || 'auto';\n        if (a === undefined) { a = 1; }\n        if (mode === 'auto') {\n            mode = a < 1 ? 'rgba' : 'rgb';\n        }\n        r = round$3(r);\n        g = round$3(g);\n        b = round$3(b);\n        var u = r << 16 | g << 8 | b;\n        var str = \"000000\" + u.toString(16); //#.toUpperCase();\n        str = str.substr(str.length - 6);\n        var hxa = '0' + round$3(a * 255).toString(16);\n        hxa = hxa.substr(hxa.length - 2);\n        switch (mode.toLowerCase()) {\n            case 'rgba': return (\"#\" + str + hxa);\n            case 'argb': return (\"#\" + hxa + str);\n            default: return (\"#\" + str);\n        }\n    };\n\n    var rgb2hex_1 = rgb2hex;\n\n    var RE_HEX = /^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/;\n    var RE_HEXA = /^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/;\n\n    var hex2rgb = function (hex) {\n        if (hex.match(RE_HEX)) {\n            // remove optional leading #\n            if (hex.length === 4 || hex.length === 7) {\n                hex = hex.substr(1);\n            }\n            // expand short-notation to full six-digit\n            if (hex.length === 3) {\n                hex = hex.split('');\n                hex = hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2];\n            }\n            var u = parseInt(hex, 16);\n            var r = u >> 16;\n            var g = u >> 8 & 0xFF;\n            var b = u & 0xFF;\n            return [r,g,b,1];\n        }\n\n        // match rgba hex format, eg #FF000077\n        if (hex.match(RE_HEXA)) {\n            if (hex.length === 5 || hex.length === 9) {\n                // remove optional leading #\n                hex = hex.substr(1);\n            }\n            // expand short-notation to full eight-digit\n            if (hex.length === 4) {\n                hex = hex.split('');\n                hex = hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]+hex[3]+hex[3];\n            }\n            var u$1 = parseInt(hex, 16);\n            var r$1 = u$1 >> 24 & 0xFF;\n            var g$1 = u$1 >> 16 & 0xFF;\n            var b$1 = u$1 >> 8 & 0xFF;\n            var a = Math.round((u$1 & 0xFF) / 0xFF * 100) / 100;\n            return [r$1,g$1,b$1,a];\n        }\n\n        // we used to check for css colors here\n        // if _input.css? and rgb = _input.css hex\n        //     return rgb\n\n        throw new Error((\"unknown hex color: \" + hex));\n    };\n\n    var hex2rgb_1 = hex2rgb;\n\n    var type$5 = utils.type;\n\n\n\n\n    Color_1.prototype.hex = function(mode) {\n        return rgb2hex_1(this._rgb, mode);\n    };\n\n    chroma_1.hex = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['hex']) ));\n    };\n\n    input.format.hex = hex2rgb_1;\n    input.autodetect.push({\n        p: 4,\n        test: function (h) {\n            var rest = [], len = arguments.length - 1;\n            while ( len-- > 0 ) rest[ len ] = arguments[ len + 1 ];\n\n            if (!rest.length && type$5(h) === 'string' && [3,4,5,6,7,8,9].indexOf(h.length) >= 0) {\n                return 'hex';\n            }\n        }\n    });\n\n    var unpack$d = utils.unpack;\n    var TWOPI = utils.TWOPI;\n    var min = Math.min;\n    var sqrt = Math.sqrt;\n    var acos = Math.acos;\n\n    var rgb2hsi = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        /*\n        borrowed from here:\n        http://hummer.stanford.edu/museinfo/doc/examples/humdrum/keyscape2/rgb2hsi.cpp\n        */\n        var ref = unpack$d(args, 'rgb');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        r /= 255;\n        g /= 255;\n        b /= 255;\n        var h;\n        var min_ = min(r,g,b);\n        var i = (r+g+b) / 3;\n        var s = i > 0 ? 1 - min_/i : 0;\n        if (s === 0) {\n            h = NaN;\n        } else {\n            h = ((r-g)+(r-b)) / 2;\n            h /= sqrt((r-g)*(r-g) + (r-b)*(g-b));\n            h = acos(h);\n            if (b > g) {\n                h = TWOPI - h;\n            }\n            h /= TWOPI;\n        }\n        return [h*360,s,i];\n    };\n\n    var rgb2hsi_1 = rgb2hsi;\n\n    var unpack$e = utils.unpack;\n    var limit$1 = utils.limit;\n    var TWOPI$1 = utils.TWOPI;\n    var PITHIRD = utils.PITHIRD;\n    var cos = Math.cos;\n\n    /*\n     * hue [0..360]\n     * saturation [0..1]\n     * intensity [0..1]\n     */\n    var hsi2rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        /*\n        borrowed from here:\n        http://hummer.stanford.edu/museinfo/doc/examples/humdrum/keyscape2/hsi2rgb.cpp\n        */\n        args = unpack$e(args, 'hsi');\n        var h = args[0];\n        var s = args[1];\n        var i = args[2];\n        var r,g,b;\n\n        if (isNaN(h)) { h = 0; }\n        if (isNaN(s)) { s = 0; }\n        // normalize hue\n        if (h > 360) { h -= 360; }\n        if (h < 0) { h += 360; }\n        h /= 360;\n        if (h < 1/3) {\n            b = (1-s)/3;\n            r = (1+s*cos(TWOPI$1*h)/cos(PITHIRD-TWOPI$1*h))/3;\n            g = 1 - (b+r);\n        } else if (h < 2/3) {\n            h -= 1/3;\n            r = (1-s)/3;\n            g = (1+s*cos(TWOPI$1*h)/cos(PITHIRD-TWOPI$1*h))/3;\n            b = 1 - (r+g);\n        } else {\n            h -= 2/3;\n            g = (1-s)/3;\n            b = (1+s*cos(TWOPI$1*h)/cos(PITHIRD-TWOPI$1*h))/3;\n            r = 1 - (g+b);\n        }\n        r = limit$1(i*r*3);\n        g = limit$1(i*g*3);\n        b = limit$1(i*b*3);\n        return [r*255, g*255, b*255, args.length > 3 ? args[3] : 1];\n    };\n\n    var hsi2rgb_1 = hsi2rgb;\n\n    var unpack$f = utils.unpack;\n    var type$6 = utils.type;\n\n\n\n\n\n\n    Color_1.prototype.hsi = function() {\n        return rgb2hsi_1(this._rgb);\n    };\n\n    chroma_1.hsi = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['hsi']) ));\n    };\n\n    input.format.hsi = hsi2rgb_1;\n\n    input.autodetect.push({\n        p: 2,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$f(args, 'hsi');\n            if (type$6(args) === 'array' && args.length === 3) {\n                return 'hsi';\n            }\n        }\n    });\n\n    var unpack$g = utils.unpack;\n    var type$7 = utils.type;\n\n\n\n\n\n\n    Color_1.prototype.hsl = function() {\n        return rgb2hsl_1(this._rgb);\n    };\n\n    chroma_1.hsl = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['hsl']) ));\n    };\n\n    input.format.hsl = hsl2rgb_1;\n\n    input.autodetect.push({\n        p: 2,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$g(args, 'hsl');\n            if (type$7(args) === 'array' && args.length === 3) {\n                return 'hsl';\n            }\n        }\n    });\n\n    var unpack$h = utils.unpack;\n    var min$1 = Math.min;\n    var max$1 = Math.max;\n\n    /*\n     * supported arguments:\n     * - rgb2hsv(r,g,b)\n     * - rgb2hsv([r,g,b])\n     * - rgb2hsv({r,g,b})\n     */\n    var rgb2hsl$1 = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        args = unpack$h(args, 'rgb');\n        var r = args[0];\n        var g = args[1];\n        var b = args[2];\n        var min_ = min$1(r, g, b);\n        var max_ = max$1(r, g, b);\n        var delta = max_ - min_;\n        var h,s,v;\n        v = max_ / 255.0;\n        if (max_ === 0) {\n            h = Number.NaN;\n            s = 0;\n        } else {\n            s = delta / max_;\n            if (r === max_) { h = (g - b) / delta; }\n            if (g === max_) { h = 2+(b - r) / delta; }\n            if (b === max_) { h = 4+(r - g) / delta; }\n            h *= 60;\n            if (h < 0) { h += 360; }\n        }\n        return [h, s, v]\n    };\n\n    var rgb2hsv = rgb2hsl$1;\n\n    var unpack$i = utils.unpack;\n    var floor$1 = Math.floor;\n\n    var hsv2rgb = function () {\n        var assign, assign$1, assign$2, assign$3, assign$4, assign$5;\n\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n        args = unpack$i(args, 'hsv');\n        var h = args[0];\n        var s = args[1];\n        var v = args[2];\n        var r,g,b;\n        v *= 255;\n        if (s === 0) {\n            r = g = b = v;\n        } else {\n            if (h === 360) { h = 0; }\n            if (h > 360) { h -= 360; }\n            if (h < 0) { h += 360; }\n            h /= 60;\n\n            var i = floor$1(h);\n            var f = h - i;\n            var p = v * (1 - s);\n            var q = v * (1 - s * f);\n            var t = v * (1 - s * (1 - f));\n\n            switch (i) {\n                case 0: (assign = [v, t, p], r = assign[0], g = assign[1], b = assign[2]); break\n                case 1: (assign$1 = [q, v, p], r = assign$1[0], g = assign$1[1], b = assign$1[2]); break\n                case 2: (assign$2 = [p, v, t], r = assign$2[0], g = assign$2[1], b = assign$2[2]); break\n                case 3: (assign$3 = [p, q, v], r = assign$3[0], g = assign$3[1], b = assign$3[2]); break\n                case 4: (assign$4 = [t, p, v], r = assign$4[0], g = assign$4[1], b = assign$4[2]); break\n                case 5: (assign$5 = [v, p, q], r = assign$5[0], g = assign$5[1], b = assign$5[2]); break\n            }\n        }\n        return [r,g,b,args.length > 3?args[3]:1];\n    };\n\n    var hsv2rgb_1 = hsv2rgb;\n\n    var unpack$j = utils.unpack;\n    var type$8 = utils.type;\n\n\n\n\n\n\n    Color_1.prototype.hsv = function() {\n        return rgb2hsv(this._rgb);\n    };\n\n    chroma_1.hsv = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['hsv']) ));\n    };\n\n    input.format.hsv = hsv2rgb_1;\n\n    input.autodetect.push({\n        p: 2,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$j(args, 'hsv');\n            if (type$8(args) === 'array' && args.length === 3) {\n                return 'hsv';\n            }\n        }\n    });\n\n    var labConstants = {\n        // Corresponds roughly to RGB brighter/darker\n        Kn: 18,\n\n        // D65 standard referent\n        Xn: 0.950470,\n        Yn: 1,\n        Zn: 1.088830,\n\n        t0: 0.137931034,  // 4 / 29\n        t1: 0.206896552,  // 6 / 29\n        t2: 0.12841855,   // 3 * t1 * t1\n        t3: 0.008856452,  // t1 * t1 * t1\n    };\n\n    var unpack$k = utils.unpack;\n    var pow = Math.pow;\n\n    var rgb2lab = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$k(args, 'rgb');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        var ref$1 = rgb2xyz(r,g,b);\n        var x = ref$1[0];\n        var y = ref$1[1];\n        var z = ref$1[2];\n        var l = 116 * y - 16;\n        return [l < 0 ? 0 : l, 500 * (x - y), 200 * (y - z)];\n    };\n\n    var rgb_xyz = function (r) {\n        if ((r /= 255) <= 0.04045) { return r / 12.92; }\n        return pow((r + 0.055) / 1.055, 2.4);\n    };\n\n    var xyz_lab = function (t) {\n        if (t > labConstants.t3) { return pow(t, 1 / 3); }\n        return t / labConstants.t2 + labConstants.t0;\n    };\n\n    var rgb2xyz = function (r,g,b) {\n        r = rgb_xyz(r);\n        g = rgb_xyz(g);\n        b = rgb_xyz(b);\n        var x = xyz_lab((0.4124564 * r + 0.3575761 * g + 0.1804375 * b) / labConstants.Xn);\n        var y = xyz_lab((0.2126729 * r + 0.7151522 * g + 0.0721750 * b) / labConstants.Yn);\n        var z = xyz_lab((0.0193339 * r + 0.1191920 * g + 0.9503041 * b) / labConstants.Zn);\n        return [x,y,z];\n    };\n\n    var rgb2lab_1 = rgb2lab;\n\n    var unpack$l = utils.unpack;\n    var pow$1 = Math.pow;\n\n    /*\n     * L* [0..100]\n     * a [-100..100]\n     * b [-100..100]\n     */\n    var lab2rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        args = unpack$l(args, 'lab');\n        var l = args[0];\n        var a = args[1];\n        var b = args[2];\n        var x,y,z, r,g,b_;\n\n        y = (l + 16) / 116;\n        x = isNaN(a) ? y : y + a / 500;\n        z = isNaN(b) ? y : y - b / 200;\n\n        y = labConstants.Yn * lab_xyz(y);\n        x = labConstants.Xn * lab_xyz(x);\n        z = labConstants.Zn * lab_xyz(z);\n\n        r = xyz_rgb(3.2404542 * x - 1.5371385 * y - 0.4985314 * z);  // D65 -> sRGB\n        g = xyz_rgb(-0.9692660 * x + 1.8760108 * y + 0.0415560 * z);\n        b_ = xyz_rgb(0.0556434 * x - 0.2040259 * y + 1.0572252 * z);\n\n        return [r,g,b_,args.length > 3 ? args[3] : 1];\n    };\n\n    var xyz_rgb = function (r) {\n        return 255 * (r <= 0.00304 ? 12.92 * r : 1.055 * pow$1(r, 1 / 2.4) - 0.055)\n    };\n\n    var lab_xyz = function (t) {\n        return t > labConstants.t1 ? t * t * t : labConstants.t2 * (t - labConstants.t0)\n    };\n\n    var lab2rgb_1 = lab2rgb;\n\n    var unpack$m = utils.unpack;\n    var type$9 = utils.type;\n\n\n\n\n\n\n    Color_1.prototype.lab = function() {\n        return rgb2lab_1(this._rgb);\n    };\n\n    chroma_1.lab = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['lab']) ));\n    };\n\n    input.format.lab = lab2rgb_1;\n\n    input.autodetect.push({\n        p: 2,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$m(args, 'lab');\n            if (type$9(args) === 'array' && args.length === 3) {\n                return 'lab';\n            }\n        }\n    });\n\n    var unpack$n = utils.unpack;\n    var RAD2DEG = utils.RAD2DEG;\n    var sqrt$1 = Math.sqrt;\n    var atan2 = Math.atan2;\n    var round$4 = Math.round;\n\n    var lab2lch = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$n(args, 'lab');\n        var l = ref[0];\n        var a = ref[1];\n        var b = ref[2];\n        var c = sqrt$1(a * a + b * b);\n        var h = (atan2(b, a) * RAD2DEG + 360) % 360;\n        if (round$4(c*10000) === 0) { h = Number.NaN; }\n        return [l, c, h];\n    };\n\n    var lab2lch_1 = lab2lch;\n\n    var unpack$o = utils.unpack;\n\n\n\n    var rgb2lch = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$o(args, 'rgb');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        var ref$1 = rgb2lab_1(r,g,b);\n        var l = ref$1[0];\n        var a = ref$1[1];\n        var b_ = ref$1[2];\n        return lab2lch_1(l,a,b_);\n    };\n\n    var rgb2lch_1 = rgb2lch;\n\n    var unpack$p = utils.unpack;\n    var DEG2RAD = utils.DEG2RAD;\n    var sin = Math.sin;\n    var cos$1 = Math.cos;\n\n    var lch2lab = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        /*\n        Convert from a qualitative parameter h and a quantitative parameter l to a 24-bit pixel.\n        These formulas were invented by David Dalrymple to obtain maximum contrast without going\n        out of gamut if the parameters are in the range 0-1.\n\n        A saturation multiplier was added by Gregor Aisch\n        */\n        var ref = unpack$p(args, 'lch');\n        var l = ref[0];\n        var c = ref[1];\n        var h = ref[2];\n        if (isNaN(h)) { h = 0; }\n        h = h * DEG2RAD;\n        return [l, cos$1(h) * c, sin(h) * c]\n    };\n\n    var lch2lab_1 = lch2lab;\n\n    var unpack$q = utils.unpack;\n\n\n\n    var lch2rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        args = unpack$q(args, 'lch');\n        var l = args[0];\n        var c = args[1];\n        var h = args[2];\n        var ref = lch2lab_1 (l,c,h);\n        var L = ref[0];\n        var a = ref[1];\n        var b_ = ref[2];\n        var ref$1 = lab2rgb_1 (L,a,b_);\n        var r = ref$1[0];\n        var g = ref$1[1];\n        var b = ref$1[2];\n        return [r, g, b, args.length > 3 ? args[3] : 1];\n    };\n\n    var lch2rgb_1 = lch2rgb;\n\n    var unpack$r = utils.unpack;\n\n\n    var hcl2rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var hcl = unpack$r(args, 'hcl').reverse();\n        return lch2rgb_1.apply(void 0, hcl);\n    };\n\n    var hcl2rgb_1 = hcl2rgb;\n\n    var unpack$s = utils.unpack;\n    var type$a = utils.type;\n\n\n\n\n\n\n    Color_1.prototype.lch = function() { return rgb2lch_1(this._rgb); };\n    Color_1.prototype.hcl = function() { return rgb2lch_1(this._rgb).reverse(); };\n\n    chroma_1.lch = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['lch']) ));\n    };\n    chroma_1.hcl = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['hcl']) ));\n    };\n\n    input.format.lch = lch2rgb_1;\n    input.format.hcl = hcl2rgb_1;\n\n    ['lch','hcl'].forEach(function (m) { return input.autodetect.push({\n        p: 2,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$s(args, m);\n            if (type$a(args) === 'array' && args.length === 3) {\n                return m;\n            }\n        }\n    }); });\n\n    /**\n    \tX11 color names\n\n    \thttp://www.w3.org/TR/css3-color/#svg-color\n    */\n\n    var w3cx11 = {\n        aliceblue: '#f0f8ff',\n        antiquewhite: '#faebd7',\n        aqua: '#00ffff',\n        aquamarine: '#7fffd4',\n        azure: '#f0ffff',\n        beige: '#f5f5dc',\n        bisque: '#ffe4c4',\n        black: '#000000',\n        blanchedalmond: '#ffebcd',\n        blue: '#0000ff',\n        blueviolet: '#8a2be2',\n        brown: '#a52a2a',\n        burlywood: '#deb887',\n        cadetblue: '#5f9ea0',\n        chartreuse: '#7fff00',\n        chocolate: '#d2691e',\n        coral: '#ff7f50',\n        cornflower: '#6495ed',\n        cornflowerblue: '#6495ed',\n        cornsilk: '#fff8dc',\n        crimson: '#dc143c',\n        cyan: '#00ffff',\n        darkblue: '#00008b',\n        darkcyan: '#008b8b',\n        darkgoldenrod: '#b8860b',\n        darkgray: '#a9a9a9',\n        darkgreen: '#006400',\n        darkgrey: '#a9a9a9',\n        darkkhaki: '#bdb76b',\n        darkmagenta: '#8b008b',\n        darkolivegreen: '#556b2f',\n        darkorange: '#ff8c00',\n        darkorchid: '#9932cc',\n        darkred: '#8b0000',\n        darksalmon: '#e9967a',\n        darkseagreen: '#8fbc8f',\n        darkslateblue: '#483d8b',\n        darkslategray: '#2f4f4f',\n        darkslategrey: '#2f4f4f',\n        darkturquoise: '#00ced1',\n        darkviolet: '#9400d3',\n        deeppink: '#ff1493',\n        deepskyblue: '#00bfff',\n        dimgray: '#696969',\n        dimgrey: '#696969',\n        dodgerblue: '#1e90ff',\n        firebrick: '#b22222',\n        floralwhite: '#fffaf0',\n        forestgreen: '#228b22',\n        fuchsia: '#ff00ff',\n        gainsboro: '#dcdcdc',\n        ghostwhite: '#f8f8ff',\n        gold: '#ffd700',\n        goldenrod: '#daa520',\n        gray: '#808080',\n        green: '#008000',\n        greenyellow: '#adff2f',\n        grey: '#808080',\n        honeydew: '#f0fff0',\n        hotpink: '#ff69b4',\n        indianred: '#cd5c5c',\n        indigo: '#4b0082',\n        ivory: '#fffff0',\n        khaki: '#f0e68c',\n        laserlemon: '#ffff54',\n        lavender: '#e6e6fa',\n        lavenderblush: '#fff0f5',\n        lawngreen: '#7cfc00',\n        lemonchiffon: '#fffacd',\n        lightblue: '#add8e6',\n        lightcoral: '#f08080',\n        lightcyan: '#e0ffff',\n        lightgoldenrod: '#fafad2',\n        lightgoldenrodyellow: '#fafad2',\n        lightgray: '#d3d3d3',\n        lightgreen: '#90ee90',\n        lightgrey: '#d3d3d3',\n        lightpink: '#ffb6c1',\n        lightsalmon: '#ffa07a',\n        lightseagreen: '#20b2aa',\n        lightskyblue: '#87cefa',\n        lightslategray: '#778899',\n        lightslategrey: '#778899',\n        lightsteelblue: '#b0c4de',\n        lightyellow: '#ffffe0',\n        lime: '#00ff00',\n        limegreen: '#32cd32',\n        linen: '#faf0e6',\n        magenta: '#ff00ff',\n        maroon: '#800000',\n        maroon2: '#7f0000',\n        maroon3: '#b03060',\n        mediumaquamarine: '#66cdaa',\n        mediumblue: '#0000cd',\n        mediumorchid: '#ba55d3',\n        mediumpurple: '#9370db',\n        mediumseagreen: '#3cb371',\n        mediumslateblue: '#7b68ee',\n        mediumspringgreen: '#00fa9a',\n        mediumturquoise: '#48d1cc',\n        mediumvioletred: '#c71585',\n        midnightblue: '#191970',\n        mintcream: '#f5fffa',\n        mistyrose: '#ffe4e1',\n        moccasin: '#ffe4b5',\n        navajowhite: '#ffdead',\n        navy: '#000080',\n        oldlace: '#fdf5e6',\n        olive: '#808000',\n        olivedrab: '#6b8e23',\n        orange: '#ffa500',\n        orangered: '#ff4500',\n        orchid: '#da70d6',\n        palegoldenrod: '#eee8aa',\n        palegreen: '#98fb98',\n        paleturquoise: '#afeeee',\n        palevioletred: '#db7093',\n        papayawhip: '#ffefd5',\n        peachpuff: '#ffdab9',\n        peru: '#cd853f',\n        pink: '#ffc0cb',\n        plum: '#dda0dd',\n        powderblue: '#b0e0e6',\n        purple: '#800080',\n        purple2: '#7f007f',\n        purple3: '#a020f0',\n        rebeccapurple: '#663399',\n        red: '#ff0000',\n        rosybrown: '#bc8f8f',\n        royalblue: '#4169e1',\n        saddlebrown: '#8b4513',\n        salmon: '#fa8072',\n        sandybrown: '#f4a460',\n        seagreen: '#2e8b57',\n        seashell: '#fff5ee',\n        sienna: '#a0522d',\n        silver: '#c0c0c0',\n        skyblue: '#87ceeb',\n        slateblue: '#6a5acd',\n        slategray: '#708090',\n        slategrey: '#708090',\n        snow: '#fffafa',\n        springgreen: '#00ff7f',\n        steelblue: '#4682b4',\n        tan: '#d2b48c',\n        teal: '#008080',\n        thistle: '#d8bfd8',\n        tomato: '#ff6347',\n        turquoise: '#40e0d0',\n        violet: '#ee82ee',\n        wheat: '#f5deb3',\n        white: '#ffffff',\n        whitesmoke: '#f5f5f5',\n        yellow: '#ffff00',\n        yellowgreen: '#9acd32'\n    };\n\n    var w3cx11_1 = w3cx11;\n\n    var type$b = utils.type;\n\n\n\n\n\n    Color_1.prototype.name = function() {\n        var hex = rgb2hex_1(this._rgb, 'rgb');\n        for (var i = 0, list = Object.keys(w3cx11_1); i < list.length; i += 1) {\n            var n = list[i];\n\n            if (w3cx11_1[n] === hex) { return n.toLowerCase(); }\n        }\n        return hex;\n    };\n\n    input.format.named = function (name) {\n        name = name.toLowerCase();\n        if (w3cx11_1[name]) { return hex2rgb_1(w3cx11_1[name]); }\n        throw new Error('unknown color name: '+name);\n    };\n\n    input.autodetect.push({\n        p: 5,\n        test: function (h) {\n            var rest = [], len = arguments.length - 1;\n            while ( len-- > 0 ) rest[ len ] = arguments[ len + 1 ];\n\n            if (!rest.length && type$b(h) === 'string' && w3cx11_1[h.toLowerCase()]) {\n                return 'named';\n            }\n        }\n    });\n\n    var unpack$t = utils.unpack;\n\n    var rgb2num = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$t(args, 'rgb');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        return (r << 16) + (g << 8) + b;\n    };\n\n    var rgb2num_1 = rgb2num;\n\n    var type$c = utils.type;\n\n    var num2rgb = function (num) {\n        if (type$c(num) == \"number\" && num >= 0 && num <= 0xFFFFFF) {\n            var r = num >> 16;\n            var g = (num >> 8) & 0xFF;\n            var b = num & 0xFF;\n            return [r,g,b,1];\n        }\n        throw new Error(\"unknown num color: \"+num);\n    };\n\n    var num2rgb_1 = num2rgb;\n\n    var type$d = utils.type;\n\n\n\n    Color_1.prototype.num = function() {\n        return rgb2num_1(this._rgb);\n    };\n\n    chroma_1.num = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['num']) ));\n    };\n\n    input.format.num = num2rgb_1;\n\n    input.autodetect.push({\n        p: 5,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            if (args.length === 1 && type$d(args[0]) === 'number' && args[0] >= 0 && args[0] <= 0xFFFFFF) {\n                return 'num';\n            }\n        }\n    });\n\n    var unpack$u = utils.unpack;\n    var type$e = utils.type;\n    var round$5 = Math.round;\n\n    Color_1.prototype.rgb = function(rnd) {\n        if ( rnd === void 0 ) rnd=true;\n\n        if (rnd === false) { return this._rgb.slice(0,3); }\n        return this._rgb.slice(0,3).map(round$5);\n    };\n\n    Color_1.prototype.rgba = function(rnd) {\n        if ( rnd === void 0 ) rnd=true;\n\n        return this._rgb.slice(0,4).map(function (v,i) {\n            return i<3 ? (rnd === false ? v : round$5(v)) : v;\n        });\n    };\n\n    chroma_1.rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['rgb']) ));\n    };\n\n    input.format.rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var rgba = unpack$u(args, 'rgba');\n        if (rgba[3] === undefined) { rgba[3] = 1; }\n        return rgba;\n    };\n\n    input.autodetect.push({\n        p: 3,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$u(args, 'rgba');\n            if (type$e(args) === 'array' && (args.length === 3 ||\n                args.length === 4 && type$e(args[3]) == 'number' && args[3] >= 0 && args[3] <= 1)) {\n                return 'rgb';\n            }\n        }\n    });\n\n    /*\n     * Based on implementation by Neil Bartlett\n     * https://github.com/neilbartlett/color-temperature\n     */\n\n    var log = Math.log;\n\n    var temperature2rgb = function (kelvin) {\n        var temp = kelvin / 100;\n        var r,g,b;\n        if (temp < 66) {\n            r = 255;\n            g = -155.25485562709179 - 0.44596950469579133 * (g = temp-2) + 104.49216199393888 * log(g);\n            b = temp < 20 ? 0 : -254.76935184120902 + 0.8274096064007395 * (b = temp-10) + 115.67994401066147 * log(b);\n        } else {\n            r = 351.97690566805693 + 0.114206453784165 * (r = temp-55) - 40.25366309332127 * log(r);\n            g = 325.4494125711974 + 0.07943456536662342 * (g = temp-50) - 28.0852963507957 * log(g);\n            b = 255;\n        }\n        return [r,g,b,1];\n    };\n\n    var temperature2rgb_1 = temperature2rgb;\n\n    /*\n     * Based on implementation by Neil Bartlett\n     * https://github.com/neilbartlett/color-temperature\n     **/\n\n\n    var unpack$v = utils.unpack;\n    var round$6 = Math.round;\n\n    var rgb2temperature = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var rgb = unpack$v(args, 'rgb');\n        var r = rgb[0], b = rgb[2];\n        var minTemp = 1000;\n        var maxTemp = 40000;\n        var eps = 0.4;\n        var temp;\n        while (maxTemp - minTemp > eps) {\n            temp = (maxTemp + minTemp) * 0.5;\n            var rgb$1 = temperature2rgb_1(temp);\n            if ((rgb$1[2] / rgb$1[0]) >= (b / r)) {\n                maxTemp = temp;\n            } else {\n                minTemp = temp;\n            }\n        }\n        return round$6(temp);\n    };\n\n    var rgb2temperature_1 = rgb2temperature;\n\n    Color_1.prototype.temp =\n    Color_1.prototype.kelvin =\n    Color_1.prototype.temperature = function() {\n        return rgb2temperature_1(this._rgb);\n    };\n\n    chroma_1.temp =\n    chroma_1.kelvin =\n    chroma_1.temperature = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['temp']) ));\n    };\n\n    input.format.temp =\n    input.format.kelvin =\n    input.format.temperature = temperature2rgb_1;\n\n    var type$f = utils.type;\n\n    Color_1.prototype.alpha = function(a, mutate) {\n        if ( mutate === void 0 ) mutate=false;\n\n        if (a !== undefined && type$f(a) === 'number') {\n            if (mutate) {\n                this._rgb[3] = a;\n                return this;\n            }\n            return new Color_1([this._rgb[0], this._rgb[1], this._rgb[2], a], 'rgb');\n        }\n        return this._rgb[3];\n    };\n\n    Color_1.prototype.clipped = function() {\n        return this._rgb._clipped || false;\n    };\n\n    Color_1.prototype.darken = function(amount) {\n    \tif ( amount === void 0 ) amount=1;\n\n    \tvar me = this;\n    \tvar lab = me.lab();\n    \tlab[0] -= labConstants.Kn * amount;\n    \treturn new Color_1(lab, 'lab').alpha(me.alpha(), true);\n    };\n\n    Color_1.prototype.brighten = function(amount) {\n    \tif ( amount === void 0 ) amount=1;\n\n    \treturn this.darken(-amount);\n    };\n\n    Color_1.prototype.darker = Color_1.prototype.darken;\n    Color_1.prototype.brighter = Color_1.prototype.brighten;\n\n    Color_1.prototype.get = function(mc) {\n        var ref = mc.split('.');\n        var mode = ref[0];\n        var channel = ref[1];\n        var src = this[mode]();\n        if (channel) {\n            var i = mode.indexOf(channel);\n            if (i > -1) { return src[i]; }\n            throw new Error((\"unknown channel \" + channel + \" in mode \" + mode));\n        } else {\n            return src;\n        }\n    };\n\n    var type$g = utils.type;\n    var pow$2 = Math.pow;\n\n    var EPS = 1e-7;\n    var MAX_ITER = 20;\n\n    Color_1.prototype.luminance = function(lum) {\n        if (lum !== undefined && type$g(lum) === 'number') {\n            if (lum === 0) {\n                // return pure black\n                return new Color_1([0,0,0,this._rgb[3]], 'rgb');\n            }\n            if (lum === 1) {\n                // return pure white\n                return new Color_1([255,255,255,this._rgb[3]], 'rgb');\n            }\n            // compute new color using...\n            var cur_lum = this.luminance();\n            var mode = 'rgb';\n            var max_iter = MAX_ITER;\n\n            var test = function (low, high) {\n                var mid = low.interpolate(high, 0.5, mode);\n                var lm = mid.luminance();\n                if (Math.abs(lum - lm) < EPS || !max_iter--) {\n                    // close enough\n                    return mid;\n                }\n                return lm > lum ? test(low, mid) : test(mid, high);\n            };\n\n            var rgb = (cur_lum > lum ? test(new Color_1([0,0,0]), this) : test(this, new Color_1([255,255,255]))).rgb();\n            return new Color_1(rgb.concat( [this._rgb[3]]));\n        }\n        return rgb2luminance.apply(void 0, (this._rgb).slice(0,3));\n    };\n\n\n    var rgb2luminance = function (r,g,b) {\n        // relative luminance\n        // see http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\n        r = luminance_x(r);\n        g = luminance_x(g);\n        b = luminance_x(b);\n        return 0.2126 * r + 0.7152 * g + 0.0722 * b;\n    };\n\n    var luminance_x = function (x) {\n        x /= 255;\n        return x <= 0.03928 ? x/12.92 : pow$2((x+0.055)/1.055, 2.4);\n    };\n\n    var interpolator = {};\n\n    var type$h = utils.type;\n\n\n    var mix = function (col1, col2, f) {\n        if ( f === void 0 ) f=0.5;\n        var rest = [], len = arguments.length - 3;\n        while ( len-- > 0 ) rest[ len ] = arguments[ len + 3 ];\n\n        var mode = rest[0] || 'lrgb';\n        if (!interpolator[mode] && !rest.length) {\n            // fall back to the first supported mode\n            mode = Object.keys(interpolator)[0];\n        }\n        if (!interpolator[mode]) {\n            throw new Error((\"interpolation mode \" + mode + \" is not defined\"));\n        }\n        if (type$h(col1) !== 'object') { col1 = new Color_1(col1); }\n        if (type$h(col2) !== 'object') { col2 = new Color_1(col2); }\n        return interpolator[mode](col1, col2, f)\n            .alpha(col1.alpha() + f * (col2.alpha() - col1.alpha()));\n    };\n\n    Color_1.prototype.mix =\n    Color_1.prototype.interpolate = function(col2, f) {\n    \tif ( f === void 0 ) f=0.5;\n    \tvar rest = [], len = arguments.length - 2;\n    \twhile ( len-- > 0 ) rest[ len ] = arguments[ len + 2 ];\n\n    \treturn mix.apply(void 0, [ this, col2, f ].concat( rest ));\n    };\n\n    Color_1.prototype.premultiply = function(mutate) {\n    \tif ( mutate === void 0 ) mutate=false;\n\n    \tvar rgb = this._rgb;\n    \tvar a = rgb[3];\n    \tif (mutate) {\n    \t\tthis._rgb = [rgb[0]*a, rgb[1]*a, rgb[2]*a, a];\n    \t\treturn this;\n    \t} else {\n    \t\treturn new Color_1([rgb[0]*a, rgb[1]*a, rgb[2]*a, a], 'rgb');\n    \t}\n    };\n\n    Color_1.prototype.saturate = function(amount) {\n    \tif ( amount === void 0 ) amount=1;\n\n    \tvar me = this;\n    \tvar lch = me.lch();\n    \tlch[1] += labConstants.Kn * amount;\n    \tif (lch[1] < 0) { lch[1] = 0; }\n    \treturn new Color_1(lch, 'lch').alpha(me.alpha(), true);\n    };\n\n    Color_1.prototype.desaturate = function(amount) {\n    \tif ( amount === void 0 ) amount=1;\n\n    \treturn this.saturate(-amount);\n    };\n\n    var type$i = utils.type;\n\n    Color_1.prototype.set = function(mc, value, mutate) {\n        if ( mutate === void 0 ) mutate=false;\n\n        var ref = mc.split('.');\n        var mode = ref[0];\n        var channel = ref[1];\n        var src = this[mode]();\n        if (channel) {\n            var i = mode.indexOf(channel);\n            if (i > -1) {\n                if (type$i(value) == 'string') {\n                    switch(value.charAt(0)) {\n                        case '+': src[i] += +value; break;\n                        case '-': src[i] += +value; break;\n                        case '*': src[i] *= +(value.substr(1)); break;\n                        case '/': src[i] /= +(value.substr(1)); break;\n                        default: src[i] = +value;\n                    }\n                } else if (type$i(value) === 'number') {\n                    src[i] = value;\n                } else {\n                    throw new Error(\"unsupported value for Color.set\");\n                }\n                var out = new Color_1(src, mode);\n                if (mutate) {\n                    this._rgb = out._rgb;\n                    return this;\n                }\n                return out;\n            }\n            throw new Error((\"unknown channel \" + channel + \" in mode \" + mode));\n        } else {\n            return src;\n        }\n    };\n\n    var rgb$1 = function (col1, col2, f) {\n        var xyz0 = col1._rgb;\n        var xyz1 = col2._rgb;\n        return new Color_1(\n            xyz0[0] + f * (xyz1[0]-xyz0[0]),\n            xyz0[1] + f * (xyz1[1]-xyz0[1]),\n            xyz0[2] + f * (xyz1[2]-xyz0[2]),\n            'rgb'\n        )\n    };\n\n    // register interpolator\n    interpolator.rgb = rgb$1;\n\n    var sqrt$2 = Math.sqrt;\n    var pow$3 = Math.pow;\n\n    var lrgb = function (col1, col2, f) {\n        var ref = col1._rgb;\n        var x1 = ref[0];\n        var y1 = ref[1];\n        var z1 = ref[2];\n        var ref$1 = col2._rgb;\n        var x2 = ref$1[0];\n        var y2 = ref$1[1];\n        var z2 = ref$1[2];\n        return new Color_1(\n            sqrt$2(pow$3(x1,2) * (1-f) + pow$3(x2,2) * f),\n            sqrt$2(pow$3(y1,2) * (1-f) + pow$3(y2,2) * f),\n            sqrt$2(pow$3(z1,2) * (1-f) + pow$3(z2,2) * f),\n            'rgb'\n        )\n    };\n\n    // register interpolator\n    interpolator.lrgb = lrgb;\n\n    var lab$1 = function (col1, col2, f) {\n        var xyz0 = col1.lab();\n        var xyz1 = col2.lab();\n        return new Color_1(\n            xyz0[0] + f * (xyz1[0]-xyz0[0]),\n            xyz0[1] + f * (xyz1[1]-xyz0[1]),\n            xyz0[2] + f * (xyz1[2]-xyz0[2]),\n            'lab'\n        )\n    };\n\n    // register interpolator\n    interpolator.lab = lab$1;\n\n    var _hsx = function (col1, col2, f, m) {\n        var assign, assign$1;\n\n        var xyz0, xyz1;\n        if (m === 'hsl') {\n            xyz0 = col1.hsl();\n            xyz1 = col2.hsl();\n        } else if (m === 'hsv') {\n            xyz0 = col1.hsv();\n            xyz1 = col2.hsv();\n        } else if (m === 'hcg') {\n            xyz0 = col1.hcg();\n            xyz1 = col2.hcg();\n        } else if (m === 'hsi') {\n            xyz0 = col1.hsi();\n            xyz1 = col2.hsi();\n        } else if (m === 'lch' || m === 'hcl') {\n            m = 'hcl';\n            xyz0 = col1.hcl();\n            xyz1 = col2.hcl();\n        }\n\n        var hue0, hue1, sat0, sat1, lbv0, lbv1;\n        if (m.substr(0, 1) === 'h') {\n            (assign = xyz0, hue0 = assign[0], sat0 = assign[1], lbv0 = assign[2]);\n            (assign$1 = xyz1, hue1 = assign$1[0], sat1 = assign$1[1], lbv1 = assign$1[2]);\n        }\n\n        var sat, hue, lbv, dh;\n\n        if (!isNaN(hue0) && !isNaN(hue1)) {\n            // both colors have hue\n            if (hue1 > hue0 && hue1 - hue0 > 180) {\n                dh = hue1-(hue0+360);\n            } else if (hue1 < hue0 && hue0 - hue1 > 180) {\n                dh = hue1+360-hue0;\n            } else{\n                dh = hue1 - hue0;\n            }\n            hue = hue0 + f * dh;\n        } else if (!isNaN(hue0)) {\n            hue = hue0;\n            if ((lbv1 == 1 || lbv1 == 0) && m != 'hsv') { sat = sat0; }\n        } else if (!isNaN(hue1)) {\n            hue = hue1;\n            if ((lbv0 == 1 || lbv0 == 0) && m != 'hsv') { sat = sat1; }\n        } else {\n            hue = Number.NaN;\n        }\n\n        if (sat === undefined) { sat = sat0 + f * (sat1 - sat0); }\n        lbv = lbv0 + f * (lbv1-lbv0);\n        return new Color_1([hue, sat, lbv], m);\n    };\n\n    var lch$1 = function (col1, col2, f) {\n    \treturn _hsx(col1, col2, f, 'lch');\n    };\n\n    // register interpolator\n    interpolator.lch = lch$1;\n    interpolator.hcl = lch$1;\n\n    var num$1 = function (col1, col2, f) {\n        var c1 = col1.num();\n        var c2 = col2.num();\n        return new Color_1(c1 + f * (c2-c1), 'num')\n    };\n\n    // register interpolator\n    interpolator.num = num$1;\n\n    var hcg$1 = function (col1, col2, f) {\n    \treturn _hsx(col1, col2, f, 'hcg');\n    };\n\n    // register interpolator\n    interpolator.hcg = hcg$1;\n\n    var hsi$1 = function (col1, col2, f) {\n    \treturn _hsx(col1, col2, f, 'hsi');\n    };\n\n    // register interpolator\n    interpolator.hsi = hsi$1;\n\n    var hsl$1 = function (col1, col2, f) {\n    \treturn _hsx(col1, col2, f, 'hsl');\n    };\n\n    // register interpolator\n    interpolator.hsl = hsl$1;\n\n    var hsv$1 = function (col1, col2, f) {\n    \treturn _hsx(col1, col2, f, 'hsv');\n    };\n\n    // register interpolator\n    interpolator.hsv = hsv$1;\n\n    var clip_rgb$2 = utils.clip_rgb;\n    var pow$4 = Math.pow;\n    var sqrt$3 = Math.sqrt;\n    var PI$1 = Math.PI;\n    var cos$2 = Math.cos;\n    var sin$1 = Math.sin;\n    var atan2$1 = Math.atan2;\n\n    var average = function (colors, mode, weights) {\n        if ( mode === void 0 ) mode='lrgb';\n        if ( weights === void 0 ) weights=null;\n\n        var l = colors.length;\n        if (!weights) { weights = Array.from(new Array(l)).map(function () { return 1; }); }\n        // normalize weights\n        var k = l / weights.reduce(function(a, b) { return a + b; });\n        weights.forEach(function (w,i) { weights[i] *= k; });\n        // convert colors to Color objects\n        colors = colors.map(function (c) { return new Color_1(c); });\n        if (mode === 'lrgb') {\n            return _average_lrgb(colors, weights)\n        }\n        var first = colors.shift();\n        var xyz = first.get(mode);\n        var cnt = [];\n        var dx = 0;\n        var dy = 0;\n        // initial color\n        for (var i=0; i<xyz.length; i++) {\n            xyz[i] = (xyz[i] || 0) * weights[0];\n            cnt.push(isNaN(xyz[i]) ? 0 : weights[0]);\n            if (mode.charAt(i) === 'h' && !isNaN(xyz[i])) {\n                var A = xyz[i] / 180 * PI$1;\n                dx += cos$2(A) * weights[0];\n                dy += sin$1(A) * weights[0];\n            }\n        }\n\n        var alpha = first.alpha() * weights[0];\n        colors.forEach(function (c,ci) {\n            var xyz2 = c.get(mode);\n            alpha += c.alpha() * weights[ci+1];\n            for (var i=0; i<xyz.length; i++) {\n                if (!isNaN(xyz2[i])) {\n                    cnt[i] += weights[ci+1];\n                    if (mode.charAt(i) === 'h') {\n                        var A = xyz2[i] / 180 * PI$1;\n                        dx += cos$2(A) * weights[ci+1];\n                        dy += sin$1(A) * weights[ci+1];\n                    } else {\n                        xyz[i] += xyz2[i] * weights[ci+1];\n                    }\n                }\n            }\n        });\n\n        for (var i$1=0; i$1<xyz.length; i$1++) {\n            if (mode.charAt(i$1) === 'h') {\n                var A$1 = atan2$1(dy / cnt[i$1], dx / cnt[i$1]) / PI$1 * 180;\n                while (A$1 < 0) { A$1 += 360; }\n                while (A$1 >= 360) { A$1 -= 360; }\n                xyz[i$1] = A$1;\n            } else {\n                xyz[i$1] = xyz[i$1]/cnt[i$1];\n            }\n        }\n        alpha /= l;\n        return (new Color_1(xyz, mode)).alpha(alpha > 0.99999 ? 1 : alpha, true);\n    };\n\n\n    var _average_lrgb = function (colors, weights) {\n        var l = colors.length;\n        var xyz = [0,0,0,0];\n        for (var i=0; i < colors.length; i++) {\n            var col = colors[i];\n            var f = weights[i] / l;\n            var rgb = col._rgb;\n            xyz[0] += pow$4(rgb[0],2) * f;\n            xyz[1] += pow$4(rgb[1],2) * f;\n            xyz[2] += pow$4(rgb[2],2) * f;\n            xyz[3] += rgb[3] * f;\n        }\n        xyz[0] = sqrt$3(xyz[0]);\n        xyz[1] = sqrt$3(xyz[1]);\n        xyz[2] = sqrt$3(xyz[2]);\n        if (xyz[3] > 0.9999999) { xyz[3] = 1; }\n        return new Color_1(clip_rgb$2(xyz));\n    };\n\n    // minimal multi-purpose interface\n\n    // @requires utils color analyze\n\n\n    var type$j = utils.type;\n\n    var pow$5 = Math.pow;\n\n    var scale = function(colors) {\n\n        // constructor\n        var _mode = 'rgb';\n        var _nacol = chroma_1('#ccc');\n        var _spread = 0;\n        // const _fixed = false;\n        var _domain = [0, 1];\n        var _pos = [];\n        var _padding = [0,0];\n        var _classes = false;\n        var _colors = [];\n        var _out = false;\n        var _min = 0;\n        var _max = 1;\n        var _correctLightness = false;\n        var _colorCache = {};\n        var _useCache = true;\n        var _gamma = 1;\n\n        // private methods\n\n        var setColors = function(colors) {\n            colors = colors || ['#fff', '#000'];\n            if (colors && type$j(colors) === 'string' && chroma_1.brewer &&\n                chroma_1.brewer[colors.toLowerCase()]) {\n                colors = chroma_1.brewer[colors.toLowerCase()];\n            }\n            if (type$j(colors) === 'array') {\n                // handle single color\n                if (colors.length === 1) {\n                    colors = [colors[0], colors[0]];\n                }\n                // make a copy of the colors\n                colors = colors.slice(0);\n                // convert to chroma classes\n                for (var c=0; c<colors.length; c++) {\n                    colors[c] = chroma_1(colors[c]);\n                }\n                // auto-fill color position\n                _pos.length = 0;\n                for (var c$1=0; c$1<colors.length; c$1++) {\n                    _pos.push(c$1/(colors.length-1));\n                }\n            }\n            resetCache();\n            return _colors = colors;\n        };\n\n        var getClass = function(value) {\n            if (_classes != null) {\n                var n = _classes.length-1;\n                var i = 0;\n                while (i < n && value >= _classes[i]) {\n                    i++;\n                }\n                return i-1;\n            }\n            return 0;\n        };\n\n        var tMapLightness = function (t) { return t; };\n        var tMapDomain = function (t) { return t; };\n\n        // const classifyValue = function(value) {\n        //     let val = value;\n        //     if (_classes.length > 2) {\n        //         const n = _classes.length-1;\n        //         const i = getClass(value);\n        //         const minc = _classes[0] + ((_classes[1]-_classes[0]) * (0 + (_spread * 0.5)));  // center of 1st class\n        //         const maxc = _classes[n-1] + ((_classes[n]-_classes[n-1]) * (1 - (_spread * 0.5)));  // center of last class\n        //         val = _min + ((((_classes[i] + ((_classes[i+1] - _classes[i]) * 0.5)) - minc) / (maxc-minc)) * (_max - _min));\n        //     }\n        //     return val;\n        // };\n\n        var getColor = function(val, bypassMap) {\n            var col, t;\n            if (bypassMap == null) { bypassMap = false; }\n            if (isNaN(val) || (val === null)) { return _nacol; }\n            if (!bypassMap) {\n                if (_classes && (_classes.length > 2)) {\n                    // find the class\n                    var c = getClass(val);\n                    t = c / (_classes.length-2);\n                } else if (_max !== _min) {\n                    // just interpolate between min/max\n                    t = (val - _min) / (_max - _min);\n                } else {\n                    t = 1;\n                }\n            } else {\n                t = val;\n            }\n\n            // domain map\n            t = tMapDomain(t);\n\n            if (!bypassMap) {\n                t = tMapLightness(t);  // lightness correction\n            }\n\n            if (_gamma !== 1) { t = pow$5(t, _gamma); }\n\n            t = _padding[0] + (t * (1 - _padding[0] - _padding[1]));\n\n            t = Math.min(1, Math.max(0, t));\n\n            var k = Math.floor(t * 10000);\n\n            if (_useCache && _colorCache[k]) {\n                col = _colorCache[k];\n            } else {\n                if (type$j(_colors) === 'array') {\n                    //for i in [0.._pos.length-1]\n                    for (var i=0; i<_pos.length; i++) {\n                        var p = _pos[i];\n                        if (t <= p) {\n                            col = _colors[i];\n                            break;\n                        }\n                        if ((t >= p) && (i === (_pos.length-1))) {\n                            col = _colors[i];\n                            break;\n                        }\n                        if (t > p && t < _pos[i+1]) {\n                            t = (t-p)/(_pos[i+1]-p);\n                            col = chroma_1.interpolate(_colors[i], _colors[i+1], t, _mode);\n                            break;\n                        }\n                    }\n                } else if (type$j(_colors) === 'function') {\n                    col = _colors(t);\n                }\n                if (_useCache) { _colorCache[k] = col; }\n            }\n            return col;\n        };\n\n        var resetCache = function () { return _colorCache = {}; };\n\n        setColors(colors);\n\n        // public interface\n\n        var f = function(v) {\n            var c = chroma_1(getColor(v));\n            if (_out && c[_out]) { return c[_out](); } else { return c; }\n        };\n\n        f.classes = function(classes) {\n            if (classes != null) {\n                if (type$j(classes) === 'array') {\n                    _classes = classes;\n                    _domain = [classes[0], classes[classes.length-1]];\n                } else {\n                    var d = chroma_1.analyze(_domain);\n                    if (classes === 0) {\n                        _classes = [d.min, d.max];\n                    } else {\n                        _classes = chroma_1.limits(d, 'e', classes);\n                    }\n                }\n                return f;\n            }\n            return _classes;\n        };\n\n\n        f.domain = function(domain) {\n            if (!arguments.length) {\n                return _domain;\n            }\n            _min = domain[0];\n            _max = domain[domain.length-1];\n            _pos = [];\n            var k = _colors.length;\n            if ((domain.length === k) && (_min !== _max)) {\n                // update positions\n                for (var i = 0, list = Array.from(domain); i < list.length; i += 1) {\n                    var d = list[i];\n\n                  _pos.push((d-_min) / (_max-_min));\n                }\n            } else {\n                for (var c=0; c<k; c++) {\n                    _pos.push(c/(k-1));\n                }\n                if (domain.length > 2) {\n                    // set domain map\n                    var tOut = domain.map(function (d,i) { return i/(domain.length-1); });\n                    var tBreaks = domain.map(function (d) { return (d - _min) / (_max - _min); });\n                    if (!tBreaks.every(function (val, i) { return tOut[i] === val; })) {\n                        tMapDomain = function (t) {\n                            if (t <= 0 || t >= 1) { return t; }\n                            var i = 0;\n                            while (t >= tBreaks[i+1]) { i++; }\n                            var f = (t - tBreaks[i]) / (tBreaks[i+1] - tBreaks[i]);\n                            var out = tOut[i] + f * (tOut[i+1] - tOut[i]);\n                            return out;\n                        };\n                    }\n\n                }\n            }\n            _domain = [_min, _max];\n            return f;\n        };\n\n        f.mode = function(_m) {\n            if (!arguments.length) {\n                return _mode;\n            }\n            _mode = _m;\n            resetCache();\n            return f;\n        };\n\n        f.range = function(colors, _pos) {\n            setColors(colors, _pos);\n            return f;\n        };\n\n        f.out = function(_o) {\n            _out = _o;\n            return f;\n        };\n\n        f.spread = function(val) {\n            if (!arguments.length) {\n                return _spread;\n            }\n            _spread = val;\n            return f;\n        };\n\n        f.correctLightness = function(v) {\n            if (v == null) { v = true; }\n            _correctLightness = v;\n            resetCache();\n            if (_correctLightness) {\n                tMapLightness = function(t) {\n                    var L0 = getColor(0, true).lab()[0];\n                    var L1 = getColor(1, true).lab()[0];\n                    var pol = L0 > L1;\n                    var L_actual = getColor(t, true).lab()[0];\n                    var L_ideal = L0 + ((L1 - L0) * t);\n                    var L_diff = L_actual - L_ideal;\n                    var t0 = 0;\n                    var t1 = 1;\n                    var max_iter = 20;\n                    while ((Math.abs(L_diff) > 1e-2) && (max_iter-- > 0)) {\n                        (function() {\n                            if (pol) { L_diff *= -1; }\n                            if (L_diff < 0) {\n                                t0 = t;\n                                t += (t1 - t) * 0.5;\n                            } else {\n                                t1 = t;\n                                t += (t0 - t) * 0.5;\n                            }\n                            L_actual = getColor(t, true).lab()[0];\n                            return L_diff = L_actual - L_ideal;\n                        })();\n                    }\n                    return t;\n                };\n            } else {\n                tMapLightness = function (t) { return t; };\n            }\n            return f;\n        };\n\n        f.padding = function(p) {\n            if (p != null) {\n                if (type$j(p) === 'number') {\n                    p = [p,p];\n                }\n                _padding = p;\n                return f;\n            } else {\n                return _padding;\n            }\n        };\n\n        f.colors = function(numColors, out) {\n            // If no arguments are given, return the original colors that were provided\n            if (arguments.length < 2) { out = 'hex'; }\n            var result = [];\n\n            if (arguments.length === 0) {\n                result = _colors.slice(0);\n\n            } else if (numColors === 1) {\n                result = [f(0.5)];\n\n            } else if (numColors > 1) {\n                var dm = _domain[0];\n                var dd = _domain[1] - dm;\n                result = __range__(0, numColors, false).map(function (i) { return f( dm + ((i/(numColors-1)) * dd) ); });\n\n            } else { // returns all colors based on the defined classes\n                colors = [];\n                var samples = [];\n                if (_classes && (_classes.length > 2)) {\n                    for (var i = 1, end = _classes.length, asc = 1 <= end; asc ? i < end : i > end; asc ? i++ : i--) {\n                        samples.push((_classes[i-1]+_classes[i])*0.5);\n                    }\n                } else {\n                    samples = _domain;\n                }\n                result = samples.map(function (v) { return f(v); });\n            }\n\n            if (chroma_1[out]) {\n                result = result.map(function (c) { return c[out](); });\n            }\n            return result;\n        };\n\n        f.cache = function(c) {\n            if (c != null) {\n                _useCache = c;\n                return f;\n            } else {\n                return _useCache;\n            }\n        };\n\n        f.gamma = function(g) {\n            if (g != null) {\n                _gamma = g;\n                return f;\n            } else {\n                return _gamma;\n            }\n        };\n\n        f.nodata = function(d) {\n            if (d != null) {\n                _nacol = chroma_1(d);\n                return f;\n            } else {\n                return _nacol;\n            }\n        };\n\n        return f;\n    };\n\n    function __range__(left, right, inclusive) {\n      var range = [];\n      var ascending = left < right;\n      var end = !inclusive ? right : ascending ? right + 1 : right - 1;\n      for (var i = left; ascending ? i < end : i > end; ascending ? i++ : i--) {\n        range.push(i);\n      }\n      return range;\n    }\n\n    //\n    // interpolates between a set of colors uzing a bezier spline\n    //\n\n    // @requires utils lab\n\n\n\n\n    var bezier = function(colors) {\n        var assign, assign$1, assign$2;\n\n        var I, lab0, lab1, lab2;\n        colors = colors.map(function (c) { return new Color_1(c); });\n        if (colors.length === 2) {\n            // linear interpolation\n            (assign = colors.map(function (c) { return c.lab(); }), lab0 = assign[0], lab1 = assign[1]);\n            I = function(t) {\n                var lab = ([0, 1, 2].map(function (i) { return lab0[i] + (t * (lab1[i] - lab0[i])); }));\n                return new Color_1(lab, 'lab');\n            };\n        } else if (colors.length === 3) {\n            // quadratic bezier interpolation\n            (assign$1 = colors.map(function (c) { return c.lab(); }), lab0 = assign$1[0], lab1 = assign$1[1], lab2 = assign$1[2]);\n            I = function(t) {\n                var lab = ([0, 1, 2].map(function (i) { return ((1-t)*(1-t) * lab0[i]) + (2 * (1-t) * t * lab1[i]) + (t * t * lab2[i]); }));\n                return new Color_1(lab, 'lab');\n            };\n        } else if (colors.length === 4) {\n            // cubic bezier interpolation\n            var lab3;\n            (assign$2 = colors.map(function (c) { return c.lab(); }), lab0 = assign$2[0], lab1 = assign$2[1], lab2 = assign$2[2], lab3 = assign$2[3]);\n            I = function(t) {\n                var lab = ([0, 1, 2].map(function (i) { return ((1-t)*(1-t)*(1-t) * lab0[i]) + (3 * (1-t) * (1-t) * t * lab1[i]) + (3 * (1-t) * t * t * lab2[i]) + (t*t*t * lab3[i]); }));\n                return new Color_1(lab, 'lab');\n            };\n        } else if (colors.length === 5) {\n            var I0 = bezier(colors.slice(0, 3));\n            var I1 = bezier(colors.slice(2, 5));\n            I = function(t) {\n                if (t < 0.5) {\n                    return I0(t*2);\n                } else {\n                    return I1((t-0.5)*2);\n                }\n            };\n        }\n        return I;\n    };\n\n    var bezier_1 = function (colors) {\n        var f = bezier(colors);\n        f.scale = function () { return scale(f); };\n        return f;\n    };\n\n    /*\n     * interpolates between a set of colors uzing a bezier spline\n     * blend mode formulas taken from http://www.venture-ware.com/kevin/coding/lets-learn-math-photoshop-blend-modes/\n     */\n\n\n\n\n    var blend = function (bottom, top, mode) {\n        if (!blend[mode]) {\n            throw new Error('unknown blend mode ' + mode);\n        }\n        return blend[mode](bottom, top);\n    };\n\n    var blend_f = function (f) { return function (bottom,top) {\n            var c0 = chroma_1(top).rgb();\n            var c1 = chroma_1(bottom).rgb();\n            return chroma_1.rgb(f(c0, c1));\n        }; };\n\n    var each = function (f) { return function (c0, c1) {\n            var out = [];\n            out[0] = f(c0[0], c1[0]);\n            out[1] = f(c0[1], c1[1]);\n            out[2] = f(c0[2], c1[2]);\n            return out;\n        }; };\n\n    var normal = function (a) { return a; };\n    var multiply = function (a,b) { return a * b / 255; };\n    var darken$1 = function (a,b) { return a > b ? b : a; };\n    var lighten = function (a,b) { return a > b ? a : b; };\n    var screen = function (a,b) { return 255 * (1 - (1-a/255) * (1-b/255)); };\n    var overlay = function (a,b) { return b < 128 ? 2 * a * b / 255 : 255 * (1 - 2 * (1 - a / 255 ) * ( 1 - b / 255 )); };\n    var burn = function (a,b) { return 255 * (1 - (1 - b / 255) / (a/255)); };\n    var dodge = function (a,b) {\n        if (a === 255) { return 255; }\n        a = 255 * (b / 255) / (1 - a / 255);\n        return a > 255 ? 255 : a\n    };\n\n    // # add = (a,b) ->\n    // #     if (a + b > 255) then 255 else a + b\n\n    blend.normal = blend_f(each(normal));\n    blend.multiply = blend_f(each(multiply));\n    blend.screen = blend_f(each(screen));\n    blend.overlay = blend_f(each(overlay));\n    blend.darken = blend_f(each(darken$1));\n    blend.lighten = blend_f(each(lighten));\n    blend.dodge = blend_f(each(dodge));\n    blend.burn = blend_f(each(burn));\n    // blend.add = blend_f(each(add));\n\n    var blend_1 = blend;\n\n    // cubehelix interpolation\n    // based on D.A. Green \"A colour scheme for the display of astronomical intensity images\"\n    // http://astron-soc.in/bulletin/11June/289392011.pdf\n\n    var type$k = utils.type;\n    var clip_rgb$3 = utils.clip_rgb;\n    var TWOPI$2 = utils.TWOPI;\n    var pow$6 = Math.pow;\n    var sin$2 = Math.sin;\n    var cos$3 = Math.cos;\n\n\n    var cubehelix = function(start, rotations, hue, gamma, lightness) {\n        if ( start === void 0 ) start=300;\n        if ( rotations === void 0 ) rotations=-1.5;\n        if ( hue === void 0 ) hue=1;\n        if ( gamma === void 0 ) gamma=1;\n        if ( lightness === void 0 ) lightness=[0,1];\n\n        var dh = 0, dl;\n        if (type$k(lightness) === 'array') {\n            dl = lightness[1] - lightness[0];\n        } else {\n            dl = 0;\n            lightness = [lightness, lightness];\n        }\n\n        var f = function(fract) {\n            var a = TWOPI$2 * (((start+120)/360) + (rotations * fract));\n            var l = pow$6(lightness[0] + (dl * fract), gamma);\n            var h = dh !== 0 ? hue[0] + (fract * dh) : hue;\n            var amp = (h * l * (1-l)) / 2;\n            var cos_a = cos$3(a);\n            var sin_a = sin$2(a);\n            var r = l + (amp * ((-0.14861 * cos_a) + (1.78277* sin_a)));\n            var g = l + (amp * ((-0.29227 * cos_a) - (0.90649* sin_a)));\n            var b = l + (amp * (+1.97294 * cos_a));\n            return chroma_1(clip_rgb$3([r*255,g*255,b*255,1]));\n        };\n\n        f.start = function(s) {\n            if ((s == null)) { return start; }\n            start = s;\n            return f;\n        };\n\n        f.rotations = function(r) {\n            if ((r == null)) { return rotations; }\n            rotations = r;\n            return f;\n        };\n\n        f.gamma = function(g) {\n            if ((g == null)) { return gamma; }\n            gamma = g;\n            return f;\n        };\n\n        f.hue = function(h) {\n            if ((h == null)) { return hue; }\n            hue = h;\n            if (type$k(hue) === 'array') {\n                dh = hue[1] - hue[0];\n                if (dh === 0) { hue = hue[1]; }\n            } else {\n                dh = 0;\n            }\n            return f;\n        };\n\n        f.lightness = function(h) {\n            if ((h == null)) { return lightness; }\n            if (type$k(h) === 'array') {\n                lightness = h;\n                dl = h[1] - h[0];\n            } else {\n                lightness = [h,h];\n                dl = 0;\n            }\n            return f;\n        };\n\n        f.scale = function () { return chroma_1.scale(f); };\n\n        f.hue(hue);\n\n        return f;\n    };\n\n    var digits = '0123456789abcdef';\n\n    var floor$2 = Math.floor;\n    var random = Math.random;\n\n    var random_1 = function () {\n        var code = '#';\n        for (var i=0; i<6; i++) {\n            code += digits.charAt(floor$2(random() * 16));\n        }\n        return new Color_1(code, 'hex');\n    };\n\n    var log$1 = Math.log;\n    var pow$7 = Math.pow;\n    var floor$3 = Math.floor;\n    var abs = Math.abs;\n\n\n    var analyze = function (data, key) {\n        if ( key === void 0 ) key=null;\n\n        var r = {\n            min: Number.MAX_VALUE,\n            max: Number.MAX_VALUE*-1,\n            sum: 0,\n            values: [],\n            count: 0\n        };\n        if (type(data) === 'object') {\n            data = Object.values(data);\n        }\n        data.forEach(function (val) {\n            if (key && type(val) === 'object') { val = val[key]; }\n            if (val !== undefined && val !== null && !isNaN(val)) {\n                r.values.push(val);\n                r.sum += val;\n                if (val < r.min) { r.min = val; }\n                if (val > r.max) { r.max = val; }\n                r.count += 1;\n            }\n        });\n\n        r.domain = [r.min, r.max];\n\n        r.limits = function (mode, num) { return limits(r, mode, num); };\n\n        return r;\n    };\n\n\n    var limits = function (data, mode, num) {\n        if ( mode === void 0 ) mode='equal';\n        if ( num === void 0 ) num=7;\n\n        if (type(data) == 'array') {\n            data = analyze(data);\n        }\n        var min = data.min;\n        var max = data.max;\n        var values = data.values.sort(function (a,b) { return a-b; });\n\n        if (num === 1) { return [min,max]; }\n\n        var limits = [];\n\n        if (mode.substr(0,1) === 'c') { // continuous\n            limits.push(min);\n            limits.push(max);\n        }\n\n        if (mode.substr(0,1) === 'e') { // equal interval\n            limits.push(min);\n            for (var i=1; i<num; i++) {\n                limits.push(min+((i/num)*(max-min)));\n            }\n            limits.push(max);\n        }\n\n        else if (mode.substr(0,1) === 'l') { // log scale\n            if (min <= 0) {\n                throw new Error('Logarithmic scales are only possible for values > 0');\n            }\n            var min_log = Math.LOG10E * log$1(min);\n            var max_log = Math.LOG10E * log$1(max);\n            limits.push(min);\n            for (var i$1=1; i$1<num; i$1++) {\n                limits.push(pow$7(10, min_log + ((i$1/num) * (max_log - min_log))));\n            }\n            limits.push(max);\n        }\n\n        else if (mode.substr(0,1) === 'q') { // quantile scale\n            limits.push(min);\n            for (var i$2=1; i$2<num; i$2++) {\n                var p = ((values.length-1) * i$2)/num;\n                var pb = floor$3(p);\n                if (pb === p) {\n                    limits.push(values[pb]);\n                } else { // p > pb\n                    var pr = p - pb;\n                    limits.push((values[pb]*(1-pr)) + (values[pb+1]*pr));\n                }\n            }\n            limits.push(max);\n\n        }\n\n        else if (mode.substr(0,1) === 'k') { // k-means clustering\n            /*\n            implementation based on\n            http://code.google.com/p/figue/source/browse/trunk/figue.js#336\n            simplified for 1-d input values\n            */\n            var cluster;\n            var n = values.length;\n            var assignments = new Array(n);\n            var clusterSizes = new Array(num);\n            var repeat = true;\n            var nb_iters = 0;\n            var centroids = null;\n\n            // get seed values\n            centroids = [];\n            centroids.push(min);\n            for (var i$3=1; i$3<num; i$3++) {\n                centroids.push(min + ((i$3/num) * (max-min)));\n            }\n            centroids.push(max);\n\n            while (repeat) {\n                // assignment step\n                for (var j=0; j<num; j++) {\n                    clusterSizes[j] = 0;\n                }\n                for (var i$4=0; i$4<n; i$4++) {\n                    var value = values[i$4];\n                    var mindist = Number.MAX_VALUE;\n                    var best = (void 0);\n                    for (var j$1=0; j$1<num; j$1++) {\n                        var dist = abs(centroids[j$1]-value);\n                        if (dist < mindist) {\n                            mindist = dist;\n                            best = j$1;\n                        }\n                        clusterSizes[best]++;\n                        assignments[i$4] = best;\n                    }\n                }\n\n                // update centroids step\n                var newCentroids = new Array(num);\n                for (var j$2=0; j$2<num; j$2++) {\n                    newCentroids[j$2] = null;\n                }\n                for (var i$5=0; i$5<n; i$5++) {\n                    cluster = assignments[i$5];\n                    if (newCentroids[cluster] === null) {\n                        newCentroids[cluster] = values[i$5];\n                    } else {\n                        newCentroids[cluster] += values[i$5];\n                    }\n                }\n                for (var j$3=0; j$3<num; j$3++) {\n                    newCentroids[j$3] *= 1/clusterSizes[j$3];\n                }\n\n                // check convergence\n                repeat = false;\n                for (var j$4=0; j$4<num; j$4++) {\n                    if (newCentroids[j$4] !== centroids[j$4]) {\n                        repeat = true;\n                        break;\n                    }\n                }\n\n                centroids = newCentroids;\n                nb_iters++;\n\n                if (nb_iters > 200) {\n                    repeat = false;\n                }\n            }\n\n            // finished k-means clustering\n            // the next part is borrowed from gabrielflor.it\n            var kClusters = {};\n            for (var j$5=0; j$5<num; j$5++) {\n                kClusters[j$5] = [];\n            }\n            for (var i$6=0; i$6<n; i$6++) {\n                cluster = assignments[i$6];\n                kClusters[cluster].push(values[i$6]);\n            }\n            var tmpKMeansBreaks = [];\n            for (var j$6=0; j$6<num; j$6++) {\n                tmpKMeansBreaks.push(kClusters[j$6][0]);\n                tmpKMeansBreaks.push(kClusters[j$6][kClusters[j$6].length-1]);\n            }\n            tmpKMeansBreaks = tmpKMeansBreaks.sort(function (a,b){ return a-b; });\n            limits.push(tmpKMeansBreaks[0]);\n            for (var i$7=1; i$7 < tmpKMeansBreaks.length; i$7+= 2) {\n                var v = tmpKMeansBreaks[i$7];\n                if (!isNaN(v) && (limits.indexOf(v) === -1)) {\n                    limits.push(v);\n                }\n            }\n        }\n        return limits;\n    };\n\n    var analyze_1 = {analyze: analyze, limits: limits};\n\n    var contrast = function (a, b) {\n        // WCAG contrast ratio\n        // see http://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef\n        a = new Color_1(a);\n        b = new Color_1(b);\n        var l1 = a.luminance();\n        var l2 = b.luminance();\n        return l1 > l2 ? (l1 + 0.05) / (l2 + 0.05) : (l2 + 0.05) / (l1 + 0.05);\n    };\n\n    var sqrt$4 = Math.sqrt;\n    var atan2$2 = Math.atan2;\n    var abs$1 = Math.abs;\n    var cos$4 = Math.cos;\n    var PI$2 = Math.PI;\n\n    var deltaE = function(a, b, L, C) {\n        if ( L === void 0 ) L=1;\n        if ( C === void 0 ) C=1;\n\n        // Delta E (CMC)\n        // see http://www.brucelindbloom.com/index.html?Eqn_DeltaE_CMC.html\n        a = new Color_1(a);\n        b = new Color_1(b);\n        var ref = Array.from(a.lab());\n        var L1 = ref[0];\n        var a1 = ref[1];\n        var b1 = ref[2];\n        var ref$1 = Array.from(b.lab());\n        var L2 = ref$1[0];\n        var a2 = ref$1[1];\n        var b2 = ref$1[2];\n        var c1 = sqrt$4((a1 * a1) + (b1 * b1));\n        var c2 = sqrt$4((a2 * a2) + (b2 * b2));\n        var sl = L1 < 16.0 ? 0.511 : (0.040975 * L1) / (1.0 + (0.01765 * L1));\n        var sc = ((0.0638 * c1) / (1.0 + (0.0131 * c1))) + 0.638;\n        var h1 = c1 < 0.000001 ? 0.0 : (atan2$2(b1, a1) * 180.0) / PI$2;\n        while (h1 < 0) { h1 += 360; }\n        while (h1 >= 360) { h1 -= 360; }\n        var t = (h1 >= 164.0) && (h1 <= 345.0) ? (0.56 + abs$1(0.2 * cos$4((PI$2 * (h1 + 168.0)) / 180.0))) : (0.36 + abs$1(0.4 * cos$4((PI$2 * (h1 + 35.0)) / 180.0)));\n        var c4 = c1 * c1 * c1 * c1;\n        var f = sqrt$4(c4 / (c4 + 1900.0));\n        var sh = sc * (((f * t) + 1.0) - f);\n        var delL = L1 - L2;\n        var delC = c1 - c2;\n        var delA = a1 - a2;\n        var delB = b1 - b2;\n        var dH2 = ((delA * delA) + (delB * delB)) - (delC * delC);\n        var v1 = delL / (L * sl);\n        var v2 = delC / (C * sc);\n        var v3 = sh;\n        return sqrt$4((v1 * v1) + (v2 * v2) + (dH2 / (v3 * v3)));\n    };\n\n    // simple Euclidean distance\n    var distance = function(a, b, mode) {\n        if ( mode === void 0 ) mode='lab';\n\n        // Delta E (CIE 1976)\n        // see http://www.brucelindbloom.com/index.html?Equations.html\n        a = new Color_1(a);\n        b = new Color_1(b);\n        var l1 = a.get(mode);\n        var l2 = b.get(mode);\n        var sum_sq = 0;\n        for (var i in l1) {\n            var d = (l1[i] || 0) - (l2[i] || 0);\n            sum_sq += d*d;\n        }\n        return Math.sqrt(sum_sq);\n    };\n\n    var valid = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        try {\n            new (Function.prototype.bind.apply( Color_1, [ null ].concat( args) ));\n            return true;\n        } catch (e) {\n            return false;\n        }\n    };\n\n    // some pre-defined color scales:\n\n\n\n\n    var scales = {\n    \tcool: function cool() { return scale([chroma_1.hsl(180,1,.9), chroma_1.hsl(250,.7,.4)]) },\n    \thot: function hot() { return scale(['#000','#f00','#ff0','#fff'], [0,.25,.75,1]).mode('rgb') }\n    };\n\n    /**\n        ColorBrewer colors for chroma.js\n\n        Copyright (c) 2002 Cynthia Brewer, Mark Harrower, and The\n        Pennsylvania State University.\n\n        Licensed under the Apache License, Version 2.0 (the \"License\");\n        you may not use this file except in compliance with the License.\n        You may obtain a copy of the License at\n        http://www.apache.org/licenses/LICENSE-2.0\n\n        Unless required by applicable law or agreed to in writing, software distributed\n        under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n        CONDITIONS OF ANY KIND, either express or implied. See the License for the\n        specific language governing permissions and limitations under the License.\n    */\n\n    var colorbrewer = {\n        // sequential\n        OrRd: ['#fff7ec', '#fee8c8', '#fdd49e', '#fdbb84', '#fc8d59', '#ef6548', '#d7301f', '#b30000', '#7f0000'],\n        PuBu: ['#fff7fb', '#ece7f2', '#d0d1e6', '#a6bddb', '#74a9cf', '#3690c0', '#0570b0', '#045a8d', '#023858'],\n        BuPu: ['#f7fcfd', '#e0ecf4', '#bfd3e6', '#9ebcda', '#8c96c6', '#8c6bb1', '#88419d', '#810f7c', '#4d004b'],\n        Oranges: ['#fff5eb', '#fee6ce', '#fdd0a2', '#fdae6b', '#fd8d3c', '#f16913', '#d94801', '#a63603', '#7f2704'],\n        BuGn: ['#f7fcfd', '#e5f5f9', '#ccece6', '#99d8c9', '#66c2a4', '#41ae76', '#238b45', '#006d2c', '#00441b'],\n        YlOrBr: ['#ffffe5', '#fff7bc', '#fee391', '#fec44f', '#fe9929', '#ec7014', '#cc4c02', '#993404', '#662506'],\n        YlGn: ['#ffffe5', '#f7fcb9', '#d9f0a3', '#addd8e', '#78c679', '#41ab5d', '#238443', '#006837', '#004529'],\n        Reds: ['#fff5f0', '#fee0d2', '#fcbba1', '#fc9272', '#fb6a4a', '#ef3b2c', '#cb181d', '#a50f15', '#67000d'],\n        RdPu: ['#fff7f3', '#fde0dd', '#fcc5c0', '#fa9fb5', '#f768a1', '#dd3497', '#ae017e', '#7a0177', '#49006a'],\n        Greens: ['#f7fcf5', '#e5f5e0', '#c7e9c0', '#a1d99b', '#74c476', '#41ab5d', '#238b45', '#006d2c', '#00441b'],\n        YlGnBu: ['#ffffd9', '#edf8b1', '#c7e9b4', '#7fcdbb', '#41b6c4', '#1d91c0', '#225ea8', '#253494', '#081d58'],\n        Purples: ['#fcfbfd', '#efedf5', '#dadaeb', '#bcbddc', '#9e9ac8', '#807dba', '#6a51a3', '#54278f', '#3f007d'],\n        GnBu: ['#f7fcf0', '#e0f3db', '#ccebc5', '#a8ddb5', '#7bccc4', '#4eb3d3', '#2b8cbe', '#0868ac', '#084081'],\n        Greys: ['#ffffff', '#f0f0f0', '#d9d9d9', '#bdbdbd', '#969696', '#737373', '#525252', '#252525', '#000000'],\n        YlOrRd: ['#ffffcc', '#ffeda0', '#fed976', '#feb24c', '#fd8d3c', '#fc4e2a', '#e31a1c', '#bd0026', '#800026'],\n        PuRd: ['#f7f4f9', '#e7e1ef', '#d4b9da', '#c994c7', '#df65b0', '#e7298a', '#ce1256', '#980043', '#67001f'],\n        Blues: ['#f7fbff', '#deebf7', '#c6dbef', '#9ecae1', '#6baed6', '#4292c6', '#2171b5', '#08519c', '#08306b'],\n        PuBuGn: ['#fff7fb', '#ece2f0', '#d0d1e6', '#a6bddb', '#67a9cf', '#3690c0', '#02818a', '#016c59', '#014636'],\n        Viridis: ['#440154', '#482777', '#3f4a8a', '#31678e', '#26838f', '#1f9d8a', '#6cce5a', '#b6de2b', '#fee825'],\n\n        // diverging\n\n        Spectral: ['#9e0142', '#d53e4f', '#f46d43', '#fdae61', '#fee08b', '#ffffbf', '#e6f598', '#abdda4', '#66c2a5', '#3288bd', '#5e4fa2'],\n        RdYlGn: ['#a50026', '#d73027', '#f46d43', '#fdae61', '#fee08b', '#ffffbf', '#d9ef8b', '#a6d96a', '#66bd63', '#1a9850', '#006837'],\n        RdBu: ['#67001f', '#b2182b', '#d6604d', '#f4a582', '#fddbc7', '#f7f7f7', '#d1e5f0', '#92c5de', '#4393c3', '#2166ac', '#053061'],\n        PiYG: ['#8e0152', '#c51b7d', '#de77ae', '#f1b6da', '#fde0ef', '#f7f7f7', '#e6f5d0', '#b8e186', '#7fbc41', '#4d9221', '#276419'],\n        PRGn: ['#40004b', '#762a83', '#9970ab', '#c2a5cf', '#e7d4e8', '#f7f7f7', '#d9f0d3', '#a6dba0', '#5aae61', '#1b7837', '#00441b'],\n        RdYlBu: ['#a50026', '#d73027', '#f46d43', '#fdae61', '#fee090', '#ffffbf', '#e0f3f8', '#abd9e9', '#74add1', '#4575b4', '#313695'],\n        BrBG: ['#543005', '#8c510a', '#bf812d', '#dfc27d', '#f6e8c3', '#f5f5f5', '#c7eae5', '#80cdc1', '#35978f', '#01665e', '#003c30'],\n        RdGy: ['#67001f', '#b2182b', '#d6604d', '#f4a582', '#fddbc7', '#ffffff', '#e0e0e0', '#bababa', '#878787', '#4d4d4d', '#1a1a1a'],\n        PuOr: ['#7f3b08', '#b35806', '#e08214', '#fdb863', '#fee0b6', '#f7f7f7', '#d8daeb', '#b2abd2', '#8073ac', '#542788', '#2d004b'],\n\n        // qualitative\n\n        Set2: ['#66c2a5', '#fc8d62', '#8da0cb', '#e78ac3', '#a6d854', '#ffd92f', '#e5c494', '#b3b3b3'],\n        Accent: ['#7fc97f', '#beaed4', '#fdc086', '#ffff99', '#386cb0', '#f0027f', '#bf5b17', '#666666'],\n        Set1: ['#e41a1c', '#377eb8', '#4daf4a', '#984ea3', '#ff7f00', '#ffff33', '#a65628', '#f781bf', '#999999'],\n        Set3: ['#8dd3c7', '#ffffb3', '#bebada', '#fb8072', '#80b1d3', '#fdb462', '#b3de69', '#fccde5', '#d9d9d9', '#bc80bd', '#ccebc5', '#ffed6f'],\n        Dark2: ['#1b9e77', '#d95f02', '#7570b3', '#e7298a', '#66a61e', '#e6ab02', '#a6761d', '#666666'],\n        Paired: ['#a6cee3', '#1f78b4', '#b2df8a', '#33a02c', '#fb9a99', '#e31a1c', '#fdbf6f', '#ff7f00', '#cab2d6', '#6a3d9a', '#ffff99', '#b15928'],\n        Pastel2: ['#b3e2cd', '#fdcdac', '#cbd5e8', '#f4cae4', '#e6f5c9', '#fff2ae', '#f1e2cc', '#cccccc'],\n        Pastel1: ['#fbb4ae', '#b3cde3', '#ccebc5', '#decbe4', '#fed9a6', '#ffffcc', '#e5d8bd', '#fddaec', '#f2f2f2'],\n    };\n\n    // add lowercase aliases for case-insensitive matches\n    for (var i$1 = 0, list$1 = Object.keys(colorbrewer); i$1 < list$1.length; i$1 += 1) {\n        var key = list$1[i$1];\n\n        colorbrewer[key.toLowerCase()] = colorbrewer[key];\n    }\n\n    var colorbrewer_1 = colorbrewer;\n\n    // feel free to comment out anything to rollup\n    // a smaller chroma.js built\n\n    // io --\x3e convert colors\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    // operators --\x3e modify existing Colors\n\n\n\n\n\n\n\n\n\n\n    // interpolators\n\n\n\n\n\n\n\n\n\n\n    // generators -- > create new colors\n    chroma_1.average = average;\n    chroma_1.bezier = bezier_1;\n    chroma_1.blend = blend_1;\n    chroma_1.cubehelix = cubehelix;\n    chroma_1.mix = chroma_1.interpolate = mix;\n    chroma_1.random = random_1;\n    chroma_1.scale = scale;\n\n    // other utility methods\n    chroma_1.analyze = analyze_1.analyze;\n    chroma_1.contrast = contrast;\n    chroma_1.deltaE = deltaE;\n    chroma_1.distance = distance;\n    chroma_1.limits = analyze_1.limits;\n    chroma_1.valid = valid;\n\n    // scale\n    chroma_1.scales = scales;\n\n    // colors\n    chroma_1.colors = w3cx11_1;\n    chroma_1.brewer = colorbrewer_1;\n\n    var chroma_js = chroma_1;\n\n    return chroma_js;\n\n})));\n\n\n//# sourceURL=webpack://ColorRick/./node_modules/chroma-js/chroma.js?")}};var __webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(t!==undefined){return t.exports}var n=__webpack_module_cache__[e]={exports:{}};__webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__);return n.exports}var __webpack_exports__=__webpack_require__("./index.js");return __webpack_exports__})()});this.CGL=this.CGL||{},this.CGL.COREMODULES=this.CGL.COREMODULES||{},this.CGL.COREMODULES.Copytexture=function(n){var a={};function r(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=n,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,n){"use strict";n.r(t);const r={EASINGS:["linear","absolute","smoothstep","smootherstep","Cubic In","Cubic Out","Cubic In Out","Expo In","Expo Out","Expo In Out","Sin In","Sin Out","Sin In Out","Quart In","Quart Out","Quart In Out","Quint In","Quint Out","Quint In Out","Back In","Back Out","Back In Out","Elastic In","Elastic Out","Bounce In","Bounce Out"],EASING_LINEAR:0,EASING_ABSOLUTE:1,EASING_SMOOTHSTEP:2,EASING_SMOOTHERSTEP:3,EASING_CUBICSPLINE:4,EASING_CUBIC_IN:5,EASING_CUBIC_OUT:6,EASING_CUBIC_INOUT:7,EASING_EXPO_IN:8,EASING_EXPO_OUT:9,EASING_EXPO_INOUT:10,EASING_SIN_IN:11,EASING_SIN_OUT:12,EASING_SIN_INOUT:13,EASING_BACK_IN:14,EASING_BACK_OUT:15,EASING_BACK_INOUT:16,EASING_ELASTIC_IN:17,EASING_ELASTIC_OUT:18,EASING_BOUNCE_IN:19,EASING_BOUNCE_OUT:21,EASING_QUART_IN:22,EASING_QUART_OUT:23,EASING_QUART_INOUT:24,EASING_QUINT_IN:25,EASING_QUINT_OUT:26,EASING_QUINT_INOUT:27},o={OP_PORT_TYPE_VALUE:0,OP_PORT_TYPE_FUNCTION:1,OP_PORT_TYPE_OBJECT:2,OP_PORT_TYPE_TEXTURE:2,OP_PORT_TYPE_ARRAY:3,OP_PORT_TYPE_DYNAMIC:4,OP_PORT_TYPE_STRING:5,OP_VERSION_PREFIX:"_v"},i={PORT_DIR_IN:0,PORT_DIR_OUT:1},s={float32Concat:function(e,t){e instanceof Float32Array||(e=new Float32Array(e)),t instanceof Float32Array||(t=new Float32Array(t));const n=new Float32Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}};Math.randomSeed=1,Math.seededRandom=function(e,t){0===Math.randomSeed&&(Math.randomSeed=999*Math.random()),e=e||1,t=t||0,Math.randomSeed=(9301*Math.randomSeed+49297)%233280;return t+Math.randomSeed/233280*(e-t)},s.arrayWriteToEnd=function(t,e){for(let e=1;e<t.length;e++)t[e-1]=t[e];t[t.length-1]=e},s.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},s.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},String.prototype.endl=function(){return this+"\n"},String.prototype.startsWith=function(e){return 0===this.indexOf(e)},String.prototype.endsWith=function(e){return this.match(e+"$")==e};window.performance=window.performance||{offset:Date.now(),now:function(){return Date.now()-this.offset}};const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=new Uint8Array(256);for(let e=0;e<a.length;e++)l[a.charCodeAt(e)]=e;const _=l,c=function(e){let t,n,a,r,o,i=.75*e.length,s=e.length,l=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);let c=new ArrayBuffer(i),u=new Uint8Array(c);for(t=0;t<s;t+=4)n=_[e.charCodeAt(t)],a=_[e.charCodeAt(t+1)],r=_[e.charCodeAt(t+2)],o=_[e.charCodeAt(t+3)],u[l++]=n<<2|a>>4,u[l++]=(15&a)<<4|r>>2,u[l++]=(3&r)<<6|63&o;return c};class u{constructor(e){this._init(),this._first=!0,this._wireMesh=null,e&&this.apply(e)}_init(){this._max=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],this._min=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this._center=[0,0,0],this._size=[0,0,0],this._maxAxis=0,this._first=!0}get maxAxis(){return this._maxAxis||1}get size(){return this._size}get center(){return this._center}get x(){return this._center[0]}get y(){return this._center[1]}get z(){return this._center[2]}get minX(){return this._min[0]}get minY(){return this._min[1]}get minZ(){return this._min[2]}get maxX(){return this._max[0]}get maxY(){return this._max[1]}get maxZ(){return this._max[2]}apply(t,e){if(t){if(t instanceof u){const e=t;this.applyPos(e.maxX,e.maxY,e.maxZ),this.applyPos(e.minX,e.minY,e.minZ)}else for(let e=0;e<t.vertices.length;e+=3)this.applyPos(t.vertices[e],t.vertices[e+1],t.vertices[e+2]);this.calcCenterSize()}}copy(){return new u(this)}get changed(){return!(this._max[0]==-Number.MAX_VALUE&&this._max[1]==-Number.MAX_VALUE&&this._max[2]==-Number.MAX_VALUE)}applyPos(e,t,n){if(e!=Number.MAX_VALUE&&e!=-Number.MAX_VALUE&&t!=Number.MAX_VALUE&&t!=-Number.MAX_VALUE&&n!=Number.MAX_VALUE&&n!=-Number.MAX_VALUE&&CABLES.UTILS.isNumeric(e)&&CABLES.UTILS.isNumeric(t)&&CABLES.UTILS.isNumeric(n)){if(this._first)return this._max[0]=e,this._max[1]=t,this._max[2]=n,this._min[0]=e,this._min[1]=t,this._min[2]=n,void(this._first=!1);this._max[0]=Math.max(this._max[0],e),this._max[1]=Math.max(this._max[1],t),this._max[2]=Math.max(this._max[2],n),this._min[0]=Math.min(this._min[0],e),this._min[1]=Math.min(this._min[1],t),this._min[2]=Math.min(this._min[2],n)}}calcCenterSize(){this._first||(this._size[0]=this._max[0]-this._min[0],this._size[1]=this._max[1]-this._min[1],this._size[2]=this._max[2]-this._min[2],this._center[0]=(this._min[0]+this._max[0])/2,this._center[1]=(this._min[1]+this._max[1])/2,this._center[2]=(this._min[2]+this._max[2])/2,this._maxAxis=Math.max(this._size[2],Math.max(this._size[0],this._size[1])))}mulMat4(e){this._first&&(this._max[0]=0,this._max[1]=0,this._max[2]=0,this._min[0]=0,this._min[1]=0,this._min[2]=0,this._first=!1),vec3.transformMat4(this._max,this._max,e),vec3.transformMat4(this._min,this._min,e),this.calcCenterSize()}render(e,t){this._wireMesh||(this._wireMesh=new CGL.WireCube(e)),e.pushModelMatrix(),mat4.translate(e.mMatrix,e.mMatrix,this._center),this._wireMesh.render(e,this._size[0]/2,this._size[1]/2,this._size[2]/2),e.popModelMatrix()}}class d{constructor(e){this._logs=[],this.initiator=e}stack(e){console.error("["+this.initiator+"] ",e),console.log((new Error).stack),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"error",e)}groupCollapsed(e){console.groupCollapsed("["+this.initiator+"] "+e)}table(e){console.table(e)}groupEnd(){console.groupEnd()}error(e){console.error("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"error",arguments)}info(e){console.error("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"info",arguments)}warn(e){console.warn("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"warn",arguments)}verbose(){(CABLES.UI&&CABLES.UI.logFilter.shouldPrint(this.initiator,...arguments)||!CABLES.logSilent)&&console.log("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"verbose",arguments)}log(e){(CABLES.UI&&CABLES.UI.logFilter.shouldPrint(this.initiator,...arguments)||!CABLES.logSilent)&&console.log("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"log",arguments)}userInteraction(e){}}const p=function(e){this.name=e||"unknown",this._log=new d("cgl_geometry"),this.faceVertCount=3,this.glPrimitive=null,this._attributes={},this._vertices=[],this.verticesIndices=[],this.morphTargets=[],Object.defineProperty(this,"vertices",{get(){return this._vertices},set(e){this.setVertices(e)}}),Object.defineProperty(this,"texCoords",{get(){const e=this.getAttribute("texCoords");return e?e.data:[]},set(e){this.setAttribute("texCoords",e,2)}}),Object.defineProperty(this,"vertexNormals",{get(){const e=this.getAttribute("vertexNormals");return e?e.data:[]},set(e){this.setAttribute("vertexNormals",e,3)}}),Object.defineProperty(this,"tangents",{get(){const e=this.getAttribute("tangents");return e?e.data:[]},set(e){this.setAttribute("tangents",e,3)}}),Object.defineProperty(this,"biTangents",{get(){const e=this.getAttribute("biTangents");return e?e.data:[]},set(e){this.setAttribute("biTangents",e,3)}}),Object.defineProperty(this,"vertexColors",{get(){const e=this.getAttribute("vertexColors");return e?e.data:[]},set(e){this.setAttribute("vertexColors",e,4)}})};p.prototype.clear=function(){this._vertices=new Float32Array([]),this.verticesIndices=[],this.texCoords=new Float32Array([]),this.vertexNormals=new Float32Array([]),this.tangents=[],this.biTangents=[]},p.prototype.getAttributes=function(){return this._attributes},p.prototype.getAttribute=function(t){for(const e in this._attributes)if(this._attributes[e].name==t)return this._attributes[e];return null},p.prototype.setAttribute=function(e,t,n){let a="";(!n||n>4)&&(console.log("itemsize wrong?",n,e),this._log.stack("itemsize"),n=3),1==n?a="float":2==n?a="vec2":3==n?a="vec3":4==n&&(a="vec4");const r={name:e,data:t,itemSize:n,type:a};this._attributes[e]=r},p.prototype.copyAttribute=function(e,t){const n=this.getAttribute(e);t.setAttribute(e,new Float32Array(n.data),n.itemSize)},p.prototype.setVertices=function(e){e instanceof Float32Array?this._vertices=e:this._vertices=new Float32Array(e)},p.prototype.setTexCoords=function(e){e instanceof Float32Array?this.texCoords=e:this.texCoords=new Float32Array(e)},p.prototype.calcNormals=function(e){e||this.unIndex(),this.calculateNormals({})},p.prototype.flipNormals=function(t,n,a){let r=vec3.create();null==t&&(t=1),null==n&&(n=1),null==a&&(a=1);for(let e=0;e<this.vertexNormals.length;e+=3)vec3.set(r,this.vertexNormals[e+0],this.vertexNormals[e+1],this.vertexNormals[e+2]),r[0]*=-t,r[1]*=-n,r[2]*=-a,vec3.normalize(r,r),this.vertexNormals[e+0]=r[0],this.vertexNormals[e+1]=r[1],this.vertexNormals[e+2]=r[2]},p.prototype.getNumTriangles=function(){return this.verticesIndices&&this.verticesIndices.length?this.verticesIndices.length/3:this.vertices.length/3},p.prototype.flipVertDir=function(){const t=[];t.length=this.verticesIndices.length;for(let e=0;e<this.verticesIndices.length;e+=3)t[e]=this.verticesIndices[e+2],t[e+1]=this.verticesIndices[e+1],t[e+2]=this.verticesIndices[e];this.verticesIndices=t},p.prototype.setPointVertices=function(t){if(t.length%3==0){t instanceof Float32Array?this.vertices=t:this.vertices=new Float32Array(t),this.texCoords instanceof Float32Array||(this.texCoords=new Float32Array(t.length/3*2)),this.verticesIndices.length=t.length/3;for(let e=0;e<t.length/3;e++)this.verticesIndices[e]=e,this.texCoords[2*e]=0,this.texCoords[2*e+1]=0}else this._log.error("SetPointVertices: Array must be multiple of three.")},p.prototype.merge=function(t){if(!t)return;if(this.isIndexed()!=t.isIndexed()&&(this.isIndexed()&&this.unIndex(!1,!0),t.isIndexed())){const n=t.copy();n.unIndex(!1,!0),t=n}const n=this.verticesIndices.length,a=this._vertices.length/3;this.verticesIndices.length=this.verticesIndices.length+t.verticesIndices.length;for(let e=0;e<t.verticesIndices.length;e++)this.verticesIndices[n+e]=t.verticesIndices[e]+a;this.vertices=s.float32Concat(this._vertices,t.vertices),this.texCoords=s.float32Concat(this.texCoords,t.texCoords),this.vertexNormals=s.float32Concat(this.vertexNormals,t.vertexNormals),this.tangents=s.float32Concat(this.tangents,t.tangents),this.biTangents=s.float32Concat(this.biTangents,t.biTangents)},p.prototype.copy=function(){const t=new p(this.name+" copy");if(t.faceVertCount=this.faceVertCount,t.glPrimitive=this.glPrimitive,t.setVertices(this._vertices.slice(0)),this.verticesIndices){t.verticesIndices.length=this.verticesIndices.length;for(let e=0;e<this.verticesIndices.length;e++)t.verticesIndices[e]=this.verticesIndices[e]}for(let e in this._attributes)this.copyAttribute(e,t);t.morphTargets.length=this.morphTargets.length;for(let e=0;e<this.morphTargets.length;e++)t.morphTargets[e]=this.morphTargets[e];return t},p.prototype.calculateNormals=function(t){const n=vec3.create(),a=vec3.create(),r=vec3.create();function o(e){return vec3.subtract(n,e[0],e[1]),vec3.subtract(a,e[0],e[2]),vec3.cross(r,n,a),vec3.normalize(r,r),t&&t.forceZUp&&r[2]<0&&(r[0]*=-1,r[1]*=-1,r[2]*=-1),r}this.getVertexVec=function(e){const t=[0,0,0];return t[0]=this.vertices[3*e+0],t[1]=this.vertices[3*e+1],t[2]=this.vertices[3*e+2],t},this.vertexNormals instanceof Float32Array&&this.vertexNormals.length==this.vertices.length||(this.vertexNormals=new Float32Array(this.vertices.length));for(let e=0;e<this.vertices.length;e++)this.vertexNormals[e]=0;if(this.isIndexed()){const t=[];t.length=Math.floor(this.verticesIndices.length/3);for(let e=0;e<this.verticesIndices.length;e+=3){const a=[this.getVertexVec(this.verticesIndices[e+0]),this.getVertexVec(this.verticesIndices[e+1]),this.getVertexVec(this.verticesIndices[e+2])];t[e/3]=o(a),this.vertexNormals[3*this.verticesIndices[e+0]+0]+=t[e/3][0],this.vertexNormals[3*this.verticesIndices[e+0]+1]+=t[e/3][1],this.vertexNormals[3*this.verticesIndices[e+0]+2]+=t[e/3][2],this.vertexNormals[3*this.verticesIndices[e+1]+0]+=t[e/3][0],this.vertexNormals[3*this.verticesIndices[e+1]+1]+=t[e/3][1],this.vertexNormals[3*this.verticesIndices[e+1]+2]+=t[e/3][2],this.vertexNormals[3*this.verticesIndices[e+2]+0]+=t[e/3][0],this.vertexNormals[3*this.verticesIndices[e+2]+1]+=t[e/3][1],this.vertexNormals[3*this.verticesIndices[e+2]+2]+=t[e/3][2]}for(let t=0;t<this.verticesIndices.length;t+=3)for(let e=0;e<3;e++){const a=[this.vertexNormals[3*this.verticesIndices[t+e]+0],this.vertexNormals[3*this.verticesIndices[t+e]+1],this.vertexNormals[3*this.verticesIndices[t+e]+2]];vec3.normalize(a,a),this.vertexNormals[3*this.verticesIndices[t+e]+0]=a[0],this.vertexNormals[3*this.verticesIndices[t+e]+1]=a[1],this.vertexNormals[3*this.verticesIndices[t+e]+2]=a[2]}}else{const t=[];for(let e=0;e<this.vertices.length;e+=9){const a=o([[this.vertices[e+0],this.vertices[e+1],this.vertices[e+2]],[this.vertices[e+3],this.vertices[e+4],this.vertices[e+5]],[this.vertices[e+6],this.vertices[e+7],this.vertices[e+8]]]);t.push(a[0],a[1],a[2],a[0],a[1],a[2],a[0],a[1],a[2])}this.vertexNormals=t}},p.prototype.calcTangentsBitangents=function(){if(!this.vertices.length)return void this._log.error("Cannot calculate tangents/bitangents without vertices.");if(!this.vertexNormals.length)return void this._log.error("Cannot calculate tangents/bitangents without normals.");if(!this.texCoords.length){const s=this.vertices.length/3*2;this.texCoords=new Float32Array(s);for(let e=0;e<s;e+=1)this.texCoords[e]=0}if(!this.verticesIndices||!this.verticesIndices.length)return void this._log.error("Cannot calculate tangents/bitangents without vertex indices.");if(this.verticesIndices.length%3!=0)return void this._log.error("Vertex indices mismatch!");const s=this.verticesIndices.length/3,l=this.vertices.length/3;this.tangents=new Float32Array(this.vertexNormals.length),this.biTangents=new Float32Array(this.vertexNormals.length);const c=[];c.length=2*l;const u=vec3.create(),_=vec3.create(),d=vec3.create(),p=vec2.create(),g=vec2.create(),f=vec2.create(),m=vec3.create(),v=vec3.create();for(let i=0;i<s;i+=1){const s=this.verticesIndices[3*i],h=this.verticesIndices[3*i+1],b=this.verticesIndices[3*i+2];vec3.set(u,this.vertices[3*s],this.vertices[3*s+1],this.vertices[3*s+2]),vec3.set(_,this.vertices[3*h],this.vertices[3*h+1],this.vertices[3*h+2]),vec3.set(d,this.vertices[3*b],this.vertices[3*b+1],this.vertices[3*b+2]),vec2.set(p,this.texCoords[2*s],this.texCoords[2*s+1]),vec2.set(g,this.texCoords[2*h],this.texCoords[2*h+1]),vec2.set(f,this.texCoords[2*b],this.texCoords[2*b+1]);const x=_[0]-u[0],O=d[0]-u[0],I=_[1]-u[1],y=d[1]-u[1],T=_[2]-u[2],e=d[2]-u[2],t=g[0]-p[0],n=f[0]-p[0],a=g[1]-p[1],r=f[1]-p[1],o=1/(t*r-n*a);vec3.set(m,(r*x-a*O)*o,(r*I-a*y)*o,(r*T-a*e)*o),vec3.set(v,(t*O-n*x)*o,(t*y-n*I)*o,(t*e-n*T)*o),c[s]=m,c[h]=m,c[b]=m,c[s+l]=v,c[h+l]=v,c[b+l]=v}const t=vec3.create(),h=vec3.create(),b=vec3.create(),x=vec3.create(),O=vec3.create(),I=vec3.create(),y=vec3.create(),T=vec3.create();for(let e=0;e<l;e+=1){if(!c[e])continue;vec3.set(t,this.vertexNormals[3*e],this.vertexNormals[3*e+1],this.vertexNormals[3*e+2]),vec3.set(h,c[e][0],c[e][1],c[e][2]);const u=vec3.dot(t,h);vec3.scale(O,t,u),vec3.subtract(I,h,O),vec3.normalize(T,I),vec3.cross(y,t,h);vec3.dot(y,c[e+l]);const _=1;vec3.scale(b,T,1/_),vec3.cross(x,t,b),this.tangents[3*e+0]=b[0],this.tangents[3*e+1]=b[1],this.tangents[3*e+2]=b[2],this.biTangents[3*e+0]=x[0],this.biTangents[3*e+1]=x[1],this.biTangents[3*e+2]=x[2]}},p.prototype.isIndexed=function(){return 0==this._vertices.length||0!=this.verticesIndices.length},p.prototype.unIndex=function(e,t){const n=[],a=[],r=[],o=[],i=[],s=[];let l=0,c=0;for(c=0;c<this.verticesIndices.length;c+=3)n.push(this.vertices[3*this.verticesIndices[c+0]+0],this.vertices[3*this.verticesIndices[c+0]+1],this.vertices[3*this.verticesIndices[c+0]+2]),o.push(this.vertexNormals[3*this.verticesIndices[c+0]+0],this.vertexNormals[3*this.verticesIndices[c+0]+1],this.vertexNormals[3*this.verticesIndices[c+0]+2]),this.tangents.length>0&&i.push(this.tangents[3*this.verticesIndices[c+0]+0],this.tangents[3*this.verticesIndices[c+0]+1],this.tangents[3*this.verticesIndices[c+0]+2]),this.biTangents.length>0&&s.push(this.biTangents[3*this.verticesIndices[c+0]+0],this.biTangents[3*this.verticesIndices[c+0]+1],this.biTangents[3*this.verticesIndices[c+0]+2]),this.texCoords?r.push(this.texCoords[2*this.verticesIndices[c+0]+0],this.texCoords[2*this.verticesIndices[c+0]+1]):r.push(0,0),a.push(l),l++,n.push(this.vertices[3*this.verticesIndices[c+1]+0],this.vertices[3*this.verticesIndices[c+1]+1],this.vertices[3*this.verticesIndices[c+1]+2]),o.push(this.vertexNormals[3*this.verticesIndices[c+1]+0],this.vertexNormals[3*this.verticesIndices[c+1]+1],this.vertexNormals[3*this.verticesIndices[c+1]+2]),this.tangents.length>0&&i.push(this.tangents[3*this.verticesIndices[c+1]+0],this.tangents[3*this.verticesIndices[c+1]+1],this.tangents[3*this.verticesIndices[c+1]+2]),this.biTangents.length>0&&s.push(this.biTangents[3*this.verticesIndices[c+1]+0],this.biTangents[3*this.verticesIndices[c+1]+1],this.biTangents[3*this.verticesIndices[c+1]+2]),this.texCoords?r.push(this.texCoords[2*this.verticesIndices[c+1]+0],this.texCoords[2*this.verticesIndices[c+1]+1]):r.push(0,0),a.push(l),l++,n.push(this.vertices[3*this.verticesIndices[c+2]+0],this.vertices[3*this.verticesIndices[c+2]+1],this.vertices[3*this.verticesIndices[c+2]+2]),o.push(this.vertexNormals[3*this.verticesIndices[c+2]+0],this.vertexNormals[3*this.verticesIndices[c+2]+1],this.vertexNormals[3*this.verticesIndices[c+2]+2]),this.tangents.length>0&&i.push(this.tangents[3*this.verticesIndices[c+2]+0],this.tangents[3*this.verticesIndices[c+2]+1],this.tangents[3*this.verticesIndices[c+2]+2]),this.biTangents.length>0&&s.push(this.biTangents[3*this.verticesIndices[c+2]+0],this.biTangents[3*this.verticesIndices[c+2]+1],this.biTangents[3*this.verticesIndices[c+2]+2]),this.texCoords?r.push(this.texCoords[2*this.verticesIndices[c+2]+0],this.texCoords[2*this.verticesIndices[c+2]+1]):r.push(0,0),a.push(l),l++;this.vertices=n,this.texCoords=r,this.vertexNormals=o,i.length>0&&(this.tangents=i),s.length>0&&(this.biTangents=s),this.verticesIndices.length=0,e&&(this.verticesIndices=a),t||this.calculateNormals()},p.prototype.calcBarycentric=function(){let t=[];t.length=this.vertices.length;for(let e=0;e<this.vertices.length;e++)t[e]=0;let n=0;for(let e=0;e<this.vertices.length;e+=3)t[e+n]=1,n++,3==n&&(n=0);this.setAttribute("attrBarycentric",t,3)},p.prototype.getBounds=function(){return new u(this)},p.prototype.center=function(e,t,n){void 0===e&&(e=!0,t=!0,n=!0);let a=0;const r=this.getBounds(),o=[r.minX+(r.maxX-r.minX)/2,r.minY+(r.maxY-r.minY)/2,r.minZ+(r.maxZ-r.minZ)/2];for(a=0;a<this.vertices.length;a+=3)this.vertices[a+0]==this.vertices[a+0]&&(e&&(this.vertices[a+0]-=o[0]),t&&(this.vertices[a+1]-=o[1]),n&&(this.vertices[a+2]-=o[2]));return o},p.prototype.mapTexCoords2d=function(){const n=this.getBounds(),a=this.vertices.length/3;this.texCoords=new Float32Array(2*a);for(let t=0;t<a;t++){const a=this.vertices[3*t+0],e=this.vertices[3*t+1];this.texCoords[2*t+0]=a/(n.maxX-n.minX)+.5,this.texCoords[2*t+1]=1-e/(n.maxY-n.minY)+.5}},p.prototype.getInfo=function(){const e={};return 3==this.faceVertCount&&this.verticesIndices?e.numFaces=this.verticesIndices.length/3:e.numFaces=0,this.verticesIndices&&this.verticesIndices.length&&(e.indices=this.verticesIndices.length),this.vertices?e.numVerts=this.vertices.length/3:e.numVerts=0,this.vertexNormals?e.numNormals=this.vertexNormals.length/3:e.numNormals=0,this.texCoords?e.numTexCoords=this.texCoords.length/2:e.numTexCoords=0,this.tangents?e.numTangents=this.tangents.length/3:e.numTangents=0,this.biTangents?e.numBiTangents=this.biTangents.length/3:e.numBiTangents=0,this.biTangents?e.numBiTangents=this.biTangents.length/3:e.numBiTangents=0,this.vertexColors?e.numVertexColors=this.vertexColors.length/4:e.numVertexColors=0,this.getAttributes()?e.numAttribs=Object.keys(this.getAttributes()).length:e.numAttribs=0,e.isIndexed=this.isIndexed(),e},p.buildFromFaces=function(r,e,o){const i=[],s=[];for(let e=0;e<r.length;e+=3){const l=r[e+0],t=r[e+1],n=r[e+2],a=[-1,-1,-1];if(o)for(let e=0;e<i.length;e+=3)i[e+0]==l[0]&&i[e+1]==l[1]&&i[e+2]==l[2]&&(a[0]=e/3),i[e+0]==t[0]&&i[e+1]==t[1]&&i[e+2]==t[2]&&(a[1]=e/3),i[e+0]==n[0]&&i[e+1]==n[1]&&i[e+2]==n[2]&&(a[2]=e/3);-1==a[0]&&(i.push(l[0],l[1],l[2]),a[0]=(i.length-1)/3),-1==a[1]&&(i.push(t[0],t[1],t[2]),a[1]=(i.length-1)/3),-1==a[2]&&(i.push(n[0],n[1],n[2]),a[2]=(i.length-1)/3),s.push(parseInt(a[0],10)),s.push(parseInt(a[1],10)),s.push(parseInt(a[2],10))}const l=new p(e);return l.name=e,l.vertices=i,l.verticesIndices=s,l},p.json2geom=function(t){const n=new p("jsonMeshGeom");if(n.verticesIndices=[],n.vertices=t.vertices||[],n.vertexNormals=t.normals||[],n.vertexColors=t.colors||[],n.tangents=t.tangents||[],n.biTangents=t.bitangents||[],t.texturecoords&&n.setTexCoords(t.texturecoords[0]),t.vertices_b64&&(n.vertices=new Float32Array(c(t.vertices_b64))),t.normals_b64&&(n.vertexNormals=new Float32Array(c(t.normals_b64))),t.tangents_b64&&(n.tangents=new Float32Array(c(t.tangents_b64))),t.bitangents_b64&&(n.biTangents=new Float32Array(c(t.bitangents_b64))),t.texturecoords_b64&&n.setTexCoords(new Float32Array(c(t.texturecoords_b64[0]))),t.faces_b64)n.verticesIndices=new Uint32Array(c(t.faces_b64));else{n.verticesIndices.length=3*t.faces.length;for(let e=0;e<t.faces.length;e++)n.verticesIndices[3*e]=t.faces[e][0],n.verticesIndices[3*e+1]=t.faces[e][1],n.verticesIndices[3*e+2]=t.faces[e][2]}return n};const g=function(){this._log=new d("eventtaget"),this._eventCallbacks={},this._logName="",this._logEvents=!1,this._listeners={},this.addEventListener=this.on=function(e,t,n){const a={id:(n||"")+CABLES.uuid(),name:e,cb:t};return this._eventCallbacks[e]?this._eventCallbacks[e].push(a):this._eventCallbacks[e]=[a],this._listeners[a.id]=a,a.id},this.hasEventListener=function(e,t){if(e&&!t)return!!this._listeners[e];if(this._log.warn("old eventtarget function haseventlistener!"),e&&t&&this._eventCallbacks[e]){return-1!=this._eventCallbacks[e].indexOf(t)}},this.removeEventListener=this.off=function(a,r){if(null==a)return;if(!r){const r=this._listeners[a];if(!r)return;let n=!0;for(;n;){n=!1;let t=-1;for(let e=0;e<this._eventCallbacks[r.name].length;e++)0===this._eventCallbacks[r.name][e].id.indexOf(a)&&(n=!0,t=e);-1!==t&&(this._eventCallbacks[r.name].splice(t,1),delete this._listeners[a])}return}this._log.stack(" old function signature: removeEventListener! use listener id");let t=null;for(let e=0;e<this._eventCallbacks[a].length;e++)this._eventCallbacks[a][e].cb==r&&(t=e);null!==t?delete this._eventCallbacks[t]:this._log.warn("removeEventListener not found "+a)},this.logEvents=function(e,t){this._logEvents=e,this._logName=t},this.emitEvent=function(t,n,a,r,o,i,s){if(this._logEvents&&console.log("[event] ",this._logName,t,this._eventCallbacks),this._eventCallbacks[t])for(let e=0;e<this._eventCallbacks[t].length;e++)this._eventCallbacks[t][e]&&this._eventCallbacks[t][e].cb(n,a,r,o,i,s);else this._logEvents&&console.log("[event] has no event callback",t,this._eventCallbacks)}},f={Key:function(e){this.time=0,this.value=0,this.ui=null,this.onChange=null,this._easing=0,this.bezTangIn=0,this.bezTangOut=0,this.cb=null,this.cbTriggered=!1;this.setEasing(r.EASING_LINEAR),this.set(e)}};f.Key.cubicSpline=function(e,t,n){let a=e*e,r=a*e;return(2*r-3*a+1)*t.value+(r-2*a+e)*t.bezTangOut+(-2*r+3*a)*n.value+(r-a)*n.bezTangIn},f.Key.easeCubicSpline=function(e,t){return f.Key.cubicSpline(e,this,t)},f.Key.linear=function(e,t,n){return parseFloat(t.value)+parseFloat(n.value-t.value)*e},f.Key.easeLinear=function(e,t){return f.Key.linear(e,this,t)},f.Key.easeAbsolute=function(e,t){return this.value};f.Key.easeExpoIn=function(e,t){return e=function(e){return Math.pow(2,10*(e-1))}(e),f.Key.linear(e,this,t)};f.Key.easeExpoOut=function(e,t){return e=function(e){return e=1-Math.pow(2,-10*e)}(e),f.Key.linear(e,this,t)};f.Key.easeExpoInOut=function(e,t){return e=function(e){return(e*=2)<1?e=.5*Math.pow(2,10*(e-1)):(e--,e=.5*(2-Math.pow(2,-10*e))),e}(e),f.Key.linear(e,this,t)},f.Key.easeSinIn=function(e,t){return e=-1*Math.cos(e*Math.PI/2)+1,f.Key.linear(e,this,t)},f.Key.easeSinOut=function(e,t){return e=Math.sin(e*Math.PI/2),f.Key.linear(e,this,t)},f.Key.easeSinInOut=function(e,t){return e=-.5*(Math.cos(Math.PI*e)-1),f.Key.linear(e,this,t)};f.Key.easeCubicIn=function(e,t){return e=function(e){return e*=e*e}(e),f.Key.linear(e,this,t)},f.Key.easeInQuint=function(e,t){return e*=e*e*e*e,f.Key.linear(e,this,t)},f.Key.easeOutQuint=function(e,t){return e=(e-=1)*e*e*e*e+1,f.Key.linear(e,this,t)},f.Key.easeInOutQuint=function(e,t){return(e/=.5)<1?e*=.5*e*e*e*e:e=.5*((e-=2)*e*e*e*e+2),f.Key.linear(e,this,t)},f.Key.easeInQuart=function(e,t){return e*=e*e*e,f.Key.linear(e,this,t)},f.Key.easeOutQuart=function(e,t){return e=-1*((e-=1)*e*e*e-1),f.Key.linear(e,this,t)},f.Key.easeInOutQuart=function(e,t){return(e/=.5)<1?e*=.5*e*e*e:e=-.5*((e-=2)*e*e*e-2),f.Key.linear(e,this,t)},f.Key.bounce=function(e){return(e/=1)<1/2.75?e*=7.5625*e:e=e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,e},f.Key.easeInBounce=function(e,t){return f.Key.linear(f.Key.bounce(e),this,t)},f.Key.easeOutBounce=function(e,t){return f.Key.linear(f.Key.bounce(e),this,t)},f.Key.easeInElastic=function(e,t){let n=1.70158,a=0,r=1;return 0===e?e=0:1==(e/=1)?e=1:(a||(a=.3),r<Math.abs(1)?(r=1,n=a/4):n=a/(2*Math.PI)*Math.asin(1/r),e=-r*Math.pow(2,10*(e-=1))*Math.sin((1*e-n)*(2*Math.PI)/a)+0),f.Key.linear(e,this,t)},f.Key.easeOutElastic=function(e,t){let n=1.70158,a=0,r=1;return 0===e?e=0:1==(e/=1)?e=1:(a||(a=.3),r<Math.abs(1)?(r=1,n=a/4):n=a/(2*Math.PI)*Math.asin(1/r),e=r*Math.pow(2,-10*e)*Math.sin((1*e-n)*(2*Math.PI)/a)+1+0),f.Key.linear(e,this,t)},f.Key.easeInBack=function(e,t){const n=1.70158;return e=e*e*((n+1)*e-n),f.Key.linear(e,this,t)},f.Key.easeOutBack=function(e,t){const n=1.70158;return e=(e=e/1-1)*e*((n+1)*e+n)+1,f.Key.linear(e,this,t)},f.Key.easeInOutBack=function(e,t){let n=1.70158;return e=(e/=.5)<1?e*e*((1+(n*=1.525))*e-n)*.5:.5*((e-=2)*e*((1+(n*=1.525))*e+n)+2),f.Key.linear(e,this,t)};f.Key.easeCubicOut=function(e,t){return e=function(e){return e=--e*e*e+1}(e),f.Key.linear(e,this,t)};f.Key.easeCubicInOut=function(e,t){return e=function(e){return(e*=2)<1?e*=.5*e*e:e=.5*((e-=2)*e*e+2),e}(e),f.Key.linear(e,this,t)},f.Key.easeSmoothStep=function(e,t){const n=Math.max(0,Math.min(1,e));return e=n*n*(3-2*n),f.Key.linear(e,this,t)},f.Key.easeSmootherStep=function(e,t){const n=Math.max(0,Math.min(1,(e-0)/1));return e=n*n*n*(n*(6*n-15)+10),f.Key.linear(e,this,t)},f.Key.prototype.setEasing=function(e){this._easing=e,this._easing==r.EASING_LINEAR?this.ease=f.Key.easeLinear:this._easing==r.EASING_ABSOLUTE?this.ease=f.Key.easeAbsolute:this._easing==r.EASING_SMOOTHSTEP?this.ease=f.Key.easeSmoothStep:this._easing==r.EASING_SMOOTHERSTEP?this.ease=f.Key.easeSmootherStep:this._easing==r.EASING_CUBIC_IN?this.ease=f.Key.easeCubicIn:this._easing==r.EASING_CUBIC_OUT?this.ease=f.Key.easeCubicOut:this._easing==r.EASING_CUBIC_INOUT?this.ease=f.Key.easeCubicInOut:this._easing==r.EASING_EXPO_IN?this.ease=f.Key.easeExpoIn:this._easing==r.EASING_EXPO_OUT?this.ease=f.Key.easeExpoOut:this._easing==r.EASING_EXPO_INOUT?this.ease=f.Key.easeExpoInOut:this._easing==r.EASING_SIN_IN?this.ease=f.Key.easeSinIn:this._easing==r.EASING_SIN_OUT?this.ease=f.Key.easeSinOut:this._easing==r.EASING_SIN_INOUT?this.ease=f.Key.easeSinInOut:this._easing==r.EASING_BACK_OUT?this.ease=f.Key.easeOutBack:this._easing==r.EASING_BACK_IN?this.ease=f.Key.easeInBack:this._easing==r.EASING_BACK_INOUT?this.ease=f.Key.easeInOutBack:this._easing==r.EASING_ELASTIC_IN?this.ease=f.Key.easeInElastic:this._easing==r.EASING_ELASTIC_OUT?this.ease=f.Key.easeOutElastic:this._easing==r.EASING_ELASTIC_INOUT?this.ease=f.Key.easeElasticInOut:this._easing==r.EASING_BOUNCE_IN?this.ease=f.Key.easeInBounce:this._easing==r.EASING_BOUNCE_OUT?this.ease=f.Key.easeOutBounce:this._easing==r.EASING_QUART_OUT?this.ease=f.Key.easeOutQuart:this._easing==r.EASING_QUART_IN?this.ease=f.Key.easeInQuart:this._easing==r.EASING_QUART_INOUT?this.ease=f.Key.easeInOutQuart:this._easing==r.EASING_QUINT_OUT?this.ease=f.Key.easeOutQuint:this._easing==r.EASING_QUINT_IN?this.ease=f.Key.easeInQuint:this._easing==r.EASING_QUINT_INOUT?this.ease=f.Key.easeInOutQuint:this._easing==r.EASING_CUBICSPLINE?this.ease=f.Key.easeCubicSpline:(this._easing=r.EASING_LINEAR,this.ease=f.Key.easeLinear)},f.Key.prototype.trigger=function(){this.cb(),this.cbTriggered=!0},f.Key.prototype.setValue=function(e){this.value=e,null!==this.onChange&&this.onChange()},f.Key.prototype.set=function(e){e&&(e.e&&this.setEasing(e.e),e.cb&&(this.cb=e.cb,this.cbTriggered=!1),e.b,e.hasOwnProperty("t")&&(this.time=e.t),e.hasOwnProperty("time")&&(this.time=e.time),e.hasOwnProperty("v")?this.value=e.v:e.hasOwnProperty("value")&&(this.value=e.value)),null!==this.onChange&&this.onChange()},f.Key.prototype.getSerialized=function(){const e={};return e.t=this.time,e.v=this.value,e.e=this._easing,e},f.Key.prototype.getEasing=function(){return this._easing};const m=function(e){g.apply(this),e=e||{},this.keys=[],this.onChange=null,this.stayInTimeline=!1,this.loop=!1,this._log=new d("Anim"),this.defaultEasing=e.defaultEasing||r.EASING_LINEAR,this.onLooped=null,this._timesLooped=0,this._needsSort=!1};m.prototype.forceChangeCallback=function(){null!==this.onChange&&this.onChange(),this.emitEvent("onChange",this)},m.prototype.getLoop=function(){return this.loop},m.prototype.setLoop=function(e){this.loop=e,this.emitEvent("onChange",this)},m.prototype.hasEnded=function(e){return 0===this.keys.length||this.keys[this.keys.length-1].time<=e},m.prototype.isRising=function(e){if(this.hasEnded(e))return!1;const t=this.getKeyIndex(e);return this.keys[t].value<this.keys[t+1].value},m.prototype.clearBefore=function(e){const t=this.getValue(e),n=this.getKeyIndex(e);this.setValue(e,t),n>1&&this.keys.splice(0,n)},m.prototype.clear=function(e){let t=0;e&&(t=this.getValue(e)),this.keys.length=0,e&&this.setValue(e,t),null!==this.onChange&&this.onChange(),this.emitEvent("onChange",this)},m.prototype.sortKeys=function(){this.keys.sort((e,t)=>parseFloat(e.time)-parseFloat(t.time)),this._needsSort=!1},m.prototype.getLength=function(){return 0===this.keys.length?0:this.keys[this.keys.length-1].time},m.prototype.getKeyIndex=function(t){let n=0;for(let e=0;e<this.keys.length;e++)if(t>=this.keys[e].time&&(n=e),this.keys[e].time>t)return n;return n},m.prototype.setValue=function(t,n,a){let r=null;for(const e in this.keys)if(this.keys[e].time==t){r=this.keys[e],this.keys[e].setValue(n),this.keys[e].cb=a;break}return r||(r=new f.Key({time:t,value:n,e:this.defaultEasing,cb:a}),this.keys.push(r)),this.onChange&&this.onChange(),this.emitEvent("onChange",this),this._needsSort=!0,r},m.prototype.setKeyEasing=function(e,t){this.keys[e]&&(this.keys[e].setEasing(t),this.emitEvent("onChange",this))},m.prototype.getSerialized=function(){const t={keys:[]};t.loop=this.loop;for(const e in this.keys)t.keys.push(this.keys[e].getSerialized());return t},m.prototype.getKey=function(e){const t=this.getKeyIndex(e);return this.keys[t]},m.prototype.getNextKey=function(e){let t=this.getKeyIndex(e)+1;return t>=this.keys.length&&(t=this.keys.length-1),this.keys[t]},m.prototype.isFinished=function(e){return this.keys.length<=0||e>this.keys[this.keys.length-1].time},m.prototype.isStarted=function(e){return!(this.keys.length<=0)&&e>=this.keys[0].time},m.prototype.getValue=function(e){if(0===this.keys.length)return 0;if(this._needsSort&&this.sortKeys(),e<this.keys[0].time)return this.keys[0].value;const t=this.keys.length-1;if(this.loop&&e>this.keys[t].time){e/this.keys[t].time>this._timesLooped&&(this._timesLooped++,this.onLooped&&this.onLooped()),e=(e-this.keys[0].time)%(this.keys[t].time-this.keys[0].time),e+=this.keys[0].time}const n=this.getKeyIndex(e);if(n>=t)return this.keys[t].cb&&!this.keys[t].cbTriggered&&this.keys[t].trigger(),this.keys[t].value;const a=parseInt(n,10)+1,r=this.keys[n],o=this.keys[a];if(r.cb&&!r.cbTriggered&&r.trigger(),!o)return-1;const i=(e-r.time)/(o.time-r.time);return r.ease||this.log._warn("has no ease",r,o),r.ease(i,o)},m.prototype.addKey=function(e){void 0===e.time?this.log.warn("key time undefined, ignoring!"):(this.keys.push(e),null!==this.onChange&&this.onChange(),this.emitEvent("onChange",this))},m.prototype.easingFromString=function(e){return"linear"==e?r.EASING_LINEAR:"absolute"==e?r.EASING_ABSOLUTE:"smoothstep"==e?r.EASING_SMOOTHSTEP:"smootherstep"==e?r.EASING_SMOOTHERSTEP:"Cubic In"==e?r.EASING_CUBIC_IN:"Cubic Out"==e?r.EASING_CUBIC_OUT:"Cubic In Out"==e?r.EASING_CUBIC_INOUT:"Expo In"==e?r.EASING_EXPO_IN:"Expo Out"==e?r.EASING_EXPO_OUT:"Expo In Out"==e?r.EASING_EXPO_INOUT:"Sin In"==e?r.EASING_SIN_IN:"Sin Out"==e?r.EASING_SIN_OUT:"Sin In Out"==e?r.EASING_SIN_INOUT:"Back In"==e?r.EASING_BACK_IN:"Back Out"==e?r.EASING_BACK_OUT:"Back In Out"==e?r.EASING_BACK_INOUT:"Elastic In"==e?r.EASING_ELASTIC_IN:"Elastic Out"==e?r.EASING_ELASTIC_OUT:"Bounce In"==e?r.EASING_BOUNCE_IN:"Bounce Out"==e?r.EASING_BOUNCE_OUT:"Quart Out"==e?r.EASING_QUART_OUT:"Quart In"==e?r.EASING_QUART_IN:"Quart In Out"==e?r.EASING_QUART_INOUT:"Quint Out"==e?r.EASING_QUINT_OUT:"Quint In"==e?r.EASING_QUINT_IN:"Quint In Out"==e?r.EASING_QUINT_INOUT:void 0},m.prototype.createPort=function(e,t,n){const a=e.inDropDown(t,r.EASINGS);return a.set("linear"),a.defaultValue="linear",a.onChange=function(){this.defaultEasing=this.easingFromString(a.get()),n&&n()}.bind(this),a},m.slerpQuaternion=function(n,a,r,o,i,s){m.slerpQuaternion.q1||(m.slerpQuaternion.q1=quat.create(),m.slerpQuaternion.q2=quat.create());const l=r.getKeyIndex(n);let c=l+1;if(c>=r.keys.length&&(c=r.keys.length-1),l==c)quat.set(a,r.keys[l].value,o.keys[l].value,i.keys[l].value,s.keys[l].value);else{const e=r.keys[l].time,t=(n-e)/(r.keys[c].time-e);quat.set(m.slerpQuaternion.q1,r.keys[l].value,o.keys[l].value,i.keys[l].value,s.keys[l].value),quat.set(m.slerpQuaternion.q2,r.keys[c].value,o.keys[c].value,i.keys[c].value,s.keys[c].value),quat.slerp(a,m.slerpQuaternion.q1,m.slerpQuaternion.q2,t)}return a};f.Anim=m;const v=function(e,t,n,a){g.apply(this),this.data={},this._log=new d("core_port"),this.direction=i.PORT_DIR_IN,this.id=CABLES.simpleId(),this.parent=e,this.links=[],this.value=0,this.name=t,this.type=n||o.OP_PORT_TYPE_VALUE,this.uiAttribs=a||{},this.anim=null,this._oldAnimVal=-5711,this.defaultValue=null,this._uiActiveState=!0,this.ignoreValueSerialize=!1,this.onLinkChanged=null,this.crashed=!1,this._valueBeforeLink=null,this._lastAnimFrame=-1,this._animated=!1,this.onValueChanged=null,this.onTriggered=null,this.onUiActiveStateChange=null,this.changeAlways=!1,this._warnedDeprecated=!1,this._useVariableName=null,this.activityCounter=0,this._tempLastUiValue=null,Object.defineProperty(this,"title",{get(){return this.uiAttribs.title||this.name}}),Object.defineProperty(this,"val",{get(){return this._log.warn("val getter deprecated!",this),this._log.stack("val getter deprecated"),this._warnedDeprecated=!0,this.get()},set(e){this._log.warn("val setter deprecated!",this),this._log.stack("val setter deprecated"),this.setValue(e),this._warnedDeprecated=!0}})};v.prototype.copyLinkedUiAttrib=function(e,t){if(!CABLES.UI)return;if(!this.isLinked())return;const n={};n[e]=this.links[0].getOtherPort(this).getUiAttrib(e),t.setUiAttribs(n)},v.prototype.getValueForDisplay=function(){let e=String(this.value);return this.uiAttribs&&"boolnum"==this.uiAttribs.display&&(e+=" - ",this.value?e+="true":e+="false"),e=e.replace(/(<([^>]+)>)/gi,""),e.length>100&&(e=e.substring(0,100)),e},v.prototype.onAnimToggle=function(){},v.prototype._onAnimToggle=function(){this.onAnimToggle()},v.prototype.remove=function(){this.removeLinks(),this.parent.removePort(this)},v.prototype.setUiAttribs=function(t){let n=!1;this.uiAttribs||(this.uiAttribs={});for(const e in t)this.uiAttribs[e]!=t[e]&&(n=!0),this.uiAttribs[e]=t[e],"group"==e&&this.indexPort&&this.indexPort.setUiAttribs({group:t[e]});n&&this.emitEvent("onUiAttrChange",t,this)},v.prototype.getUiAttribs=function(){return this.uiAttribs},v.prototype.getUiAttrib=function(e){return this.uiAttribs&&this.uiAttribs.hasOwnProperty(e)?this.uiAttribs[e]:null},v.prototype.get=function(){return this._animated&&this._lastAnimFrame!=this.parent.patch.getFrameNum()&&(this._lastAnimFrame=this.parent.patch.getFrameNum(),this.value=this.anim.getValue(this.parent.patch.timer.getTime()),this._oldAnimVal=this.value,this.forceChange()),this.value},v.prototype.set=v.prototype.setValue=function(e){if(void 0!==e&&this.parent.enabled&&!this.crashed&&(e!==this.value||this.changeAlways||this.type==o.OP_PORT_TYPE_TEXTURE||this.type==o.OP_PORT_TYPE_ARRAY)){if(this._animated)this.anim.setValue(this.parent.patch.timer.getTime(),e);else{try{this.value=e,this.forceChange()}catch(e){this.crashed=!0,this.setValue=function(e){},this.onTriggered=function(){},this._log.error("onvaluechanged exception cought",e),this._log.error(e.stack),this._log.warn("exception in: "+this.parent.name),this.parent.patch.isEditorMode()&&gui.showOpCrash(this.parent),this.parent.patch.emitEvent("exception",e,this.parent),this.parent.onError&&this.parent.onError(e)}this.parent&&this.parent.patch&&this.parent.patch.isEditorMode()&&this.type==o.OP_PORT_TYPE_TEXTURE&&gui.texturePreview().updateTexturePort(this)}if(this.direction==i.PORT_DIR_OUT)for(let e=0;e<this.links.length;++e)this.links[e].setValue()}},v.prototype.updateAnim=function(){this._animated&&(this.value=this.get(),(this._oldAnimVal!=this.value||this.changeAlways)&&(this._oldAnimVal=this.value,this.forceChange()),this._oldAnimVal=this.value)},v.args=function(e){return(e+"").replace(/[/][/].*$/gm,"").replace(/\s+/g,"").replace(/[/][*][^/*]*[*][/]/g,"").split("){",1)[0].replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean)},v.prototype.forceChange=function(){this.onValueChanged||this.onChange,this._activity(),this.emitEvent("change",this.value,this),this.onChange?this.onChange(this,this.value):this.onValueChanged&&this.onValueChanged(this,this.value)},v.prototype.getTypeString=function(){return this.type==o.OP_PORT_TYPE_VALUE?"Number":this.type==o.OP_PORT_TYPE_FUNCTION?"Trigger":this.type==o.OP_PORT_TYPE_OBJECT?"Object":this.type==o.OP_PORT_TYPE_DYNAMIC?"Dynamic":this.type==o.OP_PORT_TYPE_ARRAY?"Array":this.type==o.OP_PORT_TYPE_STRING?"String":"Unknown"},v.prototype.deSerializeSettings=function(t){if(t&&(t.animated&&this.setAnimated(t.animated),t.useVariable&&this.setVariableName(t.useVariable),t.anim)){this.anim||(this.anim=new m),this.anim.addEventListener("onChange",()=>{this.parent.patch.emitEvent("portAnimUpdated",this.parent,this,this.anim)}),t.anim.loop&&(this.anim.loop=t.anim.loop);for(const e in t.anim.keys)this.anim.keys.push(new f.Key(t.anim.keys[e]))}},v.prototype.getSerialized=function(){const t={};if(t.name=this.getName(),this.ignoreValueSerialize||0!==this.links.length||this.type==o.OP_PORT_TYPE_OBJECT&&this.value&&this.value.tex||(t.value=this.value),this._useVariableName&&(t.useVariable=this._useVariableName),this._animated&&(t.animated=!0),this.anim&&(t.anim=this.anim.getSerialized()),"file"==this.uiAttribs.display&&(t.display=this.uiAttribs.display),this.direction==i.PORT_DIR_OUT&&this.links.length>0){t.links=[];for(const e in this.links)!this.links[e].ignoreInSerialize&&this.links[e].portIn&&this.links[e].portOut&&t.links.push(this.links[e].getSerialized())}return t},v.prototype.shouldLink=function(){return!0},v.prototype.removeLinks=function(){let e=0;for(;this.links.length>0;){if(e++,e>5e3){this._log.warn("could not delete links... / infinite loop"),this.links.length=0;break}this.links[0].remove()}},v.prototype.removeLink=function(t){for(const e in this.links)this.links[e]==t&&this.links.splice(e,1);this.direction==i.PORT_DIR_IN&&(this.type==o.OP_PORT_TYPE_VALUE?this.setValue(this._valueBeforeLink||0):this.setValue(this._valueBeforeLink||null)),CABLES.UI&&this.parent.checkLinkTimeWarnings&&this.parent.checkLinkTimeWarnings(),this.onLinkChanged&&this.onLinkChanged(),this.emitEvent("onLinkChanged"),this.parent.emitEvent("onLinkChanged")},v.prototype.getName=function(){return this.name},v.prototype.addLink=function(e){this._valueBeforeLink=this.value,this.links.push(e),CABLES.UI&&this.parent.checkLinkTimeWarnings&&this.parent.checkLinkTimeWarnings(),this.onLinkChanged&&this.onLinkChanged(),this.emitEvent("onLinkChanged"),this.parent.emitEvent("onLinkChanged")},v.prototype.getLinkTo=function(t){for(const e in this.links)if(this.links[e].portIn==t||this.links[e].portOut==t)return this.links[e]},v.prototype.removeLinkTo=function(t){for(const e in this.links)if(this.links[e].portIn==t||this.links[e].portOut==t)return this.links[e].remove(),CABLES.UI&&this.parent.checkLinkTimeWarnings&&this.parent.checkLinkTimeWarnings(),this.onLinkChanged&&this.onLinkChanged(),void this.emitEvent("onLinkChanged")},v.prototype.isLinkedTo=function(t){for(const e in this.links)if(this.links[e].portIn==t||this.links[e].portOut==t)return!0;return!1},v.prototype._activity=function(){this.activityCounter++},v.prototype.trigger=function(){if(this._activity(),0===this.links.length)return;if(!this.parent.enabled)return;let t=null;try{for(let e=0;e<this.links.length;++e)this.links[e].portIn&&(t=this.links[e].portIn,t.parent.patch.pushTriggerStack(t),t._onTriggered(),t.parent.patch.popTriggerStack()),this.links[e]&&this.links[e].activity()}catch(e){this.parent.enabled=!1,this.parent.patch.isEditorMode()&&(this.parent.patch.emitEvent("exception",e,t.parent),this.parent.patch.emitEvent("opcrash",t),t.parent.onError&&t.parent.onError(e)),this._log.warn("exception!"),this._log.error("ontriggered exception cought",e),this._log.error(e.stack),this._log.warn("exception in: "+t.parent.name)}},v.prototype.call=function(){this._log.warn("call deprecated - use trigger() "),this.trigger()},v.prototype.execute=function(){this._log.warn("### execute port: "+this.getName(),this.goals.length)},v.prototype.setVariableName=function(e){this._useVariableName=e},v.prototype.getVariableName=function(){return this._useVariableName},v.prototype.setVariable=function(e){this.setAnimated(!1);const t={useVariable:!1};this._variableIn&&this._varChangeListenerId&&(this._variableIn.off(this._varChangeListenerId),this._variableIn=null),e?(this._variableIn=this.parent.patch.getVar(e),this._variableIn?(this.type==o.OP_PORT_TYPE_OBJECT?this._varChangeListenerId=this._variableIn.on("change",()=>{this.set(null),this.set(this._variableIn.getValue())}):this._varChangeListenerId=this._variableIn.on("change",this.set.bind(this)),this.set(this._variableIn.getValue())):this._log.warn("PORT VAR NOT FOUND!!!",e),this._useVariableName=e,t.useVariable=!0,t.variableName=this._useVariableName):(t.variableName=this._useVariableName=null,t.useVariable=!1),this.setUiAttribs(t),this.parent.patch.emitEvent("portSetVariable",this.parent,this,e)},v.prototype._handleNoTriggerOpAnimUpdates=function(e){let t=!1;for(let e=0;e<this.parent.portsIn.length;e++)if(this.parent.portsIn.type==o.OP_PORT_TYPE_FUNCTION){t=!0;break}t||(e?this._notriggerAnimUpdate=this.parent.patch.on("onRenderFrame",()=>{this.updateAnim()}):this.parent.patch.removeEventListener(this._notriggerAnimUpdate))},v.prototype.setAnimated=function(e){this._animated!=e&&(this._animated=e,this._animated&&!this.anim&&(this.anim=new m,this.anim.addEventListener("onChange",()=>{this.parent.patch.emitEvent("portAnimUpdated",this.parent,this,this.anim)})),this._onAnimToggle()),this._handleNoTriggerOpAnimUpdates(e),this.setUiAttribs({isAnimated:this._animated})},v.prototype.toggleAnim=function(){this._animated=!this._animated,this._animated&&!this.anim&&(this.anim=new m,this.anim.addEventListener("onChange",()=>{this.parent.patch.emitEvent("portAnimUpdated",this.parent,this,this.anim)})),this.setAnimated(this._animated),this._onAnimToggle(),this.setUiAttribs({isAnimated:this._animated})},v.prototype.getType=function(){return this.type},v.prototype.isLinked=function(){return this.links.length>0||this._animated||null!=this._useVariableName},v.prototype.isBoundToVar=function(){return null!=this._useVariableName},v.prototype.isAnimated=function(){return this._animated},v.prototype.isHidden=function(){return this.uiAttribs.hidePort},v.prototype._onTriggered=function(e){this._activity(),this.parent.updateAnims(),this.parent.enabled&&this.onTriggered&&this.onTriggered(e)},v.prototype._onSetProfiling=function(e){this.parent.patch.profiler.add("port",this),this.setValue(e),this.parent.patch.profiler.add("port",null)},v.prototype._onTriggeredProfiling=function(){this.parent.enabled&&this.onTriggered&&(this.parent.patch.profiler.add("port",this),this.onTriggered(),this.parent.patch.profiler.add("port",null))},v.prototype.onValueChange=function(e){this.onChange=e},v.prototype.getUiActiveState=function(){return this._uiActiveState},v.prototype.setUiActiveState=function(e){this._uiActiveState=e,this.onUiActiveStateChange&&this.onUiActiveStateChange()},v.prototype.hidePort=function(){this._log.warn("op.hideport() is deprecated, do not use it!")},v.portTypeNumberToString=function(e){return e==o.OP_PORT_TYPE_VALUE?"value":e==o.OP_PORT_TYPE_FUNCTION?"function":e==o.OP_PORT_TYPE_OBJECT?"object":e==o.OP_PORT_TYPE_ARRAY?"array":e==o.OP_PORT_TYPE_STRING?"string":e==o.OP_PORT_TYPE_DYNAMIC?"dynamic":"unknown"};var h=class{constructor(e,t,n,a,r,o,i,s,l,c){if(this._log=new d("cg_uniform"),this._type=t,this._name=n,this._shader=e,this._value=1e-5,this._oldValue=null,this._port=null,this._structName=l,this._structUniformName=s,this._propertyName=c,this._shader._addUniform(this),this.needsUpdate=!0,this.shaderType=null,this.comment=null,"f"==t)this.set=this.setValue=this.setValueF.bind(this),this.updateValue=this.updateValueF.bind(this);else if("f[]"==t)this.set=this.setValue=this.setValueArrayF.bind(this),this.updateValue=this.updateValueArrayF.bind(this);else if("2f[]"==t)this.set=this.setValue=this.setValueArray2F.bind(this),this.updateValue=this.updateValueArray2F.bind(this);else if("3f[]"==t)this.set=this.setValue=this.setValueArray3F.bind(this),this.updateValue=this.updateValueArray3F.bind(this);else if("4f[]"==t)this.set=this.setValue=this.setValueArray4F.bind(this),this.updateValue=this.updateValueArray4F.bind(this);else if("i"==t)this.set=this.setValue=this.setValueI.bind(this),this.updateValue=this.updateValueI.bind(this);else if("2i"==t)this.set=this.setValue=this.setValue2I.bind(this),this.updateValue=this.updateValue2I.bind(this);else if("3i"==t)this.set=this.setValue=this.setValue3I.bind(this),this.updateValue=this.updateValue3I.bind(this);else if("4i"==t)this.set=this.setValue=this.setValue4I.bind(this),this.updateValue=this.updateValue4I.bind(this);else if("b"==t)this.set=this.setValue=this.setValueBool.bind(this),this.updateValue=this.updateValueBool.bind(this);else if("4f"==t)this.set=this.setValue=this.setValue4F.bind(this),this.updateValue=this.updateValue4F.bind(this);else if("3f"==t)this.set=this.setValue=this.setValue3F.bind(this),this.updateValue=this.updateValue3F.bind(this);else if("2f"==t)this.set=this.setValue=this.setValue2F.bind(this),this.updateValue=this.updateValue2F.bind(this);else if("t"==t)this.set=this.setValue=this.setValueT.bind(this),this.updateValue=this.updateValueT.bind(this);else if("tc"==t)this.set=this.setValue=this.setValueT.bind(this),this.updateValue=this.updateValueT.bind(this);else if("t[]"==t)this.set=this.setValue=this.setValueArrayT.bind(this),this.updateValue=this.updateValueArrayT.bind(this);else{if("m4"!=t&&"m4[]"!=t)throw new Error("Unknown uniform type");this.set=this.setValue=this.setValueM4.bind(this),this.updateValue=this.updateValueM4.bind(this)}"object"==typeof a&&a instanceof v?(this._port=a,this._value=this._port.get(),r&&o&&i?(r instanceof v&&o instanceof v&&i instanceof v||this._log.error("[cgl_uniform] mixed port/value parameter for vec4 ",this._name),this._value=[0,0,0,0],this._port2=r,this._port3=o,this._port4=i,this._port.on("change",this.updateFromPort4f.bind(this)),this._port2.on("change",this.updateFromPort4f.bind(this)),this._port3.on("change",this.updateFromPort4f.bind(this)),this._port4.on("change",this.updateFromPort4f.bind(this)),this.updateFromPort4f()):r&&o?(r instanceof v&&o instanceof v||this._log.error("[cgl_uniform] mixed port/value parameter for vec4 ",this._name),this._value=[0,0,0],this._port2=r,this._port3=o,this._port.on("change",this.updateFromPort3f.bind(this)),this._port2.on("change",this.updateFromPort3f.bind(this)),this._port3.on("change",this.updateFromPort3f.bind(this)),this.updateFromPort3f()):r?(r instanceof v||this._log.error("[cgl_uniform] mixed port/value parameter for vec4 ",this._name),this._value=[0,0],this._port2=r,this._port.on("change",this.updateFromPort2f.bind(this)),this._port2.on("change",this.updateFromPort2f.bind(this)),this.updateFromPort2f()):this._port.on("change",this.updateFromPort.bind(this))):this._value=a,this.setValue(this._value),this.needsUpdate=!0}getType(){return this._type}getName(){return this._name}getValue(){return this._value}getShaderType(){return this.shaderType}isStructMember(){return!!this._structName}updateFromPort4f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this._value[2]=this._port3.get(),this._value[3]=this._port4.get(),this.setValue(this._value)}updateFromPort3f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this._value[2]=this._port3.get(),this.setValue(this._value)}updateFromPort2f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this.setValue(this._value)}updateFromPort(){this.setValue(this._port.get())}};class b extends h{constructor(e,t,n,a,r,o,i,s,l,c){super(e,t,n,a,r,o,i,s,l,c),this._loc=-1,this._cgl=e._cgl}copy(e){const t=new b(e,this._type,this._name,this._value,this._port2,this._port3,this._port4,this._structUniformName,this._structName,this._propertyName);return t.shaderType=this.shaderType,t}getGlslTypeString(){return b.glslTypeString(this._type)}_isValidLoc(){return-1!=this._loc}resetLoc(){this._loc=-1,this.needsUpdate=!0}bindTextures(){}getLoc(){return this._loc}updateFromPort4f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this._value[2]=this._port3.get(),this._value[3]=this._port4.get(),this.setValue(this._value)}updateFromPort3f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this._value[2]=this._port3.get(),this.setValue(this._value)}updateFromPort2f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this.setValue(this._value)}updateFromPort(){this.setValue(this._port.get())}updateValueF(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._shader.getCgl().gl.uniform1f(this._loc,this._value),this._cgl.profileData.profileUniformCount++}setValueF(e){e!=this._value&&(this.needsUpdate=!0,this._value=e)}updateValueI(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._shader.getCgl().gl.uniform1i(this._loc,this._value),this._cgl.profileData.profileUniformCount++}updateValue2I(){this._value&&(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform2i(this._loc,this._value[0],this._value[1]),this.needsUpdate=!1,this._cgl.profileData.profileUniformCount++)}updateValue3I(){this._value&&(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform3i(this._loc,this._value[0],this._value[1],this._value[2]),this.needsUpdate=!1,this._cgl.profileData.profileUniformCount++)}updateValue4I(){this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform4i(this._loc,this._value[0],this._value[1],this._value[2],this._value[3]),this._cgl.profileData.profileUniformCount++}setValueI(e){e!=this._value&&(this.needsUpdate=!0,this._value=e)}setValue2I(e){e&&(this._oldValue?e[0]==this._oldValue[0]&&e[1]==this._oldValue[1]||(this._oldValue[0]=e[0],this._oldValue[1]=e[1],this.needsUpdate=!0):(this._oldValue=[e[0]-1,1],this.needsUpdate=!0),this._value=e)}setValue3I(e){e&&(this._oldValue?e[0]==this._oldValue[0]&&e[1]==this._oldValue[1]&&e[2]==this._oldValue[2]||(this._oldValue[0]=e[0],this._oldValue[1]=e[1],this._oldValue[2]=e[2],this.needsUpdate=!0):(this._oldValue=[e[0]-1,1,2],this.needsUpdate=!0),this._value=e)}setValue4I(e){this.needsUpdate=!0,this._value=e||vec4.create()}updateValueBool(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._shader.getCgl().gl.uniform1i(this._loc,this._value?1:0),this._cgl.profileData.profileUniformCount++}setValueBool(e){e!=this._value&&(this.needsUpdate=!0,this._value=e)}setValueArray4F(e){this.needsUpdate=!0,this._value=e}updateValueArray4F(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform4fv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}setValueArray3F(e){this.needsUpdate=!0,this._value=e}updateValueArray3F(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform3fv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}setValueArray2F(e){this.needsUpdate=!0,this._value=e}updateValueArray2F(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform2fv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}setValueArrayF(e){this.needsUpdate=!0,this._value=e}updateValueArrayF(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform1fv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}setValueArrayT(e){this.needsUpdate=!0,this._value=e}updateValue3F(){this._value&&(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform3f(this._loc,this._value[0],this._value[1],this._value[2]),this.needsUpdate=!1,this._cgl.profileData.profileUniformCount++)}setValue3F(e){e&&(this._oldValue?e[0]==this._oldValue[0]&&e[1]==this._oldValue[1]&&e[2]==this._oldValue[2]||(this._oldValue[0]=e[0],this._oldValue[1]=e[1],this._oldValue[2]=e[2],this.needsUpdate=!0):(this._oldValue=[e[0]-1,1,2],this.needsUpdate=!0),this._value=e)}updateValue2F(){this._value&&(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform2f(this._loc,this._value[0],this._value[1]),this.needsUpdate=!1,this._cgl.profileData.profileUniformCount++)}setValue2F(e){e&&(this._oldValue?e[0]==this._oldValue[0]&&e[1]==this._oldValue[1]||(this._oldValue[0]=e[0],this._oldValue[1]=e[1],this.needsUpdate=!0):(this._oldValue=[e[0]-1,1],this.needsUpdate=!0),this._value=e)}updateValue4F(){this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._value||(this._log.warn("no value for uniform",this._name,this),this._value=[0,0,0,0]),this.needsUpdate=!1,this._shader.getCgl().gl.uniform4f(this._loc,this._value[0],this._value[1],this._value[2],this._value[3]),this._cgl.profileData.profileUniformCount++}setValue4F(e){"number"==typeof this.value&&(this.value=vec4.create()),e&&(this._oldValue?e[0]==this._oldValue[0]&&e[1]==this._oldValue[1]&&e[2]==this._oldValue[2]&&e[3]==this._oldValue[3]||(this._oldValue[0]=e[0],this._oldValue[1]=e[1],this._oldValue[2]=e[2],this.needsUpdate=!0):(this._oldValue=[e[0]-1,1,2,3],this.needsUpdate=!0),this._value=e)}updateValueM4(){if(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),!this._value||this._value.length%16!=0)return console.log("this.name",this._name,this._value);this._shader.getCgl().gl.uniformMatrix4fv(this._loc,!1,this._value),this._cgl.profileData.profileUniformCount++}setValueM4(e){this.needsUpdate=!0,this._value=e||mat4.create()}updateValueArrayT(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform1iv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}updateValueT(){this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._cgl.profileData.profileUniformCount++,this._shader.getCgl().gl.uniform1i(this._loc,this._value),this.needsUpdate=!1}setValueT(e){this.needsUpdate=!0,this._value=e}}b.glslTypeString=e=>"f"==e?"float":"b"==e?"bool":"i"==e?"int":"2i"==e?"ivec2":"2f"==e?"vec2":"3f"==e?"vec3":"4f"==e?"vec4":"m4"==e?"mat4":"t"==e?"sampler2D":"tc"==e?"samplerCube":"3f[]"==e||"m4[]"==e||"f[]"==e?null:void(void 0)._log.warn("[CGL UNIFORM] unknown glsl type string ",e);const x=180/Math.PI,O=(Math.PI,{SHADERVAR_VERTEX_POSITION:"vPosition",SHADERVAR_VERTEX_NUMBER:"attrVertIndex",SHADERVAR_VERTEX_NORMAL:"attrVertNormal",SHADERVAR_VERTEX_TEXCOORD:"attrTexCoord",SHADERVAR_INSTANCE_MMATRIX:"instMat",SHADERVAR_VERTEX_COLOR:"attrVertColor",SHADERVAR_UNI_PROJMAT:"projMatrix",SHADERVAR_UNI_VIEWMAT:"viewMatrix",SHADERVAR_UNI_MODELMAT:"modelMatrix",SHADERVAR_UNI_NORMALMAT:"normalMatrix",SHADERVAR_UNI_INVVIEWMAT:"inverseViewMatrix",SHADERVAR_UNI_INVPROJMAT:"invProjMatrix",SHADERVAR_UNI_VIEWPOS:"camPos"});const I={lastMesh:null},y=function(e,t,n){this._cgl=e,this._log=new d("cgl_mesh"),this._bufVertexAttrib=null,this._bufVerticesIndizes=this._cgl.gl.createBuffer(),this._indexType=this._cgl.gl.UNSIGNED_SHORT,this._attributes=[],this._attribLocs={},this._geom=null,this._lastShader=null,this._numInstances=0,this._glPrimitive=n,this._preWireframeGeom=null,this.addVertexNumbers=!1,this.feedBackAttributes=[],this.setGeom(t),this._feedBacks=[],this._feedBacksChanged=!1,this._transformFeedBackLoc=-1,this._lastAttrUpdate=0,this._name="unknown",this._cgl.profileData.addHeavyEvent("mesh constructed",this._name),this._queryExt=null,Object.defineProperty(this,"numInstances",{get(){return this._numInstances},set(e){this.setNumInstances(e)}})};y.prototype.updateVertices=function(e){this.setAttribute(O.SHADERVAR_VERTEX_POSITION,e.vertices,3),this._numVerts=e.vertices.length/3},y.prototype.setAttributePointer=function(t,n,a,r){for(let e=0;e<this._attributes.length;e++)this._attributes[e].name==t&&(this._attributes[e].pointer||(this._attributes[e].pointer=[]),this._attributes[e].pointer.push({loc:-1,name:n,stride:a,offset:r,instanced:t==O.SHADERVAR_INSTANCE_MMATRIX}))},y.prototype.getAttribute=function(t){for(let e=0;e<this._attributes.length;e++)if(this._attributes[e].name==t)return this._attributes[e]},y.prototype.setAttributeRange=function(e,t,n,a){e&&(n||a)&&(e.name||(console.log(e),this._log.stack("no attrname?!")),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,e.buffer),this._cgl.profileData.profileMeshAttributes+=a-n||0,this._cgl.profileData.profileSingleMeshAttribute[this._name]=this._cgl.profileData.profileSingleMeshAttribute[this._name]||0,this._cgl.profileData.profileSingleMeshAttribute[this._name]+=a-n||0,e.numItems<t.length/e.itemSize&&this._resizeAttr(t,e),a>=t.length-1&&this._log.log(this._cgl.canvas.id+" "+e.name+" buffersubdata out of bounds ?",t.length,a,n,e),1==this._cgl.glVersion?this._cgl.gl.bufferSubData(this._cgl.gl.ARRAY_BUFFER,0,t):this._cgl.gl.bufferSubData(this._cgl.gl.ARRAY_BUFFER,4*n,t,n,a-n))},y.prototype._resizeAttr=function(e,t){t.buffer&&this._cgl.gl.deleteBuffer(t.buffer),t.buffer=this._cgl.gl.createBuffer(),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,t.buffer),this._bufferArray(e,t),t.numItems=e.length/t.itemSize},y.prototype._bufferArray=function(e,t){let n=null;e&&(this._cgl.debugOneFrame&&console.log("_bufferArray",e.length,t.name),e instanceof Float32Array?n=e:t&&n&&n.length==e.length?n.set(e):(n=new Float32Array(e),this._cgl.debugOneFrame&&console.log("_bufferArray create new float32array",e.length,t.name),this._cgl.profileData.profileNonTypedAttrib++,this._cgl.profileData.profileNonTypedAttribNames="("+this._name+":"+t.name+")"),t.arrayLength=n.length,this._cgl.gl.bufferData(this._cgl.gl.ARRAY_BUFFER,n,this._cgl.gl.DYNAMIC_DRAW))},y.prototype.addAttribute=y.prototype.updateAttribute=y.prototype.setAttribute=function(e,t,n,a){if(!t)throw this._log.error("mesh addAttribute - no array given! "+e),new Error;let r=null,o=!1,i=0;const s=t.length/n;for(this._cgl.profileData.profileMeshAttributes+=s||0,"function"==typeof a&&(r=a),"object"==typeof a&&(a.cb&&(r=a.cb),a.instanced&&(o=a.instanced)),e==O.SHADERVAR_INSTANCE_MMATRIX&&(o=!0),i=0;i<this._attributes.length;i++){const n=this._attributes[i];if(n.name==e)return n.numItems===s||this._resizeAttr(t,n),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,n.buffer),this._bufferArray(t,n),n}const l=this._cgl.gl.createBuffer();this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,l);let c=this._cgl.gl.FLOAT;a&&a.type&&(c=a.type);const u={buffer:l,name:e,cb:r,itemSize:n,numItems:s,startItem:0,instanced:o,type:c};return this._bufferArray(t,u),e==O.SHADERVAR_VERTEX_POSITION&&(this._bufVertexAttrib=u),this._attributes.push(u),this._attribLocs={},u},y.prototype.getAttributes=function(){return this._attributes},y.prototype.updateTexCoords=function(t){if(t.texCoords&&t.texCoords.length>0)this.setAttribute(O.SHADERVAR_VERTEX_TEXCOORD,t.texCoords,2);else{const e=new Float32Array(Math.round(t.vertices.length/3*2));this.setAttribute(O.SHADERVAR_VERTEX_TEXCOORD,e,2)}},y.prototype.updateNormals=function(t){if(t.vertexNormals&&t.vertexNormals.length>0)this.setAttribute(O.SHADERVAR_VERTEX_NORMAL,t.vertexNormals,3);else{const e=new Float32Array(Math.round(t.vertices.length));this.setAttribute(O.SHADERVAR_VERTEX_NORMAL,e,3)}},y.prototype._setVertexNumbers=function(e){if(!this._verticesNumbers||this._verticesNumbers.length!=this._numVerts||e){if(e)this._verticesNumbers=e;else{this._verticesNumbers=new Float32Array(this._numVerts);for(let e=0;e<this._numVerts;e++)this._verticesNumbers[e]=e}this.setAttribute(O.SHADERVAR_VERTEX_NUMBER,this._verticesNumbers,1,(e,t,n)=>{n.uniformNumVertices||(n.uniformNumVertices=new b(n,"f","numVertices",this._numVerts)),n.uniformNumVertices.setValue(this._numVerts)})}},y.prototype.setVertexIndices=function(t){if(this._bufVerticesIndizes)if(t.length>0){for(let e=0;e<t.length;e++)if(t[e]>=this._numVerts)return void this._log.warn("invalid index in "+this._name);this._cgl.gl.bindBuffer(this._cgl.gl.ELEMENT_ARRAY_BUFFER,this._bufVerticesIndizes),t instanceof Float32Array&&this._log.warn("vertIndices float32Array: "+this._name),t instanceof Uint32Array?(this.vertIndicesTyped=t,this._indexType=this._cgl.gl.UNSIGNED_INT):t instanceof Uint16Array?this.vertIndicesTyped=t:this.vertIndicesTyped=new Uint16Array(t),this._cgl.gl.bufferData(this._cgl.gl.ELEMENT_ARRAY_BUFFER,this.vertIndicesTyped,this._cgl.gl.DYNAMIC_DRAW),this._bufVerticesIndizes.itemSize=1,this._bufVerticesIndizes.numItems=t.length}else this._bufVerticesIndizes.numItems=0;else this._log.warn("no bufVerticesIndizes: "+this._name)},y.prototype.setGeom=function(e,t){this._geom=e,null!=e.glPrimitive&&(this._glPrimitive=e.glPrimitive),this._geom&&this._geom.name&&(this._name="mesh "+this._geom.name),I.lastMesh=null,this._cgl.profileData.profileMeshSetGeom++,this._disposeAttributes(),this.updateVertices(this._geom),this.setVertexIndices(this._geom.verticesIndices),this.addVertexNumbers&&this._setVertexNumbers();const n=this._geom.getAttributes(),a={texCoords:O.SHADERVAR_VERTEX_TEXCOORD,vertexNormals:O.SHADERVAR_VERTEX_NORMAL,vertexColors:O.SHADERVAR_VERTEX_COLOR,tangents:"attrTangent",biTangents:"attrBiTangent"};for(const e in n)n[e].data&&n[e].data.length&&this.setAttribute(a[e]||e,n[e].data,n[e].itemSize);t&&(this._geom=null)},y.prototype._preBind=function(t){for(let e=0;e<this._attributes.length;e++)this._attributes[e].cb&&this._attributes[e].cb(this._attributes[e],this._geom,t)},y.prototype._checkAttrLengths=function(){for(let e=0;e<this._attributes.length;e++)if(this._attributes[e].arrayLength/this._attributes[e].itemSize<this._attributes[0].arrayLength/this._attributes[0].itemSize){let e="unknown";this._geom&&(e=this._geom.name)}},y.prototype._bind=function(a){if(!a.isValid())return;let t=[];if(this._attribLocs[a.id]?t=this._attribLocs[a.id]:this._attribLocs[a.id]=t,this._lastShader=a,a.lastCompile>this._lastAttrUpdate||t.length!=this._attributes.length){this._lastAttrUpdate=a.lastCompile;for(let e=0;e<this._attributes.length;e++)t[e]=-1}for(let e=0;e<this._attributes.length;e++){const n=this._attributes[e];if(-1==t[e]&&n._attrLocationLastShaderTime!=a.lastCompile&&(n._attrLocationLastShaderTime=a.lastCompile,t[e]=this._cgl.glGetAttribLocation(a.getProgram(),n.name),this._cgl.profileData.profileAttrLoc++),-1!=t[e])if(this._cgl.gl.enableVertexAttribArray(t[e]),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,n.buffer),n.instanced)if(n.itemSize<=4)n.itemSize&&0!=n.itemSize||this._log.warn("instanced attrib itemsize error",this._geom.name,n),this._cgl.gl.vertexAttribPointer(t[e],n.itemSize,n.type,!1,4*n.itemSize,0),this._cgl.gl.vertexAttribDivisor(t[e],1);else if(16==n.itemSize){const a=64;this._cgl.gl.vertexAttribPointer(t[e],4,n.type,!1,a,0),this._cgl.gl.enableVertexAttribArray(t[e]+1),this._cgl.gl.vertexAttribPointer(t[e]+1,4,n.type,!1,a,16),this._cgl.gl.enableVertexAttribArray(t[e]+2),this._cgl.gl.vertexAttribPointer(t[e]+2,4,n.type,!1,a,32),this._cgl.gl.enableVertexAttribArray(t[e]+3),this._cgl.gl.vertexAttribPointer(t[e]+3,4,n.type,!1,a,48),this._cgl.gl.vertexAttribDivisor(t[e],1),this._cgl.gl.vertexAttribDivisor(t[e]+1,1),this._cgl.gl.vertexAttribDivisor(t[e]+2,1),this._cgl.gl.vertexAttribDivisor(t[e]+3,1)}else this._log.warn("unknown instance attrib size",n.name);else{if(n.itemSize&&0!=n.itemSize||this._log.warn("attrib itemsize error",this._name,n),this._cgl.gl.vertexAttribPointer(t[e],n.itemSize,n.type,!1,4*n.itemSize,0),n.pointer)for(let t=0;t<n.pointer.length;t++){const e=n.pointer[t];-1==e.loc&&(e.loc=this._cgl.glGetAttribLocation(a.getProgram(),e.name)),this._cgl.profileData.profileAttrLoc++,this._cgl.gl.enableVertexAttribArray(e.loc),this._cgl.gl.vertexAttribPointer(e.loc,n.itemSize,n.type,!1,e.stride,e.offset)}this.bindFeedback(n)}}0!==this._bufVerticesIndizes.numItems&&this._cgl.gl.bindBuffer(this._cgl.gl.ELEMENT_ARRAY_BUFFER,this._bufVerticesIndizes)},y.prototype.unBind=function(){const e=this._lastShader;if(this._lastShader=null,!e)return;let t=[];this._attribLocs[e.id]?t=this._attribLocs[e.id]:this._attribLocs[e.id]=t,I.lastMesh=null;for(let e=0;e<this._attributes.length;e++)this._attributes[e].instanced&&(this._attributes[e].itemSize<=4?(-1!=t[e]&&this._cgl.gl.vertexAttribDivisor(t[e],0),t[e]>=0&&this._cgl.gl.disableVertexAttribArray(t[e])):(this._cgl.gl.vertexAttribDivisor(t[e],0),this._cgl.gl.vertexAttribDivisor(t[e]+1,0),this._cgl.gl.vertexAttribDivisor(t[e]+2,0),this._cgl.gl.vertexAttribDivisor(t[e]+3,0),this._cgl.gl.disableVertexAttribArray(t[e]+1),this._cgl.gl.disableVertexAttribArray(t[e]+2),this._cgl.gl.disableVertexAttribArray(t[e]+3))),-1!=t[e]&&this._cgl.gl.disableVertexAttribArray(t[e])},y.prototype.meshChanged=function(){return this._cgl.lastMesh&&this._cgl.lastMesh!=this},y.prototype.printDebug=function(e){console.log("--attributes");for(let e=0;e<this._attributes.length;e++)console.log("attribute "+e+" "+this._attributes[e].name)},y.prototype.setNumVertices=function(e){this._bufVertexAttrib.numItems=e},y.prototype.getNumVertices=function(){return this._bufVertexAttrib.numItems},y.prototype.render=function(n){if(!n||!n.isValid())return;if(this._checkAttrLengths(),this._geom&&(!this._preWireframeGeom||n.wireframe||this._geom.isIndexed()||(this.setGeom(this._preWireframeGeom),this._preWireframeGeom=null),n.wireframe)){let e=!1;this._geom.isIndexed()&&(this._preWireframeGeom||(this._preWireframeGeom=this._geom,this._geom=this._geom.copy()),this._geom.unIndex(),e=!0),this._geom.getAttribute("attrBarycentric")||(this._preWireframeGeom||(this._preWireframeGeom=this._geom,this._geom=this._geom.copy()),e=!0,this._geom.calcBarycentric()),e&&this.setGeom(this._geom)}let e=!1;I.lastMesh!=this&&(I.lastMesh&&I.lastMesh.unBind(),e=!0),e&&this._preBind(n),n.bind(),this._bind(n),this.addVertexNumbers&&this._setVertexNumbers(),I.lastMesh=this;let t=this._cgl.gl.TRIANGLES;void 0!==this._glPrimitive&&(t=this._glPrimitive),null!==n.glPrimitive&&(t=n.glPrimitive);let a=1,r=this._cgl.profileData.doProfileGlQuery,o=!1;if(r){let e=this._name+" "+n.getName()+" #"+n.id;this._numInstances&&(e+=" instanced "+this._numInstances+"x");let t=this._cgl.profileData.glQueryData[e];if(t||(t={id:e,num:0},this._cgl.profileData.glQueryData[e]=t),this._queryExt||!1===this._queryExt||(this._queryExt=this._cgl.gl.getExtension("EXT_disjoint_timer_query_webgl2")||!1),this._queryExt){if(t._drawQuery){if(this._cgl.gl.getQueryParameter(t._drawQuery,this._cgl.gl.QUERY_RESULT_AVAILABLE)){const n=this._cgl.gl.getQueryParameter(t._drawQuery,this._cgl.gl.QUERY_RESULT)/1e6;t._times+=n,t._numcount++,t.when=performance.now(),t._drawQuery=null,t.queryStarted=!1}}t.queryStarted||(t._drawQuery=this._cgl.gl.createQuery(),this._cgl.gl.beginQuery(this._queryExt.TIME_ELAPSED_EXT,t._drawQuery),o=t.queryStarted=!0)}}if(this.hasFeedbacks()?this.drawFeedbacks(n,t):0===this._bufVerticesIndizes.numItems?(t==this._cgl.gl.TRIANGLES&&(a=3),0===this._numInstances?this._cgl.gl.drawArrays(t,this._bufVertexAttrib.startItem,this._bufVertexAttrib.numItems-this._bufVertexAttrib.startItem):this._cgl.gl.drawArraysInstanced(t,this._bufVertexAttrib.startItem,this._bufVertexAttrib.numItems,this._numInstances)):0===this._numInstances?this._cgl.gl.drawElements(t,this._bufVerticesIndizes.numItems,this._indexType,0):this._cgl.gl.drawElementsInstanced(t,this._bufVerticesIndizes.numItems,this._indexType,0,this._numInstances),this._cgl.debugOneFrame&&this._cgl.gl.getError()!=this._cgl.gl.NO_ERROR){this._log.error("mesh draw gl error"),this._log.error("mesh",this),this._log.error("shader",n);for(let e=0;e<this._cgl.gl.getProgramParameter(n.getProgram(),this._cgl.gl.ACTIVE_ATTRIBUTES);e++){const t=this._cgl.gl.getActiveAttrib(n.getProgram(),e).name;this._log.error("attrib ",t)}}this._cgl.profileData.profileMeshNumElements+=this._bufVertexAttrib.numItems/a*(this._numInstances||1),this._cgl.profileData.profileMeshDraw++,r&&o&&this._cgl.gl.endQuery(this._queryExt.TIME_ELAPSED_EXT),this.unBind()},y.prototype.setNumInstances=function(n){if(n=Math.max(0,n),this._numInstances!=n){this._numInstances=n;const t=new Float32Array(n);for(let e=0;e<n;e++)t[e]=e;this.setAttribute("instanceIndex",t,1,{instanced:!0})}},y.prototype._disposeAttributes=function(){if(this._attributes){for(let e=0;e<this._attributes.length;e++)this._attributes[e].buffer&&(this._cgl.gl.deleteBuffer(this._attributes[e].buffer),this._attributes[e].buffer=null);this._attributes.length=0}},y.prototype.dispose=function(){this._bufVertexAttrib&&this._bufVertexAttrib.buffer&&this._cgl.gl.deleteBuffer(this._bufVertexAttrib.buffer),this._bufVerticesIndizes&&this._cgl.gl.deleteBuffer(this._bufVerticesIndizes),this._bufVerticesIndizes=null,this._disposeAttributes()},function(e){e.prototype.hasFeedbacks=function(){return this._feedBacks.length>0},e.prototype.removeFeedbacks=function(e){this._feedbacks&&(this._feedbacks.length=0,this._feedBacksChanged=!0)},e.prototype.setAttributeFeedback=function(){},e.prototype.setFeedback=function(e,t,n){let a={nameOut:t},r=!1;this.unBindFeedbacks();for(let e=0;e<this._feedBacks.length;e++)this._feedBacks[e].nameOut==t&&(a=this._feedBacks[e],r=!0);return r||(this._feedBacksChanged=!0),a.initialArr=n,a.attrib=e,a.outBuffer&&this._cgl.gl.deleteBuffer(a.outBuffer),a.outBuffer=this._cgl.gl.createBuffer(),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,a.outBuffer),this._cgl.gl.bufferData(this._cgl.gl.ARRAY_BUFFER,a.initialArr,this._cgl.gl.STATIC_DRAW),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,a.attrib.buffer),this._cgl.gl.bufferData(this._cgl.gl.ARRAY_BUFFER,a.initialArr,this._cgl.gl.STATIC_DRAW),r||this._feedBacks.push(a),a},e.prototype.bindFeedback=function(n){if(!this._feedBacks||0===this._feedBacks.length)return;-1==this._transformFeedBackLoc&&(this._transformFeedBackLoc=this._cgl.gl.createTransformFeedback()),this._cgl.gl.bindTransformFeedback(this._cgl.gl.TRANSFORM_FEEDBACK,this._transformFeedBackLoc);let a=!1;for(let t=0;t<this._feedBacks.length;t++){const e=this._feedBacks[t];e.attrib==n&&(a=!0,this._cgl.gl.bindBufferBase(this._cgl.gl.TRANSFORM_FEEDBACK_BUFFER,t,e.outBuffer))}},e.prototype.drawFeedbacks=function(e,t){let n=0;if(this._feedBacksChanged){const t=[];for(this._cgl.gl.bindTransformFeedback(this._cgl.gl.TRANSFORM_FEEDBACK,this._transformFeedBackLoc),n=0;n<this._feedBacks.length;n++)t.push(this._feedBacks[n].nameOut);return e.setFeedbackNames(t),console.log("feedbacknames",t),e.compile(),this._feedBacksChanged=!1,this._cgl.gl.bindTransformFeedback(this._cgl.gl.TRANSFORM_FEEDBACK,null),void console.log("changed finished")}this._cgl.gl.beginTransformFeedback(this.glPrimitive),this._cgl.gl.drawArrays(t,0,this._feedBacks[0].attrib.numItems),this._cgl.gl.endTransformFeedback(),this.unBindFeedbacks(),this.feedBacksSwapBuffers()},e.prototype.unBindFeedbacks=function(){for(let e=0;e<this._feedBacks.length;e++)this._cgl.gl.bindBufferBase(this._cgl.gl.TRANSFORM_FEEDBACK_BUFFER,e,null);this._cgl.gl.bindTransformFeedback(this._cgl.gl.TRANSFORM_FEEDBACK,null)},e.prototype.feedBacksSwapBuffers=function(){for(let t=0;t<this._feedBacks.length;t++){const e=this._feedBacks[t].attrib.buffer;this._feedBacks[t].attrib.buffer=this._feedBacks[t].outBuffer,this._feedBacks[t].outBuffer=e}}}(y);const T={getSimpleRect:function(e,t){const n=new p(t);return n.vertices=[1,1,0,-1,1,0,1,-1,0,-1,-1,0],n.texCoords=[1,1,0,1,1,0,0,0],n.verticesIndices=[0,1,2,2,1,3],n.vertexNormals=[0,0,0,0,0,0,0,0,0,0,0,0],new y(e,n)}};CGL.CopyTexture=class{constructor(e,t,n){this.cgl=e,this._options=n,this.fb=null;const a=n.shader||"".endl()+"UNI sampler2D tex;".endl()+"IN vec2 texCoord;".endl()+"void main()".endl()+"{".endl()+"    vec4 col=texture(tex,texCoord);".endl()+"    outColor= col;".endl()+"}",r="".endl()+"IN vec3 vPosition;".endl()+"IN vec2 attrTexCoord;".endl()+"OUT vec2 texCoord;".endl()+"void main()".endl()+"{".endl()+"   texCoord=attrTexCoord;".endl()+"   gl_Position = vec4(vPosition,  1.0);".endl()+"}";this.bgShader=new CGL.Shader(e,"corelib copytexture "+t),this.bgShader.setSource(r,a);new CGL.Uniform(this.bgShader,"t","tex",0);this.mesh=T.getSimpleRect(this.cgl,"texEffectRect")}copy(e){if(!e)return CGL.Texture.getEmptyTexture(this.cgl);const a=this._options.width||e.width,r=this._options.height||e.height,o=this.cgl;if(this.fb)this.fb.getWidth()==a&&this.fb.getHeight()==r||this.fb.setSize(a,r);else{let e=CGL.Texture.FILTER_LINEAR,t=CGL.Texture.WRAP_CLAMP_TO_EDGE;this._options.hasOwnProperty("filter")&&(e=this._options.filter),this._options.hasOwnProperty("wrap")&&(t=this._options.wrap);const n={isFloatingPointTexture:this._options.isFloatingPointTexture,numRenderBuffers:this._options.numRenderBuffers||1,filter:e,wrap:t};1==o.glVersion?this.fb=new CGL.Framebuffer(o,a,r,n):this.fb=new CGL.Framebuffer2(o,a,r,n)}return o.frameStore.renderOffscreen=!0,this.fb.renderStart(o),o.setTexture(0,e.tex),o.pushShader(this.bgShader),this.mesh.render(this.bgShader),o.popShader(),this.fb.renderEnd(),o.frameStore.renderOffscreen=!1,this.fb.getTextureColor()}dispose(){this.fb&&this.fb.dispose(),this.bgShader&&this.bgShader.dispose(),this.mesh&&this.mesh.dispose()}}}]).Copytexture;this.CGL=this.CGL||{},this.CGL.COREMODULES=this.CGL.COREMODULES||{},this.CGL.COREMODULES.Shadermodifier=function(n){var a={};function r(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=n,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,n){"use strict";n.r(t);CGL.ShaderModifier=class{constructor(e,t,n){this._cgl=e,this._name=t,this._origShaders={},this._uniforms=[],this._structUniforms=[],this._definesToggled={},this._defines={},this._mods=[],this._textures=[],this._boundShader=null,this._changedDefines=!0,this._changedUniforms=!0,this._modulesChanged=!1,this.needsTexturePush=!1,this._lastShader=null,this._attributes=[],1==this._cgl.glVersion&&(this._cgl.gl.getExtension("OES_texture_float"),this._cgl.gl.getExtension("OES_texture_float_linear"),this._cgl.gl.getExtension("OES_texture_half_float"),this._cgl.gl.getExtension("OES_texture_half_float_linear"))}bind(){const n=this._cgl.getShader();if(!n)return;this._boundShader=this._origShaders[n.id];let a=!1;if(this._boundShader&&this._lastShader!=this._boundShader.shader&&(this._boundShader.shader.hasModule(this._mods[0].id)||(a=!0)),(a||!this._boundShader||n.lastCompile!=this._boundShader.lastCompile||this._modulesChanged||n._needsRecompile)&&(this._boundShader&&this._boundShader.shader.dispose(),n._needsRecompile&&n.compile(),this._boundShader=this._origShaders[n.id]={lastCompile:n.lastCompile,orig:n,shader:n.copy()},1==this._cgl.glVersion&&(this._boundShader.shader.enableExtension("GL_OES_standard_derivatives"),this._boundShader.shader.enableExtension("GL_OES_texture_float"),this._boundShader.shader.enableExtension("GL_OES_texture_float_linear"),this._boundShader.shader.enableExtension("GL_OES_texture_half_float"),this._boundShader.shader.enableExtension("GL_OES_texture_half_float_linear")),this._addModulesToShader(this._boundShader.shader),this._updateDefinesShader(this._boundShader.shader),this._updateUniformsShader(this._boundShader.shader)),this._boundShader.wireframe=n.wireframe,this._changedDefines&&this._updateDefines(),this._changedUniforms&&this._updateUniforms(),this._cgl.pushShader(this._boundShader.shader),this._boundShader.shader.copyUniformValues(this._boundShader.orig),this.needsTexturePush){for(let t=0;t<this._textures.length;t+=1){const a=this._textures[t][0],e=this._textures[t][1],r=this._textures[t][2];if(this._getUniform(a)){const n=this.getPrefixedName(a),o=this._boundShader.shader.getUniform(n);o&&this._boundShader.shader.pushTexture(o,e,r)}}this.needsTexturePush=!1,this._textures.length=0}this._modulesChanged=!1}unbind(){this._boundShader&&this._cgl.popShader(),this._boundShader=null}_addModulesToShader(t){let n;this._mods.length>1&&(n=this._mods[0]);for(let e=0;e<this._mods.length;e++)t.addModule(this._mods[e],n)}_removeModulesFromShader(t){for(const e in this._origShaders)this._origShaders[e].shader.removeModule(t)}addModule(e){this._mods.push(e),this._modulesChanged=!0}removeModule(t){const n=[];for(let e=0;e<this._mods.length;e++)this._mods[e].title==t&&(this._removeModulesFromShader(this._mods[e]),n.push(e));for(let e=n.length-1;e>=0;e-=1)this._mods.splice(n[e],1);this._modulesChanged=!0}_updateUniformsShader(r){for(let e=0;e<this._uniforms.length;e++){const t=this._uniforms[e],n=this.getPrefixedName(t.name);if(!r.hasUniform(n)&&!t.structName){let e=null;"both"===t.shaderType?(e=r.addUniformBoth(t.type,n,t.v1,t.v2,t.v3,t.v4),e.comment="mod: "+this._name):"frag"===t.shaderType?(e=r.addUniformFrag(t.type,n,t.v1,t.v2,t.v3,t.v4),e.comment="mod: "+this._name):"vert"===t.shaderType&&(e=r.addUniformVert(t.type,n,t.v1,t.v2,t.v3,t.v4),e.comment="mod: "+this._name)}}for(let a=0;a<this._structUniforms.length;a+=1){const e=this._structUniforms[a];let t=e.uniformName,n=e.structName;const o=e.members;t=this.getPrefixedName(e.uniformName),n=this.getPrefixedName(e.structName),"frag"===e.shaderType&&r.addUniformStructFrag(n,t,o),"vert"===e.shaderType&&r.addUniformStructVert(n,t,o),"both"===e.shaderType&&r.addUniformStructBoth(n,t,o)}}_updateUniforms(){for(const e in this._origShaders)this._updateUniformsShader(this._origShaders[e].shader);this._changedUniforms=!1}_setUniformValue(e,t,n){const a=e.getUniform(t);a&&a.setValue(n)}setUniformValue(e,t){if(!this._getUniform(e))return;const n=this.getPrefixedName(e);for(const e in this._origShaders)this._setUniformValue(this._origShaders[e].shader,n,t)}hasUniform(e){return this._getUniform(e)}_getUniform(t){for(let e=0;e<this._uniforms.length;e++){if(this._uniforms[e].name==t)return this._uniforms[e];if(this._uniforms[e].structName&&this._uniforms[e].propertyName==t)return this._uniforms[e]}return!1}_getStructUniform(t){for(let e=0;e<this._structUniforms.length;e+=1)if(this._structUniforms[e].uniformName===t)return this._structUniforms[e];return null}_isStructUniform(t){for(let e=0;e<this._uniforms.length;e++){if(this._uniforms[e].name==t)return!1;if(this._uniforms[e].structName&&this._uniforms[e].propertyName==t)return!0}return!1}addUniform(t,n,a,r,o,i,s,l,c,u){if(!this._getUniform(n)){let e="both";u&&(e=u),this._uniforms.push({type:t,name:n,v1:a,v2:r,v3:o,v4:i,structUniformName:s,structName:l,propertyName:c,shaderType:e}),this._changedUniforms=!0}}addUniformFrag(e,t,n,a,r,o){this.addUniform(e,t,n,a,r,o,null,null,null,"frag"),this._changedUniforms=!0}addUniformVert(e,t,n,a,r,o){this.addUniform(e,t,n,a,r,o,null,null,null,"vert"),this._changedUniforms=!0}addUniformBoth(e,t,n,a,r,o){this.addUniform(e,t,n,a,r,o,null,null,null,"both"),this._changedUniforms=!0}addUniformStruct(t,n,a,r){for(let e=0;e<a.length;e+=1){const o=a[e];"2i"!==o.type&&"i"!==o.type&&"3i"!==o.type||"both"!==r||console.error("Adding an integer struct member to both shaders can potentially error. Please use different structs for each shader. Error occured in struct:",t," with member:",o.name," of type:",o.type,"."),this._getUniform(n+"."+o.name)||this.addUniform(o.type,n+"."+o.name,o.v1,o.v2,o.v3,o.v4,n,t,o.name,r)}this._getStructUniform(n)||this._structUniforms.push({structName:t,uniformName:n,members:a,shaderType:r})}addUniformStructVert(e,t,n){this.addUniformStruct(e,t,n,"vert")}addUniformStructFrag(e,t,n){this.addUniformStruct(e,t,n,"frag")}addUniformStructBoth(e,t,n){this.addUniformStruct(e,t,n,"both")}addAttribute(t){for(let e=0;e<this._attributes.length;e++)if(this._attributes[e].name==t.name&&this._attributes[e].nameFrag==t.nameFrag)return;this._attributes.push(t)}pushTexture(e,t,n){if(!t)throw new Error("no texture given to texturestack");this._textures.push([e,t,n]),this.needsTexturePush=!0}_removeUniformFromShader(e,t){t.hasUniform(e)&&t.removeUniform(e)}removeUniform(n){if(this._getUniform(n)){for(let t=this._uniforms.length-1;t>=0;t-=1){const e=n;if(this._uniforms[t].name==n&&!this._uniforms[t].structName){for(const n in this._origShaders)this._removeUniformFromShader(this.getPrefixedName(e),this._origShaders[n].shader);this._uniforms.splice(t,1)}}this._changedUniforms=!0}}removeUniformStruct(n){if(this._getStructUniform(n)){for(let e=this._structUniforms.length-1;e>=0;e-=1){const t=this._structUniforms[e];if(t.uniformName===n){for(const n in this._origShaders)for(let e=0;e<t.members.length;e+=1){const a=t.members[e];this._removeUniformFromShader(this.getPrefixedName(a.name),this._origShaders[n].shader)}this._structUniforms.splice(e,1)}}this._changedUniforms=!0}}getPrefixedName(e){const t=this._mods[0].group;if(void 0!==t)return 0==e.indexOf("MOD_")&&(e="mod"+t+"_"+(e=e.substr("MOD_".length))),e}_updateDefinesShader(n){for(const t in this._defines){const e=this.getPrefixedName(t);null!==this._defines[t]&&void 0!==this._defines[t]?n.define(e,this._defines[t]):n.removeDefine(e)}for(const t in this._definesToggled){const e=this.getPrefixedName(t);n.toggleDefine(e,this._definesToggled[t])}}_updateDefines(){for(const e in this._origShaders)this._updateDefinesShader(this._origShaders[e].shader);this._changedDefines=!1}define(e,t){this._defines[e]=t,this._changedDefines=!0}removeDefine(e){this._defines[e]=null,this._changedDefines=!0}hasDefine(e){return null!==this._defines[e]&&void 0!==this._defines[e]}toggleDefine(e,t){this._changedDefines=!0,this._definesToggled[e]=t}currentShader(){return this._boundShader.shader}dispose(){}}}]).Shadermodifier;
